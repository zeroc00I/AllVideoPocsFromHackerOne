{"id":419896,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTk4OTY=","url":"https://hackerone.com/reports/419896","title":"Unauthenticated user can upload an attachment to the last updated report draft","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-10-06T01:09:10.501Z","submitted_at":"2018-10-06T01:09:10.501Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-09T23:55:44.633Z","bug_reporter_agreed_on_going_public_at":"2018-10-09T23:53:52.318Z","team_member_agreed_on_going_public_at":"2018-10-09T23:55:44.496Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The newly launched beta embedded submissions form introduced the concept of anonymous submissions. When an anonymous user starts writing a report through an embedded form, a UUID will be generated to track their submission. Any object that is created will reference this UUID. We call this a `tracer`. Because anonymous submissions also allow the person to upload attachments, we made a minor update to the controller. Here's a snippet of the controller:\n\n```ruby\nskip_before_action :authenticate_user!, only: :create\n\ndef create\n  attachment = Interactors::Attachments::Upload.interact(\n    file: params[:file],\n    attachable: report_draft,\n    as_user: current_user,\n  )\n\n  # ...\nend\n\n# ...\n\nprivate\n\ndef report_draft\n  return unless params[:tracer].present?\n  ReportDraft.find_by(tracer: params[:tracer])\nend\n```\n\nWhen a `POST` request is sent to the `/attachments` endpoint, the `create` method will be called. This method will call the `report_draft` method, which will try to load the report draft. In case a `tracer` value hasn't been given or the `tracer` value is not found, the method will return `nil`. Any report draft with a `tracer` value that is `nil` is created by an authenticated user, as we identify those based on their author, not the `tracer` value.\n\nAt first sight, this seems to be fine because of the `return unless params[:tracer].present?` check. If the parameter wouldn't be submitted, the value would be `nil`, and therefor the `present?` method would return false. However, when the user submits an array with one element that contains a null byte, the `present?` check will return true, and the ActiveRecord query will execute an `IS NULL` query. Here's a code example that shows this behavior:\n\n```\n[1] pry(main)\u003e [\"\\x00\"].present?\n=\u003e true\n[2] pry(main)\u003e ReportDraft.find_by(tracer: [\"\\x00\"])\n   ReportDraft Load (1.0ms)  SELECT  \"report_drafts\".* FROM \"report_drafts\" WHERE \"report_drafts\".\"tracer\" IS NULL LIMIT $1  [[\"LIMIT\", 1]]\n=\u003e #\u003cReportDraft:0x00007fcd94ae6dc0\u003e\n```\n\nHere's a normal request that is submitted to the attachments controller when an anonymous user uploads anything:\n\n```\nPOST /attachments HTTP/1.1\nHost: localhost:8080\n...\n\n------WebKitFormBoundarylWiasZL7nPVPOJ9M\nContent-Disposition: form-data; name=\"tracer\";\n\n04b0e56b-da08-4d3e-8962-f2455cfdbd19\n------WebKitFormBoundarylWiasZL7nPVPOJ9M\nContent-Disposition: form-data; name=\"file\"; filename=\"file.txt\"\nContent-Type: text/plain\n\nfile-contents\n------WebKitFormBoundarylWiasZL7nPVPOJ9M--\n```\n\nIn order to properly inject the array containing the null byte, the hex view in Burp Suite can be used. Here is the original request in the hex editor, in which case it has a proper UUID in the `tracer` parameter:\n\n{F356266}\n\nHere is the updated request, where the `tracer` parameter has been changed to an array and the value has been changed to a null byte:\n\n{F356267}\n\n## Impact\n\nThis means that if an array with a null byte to the `/attachments` endpoint is submitted, a random report draft will be loaded that was created by an authenticated user. The attachment will then be attached to that report draft. This allows an attacker to inject attachments in other users' report drafts, before it is submitted to the program.\n\nThe vulnerability requires user interaction to be exploited. When a user submits the report form, only the attachment IDs will be submitted that are cached in the DOM. This means that the injected attachment will only be submitted when the user refreshes the page **before** submitting the report. This means that they may actually detect the injected attachment, and they will have the ability to delete it.","vulnerability_information_html":"\u003cp\u003eThe newly launched beta embedded submissions form introduced the concept of anonymous submissions. When an anonymous user starts writing a report through an embedded form, a UUID will be generated to track their submission. Any object that is created will reference this UUID. We call this a \u003ccode\u003etracer\u003c/code\u003e. Because anonymous submissions also allow the person to upload attachments, we made a minor update to the controller. Here\u0026#39;s a snippet of the controller:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eskip_before_action\u003c/span\u003e \u003cspan class=\"ss\"\u003e:authenticate_user!\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eonly: :create\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eattachment\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eInteractors\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAttachments\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eUpload\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einteract\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003efile: \u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:file\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003eattachable: \u003c/span\u003e\u003cspan class=\"n\"\u003ereport_draft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"ss\"\u003eas_user: \u003c/span\u003e\u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# ...\u003c/span\u003e\n\n\u003cspan class=\"kp\"\u003eprivate\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ereport_draft\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tracer\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003epresent?\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eReportDraft\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind_by\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003etracer: \u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tracer\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhen a \u003ccode\u003ePOST\u003c/code\u003e request is sent to the \u003ccode\u003e/attachments\u003c/code\u003e endpoint, the \u003ccode\u003ecreate\u003c/code\u003e method will be called. This method will call the \u003ccode\u003ereport_draft\u003c/code\u003e method, which will try to load the report draft. In case a \u003ccode\u003etracer\u003c/code\u003e value hasn\u0026#39;t been given or the \u003ccode\u003etracer\u003c/code\u003e value is not found, the method will return \u003ccode\u003enil\u003c/code\u003e. Any report draft with a \u003ccode\u003etracer\u003c/code\u003e value that is \u003ccode\u003enil\u003c/code\u003e is created by an authenticated user, as we identify those based on their author, not the \u003ccode\u003etracer\u003c/code\u003e value.\u003c/p\u003e\n\n\u003cp\u003eAt first sight, this seems to be fine because of the \u003ccode\u003ereturn unless params[:tracer].present?\u003c/code\u003e check. If the parameter wouldn\u0026#39;t be submitted, the value would be \u003ccode\u003enil\u003c/code\u003e, and therefor the \u003ccode\u003epresent?\u003c/code\u003e method would return false. However, when the user submits an array with one element that contains a null byte, the \u003ccode\u003epresent?\u003c/code\u003e check will return true, and the ActiveRecord query will execute an \u003ccode\u003eIS NULL\u003c/code\u003e query. Here\u0026#39;s a code example that shows this behavior:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[1] pry(main)\u0026gt; [\u0026quot;\\x00\u0026quot;].present?\n=\u0026gt; true\n[2] pry(main)\u0026gt; ReportDraft.find_by(tracer: [\u0026quot;\\x00\u0026quot;])\n   ReportDraft Load (1.0ms)  SELECT  \u0026quot;report_drafts\u0026quot;.* FROM \u0026quot;report_drafts\u0026quot; WHERE \u0026quot;report_drafts\u0026quot;.\u0026quot;tracer\u0026quot; IS NULL LIMIT $1  [[\u0026quot;LIMIT\u0026quot;, 1]]\n=\u0026gt; #\u0026lt;ReportDraft:0x00007fcd94ae6dc0\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHere\u0026#39;s a normal request that is submitted to the attachments controller when an anonymous user uploads anything:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /attachments HTTP/1.1\nHost: localhost:8080\n...\n\n------WebKitFormBoundarylWiasZL7nPVPOJ9M\nContent-Disposition: form-data; name=\u0026quot;tracer\u0026quot;;\n\n04b0e56b-da08-4d3e-8962-f2455cfdbd19\n------WebKitFormBoundarylWiasZL7nPVPOJ9M\nContent-Disposition: form-data; name=\u0026quot;file\u0026quot;; filename=\u0026quot;file.txt\u0026quot;\nContent-Type: text/plain\n\nfile-contents\n------WebKitFormBoundarylWiasZL7nPVPOJ9M--\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn order to properly inject the array containing the null byte, the hex view in Burp Suite can be used. Here is the original request in the hex editor, in which case it has a proper UUID in the \u003ccode\u003etracer\u003c/code\u003e parameter:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-10-05_at_6.06.40_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/266/09c4c768f1000741fa36a1867afea54f3f7241c6/Screen_Shot_2018-10-05_at_6.06.40_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-05_at_6.06.40_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-05_at_6.06.40_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=81571add691bcd1a269f107efd6e9e7122e2f422662ea223a8876cf7d9b217d2\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/266/09c4c768f1000741fa36a1867afea54f3f7241c6/Screen_Shot_2018-10-05_at_6.06.40_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-05_at_6.06.40_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-05_at_6.06.40_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=81571add691bcd1a269f107efd6e9e7122e2f422662ea223a8876cf7d9b217d2\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHere is the updated request, where the \u003ccode\u003etracer\u003c/code\u003e parameter has been changed to an array and the value has been changed to a null byte:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-10-05_at_6.07.50_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/267/38bd4e96d69bdca221ee0aa1ed097d1b9707df01/Screen_Shot_2018-10-05_at_6.07.50_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-05_at_6.07.50_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-05_at_6.07.50_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=785ae3dc53605e8f0595bdd459e3354872448a6be48b7411f506c9f304ac3008\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/267/38bd4e96d69bdca221ee0aa1ed097d1b9707df01/Screen_Shot_2018-10-05_at_6.07.50_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-05_at_6.07.50_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-05_at_6.07.50_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026amp;X-Amz-Signature=785ae3dc53605e8f0595bdd459e3354872448a6be48b7411f506c9f304ac3008\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis means that if an array with a null byte to the \u003ccode\u003e/attachments\u003c/code\u003e endpoint is submitted, a random report draft will be loaded that was created by an authenticated user. The attachment will then be attached to that report draft. This allows an attacker to inject attachments in other users\u0026#39; report drafts, before it is submitted to the program.\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability requires user interaction to be exploited. When a user submits the report form, only the attachment IDs will be submitted that are cached in the DOM. This means that the injected attachment will only be submitted when the user refreshes the page \u003cstrong\u003ebefore\u003c/strong\u003e submitting the report. This means that they may actually detect the injected attachment, and they will have the ability to delete it.\u003c/p\u003e\n","weakness":{"id":14,"name":"Improper Null Termination"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":356266,"file_name":"Screen_Shot_2018-10-05_at_6.06.40_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/266/09c4c768f1000741fa36a1867afea54f3f7241c6/Screen_Shot_2018-10-05_at_6.06.40_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-05_at_6.06.40_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-05_at_6.06.40_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=81571add691bcd1a269f107efd6e9e7122e2f422662ea223a8876cf7d9b217d2","file_size":34709,"type":"image/png"},{"id":356267,"file_name":"Screen_Shot_2018-10-05_at_6.07.50_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/267/38bd4e96d69bdca221ee0aa1ed097d1b9707df01/Screen_Shot_2018-10-05_at_6.07.50_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-05_at_6.07.50_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-05_at_6.07.50_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=785ae3dc53605e8f0595bdd459e3354872448a6be48b7411f506c9f304ac3008","file_size":21377,"type":"image/png"}],"allow_singular_disclosure_at":"2018-11-08T23:53:52.460Z","allow_singular_disclosure_after":-67500093.20610547,"singular_disclosure_allowed":true,"vote_count":80,"voters":["arneswinnen","sp1d3rs","smiegles","kapytein","jobert","michiel","inhibitor181","muon4","danila","spam404","and 70 more..."],"severity":{"rating":"high","score":8.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3442256,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-06T01:09:31.338Z","updated_at":"2018-10-06T01:09:31.338Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3443722,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"A fix was deployed last night.","markdown_message":"\u003cp\u003eA fix was deployed last night.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-06T17:31:01.208Z","updated_at":"2018-10-06T17:31:01.208Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3444112,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-06T20:56:51.769Z","updated_at":"2018-10-06T20:56:51.769Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3444113,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-06T20:56:52.350Z","updated_at":"2018-10-06T20:56:52.350Z","actor":{"username":"popeax","cleared":true,"url":"/popeax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/350/7af44ed51419e756a0f92b59a8f66ae3285cf890_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3444114,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-06T20:56:53.039Z","updated_at":"2018-10-06T20:56:53.039Z","actor":{"username":"bull","cleared":true,"url":"/bull","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3444115,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-06T20:56:53.753Z","updated_at":"2018-10-06T20:56:53.753Z","actor":{"username":"meals","cleared":true,"url":"/meals","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/411/6d37adb1666131d39f36c8e0d715709b7381b052_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3444677,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"can you provide any test embedded submission form, since the feature is in beta?\nthanks","markdown_message":"\u003cp\u003ecan you provide any test embedded submission form, since the feature is in beta?\u003cbr\u003e\nthanks\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-07T07:24:17.463Z","updated_at":"2018-10-07T07:24:17.463Z","actor":{"username":"bull","cleared":true,"url":"/bull","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/224/c7a38e937595fb38aba8f664ca35626c15243a0d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3445837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bull here is an anonymous submission form for Parrot Sec -- @parrotsec: https://hackerone.com/0a1e1f11-257e-4b46-b949-c7151212ffbb/embedded_submissions/new","markdown_message":"\u003cp\u003e\u003ca href=\"/bull\"\u003e@bull\u003c/a\u003e here is an anonymous submission form for Parrot Sec -- \u003ca href=\"/parrotsec\"\u003e@parrotsec\u003c/a\u003e: \u003ca title=\"https://hackerone.com/0a1e1f11-257e-4b46-b949-c7151212ffbb/embedded_submissions/new\" href=\"https://hackerone.com/0a1e1f11-257e-4b46-b949-c7151212ffbb/embedded_submissions/new\"\u003ehttps://hackerone.com/0a1e1f11-257e-4b46-b949-c7151212ffbb/embedded_submissions/new\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-07T17:51:41.943Z","updated_at":"2018-10-07T17:51:41.943Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3449110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Verification screenshot.","markdown_message":"\u003cp\u003eVerification screenshot.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-08T15:34:37.016Z","updated_at":"2018-10-08T15:34:37.016Z","actor":{"username":"popeax","cleared":true,"url":"/popeax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/350/7af44ed51419e756a0f92b59a8f66ae3285cf890_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":357298,"filename":"419896_verification_1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/357/298/3f723a16dc7052398f893e6caacb860604c2eb92/419896_verification_1.png?response-content-disposition=attachment%3B%20filename%3D%22419896_verification_1.png%22%3B%20filename%2A%3DUTF-8%27%27419896_verification_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=c7b089fdc11d5df2617a828009539eeebf0b12088f6724358f77355c7eb1b0ee"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3449115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@michiel I would suggest allowing (and requiring) attachment uploads with this new retest feature.  ","markdown_message":"\u003cp\u003e\u003ca href=\"/michiel\"\u003e@michiel\u003c/a\u003e I would suggest allowing (and requiring) attachment uploads with this new retest feature.  \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-08T15:36:30.741Z","updated_at":"2018-10-08T15:36:30.741Z","actor":{"username":"popeax","cleared":true,"url":"/popeax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/350/7af44ed51419e756a0f92b59a8f66ae3285cf890_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3449160,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert @michiel One thing I don't understand here is this tracer is generated client side and should be a UUID format.  Based on the application's response, tracer values such as \"zzzzzzzz-zzzz-zzzz-zzzz-zzzzzzzzzzzzzz\" are accepted.  \"zzzzzzzz-zzzz-zzzz-zzzz-zzzzzzzzzzz\" is not accepted\", which indicates to me any alpha numeric string is accepted provided if it is of a sufficient length.  No idea if that is a concern.","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e \u003ca href=\"/michiel\"\u003e@michiel\u003c/a\u003e One thing I don\u0026#39;t understand here is this tracer is generated client side and should be a UUID format.  Based on the application\u0026#39;s response, tracer values such as \u0026quot;zzzzzzzz-zzzz-zzzz-zzzz-zzzzzzzzzzzzzz\u0026quot; are accepted.  \u0026quot;zzzzzzzz-zzzz-zzzz-zzzz-zzzzzzzzzzz\u0026quot; is not accepted\u0026quot;, which indicates to me any alpha numeric string is accepted provided if it is of a sufficient length.  No idea if that is a concern.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-08T15:47:51.769Z","updated_at":"2018-10-08T15:48:19.832Z","actor":{"username":"popeax","cleared":true,"url":"/popeax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/350/7af44ed51419e756a0f92b59a8f66ae3285cf890_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3458173,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @popeax - good point. We'll further restrict the regular expression to make sure that it only matches `/a-f0-9/` rather than `/a-z0-9/`.\n\n@cablej,  @popeax, and @bull - thanks for completing the retest, it's much appreciated! No one identified a regression or bypass for the security vulnerability that was initially reported. @meals notified us that he isn't able to complete the retest at this time. We're going ahead and publicly disclose this report.\n\nGood luck and happy hacking!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/popeax\"\u003e@popeax\u003c/a\u003e - good point. We\u0026#39;ll further restrict the regular expression to make sure that it only matches \u003ccode\u003e/a-f0-9/\u003c/code\u003e rather than \u003ccode\u003e/a-z0-9/\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/cablej\"\u003e@cablej\u003c/a\u003e,  \u003ca href=\"/popeax\"\u003e@popeax\u003c/a\u003e, and \u003ca href=\"/bull\"\u003e@bull\u003c/a\u003e - thanks for completing the retest, it\u0026#39;s much appreciated! No one identified a regression or bypass for the security vulnerability that was initially reported. \u003ca href=\"/meals\"\u003e@meals\u003c/a\u003e notified us that he isn\u0026#39;t able to complete the retest at this time. We\u0026#39;re going ahead and publicly disclose this report.\u003c/p\u003e\n\n\u003cp\u003eGood luck and happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-09T23:53:52.360Z","updated_at":"2018-10-09T23:53:52.360Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3458174,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-09T23:55:44.545Z","updated_at":"2018-10-09T23:55:44.545Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3458175,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-09T23:55:44.659Z","updated_at":"2018-10-09T23:55:44.659Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3471987,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-12T17:27:04.644Z","updated_at":"2018-10-12T17:27:04.644Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3534536,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@popeax's comment made us realize that passing down `zzzzzzzz-zzzz-zzzz-zzzz-zzzzzzzzzzzzzz` as UUID was a bypass for the original fix. His report, the bypass, and the explanation why it was a bypass have been documented in #423073 and it'll be disclosed soon. Thanks, @popeax!","markdown_message":"\u003cp\u003e\u003ca href=\"/popeax\"\u003e@popeax\u003c/a\u003e\u0026#39;s comment made us realize that passing down \u003ccode\u003ezzzzzzzz-zzzz-zzzz-zzzz-zzzzzzzzzzzzzz\u003c/code\u003e as UUID was a bypass for the original fix. His report, the bypass, and the explanation why it was a bypass have been documented in \u003ca href=\"/reports/423073\"\u003e#423073\u003c/a\u003e and it\u0026#39;ll be disclosed soon. Thanks, \u003ca href=\"/popeax\"\u003e@popeax\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-25T19:18:25.017Z","updated_at":"2018-10-25T19:18:25.017Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":10960,"category":"team","content":"\"What, HackerOne resolved a report that was submitted by @jobert?\"\n\nAt HackerOne we often find security vulnerabilities ourselves. In most cases, we find them before new features even make it into production. Sometimes we find them when they're already in the wild. Recently we've launched a new feature called [retesting](https://docs.hackerone.com/hackers/retesting.html). Up until now, HackerOne would always retest our own findings. We're changing that. This is the first report we identified ourselves where we're expanding retesting to the community. When we identified this vulnerability, we filed a ticket to our own bug bounty program instead of filing an internal ticket. We then leveraged the community to retest the vulnerability and allow them to find a bypass.\n\nThis particular security vulnerability allowed an unauthenticated user to upload attachments and attach them to the last created report draft of other users. This was possible by sending a specially crafted request to the `/attachments` endpoint. Our investigation concluded that this was not abused.\n\nThanks to the hackers that retested this vulnerability!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u0026quot;What, HackerOne resolved a report that was submitted by \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e?\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eAt HackerOne we often find security vulnerabilities ourselves. In most cases, we find them before new features even make it into production. Sometimes we find them when they\u0026#39;re already in the wild. Recently we\u0026#39;ve launched a new feature called \u003ca href=\"https://docs.hackerone.com/hackers/retesting.html\"\u003eretesting\u003c/a\u003e. Up until now, HackerOne would always retest our own findings. We\u0026#39;re changing that. This is the first report we identified ourselves where we\u0026#39;re expanding retesting to the community. When we identified this vulnerability, we filed a ticket to our own bug bounty program instead of filing an internal ticket. We then leveraged the community to retest the vulnerability and allow them to find a bypass.\u003c/p\u003e\n\n\u003cp\u003eThis particular security vulnerability allowed an unauthenticated user to upload attachments and attach them to the last created report draft of other users. This was possible by sending a specially crafted request to the \u003ccode\u003e/attachments\u003c/code\u003e endpoint. Our investigation concluded that this was not abused.\u003c/p\u003e\n\n\u003cp\u003eThanks to the hackers that retested this vulnerability!\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}