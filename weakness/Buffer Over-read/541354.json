{"id":541354,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDEzNTQ=","url":"https://hackerone.com/reports/541354","title":"A specifically malformed MQTT Subscribe packet crashes MQTT Brokers using the mqtt-packet module for decoding  ","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-04-17T15:00:31.503Z","submitted_at":"2019-04-17T15:00:31.503Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lxndr","url":"/lxndr","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-5432"],"singular_disclosure_disabled":false,"disclosed_at":"2019-04-28T07:36:31.109Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-04-28T07:36:22.404Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report a buffer over-read in mqtt-packet respectively BufferList module.\nIt allows triggering an out of range read on a buffer which throws a RangeError. MQTT Brokers like mosca and aedes using this module can be forced to crash by sending a specifically malformed MQTT Subscribe packet. \n\n# Module\n\n**module name:** mqtt-packet\n**version:** 6.1.1\n**npm page:** `https://www.npmjs.com/package/mqtt-packet`\n\n## Module Description\n\nEncode and Decode MQTT 3.1.1, 5.0 packets the node way.\n\n## Module Stats\n\n114,635 weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\nFrom the original E-Mail to the Author:\n*Hey Matteo,\nwhile playing around with mosca/aedes and our fuzzing approach from IoT-Testware, I discovered some flaws which cause mosca/aedes to crash. Though, I assume the reasons originate from the mqtt-packet respectively bl modules. \nI didn't open an issue because the issue is IMHO quite critical. One could try to abuse to crash mosca/aedes without requiring any credentials, thus might lead to easy DoS attacks.\nThe malformed Subscribe Packet crashes mosca (v2.8.3) and aedes (v0.37.0), no valid credentials required.*\n\n## Steps To Reproduce:\n\n\u003e Detailed steps to reproduce with all required references/steps/commands. If there is any exploit code or reference to the package source code this is the place where it should be put.\n\n1. start either mosca or aedes MQTT Broker\n2. shoot the following command against the Broker (on localhost)\n  * `echo -ne '\\x104\\x00\\x04MQTT\\x04\\xc2\\x00\\xff\\x00\\x19alicedoesnotneedaclientid\\x00\\x05alice\\x00\\x06secret\\x82\\x19\\xa5\\xa6\\x00\\x15hello/topic/of/alice\\x00' | nc localhost 1883`\n  * the sent byte string contains 2 accumulated MQTT Packets. The second packet is a subscribe packet and is processed in any case and the Broker's Auth mechanisms are undermined.\n\n## Patch\n\nPlease find a GitHub patch attached.\n\n## Supporting Material/References:\n\n\u003e State all technical information about the stack where the vulnerability was found\n\n- Ubuntu 18.04.2 LTS\n- nodejs -v `v6.17.1`\n- npm -v `3.10.10`\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [Y] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nAn attacker can harm the availability of MQTT services which are using these modules.","vulnerability_information_html":"\u003cp\u003eI would like to report a buffer over-read in mqtt-packet respectively BufferList module.\u003cbr\u003e\nIt allows triggering an out of range read on a buffer which throws a RangeError. MQTT Brokers like mosca and aedes using this module can be forced to crash by sending a specifically malformed MQTT Subscribe packet. \u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e mqtt-packet\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 6.1.1\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/mqtt-packet\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eEncode and Decode MQTT 3.1.1, 5.0 packets the node way.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e114,635 weekly downloads\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eFrom the original E-Mail to the Author:\u003cbr\u003e\n\u003cem\u003eHey Matteo,\u003cbr\u003e\nwhile playing around with mosca/aedes and our fuzzing approach from IoT-Testware, I discovered some flaws which cause mosca/aedes to crash. Though, I assume the reasons originate from the mqtt-packet respectively bl modules. \u003cbr\u003e\nI didn\u0026#39;t open an issue because the issue is IMHO quite critical. One could try to abuse to crash mosca/aedes without requiring any credentials, thus might lead to easy DoS attacks.\u003cbr\u003e\nThe malformed Subscribe Packet crashes mosca (v2.8.3) and aedes (v0.37.0), no valid credentials required.\u003c/em\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eDetailed steps to reproduce with all required references/steps/commands. If there is any exploit code or reference to the package source code this is the place where it should be put.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003estart either mosca or aedes MQTT Broker\u003c/li\u003e\n\u003cli\u003eshoot the following command against the Broker (on localhost)\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eecho -ne \u0026#39;\\x104\\x00\\x04MQTT\\x04\\xc2\\x00\\xff\\x00\\x19alicedoesnotneedaclientid\\x00\\x05alice\\x00\\x06secret\\x82\\x19\\xa5\\xa6\\x00\\x15hello/topic/of/alice\\x00\u0026#39; | nc localhost 1883\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003ethe sent byte string contains 2 accumulated MQTT Packets. The second packet is a subscribe packet and is processed in any case and the Broker\u0026#39;s Auth mechanisms are undermined.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003ePlease find a GitHub patch attached.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eState all technical information about the stack where the vulnerability was found\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eUbuntu 18.04.2 LTS\u003c/li\u003e\n\u003cli\u003enodejs -v \u003ccode\u003ev6.17.1\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003enpm -v \u003ccode\u003e3.10.10\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [Y] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can harm the availability of MQTT services which are using these modules.\u003c/p\u003e\n","weakness":{"id":9,"name":"Buffer Over-read"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":470856,"file_name":"fix_malformed_subscribe_crash.patch","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/470/856/5ce59c60e49c87feb9b3ea1f26938d8965c235f2/fix_malformed_subscribe_crash.patch?response-content-disposition=attachment%3B%20filename%3D%22fix_malformed_subscribe_crash.patch%22%3B%20filename%2A%3DUTF-8%27%27fix_malformed_subscribe_crash.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061642Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=2a0ad49d58654de0e942d9eb5977a4f2542c9dfb318d5f12cdf782798914b2b9","file_size":1714,"type":"text/x-diff"}],"allow_singular_disclosure_at":"2019-05-28T07:36:22.481Z","allow_singular_disclosure_after":-50193619.86393773,"singular_disclosure_allowed":true,"vote_count":3,"voters":["bl4de","khizer47","questsin"],"severity":{"rating":"high","score":7.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":25530,"asset_type":"SOURCE_CODE","asset_identifier":"mqtt-packet","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4584562,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-04-17T15:00:38.006Z","updated_at":"2019-04-17T15:00:38.006Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4585108,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-17T15:50:56.502Z","updated_at":"2019-04-17T15:50:56.502Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4587028,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi¬†@lxndr,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\nI invited Matteo to the issue to confirm, and coordinate a fix.\n","markdown_message":"\u003cp\u003eHi¬†@lxndr,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\u003cbr\u003e\nI invited Matteo to the issue to confirm, and coordinate a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T21:05:05.783Z","updated_at":"2019-04-17T21:05:05.783Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4587039,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mcollina can you confirm which versions are vulnerable and which has the fix? (hopefully a patch version if the fix doesn't break anything or adds any other functionality)\n\nWe should probably let the report stay undisclosed for a week or two until enough users adopt the new version and then I'll disclose and request a CVE.","markdown_message":"\u003cp\u003e\u003ca href=\"/mcollina\"\u003e@mcollina\u003c/a\u003e can you confirm which versions are vulnerable and which has the fix? (hopefully a patch version if the fix doesn\u0026#39;t break anything or adds any other functionality)\u003c/p\u003e\n\n\u003cp\u003eWe should probably let the report stay undisclosed for a week or two until enough users adopt the new version and then I\u0026#39;ll disclose and request a CVE.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T21:08:25.493Z","updated_at":"2019-04-17T21:08:25.493Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4587183,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-17T21:27:52.637Z","updated_at":"2019-04-17T21:27:52.637Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4587189,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All release lines of mqtt-packet are vulnerable.\nI'm planning to patch as many as I can, because there are some old dependency chains. As an example, mqtt@1 uses mqtt-packet 3.x https://github.com/mqttjs/MQTT.js/blob/v1.14.1/package.json#L56.","markdown_message":"\u003cp\u003eAll release lines of mqtt-packet are vulnerable.\u003cbr\u003e\nI\u0026#39;m planning to patch as many as I can, because there are some old dependency chains. As an example, mqtt@1 uses mqtt-packet 3.x \u003ca title=\"https://github.com/mqttjs/MQTT.js/blob/v1.14.1/package.json#L56\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmqttjs%2FMQTT.js%2Fblob%2Fv1.14.1%2Fpackage.json%23L56\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mqttjs/MQTT.js/blob/v1.14.1/package.json#L56\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T21:31:51.765Z","updated_at":"2019-04-17T21:31:51.765Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4587229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Understood. I can see that this dates quite a few years back too.","markdown_message":"\u003cp\u003eUnderstood. I can see that this dates quite a few years back too.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T21:43:17.843Z","updated_at":"2019-04-17T21:43:17.843Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4587732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This has been fixed in v3.5.1, v4.1.3, v5.6.1, v6.1.2 (latest).\nAll other releases are vulnerable","markdown_message":"\u003cp\u003eThis has been fixed in v3.5.1, v4.1.3, v5.6.1, v6.1.2 (latest).\u003cbr\u003e\nAll other releases are vulnerable\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T23:13:48.069Z","updated_at":"2019-04-17T23:13:48.069Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4587740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Feel free to disclose whenever you prefer.","markdown_message":"\u003cp\u003eFeel free to disclose whenever you prefer.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T23:19:05.664Z","updated_at":"2019-04-17T23:19:05.664Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4588715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mcollina does the following version range seems right:\nvulnerable: \u003c3.5.1 || \u003e=4.0.0 \u003c4.1.3 || \u003e=5.0.0 \u003c5.6.1 || \u003e=6.0.0 \u003c6.1.2\npatched: \u003e=3.5.1 \u003c4.0.0 || \u003e=4.1.3 \u003c5.0.0 || \u003e=5.6.1 \u003c6.0.0 || \u003e=6.1.2\n\n@lxndr can you please confirm the fix?\n","markdown_message":"\u003cp\u003e\u003ca href=\"/mcollina\"\u003e@mcollina\u003c/a\u003e does the following version range seems right:\u003cbr\u003e\nvulnerable: \u0026lt;3.5.1 || \u0026gt;=4.0.0 \u0026lt;4.1.3 || \u0026gt;=5.0.0 \u0026lt;5.6.1 || \u0026gt;=6.0.0 \u0026lt;6.1.2\u003cbr\u003e\npatched: \u0026gt;=3.5.1 \u0026lt;4.0.0 || \u0026gt;=4.1.3 \u0026lt;5.0.0 || \u0026gt;=5.6.1 \u0026lt;6.0.0 || \u0026gt;=6.1.2\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/lxndr\"\u003e@lxndr\u003c/a\u003e can you please confirm the fix?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T06:23:33.961Z","updated_at":"2019-04-18T06:23:33.961Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4588810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Given that the code has been extracted from MQTT.js long ago, this vulnerability applies to mqtt \u003c 1.0.0 as well.","markdown_message":"\u003cp\u003eGiven that the code has been extracted from MQTT.js long ago, this vulnerability applies to mqtt \u0026lt; 1.0.0 as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T07:04:17.341Z","updated_at":"2019-04-18T07:04:17.341Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4588826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good point to have here in the report when it gets disclosed. We don't have reports for consumers of each library but perhaps MQTT.js is a different case as the code used to live there. Seems that 1.0.0 branch is quite old so we can do one of:\n1. Add a security disclosure to the MQTT.js library README/GitHub page with regards to versions affected (such as the \u003c1.0.0)\n2. Submit a new report for the affected MQTT.js versions \n\n(2) is probably the better way of doing it if you or @lxndr are up for another vulnerability report.","markdown_message":"\u003cp\u003eGood point to have here in the report when it gets disclosed. We don\u0026#39;t have reports for consumers of each library but perhaps MQTT.js is a different case as the code used to live there. Seems that 1.0.0 branch is quite old so we can do one of:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAdd a security disclosure to the MQTT.js library README/GitHub page with regards to versions affected (such as the \u0026lt;1.0.0)\u003c/li\u003e\n\u003cli\u003eSubmit a new report for the affected MQTT.js versions \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e(2) is probably the better way of doing it if you or \u003ca href=\"/lxndr\"\u003e@lxndr\u003c/a\u003e are up for another vulnerability report.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T07:10:26.016Z","updated_at":"2019-04-18T07:10:26.016Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4588832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think 2 is the best option. The recommendation in that case is \"upgrade\".","markdown_message":"\u003cp\u003eI think 2 is the best option. The recommendation in that case is \u0026quot;upgrade\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T07:12:39.702Z","updated_at":"2019-04-18T07:12:39.702Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4588843,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Indeed üëç","markdown_message":"\u003cp\u003eIndeed üëç\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T07:15:18.870Z","updated_at":"2019-04-18T07:15:18.870Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4589411,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry for the delayed response.\n\n@lirantal confirmed üëç\n\n*We should probably let the report stay undisclosed for a week or two until enough users adopt the new version and then I'll disclose and request a CVE.*\n\nIt's no rush for disclosure from my side. \nOption 2 sounds feasible. I'll prefer to let @mcollina go ahead with a subsequent report or whatever is required. ","markdown_message":"\u003cp\u003esorry for the delayed response.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e confirmed üëç\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eWe should probably let the report stay undisclosed for a week or two until enough users adopt the new version and then I\u0026#39;ll disclose and request a CVE.\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eIt\u0026#39;s no rush for disclosure from my side. \u003cbr\u003e\nOption 2 sounds feasible. I\u0026#39;ll prefer to let \u003ca href=\"/mcollina\"\u003e@mcollina\u003c/a\u003e go ahead with a subsequent report or whatever is required. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T08:35:52.134Z","updated_at":"2019-04-18T08:35:52.134Z","actor":{"username":"lxndr","cleared":false,"url":"/lxndr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4589452,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!\nSounds good","markdown_message":"\u003cp\u003eThanks!\u003cbr\u003e\nSounds good\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T08:38:21.002Z","updated_at":"2019-04-18T08:38:21.002Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4593338,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I will not have time to do a report on MQTT.js for the next few weeks - I'm on vacation and then at Build.","markdown_message":"\u003cp\u003eI will not have time to do a report on MQTT.js for the next few weeks - I\u0026#39;m on vacation and then at Build.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T16:58:15.766Z","updated_at":"2019-04-18T16:58:15.766Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4604659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay, no problem. We have also vacation time over here. \nBut I will have time on Tuesday to write a new one. \n\nJust to confirm, the final affected MQTT.js versions are\nvulnerable: \u003c1.0.0 || \u003c3.5.1 || \u003e=4.0.0 \u003c4.1.3 || \u003e=5.0.0 \u003c5.6.1 || \u003e=6.0.0 \u003c6.1.2\nright?","markdown_message":"\u003cp\u003eOkay, no problem. We have also vacation time over here. \u003cbr\u003e\nBut I will have time on Tuesday to write a new one. \u003c/p\u003e\n\n\u003cp\u003eJust to confirm, the final affected MQTT.js versions are\u003cbr\u003e\nvulnerable: \u0026lt;1.0.0 || \u0026lt;3.5.1 || \u0026gt;=4.0.0 \u0026lt;4.1.3 || \u0026gt;=5.0.0 \u0026lt;5.6.1 || \u0026gt;=6.0.0 \u0026lt;6.1.2\u003cbr\u003e\nright?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-20T08:16:20.886Z","updated_at":"2019-04-20T08:16:20.886Z","actor":{"username":"lxndr","cleared":false,"url":"/lxndr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4605787,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No, these are two modules:\n\n[mqtt](http://npm.im/mqtt): \u003c1.0.0\n\n[mqtt-packet](http://npm.im/mqtt-packet): \u003c3.5.1 || \u003e=4.0.0 \u003c4.1.3 || \u003e=5.0.0 \u003c5.6.1 || \u003e=6.0.0 \u003c6.1.2","markdown_message":"\u003cp\u003eNo, these are two modules:\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fnpm.im%2Fmqtt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emqtt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e: \u0026lt;1.0.0\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fnpm.im%2Fmqtt-packet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emqtt-packet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e: \u0026lt;3.5.1 || \u0026gt;=4.0.0 \u0026lt;4.1.3 || \u0026gt;=5.0.0 \u0026lt;5.6.1 || \u0026gt;=6.0.0 \u0026lt;6.1.2\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-20T09:50:05.587Z","updated_at":"2019-04-20T09:50:28.880Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4624802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've checked the mqtt.js v0.3.13 (examples/server/orig.js) module today and couldn't reproduce the crash there.\n\nI found a note in [MQTT.js/parse.js](https://github.com/mqttjs/MQTT.js/blob/v0.3.13/lib/parse.js#L156) which points to possible errors here.\nHowever, the parser does also here over-read the buffer but does not crash. It simply complains later while trying to send the corresponding suback (as the granted QoS is undefined).\n\nHere some log output from around [Line 156](https://github.com/mqttjs/MQTT.js/blob/v0.3.13/lib/parse.js#L156)\n```\nCONNECT: client id: alicedoesnotneedaclientid\n\u003cTopic\u003e hello/topic/of/alice\n\u003cParser Pos\u003e 25 \u003cBuffer Length\u003e 25\n\u003cQoS from Buffer\u003e undefined\n```\nOn the other hand, [mqtt-packet](https://github.com/mqttjs/mqtt-packet/blob/v1.0.0/lib/parser.js#L288) contains the malicious line since v1.0.0 (where it uses `readUInt8` function to read that byte)\n\nSo I assume, the bug was introduced with [MQTT.js v1.0.0](https://github.com/mqttjs/MQTT.js/releases/tag/v1.0.0) where [MQTT.js/parse.js](https://github.com/mqttjs/MQTT.js/blob/v0.3.13/lib/parse.js#L156) was moved to a separate module [mqtt-packet/parser.js](https://github.com/mqttjs/mqtt-packet/blob/v1.0.0/lib/parser.js#L288). \nThus, [mqtt](https://www.npmjs.com/package/mqtt) \u003c1.0.0 does not seem to be affected by this vulnerability.\n\n\n","markdown_message":"\u003cp\u003eI\u0026#39;ve checked the mqtt.js v0.3.13 (examples/server/orig.js) module today and couldn\u0026#39;t reproduce the crash there.\u003c/p\u003e\n\n\u003cp\u003eI found a note in \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmqttjs%2FMQTT.js%2Fblob%2Fv0.3.13%2Flib%2Fparse.js%23L156\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMQTT.js/parse.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which points to possible errors here.\u003cbr\u003e\nHowever, the parser does also here over-read the buffer but does not crash. It simply complains later while trying to send the corresponding suback (as the granted QoS is undefined).\u003c/p\u003e\n\n\u003cp\u003eHere some log output from around \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmqttjs%2FMQTT.js%2Fblob%2Fv0.3.13%2Flib%2Fparse.js%23L156\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLine 156\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eCONNECT: client id: alicedoesnotneedaclientid\n\u0026lt;Topic\u0026gt; hello/topic/of/alice\n\u0026lt;Parser Pos\u0026gt; 25 \u0026lt;Buffer Length\u0026gt; 25\n\u0026lt;QoS from Buffer\u0026gt; undefined\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOn the other hand, \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmqttjs%2Fmqtt-packet%2Fblob%2Fv1.0.0%2Flib%2Fparser.js%23L288\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emqtt-packet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e contains the malicious line since v1.0.0 (where it uses \u003ccode\u003ereadUInt8\u003c/code\u003e function to read that byte)\u003c/p\u003e\n\n\u003cp\u003eSo I assume, the bug was introduced with \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmqttjs%2FMQTT.js%2Freleases%2Ftag%2Fv1.0.0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMQTT.js v1.0.0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e where \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmqttjs%2FMQTT.js%2Fblob%2Fv0.3.13%2Flib%2Fparse.js%23L156\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMQTT.js/parse.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was moved to a separate module \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmqttjs%2Fmqtt-packet%2Fblob%2Fv1.0.0%2Flib%2Fparser.js%23L288\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emqtt-packet/parser.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003cbr\u003e\nThus, \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fmqtt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emqtt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026lt;1.0.0 does not seem to be affected by this vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-23T09:50:11.701Z","updated_at":"2019-04-23T09:50:11.701Z","actor":{"username":"lxndr","cleared":false,"url":"/lxndr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4655514,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As I'm disclosing this report the vulnerability for MQTT.js 1.0.0 will be public as well. @lxndr will you send a report for that? (seems to be affecting MQTT.js == 1.0.0 only from your last update)","markdown_message":"\u003cp\u003eAs I\u0026#39;m disclosing this report the vulnerability for MQTT.js 1.0.0 will be public as well. \u003ca href=\"/lxndr\"\u003e@lxndr\u003c/a\u003e will you send a report for that? (seems to be affecting MQTT.js == 1.0.0 only from your last update)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-28T07:27:44.540Z","updated_at":"2019-04-28T07:27:44.540Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4655518,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-28T07:30:23.889Z","updated_at":"2019-04-28T07:30:23.889Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Other module","new_scope":"mqtt-packet","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4655535,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-28T07:35:30.121Z","updated_at":"2019-04-28T07:35:30.121Z","additional_data":{"old_severity":"High (8.6)","new_severity":"High (7.5)","old_severity_id":350120,"new_severity_id":359279},"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4655537,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-28T07:35:49.679Z","updated_at":"2019-04-28T07:35:49.679Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"lxndr","url":"/lxndr"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4655540,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-28T07:36:22.428Z","updated_at":"2019-04-28T07:36:22.428Z","first_to_agree":true,"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4655541,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-28T07:36:31.036Z","updated_at":"2019-04-28T07:36:31.036Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4660458,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"MQTT.js 1.0.0 uses mqtt-packet 3.5.1 which already contains the fix and thus should be vulnerable anymore.\n\nShooting the malformed packet against MQTT.js 1.0.0 with mqtt-packet 3.5.1:\n```\nCONNECT: client id: alicedoesnotneedaclientid\nError: Malformed Subscribe Payload\n    at Parser._parseSubscribe (~/MQTT/Brokers/MQTT.js/node_modules/mqtt-packet/parser.js:291:60)\n    at Parser._parsePayload (~/MQTT/Brokers/MQTT.js/node_modules/mqtt-packet/parser.js:124:14)\r\n```\n\nI'd say MQTT.js \u003c1.0.0 is prone to buffer over-read at the same position ([L155-156](https://github.com/mqttjs/MQTT.js/blob/v0.3.13/lib/parse.js#L155-156)). \nBut sending the same malformed packet does not crash the Broker. But it does break the protocol logic. \nHowever, this does not break immediately but might cause problems under specific scenarios later on. I will open a new report for MQTT.js \u003c 1.0.0 if I find such a scenario.","markdown_message":"\u003cp\u003eMQTT.js 1.0.0 uses mqtt-packet 3.5.1 which already contains the fix and thus should be vulnerable anymore.\u003c/p\u003e\n\n\u003cp\u003eShooting the malformed packet against MQTT.js 1.0.0 with mqtt-packet 3.5.1:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eCONNECT: client id: alicedoesnotneedaclientid\nError: Malformed Subscribe Payload\n    at Parser._parseSubscribe (~/MQTT/Brokers/MQTT.js/node_modules/mqtt-packet/parser.js:291:60)\n    at Parser._parsePayload (~/MQTT/Brokers/MQTT.js/node_modules/mqtt-packet/parser.js:124:14)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI\u0026#39;d say MQTT.js \u0026lt;1.0.0 is prone to buffer over-read at the same position (\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmqttjs%2FMQTT.js%2Fblob%2Fv0.3.13%2Flib%2Fparse.js%23L155-156\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eL155-156\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). \u003cbr\u003e\nBut sending the same malformed packet does not crash the Broker. But it does break the protocol logic. \u003cbr\u003e\nHowever, this does not break immediately but might cause problems under specific scenarios later on. I will open a new report for MQTT.js \u0026lt; 1.0.0 if I find such a scenario.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-29T10:16:51.824Z","updated_at":"2019-04-29T10:16:51.824Z","actor":{"username":"lxndr","cleared":false,"url":"/lxndr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4670374,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks, sounds good!","markdown_message":"\u003cp\u003ethanks, sounds good!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-29T20:47:32.685Z","updated_at":"2019-04-29T20:47:32.685Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}