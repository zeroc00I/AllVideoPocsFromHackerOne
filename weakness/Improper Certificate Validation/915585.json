{"id":915585,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MTU1ODU=","url":"https://hackerone.com/reports/915585","title":"Social App does not validate server certificates for outgoing connections","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-07-04T22:45:44.180Z","submitted_at":"2020-07-04T22:45:44.180Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sanktjodel","url":"/sanktjodel","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8279"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-17T16:37:41.232Z","bug_reporter_agreed_on_going_public_at":"2020-11-17T16:37:41.185Z","team_member_agreed_on_going_public_at":"2020-11-17T10:37:02.475Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The Social App (https://apps.nextcloud.com/apps/social) does not validate the server TLS certificate for connections to other ActivityPub servers.\nThese connections are used to retrieve the public key for a user or posting a message to another ActivityPub server.\nThe public key for a user is used to validate the ActivityPub user.\n\nThe vulnerable code is at https://github.com/daita/my-small-php-tools/blob/d8778803612af20699c7efb0637bfe62478e596c/lib/Traits/TRequest.php#L151.\nThe initRequest method disables verifying of the peer's certificate by setting CURLOPT_SSL_VERIFYPEER to FALSE.\nThis code is called from CurlService.php (https://github.com/nextcloud/social/blob/97fb063479d4c0ad6fccdea3774601a619f8a886/lib/Service/CurlService.php#L265).\n\nThis issue has been tested on Nextcloud version version 19.0.0.12 with Social version 0.3.1.\n\n## Impact\n\nAn attacker can perform a man-in-the-middle attack by impersonating the victim server by using a self-signed TLS certificate.\nThe attacker would have to be in a privileged network position between the Nextcloud instance and the target ActivityPub server.","vulnerability_information_html":"\u003cp\u003eThe Social App (\u003ca title=\"https://apps.nextcloud.com/apps/social\" href=\"/redirect?url=https%3A%2F%2Fapps.nextcloud.com%2Fapps%2Fsocial\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://apps.nextcloud.com/apps/social\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) does not validate the server TLS certificate for connections to other ActivityPub servers.\u003cbr\u003e\nThese connections are used to retrieve the public key for a user or posting a message to another ActivityPub server.\u003cbr\u003e\nThe public key for a user is used to validate the ActivityPub user.\u003c/p\u003e\n\n\u003cp\u003eThe vulnerable code is at \u003ca title=\"https://github.com/daita/my-small-php-tools/blob/d8778803612af20699c7efb0637bfe62478e596c/lib/Traits/TRequest.php#L151\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fdaita%2Fmy-small-php-tools%2Fblob%2Fd8778803612af20699c7efb0637bfe62478e596c%2Flib%2FTraits%2FTRequest.php%23L151\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/daita/my-small-php-tools/blob/d8778803612af20699c7efb0637bfe62478e596c/lib/Traits/TRequest.php#L151\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nThe initRequest method disables verifying of the peer\u0026#39;s certificate by setting CURLOPT_SSL_VERIFYPEER to FALSE.\u003cbr\u003e\nThis code is called from CurlService.php (\u003ca title=\"https://github.com/nextcloud/social/blob/97fb063479d4c0ad6fccdea3774601a619f8a886/lib/Service/CurlService.php#L265\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fsocial%2Fblob%2F97fb063479d4c0ad6fccdea3774601a619f8a886%2Flib%2FService%2FCurlService.php%23L265\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/social/blob/97fb063479d4c0ad6fccdea3774601a619f8a886/lib/Service/CurlService.php#L265\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eThis issue has been tested on Nextcloud version version 19.0.0.12 with Social version 0.3.1.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can perform a man-in-the-middle attack by impersonating the victim server by using a self-signed TLS certificate.\u003cbr\u003e\nThe attacker would have to be in a privileged network position between the Nextcloud instance and the target ActivityPub server.\u003c/p\u003e\n","weakness":{"id":28,"name":"Improper Certificate Validation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-17T10:37:02.591Z","allow_singular_disclosure_after":-1024415.224426206,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sanktjodel","mygf","yusuf_furkan","jleek1"],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8500895,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2020-07-04T22:45:44.574Z","updated_at":"2020-07-04T22:45:44.574Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8509625,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-06T07:09:08.078Z","updated_at":"2020-07-06T07:09:08.078Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8526240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, thanks for your reports\n\nI guess that this should fix this issue:\n\nhttps://github.com/daita/my-small-php-tools/commit/a253279a181ae6c09be80d786377fdb7afd37741\nhttps://github.com/nextcloud/social/pull/936\n\nRegards,\n\nMaxence","markdown_message":"\u003cp\u003eHello, thanks for your reports\u003c/p\u003e\n\n\u003cp\u003eI guess that this should fix this issue:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/daita/my-small-php-tools/commit/a253279a181ae6c09be80d786377fdb7afd37741\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fdaita%2Fmy-small-php-tools%2Fcommit%2Fa253279a181ae6c09be80d786377fdb7afd37741\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/daita/my-small-php-tools/commit/a253279a181ae6c09be80d786377fdb7afd37741\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/nextcloud/social/pull/936\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fsocial%2Fpull%2F936\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/social/pull/936\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eMaxence\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-07T11:30:17.362Z","updated_at":"2020-07-07T11:30:17.362Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8529470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This code change looks reasonable and should fix this issue.","markdown_message":"\u003cp\u003eThis code change looks reasonable and should fix this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-07T16:37:59.894Z","updated_at":"2020-07-07T16:37:59.894Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9709767,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue has been fixed over 3 months ago. Can we resolve this issue and make it public?","markdown_message":"\u003cp\u003eThis issue has been fixed over 3 months ago. Can we resolve this issue and make it public?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-03T05:13:38.719Z","updated_at":"2020-11-03T05:13:38.719Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9710739,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah yeah sure, seems it slipped of the list.","markdown_message":"\u003cp\u003eAh yeah sure, seems it slipped of the list.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-03T08:19:37.922Z","updated_at":"2020-11-03T08:19:37.922Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9710744,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in a maintenance release and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in a maintenance release and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-11-03T08:19:56.259Z","updated_at":"2020-11-03T08:19:56.259Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sanktjodel","url":"/sanktjodel"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9721147,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you.\n\nName: Roger Meyer\nWebsite: https://twitter.com/sanktjodel","markdown_message":"\u003cp\u003eThank you.\u003c/p\u003e\n\n\u003cp\u003eName: Roger Meyer\u003cbr\u003e\nWebsite: \u003ca title=\"https://twitter.com/sanktjodel\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fsanktjodel\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/sanktjodel\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-04T05:56:09.775Z","updated_at":"2020-11-04T05:56:09.775Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9843041,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-11-17T10:21:34.914Z","updated_at":"2020-11-17T10:21:34.914Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.4)","old_severity_id":769951,"new_severity_id":908189},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9843043,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"The social app is not eligible for bounties.","markdown_message":"\u003cp\u003eThe social app is not eligible for bounties.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-17T10:21:53.468Z","updated_at":"2020-11-17T10:21:53.468Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9843172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE pending: CVE-2020-8279\nAdvisory will be published at https://nextcloud.com/security/advisory/?id=NC-SA-2020-043","markdown_message":"\u003cp\u003eCVE pending: CVE-2020-8279\u003cbr\u003e\nAdvisory will be published at \u003ca title=\"https://nextcloud.com/security/advisory/?id=NC-SA-2020-043\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisory%2F%3Fid%3DNC-SA-2020-043\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/advisory/?id=NC-SA-2020-043\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-17T10:36:54.541Z","updated_at":"2020-11-17T10:36:54.541Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9843173,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-17T10:37:02.507Z","updated_at":"2020-11-17T10:37:02.507Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9846663,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-17T16:37:41.201Z","updated_at":"2020-11-17T16:37:41.201Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9846664,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-17T16:37:41.292Z","updated_at":"2020-11-17T16:37:41.292Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}