{"id":304770,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDQ3NzA=","url":"https://hackerone.com/reports/304770","title":"Corrupt RPC responses from remote daemon nodes can lead to transaction tracing","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-01-14T21:22:24.574Z","submitted_at":"2018-01-14T21:22:24.574Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"monero-hax123","url":"/monero-hax123","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7731,"url":"https://hackerone.com/monero","handle":"monero","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Monero","twitter_handle":"monero","website":"https://getmonero.org","about":" Monero: the secure, private, untraceable cryptocurrency"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-03-16T22:10:21.957Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-03-15T15:47:21.641Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear Monero security team,\n    We’re writing to disclose a privacy vulnerability when using monero-cli or monero-gui with an untrusted remote node.\n\nWhen using a remote node, the Monero client relies on the node to provide information from the blockchain, in particular the public keys and transaction outputs corresponding to mixins that the client chooses by global index (gidx). The client selects a handful of gidxs, and passes these in a request to the “get_outs.bin” RPC endpoint. The client is generally designed to provide *untraceability* even against the untrusted remote node, e.g. by masking which index in the request is the real one being spent. However, if the remote node provides an invalid response then the client may end up inadvertently revealing information about the real gidx being spent.\n\nIn more detail there, we've made a proof-of-concept of two forms of this attack:\n\n#1 Retry-and-intersect attack. \n====\nIf the attacker remote node returns bogus data, and the user *retries the same transaction* after clicking through the error message, it most likely reveals to the remote node exactly which coin in the transaction is the real one being spent.\n\n1. The attacker modifies monerod to return all bogus public keys in response to the first “get_outs.bin” request.\n\n2. The client reports an error that invalid data was received, but does not disconnect from the remote node or otherwise change its behavior. The outputs remain available for use.\n\n3. If the user dismisses the error and then tries the same transaction again, then the client samples a *new set of mixins* to request along with the real output again.\n\n4. The remote node looks at the two requests. Most likely, there is a unique intersection between the two sets of requested gidxs, which corresponds to the real transaction output.\n\n5. The remote node responds to the second request with correct data, so the transaction goes through.\nAs a proof of concept, we tested this 10 times with a monero-cli and our own modified monerod, and found that the correct output was detected in each trial. It is possible that two such requests do not have a unique intersection, but this appears to happen with low frequency.\n\nThis is an active attack, and involves showing an error message to the client. This would likely raise suspicion if occurred many times in a row. However, since the transaction goes through without error on the second request, used sparingly it may not raise suspicion.\n\n#2 Guess-and-check attack\n====\nIf the remote node returns bogus data for some but not all of of the requested gidxs, then by observing the client’s behavior it can tell whether the real transaction input is one of the bogus ones or not.\n\n1. The attacker modifies monerod to return bogus public keys for all but one of the requested gidxs. There are two cases, depending on whether the real transaction input is one of the bogus ones.\n\n2a. The real input is one of the bogus public keys.\n   The client is able to identify the incorrect response. It throws an exception, and will not sign and transmit any transaction (until after making subsequent get_out.bin requests). The attacker learns that the real transaction input is not one of the bogus ones.\n\n2b. The real input corresponds to the non-bogus response\n\n   The wallet is unable to discover that the response is invalid, and therefore proceeds to sign and transmit the transaction to the remote node. The attacker learns that the real transaction input is the bogus one.\n\nSince the transaction is invalid, it will not show up on the blockchain. However, the client stores the transaction in the wallet as “pending”, such that its transaction inputs will not be reused again for 24 hours.\n\nBecause the client requests many more public keys than it actually needs for mixins (e.g., a default of 58 gidx requested for a ring size of 5), the probability of succeeding is small but non-negligible. If the attack fails (case 2a), the attacker cannot easily “try again”, since the transaction inputs are unavailable for 24 hours. (However, we note that this behavior could also be considered a DoS vector for a remote node, and hence we imagine there could be a pressure to change this behavior, trading off privacy for DoS-resilience.)\n\nAttacks exacerbated by unauthenticated RPC\n======\nWe have described these two attack scenarios from the point of view of a corrupted remote node. However, because data between clients and the remote node is not authenticated (http json rather than https), this attack could also be performed by any on-path adversary (such as a router or ISP)\n\n## Impact\n\nSeverity:\n=======\nThe first of the two attacks is more severe, since the attacker can trace the transaction inputs with high probability while raising minimal suspicion to the user. We therefore recommend immediately implementing mitigations 1-3 as suggested below. The second attack type is less severe, since it has a smaller chance of success and cannot easily be repeated multiple times to increase the chance.\nRemote node operation can be considered a “non-default” configuration, which is a mitigating factor. However, it is clear that many users would prefer a light client for administrative and performance reasons (it takes a while to sync a full node). Instructions for remote node operation appear on the getmonero.org user guides page, and infrastructure support is increasing (e.g., there are several “open nodes” services that provide lists of available remote nodes to connect to). So we think it is likely that this usage mode will see increased use in the near future. Statistics from moneroworld could be requested to estimate the popularity of this configuration.\n\nThe instructions at MoneroWorld https://moneroworld.com/#nodes do stress that remote nodes is not the recommended mode of operation and could lead to additional privacy risks. However, the instructions explain “the primary risk is that a remote node can get your IP address.” Hence we think it is likely that users may follow these instructions, and even take precautions to shield their IP address (e.g., use Tor), but still fail to achieve the untraceability they expect. The instructions at getmonero do not provide warnings at all: https://getmonero.org/resources/user-guides/remote_node_gui.html )\nTo our knowledge, this attack vector is new and has not been discussed before in forums or reddit.\nWe suggest this should be considered MEDIUM severity according to the standards of the Vulnerability Response Process.\n\nPotential Mitigations\n=========\n1. _User warnings._ Any exceptions encountered in the RPC, after sending the list of gidxs to the remote node but prior to committing the transaction, should come with enhanced error messages warning about the potential of an active tracing attack. The instructions on using remote nodes should be expanded to warn the user in advance of this possibility against retrying a transaction. Statistics from moneroworld should be used to estimate the number of potentially affected users.\n\n2. _Caching of get_outs requests._ After the client samples a list of gidxs associated with a transaction output, it should immediately commit these to a persistent data structure (similar to the pending transactions in the wallet). If the output is used again in a short time interval (because of an exception through in the get_outs.bin RPC query or for any other reason), then the exact same gidxs should be sampled. This directly prevents the intersection attack #1 described above, however it does nothing to address attack #2.\n\n3. _Use a secure channel (TLS) between the client and remote node._ Communications should be JSON-RPC over HTTPS instead of over HTTP. Even opportunistic encryption (if the remote cannot be authenticated by a standard certificate) would require a network attacker to mount an active MitM first, which at least requires them to conduct a more invasive attack\n\n4. _Disconnect \u0026 blacklist remote node on failures._\nBoth of the attacks involve a remote node sending corrupt information in response to get_outs. Immediately blacklisting the node upon such an event reduces the effectiveness of the attack. A caveat is that with several “open nodes” services, e.g. nodes.moneroworld.com, which DNS-resolve to multiple IP addresses of different volunteers, the blacklist should be at the IP level rather than the hostname level. This should only be implemented after mitigation 3, since otherwise it would allow on-path adversaries to cause honest remote nodes to be falsely blacklisted.\n\n5. _Use authenticated data structures._ Although attack #2 is of lower severity, it is difficult to stamp out entirely. The general problem is that it is currently impossible for a client to authenticate get_outs.bin responses from a remote node except for public keys that it already knows, i.e. the real transaction input. Hence the differential behavior reveals information about the treal transaction inputs. A systematic mitigation would be to add an additional Merkle tree data structure to the Monero blockchain, indexed by gidx, that allows the client to authenticate responses to get_idx. We are currently working on a writeup about this mitigation, but the simpler mitigations could be employed in the meantime.","vulnerability_information_html":"\u003cp\u003eDear Monero security team,\u003cbr\u003e\n    We’re writing to disclose a privacy vulnerability when using monero-cli or monero-gui with an untrusted remote node.\u003c/p\u003e\n\n\u003cp\u003eWhen using a remote node, the Monero client relies on the node to provide information from the blockchain, in particular the public keys and transaction outputs corresponding to mixins that the client chooses by global index (gidx). The client selects a handful of gidxs, and passes these in a request to the “get_outs.bin” RPC endpoint. The client is generally designed to provide \u003cem\u003euntraceability\u003c/em\u003e even against the untrusted remote node, e.g. by masking which index in the request is the real one being spent. However, if the remote node provides an invalid response then the client may end up inadvertently revealing information about the real gidx being spent.\u003c/p\u003e\n\n\u003cp\u003eIn more detail there, we\u0026#39;ve made a proof-of-concept of two forms of this attack:\u003c/p\u003e\n\n\u003ch1 id=\"1-retry-and-intersect-attack\"\u003e1 Retry-and-intersect attack.\u003c/h1\u003e\n\n\u003cp\u003e====\u003cbr\u003e\nIf the attacker remote node returns bogus data, and the user \u003cem\u003eretries the same transaction\u003c/em\u003e after clicking through the error message, it most likely reveals to the remote node exactly which coin in the transaction is the real one being spent.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eThe attacker modifies monerod to return all bogus public keys in response to the first “get_outs.bin” request.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe client reports an error that invalid data was received, but does not disconnect from the remote node or otherwise change its behavior. The outputs remain available for use.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIf the user dismisses the error and then tries the same transaction again, then the client samples a \u003cem\u003enew set of mixins\u003c/em\u003e to request along with the real output again.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe remote node looks at the two requests. Most likely, there is a unique intersection between the two sets of requested gidxs, which corresponds to the real transaction output.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe remote node responds to the second request with correct data, so the transaction goes through.\u003cbr\u003e\nAs a proof of concept, we tested this 10 times with a monero-cli and our own modified monerod, and found that the correct output was detected in each trial. It is possible that two such requests do not have a unique intersection, but this appears to happen with low frequency.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThis is an active attack, and involves showing an error message to the client. This would likely raise suspicion if occurred many times in a row. However, since the transaction goes through without error on the second request, used sparingly it may not raise suspicion.\u003c/p\u003e\n\n\u003ch1 id=\"2-guess-and-check-attack\"\u003e2 Guess-and-check attack\u003c/h1\u003e\n\n\u003cp\u003e====\u003cbr\u003e\nIf the remote node returns bogus data for some but not all of of the requested gidxs, then by observing the client’s behavior it can tell whether the real transaction input is one of the bogus ones or not.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe attacker modifies monerod to return bogus public keys for all but one of the requested gidxs. There are two cases, depending on whether the real transaction input is one of the bogus ones.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e2a. The real input is one of the bogus public keys.\u003cbr\u003e\n   The client is able to identify the incorrect response. It throws an exception, and will not sign and transmit any transaction (until after making subsequent get_out.bin requests). The attacker learns that the real transaction input is not one of the bogus ones.\u003c/p\u003e\n\n\u003cp\u003e2b. The real input corresponds to the non-bogus response\u003c/p\u003e\n\n\u003cp\u003eThe wallet is unable to discover that the response is invalid, and therefore proceeds to sign and transmit the transaction to the remote node. The attacker learns that the real transaction input is the bogus one.\u003c/p\u003e\n\n\u003cp\u003eSince the transaction is invalid, it will not show up on the blockchain. However, the client stores the transaction in the wallet as “pending”, such that its transaction inputs will not be reused again for 24 hours.\u003c/p\u003e\n\n\u003cp\u003eBecause the client requests many more public keys than it actually needs for mixins (e.g., a default of 58 gidx requested for a ring size of 5), the probability of succeeding is small but non-negligible. If the attack fails (case 2a), the attacker cannot easily “try again”, since the transaction inputs are unavailable for 24 hours. (However, we note that this behavior could also be considered a DoS vector for a remote node, and hence we imagine there could be a pressure to change this behavior, trading off privacy for DoS-resilience.)\u003c/p\u003e\n\n\u003ch1 id=\"attacks-exacerbated-by-unauthenticated-rpc\"\u003eAttacks exacerbated by unauthenticated RPC\u003c/h1\u003e\n\n\u003cp\u003eWe have described these two attack scenarios from the point of view of a corrupted remote node. However, because data between clients and the remote node is not authenticated (http json rather than https), this attack could also be performed by any on-path adversary (such as a router or ISP)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch1 id=\"severity\"\u003eSeverity:\u003c/h1\u003e\n\n\u003cp\u003eThe first of the two attacks is more severe, since the attacker can trace the transaction inputs with high probability while raising minimal suspicion to the user. We therefore recommend immediately implementing mitigations 1-3 as suggested below. The second attack type is less severe, since it has a smaller chance of success and cannot easily be repeated multiple times to increase the chance.\u003cbr\u003e\nRemote node operation can be considered a “non-default” configuration, which is a mitigating factor. However, it is clear that many users would prefer a light client for administrative and performance reasons (it takes a while to sync a full node). Instructions for remote node operation appear on the getmonero.org user guides page, and infrastructure support is increasing (e.g., there are several “open nodes” services that provide lists of available remote nodes to connect to). So we think it is likely that this usage mode will see increased use in the near future. Statistics from moneroworld could be requested to estimate the popularity of this configuration.\u003c/p\u003e\n\n\u003cp\u003eThe instructions at MoneroWorld \u003ca title=\"https://moneroworld.com/#nodes\" href=\"/redirect?url=https%3A%2F%2Fmoneroworld.com%2F%23nodes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://moneroworld.com/#nodes\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e do stress that remote nodes is not the recommended mode of operation and could lead to additional privacy risks. However, the instructions explain “the primary risk is that a remote node can get your IP address.” Hence we think it is likely that users may follow these instructions, and even take precautions to shield their IP address (e.g., use Tor), but still fail to achieve the untraceability they expect. The instructions at getmonero do not provide warnings at all: \u003ca title=\"https://getmonero.org/resources/user-guides/remote_node_gui.html\" href=\"/redirect?url=https%3A%2F%2Fgetmonero.org%2Fresources%2Fuser-guides%2Fremote_node_gui.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://getmonero.org/resources/user-guides/remote_node_gui.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e )\u003cbr\u003e\nTo our knowledge, this attack vector is new and has not been discussed before in forums or reddit.\u003cbr\u003e\nWe suggest this should be considered MEDIUM severity according to the standards of the Vulnerability Response Process.\u003c/p\u003e\n\n\u003ch1 id=\"potential-mitigations\"\u003ePotential Mitigations\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e\u003cu\u003eUser warnings.\u003c/u\u003e Any exceptions encountered in the RPC, after sending the list of gidxs to the remote node but prior to committing the transaction, should come with enhanced error messages warning about the potential of an active tracing attack. The instructions on using remote nodes should be expanded to warn the user in advance of this possibility against retrying a transaction. Statistics from moneroworld should be used to estimate the number of potentially affected users.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003cu\u003eCaching of get_outs requests.\u003c/u\u003e After the client samples a list of gidxs associated with a transaction output, it should immediately commit these to a persistent data structure (similar to the pending transactions in the wallet). If the output is used again in a short time interval (because of an exception through in the get_outs.bin RPC query or for any other reason), then the exact same gidxs should be sampled. This directly prevents the intersection attack #1 described above, however it does nothing to address attack #2.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003cu\u003eUse a secure channel (TLS) between the client and remote node.\u003c/u\u003e Communications should be JSON-RPC over HTTPS instead of over HTTP. Even opportunistic encryption (if the remote cannot be authenticated by a standard certificate) would require a network attacker to mount an active MitM first, which at least requires them to conduct a more invasive attack\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003cu\u003eDisconnect \u0026amp; blacklist remote node on failures.\u003c/u\u003e\u003cbr\u003e\nBoth of the attacks involve a remote node sending corrupt information in response to get_outs. Immediately blacklisting the node upon such an event reduces the effectiveness of the attack. A caveat is that with several “open nodes” services, e.g. nodes.moneroworld.com, which DNS-resolve to multiple IP addresses of different volunteers, the blacklist should be at the IP level rather than the hostname level. This should only be implemented after mitigation 3, since otherwise it would allow on-path adversaries to cause honest remote nodes to be falsely blacklisted.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003cu\u003eUse authenticated data structures.\u003c/u\u003e Although attack #2 is of lower severity, it is difficult to stamp out entirely. The general problem is that it is currently impossible for a client to authenticate get_outs.bin responses from a remote node except for public keys that it already knows, i.e. the real transaction input. Hence the differential behavior reveals information about the treal transaction inputs. A systematic mitigation would be to add an additional Merkle tree data structure to the Monero blockchain, indexed by gidx, that allows the client to authenticate responses to get_idx. We are currently working on a writeup about this mitigation, but the simpler mitigations could be employed in the meantime.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","weakness":{"id":46,"name":"Privacy Violation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-04-14T15:47:21.722Z","allow_singular_disclosure_after":-85498975.23942496,"singular_disclosure_allowed":true,"vote_count":12,"voters":["yumi","eveeez","geeknik","r3y","apapedulimu","hassham","cr4xerbik4sh","d4rk_g1rl","protector47","lopwoq","and 2 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2287282,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nthanks for the report.\nThis has been known for a while, and while we fixed a lot of the leaks that happen to the daemon, it's unfixable fully (and I've been regretting fixing some of them, since it makes use of a third party daemon have less drawbacks, making the problem worse in a way). If you want privacy and security, you shouldn't use a third party daemon. Unfortunately, many people just don't care and go for the easiest to use.\nSo while your report is correct, it doesn't tell us anything new, and this is not really something I want to fix (of course that only applies to information disclosure, and not of something like keys, that's be pretty bad).\nI'll let others give their opinion here, since it's a valid report.\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003ethanks for the report.\u003cbr\u003e\nThis has been known for a while, and while we fixed a lot of the leaks that happen to the daemon, it\u0026#39;s unfixable fully (and I\u0026#39;ve been regretting fixing some of them, since it makes use of a third party daemon have less drawbacks, making the problem worse in a way). If you want privacy and security, you shouldn\u0026#39;t use a third party daemon. Unfortunately, many people just don\u0026#39;t care and go for the easiest to use.\u003cbr\u003e\nSo while your report is correct, it doesn\u0026#39;t tell us anything new, and this is not really something I want to fix (of course that only applies to information disclosure, and not of something like keys, that\u0026#39;s be pretty bad).\u003cbr\u003e\nI\u0026#39;ll let others give their opinion here, since it\u0026#39;s a valid report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-16T10:46:18.161Z","updated_at":"2018-01-16T10:46:18.161Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2287702,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree with moneromooo. I think that remote node functionality has been incorrectly advertised as being untrusted, when in fact it's a fully trusted model even with the untrusted flag on. I also think that this valid report might be a good catalyst for us to highlight this to users and start changing the perception. I will discuss this with others on the VRP response team as well.","markdown_message":"\u003cp\u003eI agree with moneromooo. I think that remote node functionality has been incorrectly advertised as being untrusted, when in fact it\u0026#39;s a fully trusted model even with the untrusted flag on. I also think that this valid report might be a good catalyst for us to highlight this to users and start changing the perception. I will discuss this with others on the VRP response team as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-16T14:35:37.843Z","updated_at":"2018-01-16T14:35:37.843Z","actor":{"username":"fluffypony","cleared":false,"url":"/fluffypony","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2300208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the way, most of this would be bypassed if we'd cache usable fake outs in the wallet as it scans the chain. I've not done that because it gives people another push towards using a third party node, which is proving too attractive to people who don't really care about privacy. Unfortunately, we have conflicting requirements here. Technically, it'd be nice fix, but fixing it acts as a force against decentralization.","markdown_message":"\u003cp\u003eBy the way, most of this would be bypassed if we\u0026#39;d cache usable fake outs in the wallet as it scans the chain. I\u0026#39;ve not done that because it gives people another push towards using a third party node, which is proving too attractive to people who don\u0026#39;t really care about privacy. Unfortunately, we have conflicting requirements here. Technically, it\u0026#39;d be nice fix, but fixing it acts as a force against decentralization.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-19T09:33:15.075Z","updated_at":"2018-01-19T09:33:15.075Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2301730,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your responses!\n\n1. Do you have any citations (e.g. developer minutes) that show it was already known that malicious remote nodes would be able to trace transaction inputs? Otherwise we would still like to argue that this counts as a new insight. Many stackexchange and reddit posts explicitly say that tracing transaction inputs is not one of the risks of using remote nodes, whereas we haven't found anything to the contrary.\n\n2. We're receptive to the idea that declining to further develop remote node support could help discourage this usage pattern. However, leaving in a privacy vulnerability seems like the wrong lever to pull to achieve that, since that seems unlikely to discourage users one way or the other (it's a tail risk, and users may already think it's prevented). This is clearly subjective/speculative though, just a suggestion.","markdown_message":"\u003cp\u003eThanks for your responses!\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eDo you have any citations (e.g. developer minutes) that show it was already known that malicious remote nodes would be able to trace transaction inputs? Otherwise we would still like to argue that this counts as a new insight. Many stackexchange and reddit posts explicitly say that tracing transaction inputs is not one of the risks of using remote nodes, whereas we haven\u0026#39;t found anything to the contrary.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eWe\u0026#39;re receptive to the idea that declining to further develop remote node support could help discourage this usage pattern. However, leaving in a privacy vulnerability seems like the wrong lever to pull to achieve that, since that seems unlikely to discourage users one way or the other (it\u0026#39;s a tail risk, and users may already think it\u0026#39;s prevented). This is clearly subjective/speculative though, just a suggestion.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-01-19T17:42:56.191Z","updated_at":"2018-01-19T17:42:56.191Z","actor":{"username":"monero-hax123","cleared":false,"url":"/monero-hax123","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2303364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't think we have any kind of written up proof we know :) It's probably lost in IRC logs. A while back, I started caching the fake outs from the daemon for reuse, if that counts, but it's not cached long term. You have described well some avenues of attack, so this look good to me tbh, and is a good \"advancement\" of the problem, so I'm fine with describing this as a \"new insight\", and it is true that most privacy risk analysis does not consider this. tbh, I also often do when asked. So for the purposes of this bug report, I'm fine considering this as a valid report (also see fluffypony's reply above). ","markdown_message":"\u003cp\u003eI don\u0026#39;t think we have any kind of written up proof we know :) It\u0026#39;s probably lost in IRC logs. A while back, I started caching the fake outs from the daemon for reuse, if that counts, but it\u0026#39;s not cached long term. You have described well some avenues of attack, so this look good to me tbh, and is a good \u0026quot;advancement\u0026quot; of the problem, so I\u0026#39;m fine with describing this as a \u0026quot;new insight\u0026quot;, and it is true that most privacy risk analysis does not consider this. tbh, I also often do when asked. So for the purposes of this bug report, I\u0026#39;m fine considering this as a valid report (also see fluffypony\u0026#39;s reply above). \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-20T09:45:13.934Z","updated_at":"2018-01-20T09:45:13.934Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2380753,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If no one is going to provide a code fix, we should add this issue to our threat model as a known attack vector and publish said threat model.","markdown_message":"\u003cp\u003eIf no one is going to provide a code fix, we should add this issue to our threat model as a known attack vector and publish said threat model.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-14T00:30:29.707Z","updated_at":"2018-02-14T00:30:29.707Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2380755,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-14T00:31:11.915Z","updated_at":"2018-02-14T00:31:11.915Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2431768,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just checking in... Could we agree on a timeline for concluding this disclosure? It seems like this is headed for a documentation update and a wontfix as far as code. I am assuming you could easily communicate this to Moneroworld, but I'm happy to communicate to them too. Given this response, it does not seem like there is any need to carefully coordinate the disclosure, e.g. with a software upgrade. Shall I consider myself free to publish the disclosure now, or in a short time frame? Thanks :)","markdown_message":"\u003cp\u003eJust checking in... Could we agree on a timeline for concluding this disclosure? It seems like this is headed for a documentation update and a wontfix as far as code. I am assuming you could easily communicate this to Moneroworld, but I\u0026#39;m happy to communicate to them too. Given this response, it does not seem like there is any need to carefully coordinate the disclosure, e.g. with a software upgrade. Shall I consider myself free to publish the disclosure now, or in a short time frame? Thanks :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-25T14:36:40.679Z","updated_at":"2018-02-25T14:36:40.679Z","actor":{"username":"monero-hax123","cleared":false,"url":"/monero-hax123","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2436631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@monero-hax123 Please read the VRP.\n\n`1. Response Team has 90 days to fulfill all points within section III`.","markdown_message":"\u003cp\u003e\u003ca href=\"/monero-hax123\"\u003e@monero-hax123\u003c/a\u003e Please read the VRP.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e1. Response Team has 90 days to fulfill all points within section III\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-26T23:18:32.690Z","updated_at":"2018-02-26T23:18:32.690Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2443474,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Indeed, we've read the VRP. Since the conclusion appears to be that no code fix or point release is forthcoming, then we'd hope for a shorter timeline. What do you think?","markdown_message":"\u003cp\u003eIndeed, we\u0026#39;ve read the VRP. Since the conclusion appears to be that no code fix or point release is forthcoming, then we\u0026#39;d hope for a shorter timeline. What do you think?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-28T18:10:54.649Z","updated_at":"2018-02-28T18:10:54.649Z","actor":{"username":"monero-hax123","cleared":false,"url":"/monero-hax123","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2475526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@monero-hax123 Thanks for your patience. We'd like to proceed with the following:\n\n- If you'd like to do a writeup of this as a blog/reddit post, we'd back the findings. We'd also appreciate a non-clickbait/non-alarmist writeup since these issues are known issues. If you can give us the planned date/time of the post, we can then coordinate disclosure of this H1 ticket.\n- If you are interested in receiving bounty, please paste a monero address into this ticket. The address can be temporary/one-time if needed.","markdown_message":"\u003cp\u003e\u003ca href=\"/monero-hax123\"\u003e@monero-hax123\u003c/a\u003e Thanks for your patience. We\u0026#39;d like to proceed with the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eIf you\u0026#39;d like to do a writeup of this as a blog/reddit post, we\u0026#39;d back the findings. We\u0026#39;d also appreciate a non-clickbait/non-alarmist writeup since these issues are known issues. If you can give us the planned date/time of the post, we can then coordinate disclosure of this H1 ticket.\u003c/li\u003e\n\u003cli\u003eIf you are interested in receiving bounty, please paste a monero address into this ticket. The address can be temporary/one-time if needed.\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2018-03-09T02:07:31.411Z","updated_at":"2018-03-09T02:07:31.411Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2477994,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks for this response. I think a reddit post is appropriate, especially since that is where I've found most of the discussions about remote node operation. I will work on a draft of this and share it here first, which will be mostly similar to the writeup in this issue. My only other concern is I'd like to send a note about this to MoneroWorld ASAP since that is serving as a gateway to remote nodes and hosts explicit guidance about how to use it. I believe gingeropolous runs moneroworld, so I will share a draft with them by email at the same time as I post the draft here, OK?","markdown_message":"\u003cp\u003eGreat, thanks for this response. I think a reddit post is appropriate, especially since that is where I\u0026#39;ve found most of the discussions about remote node operation. I will work on a draft of this and share it here first, which will be mostly similar to the writeup in this issue. My only other concern is I\u0026#39;d like to send a note about this to MoneroWorld ASAP since that is serving as a gateway to remote nodes and hosts explicit guidance about how to use it. I believe gingeropolous runs moneroworld, so I will share a draft with them by email at the same time as I post the draft here, OK?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-09T19:53:16.888Z","updated_at":"2018-03-09T19:53:16.888Z","actor":{"username":"monero-hax123","cleared":false,"url":"/monero-hax123","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2478428,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a draft post:\n\nVulnerability disclosure: Tracing attacks are possible when using “Remote Nodes”\n\n“Remote nodes” are when you connect the monero-cli or monero-gui user interface to a remote full node run by someone else. Remote nodes live in a grey area of best practice recommendations. On one hand, it is universally recommended that you run your own full node if possible. On the other hand, running a remote node is obviously more convenient, and several websites and reddit discussions provide documentation on how to use remote nodes. There is also increasing infrastructure support - monero reference software provides an “-untrusted” command line option that (partially) defends the client against an untrusted remote nodes, moneroworld provides a gateway service to remote nodes by volunteers, and a recent campaign to add remote node hidden services suggest these are an increasingly appealing option for new users.\n\nIn this note we explain a new attack vector on remote node clients, by which a corrupt remote node (or a man-in-the-middle attacker, since remote nodes are not authenticated), could launch an active attack to trace your transaction inputs.\n\nThe attack is pretty straightforward (a subtler variant is discussed later). When the wallet requests data from the remote node to create a transaction, the remote node sends bogus data in response. This results in an error message displayed to the user. If the user clicks through the error and retries the transaction a second time, *this immediately reveals the real input to the remote node.*\n\nMitigations: If you see ANY error message after attempting a transaction, DISCONNECT from that remote node and DO NOT try your transaction again right away.\n\nHere is an example of a possible error message, but others are possible too:\nhttps://imgur.com/a/C0ESM\n\nThe most important immediate-term mitigation is to increase user awareness. Documentation on remote nodes, especially those that steer new users towards this option, should warn users about this potential attack vector so they can react accordingly.\n\nHere are a short list of existing resources about remote nodes where this should be mentioned:\n- Guide to using remote nodes on getmonero.org https://getmonero.org/resources/user-guides/remote_node_gui.html\n- Guide to using remote nodes on moneroworld https://moneroworld.com/#nodes\n- Reddit discussions: \n-- https://www.reddit.com/r/Monero/comments/7ve75t/to_conceal_my_ip_address_using_monero_gui_wallet/\n-- https://www.reddit.com/r/Monero/comments/7ofx9v/monero_remote_node_for_tor/\n-- https://www.reddit.com/r/Monero/comments/605kp1/tell_new_users_to_use_remote_nodes/\n-- https://www.reddit.com/r/Monero/comments/7no0nh/running_your_own_node_vs_using_a_remote_node/\n\nTo explain the attack in slightly more detail:\n\nWhen the Monero client creates a transaction, it first chooses some random indices (“gidxs”) for the mixins. Since the wallet doesn’t have the blockchain data, it needs to fetch the corresponding public keys from the remote node. This is done by sending the list of gidxs to the “get_outs.bin” RPC endpoint. Even though only 4 mixins are included by default, the client fetches a much larger number (58 by default). To disguise the real input, the wallet includes the real gidx along with the fake ones. Here is an example of what the client might send to the server:\n\n```\n   { 827145, 1633390, 1636535, …, 4239205, \n    4239384, **4240066**, 4240130, 4240478,  ...}\n   (58 in total)\n```\n\nIf the “get_outs.bin” RPC endpoint returns invalid data, then the client will likely throw an error, which could be one of any variety of messages, including “couldn’t create transaction” as shown above, but also possibly “Daemon returned wrong response”, “Daemon response did not include the requested real output,” or several potential others.\n\nIf the user clicks OK and tries again, then the wallet will sample NEW mixins and include them along with the response. For example, \n```\n  { 772573, 829705, 1138406, …, 4238645, \n  4239971, **4240066**, 4240661, 4241277, …}\n  (58 in total)\n```\n\nNotice that only ONE of the requested gidxs is the same in both queries, and it happens to be the real one.\n\nThis is an active attack, and involves showing an error message to the client. This would likely raise suspicion if occurred many times in a row. However, since the transaction goes through without error on the second request, used sparingly the attack may not raise suspicion. This attack could also be performed by a man-in-the-middle or on-path attacker (e.g., an ISP or the starbucks wifi), since connections between a monero client and remote node are over unauthenticated HTTP.\n\nThe root cause of this hazard is that Monero wallets cannot determine whether the response from remote nodes. Other variations of this attack are possible but are lower yield for the attacker (they only provide useful information some of the time). In particular, instead of returning invalid data, the attacker could guess which input is the real one and just return a bogus response for that one. \n","markdown_message":"\u003cp\u003eHere is a draft post:\u003c/p\u003e\n\n\u003cp\u003eVulnerability disclosure: Tracing attacks are possible when using “Remote Nodes”\u003c/p\u003e\n\n\u003cp\u003e“Remote nodes” are when you connect the monero-cli or monero-gui user interface to a remote full node run by someone else. Remote nodes live in a grey area of best practice recommendations. On one hand, it is universally recommended that you run your own full node if possible. On the other hand, running a remote node is obviously more convenient, and several websites and reddit discussions provide documentation on how to use remote nodes. There is also increasing infrastructure support - monero reference software provides an “-untrusted” command line option that (partially) defends the client against an untrusted remote nodes, moneroworld provides a gateway service to remote nodes by volunteers, and a recent campaign to add remote node hidden services suggest these are an increasingly appealing option for new users.\u003c/p\u003e\n\n\u003cp\u003eIn this note we explain a new attack vector on remote node clients, by which a corrupt remote node (or a man-in-the-middle attacker, since remote nodes are not authenticated), could launch an active attack to trace your transaction inputs.\u003c/p\u003e\n\n\u003cp\u003eThe attack is pretty straightforward (a subtler variant is discussed later). When the wallet requests data from the remote node to create a transaction, the remote node sends bogus data in response. This results in an error message displayed to the user. If the user clicks through the error and retries the transaction a second time, \u003cem\u003ethis immediately reveals the real input to the remote node.\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eMitigations: If you see ANY error message after attempting a transaction, DISCONNECT from that remote node and DO NOT try your transaction again right away.\u003c/p\u003e\n\n\u003cp\u003eHere is an example of a possible error message, but others are possible too:\u003cbr\u003e\n\u003ca title=\"https://imgur.com/a/C0ESM\" href=\"/redirect?url=https%3A%2F%2Fimgur.com%2Fa%2FC0ESM\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://imgur.com/a/C0ESM\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe most important immediate-term mitigation is to increase user awareness. Documentation on remote nodes, especially those that steer new users towards this option, should warn users about this potential attack vector so they can react accordingly.\u003c/p\u003e\n\n\u003cp\u003eHere are a short list of existing resources about remote nodes where this should be mentioned:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eGuide to using remote nodes on getmonero.org \u003ca title=\"https://getmonero.org/resources/user-guides/remote_node_gui.html\" href=\"/redirect?url=https%3A%2F%2Fgetmonero.org%2Fresources%2Fuser-guides%2Fremote_node_gui.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://getmonero.org/resources/user-guides/remote_node_gui.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eGuide to using remote nodes on moneroworld \u003ca title=\"https://moneroworld.com/#nodes\" href=\"/redirect?url=https%3A%2F%2Fmoneroworld.com%2F%23nodes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://moneroworld.com/#nodes\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eReddit discussions: \n-- \u003ca title=\"https://www.reddit.com/r/Monero/comments/7ve75t/to_conceal_my_ip_address_using_monero_gui_wallet/\" href=\"/redirect?url=https%3A%2F%2Fwww.reddit.com%2Fr%2FMonero%2Fcomments%2F7ve75t%2Fto_conceal_my_ip_address_using_monero_gui_wallet%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.reddit.com/r/Monero/comments/7ve75t/to_conceal_my_ip_address_using_monero_gui_wallet/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n-- \u003ca title=\"https://www.reddit.com/r/Monero/comments/7ofx9v/monero_remote_node_for_tor/\" href=\"/redirect?url=https%3A%2F%2Fwww.reddit.com%2Fr%2FMonero%2Fcomments%2F7ofx9v%2Fmonero_remote_node_for_tor%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.reddit.com/r/Monero/comments/7ofx9v/monero_remote_node_for_tor/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n-- \u003ca title=\"https://www.reddit.com/r/Monero/comments/605kp1/tell_new_users_to_use_remote_nodes/\" href=\"/redirect?url=https%3A%2F%2Fwww.reddit.com%2Fr%2FMonero%2Fcomments%2F605kp1%2Ftell_new_users_to_use_remote_nodes%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.reddit.com/r/Monero/comments/605kp1/tell_new_users_to_use_remote_nodes/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n-- \u003ca title=\"https://www.reddit.com/r/Monero/comments/7no0nh/running_your_own_node_vs_using_a_remote_node/\" href=\"/redirect?url=https%3A%2F%2Fwww.reddit.com%2Fr%2FMonero%2Fcomments%2F7no0nh%2Frunning_your_own_node_vs_using_a_remote_node%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.reddit.com/r/Monero/comments/7no0nh/running_your_own_node_vs_using_a_remote_node/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eTo explain the attack in slightly more detail:\u003c/p\u003e\n\n\u003cp\u003eWhen the Monero client creates a transaction, it first chooses some random indices (“gidxs”) for the mixins. Since the wallet doesn’t have the blockchain data, it needs to fetch the corresponding public keys from the remote node. This is done by sending the list of gidxs to the “get_outs.bin” RPC endpoint. Even though only 4 mixins are included by default, the client fetches a much larger number (58 by default). To disguise the real input, the wallet includes the real gidx along with the fake ones. Here is an example of what the client might send to the server:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e   { 827145, 1633390, 1636535, …, 4239205, \n    4239384, **4240066**, 4240130, 4240478,  ...}\n   (58 in total)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf the “get_outs.bin” RPC endpoint returns invalid data, then the client will likely throw an error, which could be one of any variety of messages, including “couldn’t create transaction” as shown above, but also possibly “Daemon returned wrong response”, “Daemon response did not include the requested real output,” or several potential others.\u003c/p\u003e\n\n\u003cp\u003eIf the user clicks OK and tries again, then the wallet will sample NEW mixins and include them along with the response. For example, \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e  { 772573, 829705, 1138406, …, 4238645, \n  4239971, **4240066**, 4240661, 4241277, …}\n  (58 in total)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNotice that only ONE of the requested gidxs is the same in both queries, and it happens to be the real one.\u003c/p\u003e\n\n\u003cp\u003eThis is an active attack, and involves showing an error message to the client. This would likely raise suspicion if occurred many times in a row. However, since the transaction goes through without error on the second request, used sparingly the attack may not raise suspicion. This attack could also be performed by a man-in-the-middle or on-path attacker (e.g., an ISP or the starbucks wifi), since connections between a monero client and remote node are over unauthenticated HTTP.\u003c/p\u003e\n\n\u003cp\u003eThe root cause of this hazard is that Monero wallets cannot determine whether the response from remote nodes. Other variations of this attack are possible but are lower yield for the attacker (they only provide useful information some of the time). In particular, instead of returning invalid data, the attacker could guess which input is the real one and just return a bogus response for that one. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-10T00:09:58.470Z","updated_at":"2018-03-10T00:09:58.470Z","actor":{"username":"monero-hax123","cleared":false,"url":"/monero-hax123","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2480110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's a monero address for any bug bounty, thank you for your consideration!\n4DQPtabN9QEW3xhKJ3T2mjNPhnvoDvBRjLRASKr3b58dT2PniYtYwNzfFBrPBamkNA21bCSDuVHk5CHxJy3cBEKL1yox67B3ob6BMZ4FyZ\nI've sent a note containing the draft above to gingeropolous via reddit as well.","markdown_message":"\u003cp\u003eHere\u0026#39;s a monero address for any bug bounty, thank you for your consideration!\u003cbr\u003e\n4DQPtabN9QEW3xhKJ3T2mjNPhnvoDvBRjLRASKr3b58dT2PniYtYwNzfFBrPBamkNA21bCSDuVHk5CHxJy3cBEKL1yox67B3ob6BMZ4FyZ\u003cbr\u003e\nI\u0026#39;ve sent a note containing the draft above to gingeropolous via reddit as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-10T21:56:24.545Z","updated_at":"2018-03-10T21:56:24.545Z","actor":{"username":"monero-hax123","cleared":false,"url":"/monero-hax123","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2481061,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How about Tuesday at 1900 GMT?\n\nI contacted gingeropolous and proposed changes to the moneroworld.com documentation to highlight this risk, he responded quickly and said sure just say when.\n\nI will also make a pull-request for monero-site to add a similar brief warning to this guide:\nhttps://getmonero.org/resources/user-guides/remote_node_gui.html\nsomething like an italicized warning \"Caution: using a public remote node does not provide the same guarantees as running your own remote node.\"","markdown_message":"\u003cp\u003eHow about Tuesday at 1900 GMT?\u003c/p\u003e\n\n\u003cp\u003eI contacted gingeropolous and proposed changes to the moneroworld.com documentation to highlight this risk, he responded quickly and said sure just say when.\u003c/p\u003e\n\n\u003cp\u003eI will also make a pull-request for monero-site to add a similar brief warning to this guide:\u003cbr\u003e\n\u003ca title=\"https://getmonero.org/resources/user-guides/remote_node_gui.html\" href=\"/redirect?url=https%3A%2F%2Fgetmonero.org%2Fresources%2Fuser-guides%2Fremote_node_gui.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://getmonero.org/resources/user-guides/remote_node_gui.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nsomething like an italicized warning \u0026quot;Caution: using a public remote node does not provide the same guarantees as running your own remote node.\u0026quot;\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-11T17:22:12.955Z","updated_at":"2018-03-11T17:22:12.955Z","actor":{"username":"monero-hax123","cleared":false,"url":"/monero-hax123","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2492959,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eHow about Tuesday at 1900 GMT?\n\nWe did not agree to a disclosure date and you [went ahead and posted](https://www.reddit.com/r/Monero/comments/84810s/psa_tracing_attacks_could_be_possible_when_using/) regardless. Not cool. We were waiting for a final review from the team. In the future, please respect the VRP as we were well within the parameters of time constraint.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eHow about Tuesday at 1900 GMT?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWe did not agree to a disclosure date and you \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.reddit.com%2Fr%2FMonero%2Fcomments%2F84810s%2Fpsa_tracing_attacks_could_be_possible_when_using%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewent ahead and posted\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e regardless. Not cool. We were waiting for a final review from the team. In the future, please respect the VRP as we were well within the parameters of time constraint.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-14T19:44:07.824Z","updated_at":"2018-03-14T19:44:07.824Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2494563,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The text looks OK to me. A good place to put this is also monero.stackexchange.com. Just one minor thing:\n\n\u003e The root cause of this hazard is that Monero wallets cannot determine whether the response from remote nodes\n\nThat sentence near the end is incomplete.\n\nSorry for the delay.","markdown_message":"\u003cp\u003eThe text looks OK to me. A good place to put this is also monero.stackexchange.com. Just one minor thing:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThe root cause of this hazard is that Monero wallets cannot determine whether the response from remote nodes\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThat sentence near the end is incomplete.\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-15T09:40:13.343Z","updated_at":"2018-03-15T09:40:13.343Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2495617,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@anonimal sorry about that, I interpreted your last message as a go ahead, and did not realize you were continuing to review w/ the team","markdown_message":"\u003cp\u003e\u003ca href=\"/anonimal\"\u003e@anonimal\u003c/a\u003e sorry about that, I interpreted your last message as a go ahead, and did not realize you were continuing to review w/ the team\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-15T13:34:48.260Z","updated_at":"2018-03-15T13:34:48.260Z","actor":{"username":"monero-hax123","cleared":false,"url":"/monero-hax123","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2496049,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Bounty should be dispersed within a week but no later than 45 days per the VRP.","markdown_message":"\u003cp\u003eBounty should be dispersed within a week but no later than 45 days per the VRP.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-15T15:45:23.861Z","updated_at":"2018-03-15T15:45:23.861Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"monero-hax123","url":"/monero-hax123"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2496054,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-15T15:47:21.676Z","updated_at":"2018-03-15T15:47:21.676Z","first_to_agree":true,"actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2497001,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sent 10 XMR, \u003c8ab4579d98b1c56ce3a6f0acdfabb11efddea6599ae42324ca78ed874b023350\u003e","markdown_message":"\u003cp\u003eSent 10 XMR, \u0026lt;8ab4579d98b1c56ce3a6f0acdfabb11efddea6599ae42324ca78ed874b023350\u0026gt;\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-15T20:37:05.041Z","updated_at":"2018-03-15T20:37:05.041Z","actor":{"username":"luigi1111w","cleared":false,"url":"/luigi1111w","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2497011,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-15T20:40:34.208Z","updated_at":"2018-03-15T20:40:34.208Z","actor":{"url":"/monero","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Monero"}},"reporter":{"username":"monero-hax123","url":"/monero-hax123"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2500243,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-16T22:10:21.863Z","updated_at":"2018-03-16T22:10:21.863Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}