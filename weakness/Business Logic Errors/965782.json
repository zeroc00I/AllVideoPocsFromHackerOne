{"id":965782,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjU3ODI=","url":"https://hackerone.com/reports/965782","title":"Failed assert in `mail_index_transaction_lookup`","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2020-08-24T13:08:53.345Z","submitted_at":"2020-08-24T13:08:53.406Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"catenacyber","url":"/catenacyber","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-27T11:20:51.600Z","bug_reporter_agreed_on_going_public_at":"2020-08-27T11:20:51.549Z","team_member_agreed_on_going_public_at":"2020-08-27T06:05:14.268Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"To reproduce, run test suite on following input :\n```\nrequire\"vnd.dovecot.testsuite\";require \"fileinto\";require \"mailbox\";test\"\" {fileinto:create \"Folder\";\nif test_result_execute {\n}test_message:folder \"Folder\" 2;}\n```\n\nOutput is with (ASAN enabled) stack trace\n```\ntestsuite: Panic: file mail-index-transaction-update.c: line 19 (mail_index_transaction_lookup): assertion failed: (seq \u003e= t-\u003efirst_new_seq \u0026\u0026 seq \u003c= t-\u003elast_new_seq)\n==88957== ERROR: libFuzzer: deadly signal\n    #0 0x10ccb10e7 in __sanitizer_print_stack_trace (libclang_rt.asan_osx_dynamic.dylib:x86_64h+0x600e7)\n    #1 0x10c4b2d5a in fuzzer::PrintStackTrace() FuzzerUtil.cpp:205\n    #2 0x10c494b66 in fuzzer::Fuzzer::CrashCallback() FuzzerLoop.cpp:232\n    #3 0x7fff6121df59 in _sigtramp (libsystem_platform.dylib:x86_64+0x1f59)\n    #4 0x11427ca3f in initialPoolContent (dyld:x86_64+0x52a3f)\n    #5 0x7fff60fbb1ad in abort (libsystem_c.dylib:x86_64+0x5d1ad)\n    #6 0x10cb15a55 in default_fatal_finish failures.c:459\n    #7 0x10cb1425c in fatal_handler_real failures.c:471\n    #8 0x10cb14220 in default_fatal_handler failures.c:479\n    #9 0x10cb1445f in i_panic failures.c:523\n    #10 0x10c9aa992 in mail_index_transaction_lookup mail-index-transaction-update.c:19\n    #11 0x10c9ae4a2 in tview_lookup_uid mail-index-transaction-view.c:162\n    #12 0x10c97cc97 in index_mail_set_seq index-mail.c:1999\n    #13 0x10c468a49 in testsuite_mailstore_mail_index testsuite-mailstore.c:271\n    #14 0x10c46e3ac in cmd_test_message_mailbox_operation_execute cmd-test-message.c:501\n    #15 0x10c5c15dd in sieve_interpreter_operation_execute sieve-interpreter.c:899\n    #16 0x10c5c0fee in sieve_interpreter_continue sieve-interpreter.c:940\n    #17 0x10c5c1bc6 in sieve_interpreter_start sieve-interpreter.c:1012\n    #18 0x10c476cee in testsuite_run fuzz_testsuite.c:60\n```\n\n## Impact\n\nI do not think there is a security impact but pigeonhole should check these values, before passing them to dovecot's lib-index and calling `index_mail_set_seq`","vulnerability_information_html":"\u003cp\u003eTo reproduce, run test suite on following input :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erequire\u0026quot;vnd.dovecot.testsuite\u0026quot;;require \u0026quot;fileinto\u0026quot;;require \u0026quot;mailbox\u0026quot;;test\u0026quot;\u0026quot; {fileinto:create \u0026quot;Folder\u0026quot;;\nif test_result_execute {\n}test_message:folder \u0026quot;Folder\u0026quot; 2;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOutput is with (ASAN enabled) stack trace\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003etestsuite: Panic: file mail-index-transaction-update.c: line 19 (mail_index_transaction_lookup): assertion failed: (seq \u0026gt;= t-\u0026gt;first_new_seq \u0026amp;\u0026amp; seq \u0026lt;= t-\u0026gt;last_new_seq)\n==88957== ERROR: libFuzzer: deadly signal\n    #0 0x10ccb10e7 in __sanitizer_print_stack_trace (libclang_rt.asan_osx_dynamic.dylib:x86_64h+0x600e7)\n    #1 0x10c4b2d5a in fuzzer::PrintStackTrace() FuzzerUtil.cpp:205\n    #2 0x10c494b66 in fuzzer::Fuzzer::CrashCallback() FuzzerLoop.cpp:232\n    #3 0x7fff6121df59 in _sigtramp (libsystem_platform.dylib:x86_64+0x1f59)\n    #4 0x11427ca3f in initialPoolContent (dyld:x86_64+0x52a3f)\n    #5 0x7fff60fbb1ad in abort (libsystem_c.dylib:x86_64+0x5d1ad)\n    #6 0x10cb15a55 in default_fatal_finish failures.c:459\n    #7 0x10cb1425c in fatal_handler_real failures.c:471\n    #8 0x10cb14220 in default_fatal_handler failures.c:479\n    #9 0x10cb1445f in i_panic failures.c:523\n    #10 0x10c9aa992 in mail_index_transaction_lookup mail-index-transaction-update.c:19\n    #11 0x10c9ae4a2 in tview_lookup_uid mail-index-transaction-view.c:162\n    #12 0x10c97cc97 in index_mail_set_seq index-mail.c:1999\n    #13 0x10c468a49 in testsuite_mailstore_mail_index testsuite-mailstore.c:271\n    #14 0x10c46e3ac in cmd_test_message_mailbox_operation_execute cmd-test-message.c:501\n    #15 0x10c5c15dd in sieve_interpreter_operation_execute sieve-interpreter.c:899\n    #16 0x10c5c0fee in sieve_interpreter_continue sieve-interpreter.c:940\n    #17 0x10c5c1bc6 in sieve_interpreter_start sieve-interpreter.c:1012\n    #18 0x10c476cee in testsuite_run fuzz_testsuite.c:60\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eI do not think there is a security impact but pigeonhole should check these values, before passing them to dovecot\u0026#39;s lib-index and calling \u003ccode\u003eindex_mail_set_seq\u003c/code\u003e\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["mygf","aj_75"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":42900,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/dovecot/pigeonhole","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9038166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Problem is strictly limited to the test suite. I have a fix.","markdown_message":"\u003cp\u003eProblem is strictly limited to the test suite. I have a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-25T20:34:25.564Z","updated_at":"2020-08-25T20:34:25.564Z","actor":{"username":"sbosch","cleared":false,"url":"/sbosch","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9050979,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T05:34:27.468Z","updated_at":"2020-08-27T05:34:27.468Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9051161,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T06:01:33.546Z","updated_at":"2020-08-27T06:01:33.546Z","additional_data":{"old_severity":"Low (2.3)","new_severity":"None","old_severity_id":827074,"new_severity_id":829999},"actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9051162,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is not a security issue, and we thank you for taking time to report this to us. We will fix this bug eventually.","markdown_message":"\u003cp\u003eThis is not a security issue, and we thank you for taking time to report this to us. We will fix this bug eventually.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-27T06:01:36.184Z","updated_at":"2020-08-27T06:01:36.184Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"catenacyber","url":"/catenacyber"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9051180,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T06:05:04.837Z","updated_at":"2020-08-27T06:05:04.837Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"catenacyber","url":"/catenacyber"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9051185,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T06:05:14.284Z","updated_at":"2020-08-27T06:05:14.284Z","first_to_agree":true,"actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9053403,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T11:20:51.568Z","updated_at":"2020-08-27T11:20:51.568Z","actor":{"username":"catenacyber","cleared":false,"url":"/catenacyber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9053404,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T11:20:51.621Z","updated_at":"2020-08-27T11:20:51.621Z","actor":{"username":"catenacyber","cleared":false,"url":"/catenacyber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}