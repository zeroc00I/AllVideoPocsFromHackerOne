{"id":336131,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzYxMzE=","url":"https://hackerone.com/reports/336131","title":"Potential to abuse pricing errors in saved carts","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-04-11T20:59:56.472Z","submitted_at":"2018-04-11T20:59:56.472Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"richardf","url":"/richardf","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-05-02T13:51:05.050Z","bug_reporter_agreed_on_going_public_at":"2018-05-02T13:51:04.553Z","team_member_agreed_on_going_public_at":"2018-05-01T21:31:00.875Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"If someone abandons a shopping cart and the price changes between that time and when the abandoned cart recovery email is sent, the saved cart will always show the old price. \n\nIf saved carts do not expire, this can create a situation where bad actors can fill and save shopping carts with sale priced items for purchase at any time in the future simply by bookmarking the cart or saving the abandoned cart recovery email. \n\nOne could for example, save 50% off sale prices in a cart in June and complete the transaction in December. Automated stores or stores in jurisdictions where pricing errors must be honored, may fulfill these purchases at incorrect prices.  \n\nAny Shopify store not using automated abandoned cart emails are probably susceptible to this. \n\nTo replicate this bug simply add any product to a cart with valid purchaser information and then abandon the cart. Then go to the shopify dashboard for that store and change the price for the product in the cart. Then click the abandoned cart link in the corresponding abandoned checkout or send an abandoned cart recovery email and click on the link in that email. The cart will show the old price and will never update.\n\n## Impact\n\nIf commonly known, this could dramatically undermine the integrity of the Shopify platform by allowing unethical consumers attempt to take advantage of vendors by saving and using invalid prices. Any Shopify store not using automated abandoned cart emails are probably susceptible to this.","vulnerability_information_html":"\u003cp\u003eIf someone abandons a shopping cart and the price changes between that time and when the abandoned cart recovery email is sent, the saved cart will always show the old price. \u003c/p\u003e\n\n\u003cp\u003eIf saved carts do not expire, this can create a situation where bad actors can fill and save shopping carts with sale priced items for purchase at any time in the future simply by bookmarking the cart or saving the abandoned cart recovery email. \u003c/p\u003e\n\n\u003cp\u003eOne could for example, save 50% off sale prices in a cart in June and complete the transaction in December. Automated stores or stores in jurisdictions where pricing errors must be honored, may fulfill these purchases at incorrect prices.  \u003c/p\u003e\n\n\u003cp\u003eAny Shopify store not using automated abandoned cart emails are probably susceptible to this. \u003c/p\u003e\n\n\u003cp\u003eTo replicate this bug simply add any product to a cart with valid purchaser information and then abandon the cart. Then go to the shopify dashboard for that store and change the price for the product in the cart. Then click the abandoned cart link in the corresponding abandoned checkout or send an abandoned cart recovery email and click on the link in that email. The cart will show the old price and will never update.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIf commonly known, this could dramatically undermine the integrity of the Shopify platform by allowing unethical consumers attempt to take advantage of vendors by saving and using invalid prices. Any Shopify store not using automated abandoned cart emails are probably susceptible to this.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":30,"voters":["jokebookservice1","jensec","spam404","shazad_sadiq","flashdisk","riramar","syntax-error","eveeez","apapedulimu","lordjerry0x01","and 20 more..."],"severity":{"rating":"medium","score":4.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2598895,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report. Our engineering team is working on a fix for the issue. This issue appears to be more of a functional bug rather than security vulnerability so this may not be eligible for a bounty.\n\nThanks you for helping improve the security of Shopify!","markdown_message":"\u003cp\u003eThanks for your report. Our engineering team is working on a fix for the issue. This issue appears to be more of a functional bug rather than security vulnerability so this may not be eligible for a bounty.\u003c/p\u003e\n\n\u003cp\u003eThanks you for helping improve the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-12T20:36:38.519Z","updated_at":"2018-04-12T20:36:38.519Z","actor":{"username":"lalith-shopify","cleared":false,"url":"/lalith-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2599129,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Happy to help. IMHO it seems to be a glaring and easily exploitable system susceptibility that puts shopify customers at risk of financial loss - which is more or less the definition of a security vulnerability. The fact that no sophisticated tools or techniques are required to exploit this vulnerability does not make it any less critical. Nor does that preclude bad actors from using, or having already used, more sophisticated tools to exploit it.  Let me know if you need anything else from me. ","markdown_message":"\u003cp\u003eHappy to help. IMHO it seems to be a glaring and easily exploitable system susceptibility that puts shopify customers at risk of financial loss - which is more or less the definition of a security vulnerability. The fact that no sophisticated tools or techniques are required to exploit this vulnerability does not make it any less critical. Nor does that preclude bad actors from using, or having already used, more sophisticated tools to exploit it.  Let me know if you need anything else from me. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-12T21:52:33.148Z","updated_at":"2018-04-12T21:52:33.148Z","actor":{"username":"richardf","cleared":false,"url":"/richardf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2653386,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-23T13:12:43.734Z","updated_at":"2018-04-23T13:12:43.734Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"richardf","url":"/richardf"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2687851,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report!\n\nWe have deployed a fix for this issue, and now when a product price gets updated, total price of abandoned checkouts will be also be updated to the latest product price. Given the impact of this issue, we are going to reward an additional $500 bounty. We look forward to more reports from you.","markdown_message":"\u003cp\u003eThanks again for your report!\u003c/p\u003e\n\n\u003cp\u003eWe have deployed a fix for this issue, and now when a product price gets updated, total price of abandoned checkouts will be also be updated to the latest product price. Given the impact of this issue, we are going to reward an additional $500 bounty. We look forward to more reports from you.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-01T21:06:45.917Z","updated_at":"2018-05-01T21:06:45.917Z","actor":{"username":"lalith-shopify","cleared":false,"url":"/lalith-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"richardf","url":"/richardf"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2687914,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @richardf, we're awarding 500$ in addition to the amount paid on triage for a total of 1000$, thank you again for the report!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/richardf\"\u003e@richardf\u003c/a\u003e, we\u0026#39;re awarding 500$ in addition to the amount paid on triage for a total of 1000$, thank you again for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-01T21:24:38.691Z","updated_at":"2018-05-01T21:24:38.691Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"richardf","url":"/richardf"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2687929,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-01T21:31:00.903Z","updated_at":"2018-05-01T21:31:00.903Z","first_to_agree":true,"actor":{"username":"lalith-shopify","cleared":false,"url":"/lalith-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2691102,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you. ","markdown_message":"\u003cp\u003eThank you. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-02T13:51:04.972Z","updated_at":"2018-05-02T13:51:04.972Z","actor":{"username":"richardf","cleared":false,"url":"/richardf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2691103,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-02T13:51:05.079Z","updated_at":"2018-05-02T13:51:05.079Z","actor":{"username":"richardf","cleared":false,"url":"/richardf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2691106,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-02T13:51:20.900Z","updated_at":"2018-05-02T13:51:20.900Z","additional_data":{"old_severity":"None","new_severity":"Medium","old_severity_id":138445,"new_severity_id":148514},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2889837,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T17:43:54.442Z","updated_at":"2018-06-15T17:43:54.442Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.4)","old_severity_id":148514,"new_severity_id":168621},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2889838,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T17:44:10.215Z","updated_at":"2018-06-15T17:44:10.215Z","additional_data":{"added_weaknesses":[{"id":65,"name":"Business Logic Errors"}],"removed_weaknesses":[]},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}