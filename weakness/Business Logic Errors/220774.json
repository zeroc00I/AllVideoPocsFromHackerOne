{"id":220774,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjA3NzQ=","url":"https://hackerone.com/reports/220774","title":"API Last Request Date/Time Not Updating","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-04-13T13:52:36.188Z","submitted_at":"2017-04-13T13:52:36.188Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yaworsk","url":"/yaworsk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-19T18:14:52.827Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-04-19T18:14:52.218Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi All,\nI believe I've found a minor vulnerability with regards to your API last request date/time. However, I could not find any documentation on what this value is supposed to represent / when it should be relied on so I debated reporting this but figured it might in fact be an issue.\n\n##Description\nAfter creating an API token, on the API administration page, there is a field, ```Last request```. When I created the token, the value was ```Never```. However, after playing with the API, making GET, POST and PUT requests, the last request time never gets updated, it appears to be permanently ```Never```.\n\nIn the POC here, you can see that I've received notifications that my API user has performed actions via my notifications popup but the last request remains ```Never```. {F175636}\n\nI should also note that my program is still in sandbox in the event that has some impact on the functionality though I think that would be an odd cause for this. I also have two tokens, one of which I used yesterday just for reading but still says never.\n\n##Vulnerability\nWhile I believe this is minor, I'm reporting because I would think this value was created on the administration page as an added security feature to let administrators know when the API token has last been used. If I'm correct, never updating it would undermine that purpose and create a false sense of security for any administrators relying on the value.\n\n##Steps to reproduce\n1. Create a new sandbox program\n2. Go to the program settings --\u003e API, the url will be https://hackerone.com/PROGRAM_HANDLE/api\n3. Create a token and assign the API user to standard user and admin (or at least I did)\n4. Perform some API curl requests -- I used read report, assign report and program details\n5. Come back to the H1 UI and confirm you got the notifications for the API assigning a report and creating a comment\n6. Reload the /PROGRAM_HANDLE/api page and you'll notice that the last request value has not been updated.\n\nPlease let me know if you have any questions and I apologize in advance if I've misunderstood what the last request field is supposed to denote.\n\nPete\n\n","vulnerability_information_html":"\u003cp\u003eHi All,\u003cbr\u003e\nI believe I\u0026#39;ve found a minor vulnerability with regards to your API last request date/time. However, I could not find any documentation on what this value is supposed to represent / when it should be relied on so I debated reporting this but figured it might in fact be an issue.\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eAfter creating an API token, on the API administration page, there is a field, \u003ccode\u003eLast request\u003c/code\u003e. When I created the token, the value was \u003ccode\u003eNever\u003c/code\u003e. However, after playing with the API, making GET, POST and PUT requests, the last request time never gets updated, it appears to be permanently \u003ccode\u003eNever\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eIn the POC here, you can see that I\u0026#39;ve received notifications that my API user has performed actions via my notifications popup but the last request remains \u003ccode\u003eNever\u003c/code\u003e. {F175636}\u003c/p\u003e\n\n\u003cp\u003eI should also note that my program is still in sandbox in the event that has some impact on the functionality though I think that would be an odd cause for this. I also have two tokens, one of which I used yesterday just for reading but still says never.\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability\"\u003eVulnerability\u003c/h2\u003e\n\n\u003cp\u003eWhile I believe this is minor, I\u0026#39;m reporting because I would think this value was created on the administration page as an added security feature to let administrators know when the API token has last been used. If I\u0026#39;m correct, never updating it would undermine that purpose and create a false sense of security for any administrators relying on the value.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a new sandbox program\u003c/li\u003e\n\u003cli\u003eGo to the program settings --\u0026gt; API, the url will be \u003ca title=\"https://hackerone.com/PROGRAM_HANDLE/api\" href=\"https://hackerone.com/PROGRAM_HANDLE/api\"\u003ehttps://hackerone.com/PROGRAM_HANDLE/api\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eCreate a token and assign the API user to standard user and admin (or at least I did)\u003c/li\u003e\n\u003cli\u003ePerform some API curl requests -- I used read report, assign report and program details\u003c/li\u003e\n\u003cli\u003eCome back to the H1 UI and confirm you got the notifications for the API assigning a report and creating a comment\u003c/li\u003e\n\u003cli\u003eReload the /PROGRAM_HANDLE/api page and you\u0026#39;ll notice that the last request value has not been updated.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePlease let me know if you have any questions and I apologize in advance if I\u0026#39;ve misunderstood what the last request field is supposed to denote.\u003c/p\u003e\n\n\u003cp\u003ePete\u003c/p\u003e\n","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-05-19T18:14:52.307Z","allow_singular_disclosure_after":-50928310.446344465,"singular_disclosure_allowed":true,"vote_count":42,"voters":["str0k1rch","mashoud1122","ramsexy","sameerphad72","mrmustacheman","mygf","jpdev","aryan2808","dhakal_bibek","eveeez","and 32 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1616084,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the delay Pete! Currently investigating this vulnerability and will get back to you shortly.","markdown_message":"\u003cp\u003eSorry for the delay Pete! Currently investigating this vulnerability and will get back to you shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-17T18:20:23.136Z","updated_at":"2017-04-17T18:20:23.136Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1616170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All good. Figured the severity + long weekend might result in a delay. Let me know if I can help in any way.\n\nPete","markdown_message":"\u003cp\u003eAll good. Figured the severity + long weekend might result in a delay. Let me know if I can help in any way.\u003c/p\u003e\n\n\u003cp\u003ePete\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-17T18:38:20.653Z","updated_at":"2017-04-17T18:38:20.653Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1644502,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Marking as triaged :)","markdown_message":"\u003cp\u003eMarking as triaged :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-29T14:41:32.788Z","updated_at":"2017-04-29T14:41:32.788Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646062,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-01T08:12:53.292Z","updated_at":"2017-05-01T08:12:53.292Z","actor":{"username":"jjoos","cleared":false,"url":"/jjoos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/059/21840b8ea35224c071947ddcac0b9eb0801e0235_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1646068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In the end this was us not rendering the actual timestamps in the frontend.\n\nWe appreciate your report, but because the very low severity of this bug we decided not to award a bounty.","markdown_message":"\u003cp\u003eIn the end this was us not rendering the actual timestamps in the frontend.\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your report, but because the very low severity of this bug we decided not to award a bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-01T08:16:10.130Z","updated_at":"2017-05-01T08:16:10.130Z","actor":{"username":"jjoos","cleared":false,"url":"/jjoos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/059/21840b8ea35224c071947ddcac0b9eb0801e0235_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1646074,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-01T08:21:59.894Z","updated_at":"2017-05-01T08:21:59.894Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4599566,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-19T18:14:52.239Z","updated_at":"2019-04-19T18:14:52.239Z","first_to_agree":true,"actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4664045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @bencode, I wondered if you'd ever get around to this report. Can you just remove the image please?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/bencode\"\u003e@bencode\u003c/a\u003e, I wondered if you\u0026#39;d ever get around to this report. Can you just remove the image please?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-29T17:45:33.235Z","updated_at":"2019-04-29T17:45:33.235Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4664946,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Hey @bencode, I wondered if you'd ever get around to this report. Can you just remove the image please?\n\nYep! It's removed now ðŸ˜€","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eHey \u003ca href=\"/bencode\"\u003e@bencode\u003c/a\u003e, I wondered if you\u0026#39;d ever get around to this report. Can you just remove the image please?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYep! It\u0026#39;s removed now ðŸ˜€\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-29T18:33:57.179Z","updated_at":"2019-04-29T18:33:57.179Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4876167,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-19T18:14:52.844Z","updated_at":"2019-05-19T18:14:52.844Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}