{"id":230837,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzA4Mzc=","url":"https://hackerone.com/reports/230837","title":"CSRF To Like/Unlike Photos","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-05-22T17:59:33.758Z","submitted_at":"2017-05-22T17:59:33.758Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pabster","url":"/pabster","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-06-30T04:51:38.579Z","bug_reporter_agreed_on_going_public_at":"2017-06-07T12:14:32.166Z","team_member_agreed_on_going_public_at":"2017-06-30T04:51:38.491Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description:\nThere is a CSRF vulnerability allowing an attacker to trick a user into visiting his/her site and to forge a request to zomato.com that will in turn like or unlike the photos of the attacker's choosing.\n\nThe vulnerable page is https://www.zomato.com/php/photoViewerActionsHandler.php , which doesn't need a csrf token or anything like that in a POST request to like or unlike photos. The request looks like this: \nPOST /php/photoViewerActionsHandler.php\nParameters: \ntype = UNLIKE_PHOTO (Or LIKE_PHOTO)\nphoto_id = [photo id]\n\nTo get the photo id you just have to click on the photo you want the victim to like or unlike, then when you look at the url it should look something like: /es/photos/pv-res-18342981-r_2MzMzNTg1NzIwO      the last section will be /pv-res-[number]-[photo id]\n\nOnce you have the photo id you can perform the CSRF attack easily.\n\nSteps to reproduce:\n1. Deploy a webserver with an index.html file:\n\n\u003cform name=\"x\" action=\"https://www.zomato.com//php/photoViewerActionsHandler.php\" method=\"post\"\u003e\n\u003cinput type=\"hidden\" name='type' value=\"LIKE_PHOTO\"\u003e\n\u003cinput type=\"hidden\" name='photo_id' value=\"r_2MzMzNTg1NzIwO\"\u003e\n\u003c/form\u003e\n\u003cscript\u003edocument.x.submit();\u003c/script\u003e\n\n(Change the value attribute for the input tag with the name attribute of photo_id with the target photo's id and the input tag with the name attribute of type with UNLIKE_PHOTO if you want the victim to unlike a photo.\n2. Get a victim to visit the webserver.\n\nWhen done in large numbers you can easily get a photo to get 100's of likes. You can also damage a restaurant's reputation by using this attack to decrease their likes, and improve your own restaurant's reputation by using this attack to increase their likes.\n\nHope it helps.\nSincerely,\nPablo\n","vulnerability_information_html":"\u003cp\u003eDescription:\u003cbr\u003e\nThere is a CSRF vulnerability allowing an attacker to trick a user into visiting his/her site and to forge a request to zomato.com that will in turn like or unlike the photos of the attacker\u0026#39;s choosing.\u003c/p\u003e\n\n\u003cp\u003eThe vulnerable page is \u003ca title=\"https://www.zomato.com/php/photoViewerActionsHandler.php\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Fphp%2FphotoViewerActionsHandler.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/php/photoViewerActionsHandler.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e , which doesn\u0026#39;t need a csrf token or anything like that in a POST request to like or unlike photos. The request looks like this: \u003cbr\u003e\nPOST /php/photoViewerActionsHandler.php\u003cbr\u003e\nParameters: \u003cbr\u003e\ntype = UNLIKE_PHOTO (Or LIKE_PHOTO)\u003cbr\u003e\nphoto_id = [photo id]\u003c/p\u003e\n\n\u003cp\u003eTo get the photo id you just have to click on the photo you want the victim to like or unlike, then when you look at the url it should look something like: /es/photos/pv-res-18342981-r_2MzMzNTg1NzIwO      the last section will be /pv-res-[number]-[photo id]\u003c/p\u003e\n\n\u003cp\u003eOnce you have the photo id you can perform the CSRF attack easily.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDeploy a webserver with an index.html file:\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u0026lt;form name=\u0026quot;x\u0026quot; action=\u0026quot;https://www.zomato.com//php/photoViewerActionsHandler.php\u0026quot; method=\u0026quot;post\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026#39;type\u0026#39; value=\u0026quot;LIKE_PHOTO\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026#39;photo_id\u0026#39; value=\u0026quot;r_2MzMzNTg1NzIwO\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;/form\u0026gt;\u003cbr\u003e\n\u0026lt;script\u0026gt;document.x.submit();\u0026lt;/script\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e(Change the value attribute for the input tag with the name attribute of photo_id with the target photo\u0026#39;s id and the input tag with the name attribute of type with UNLIKE_PHOTO if you want the victim to unlike a photo.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGet a victim to visit the webserver.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhen done in large numbers you can easily get a photo to get 100\u0026#39;s of likes. You can also damage a restaurant\u0026#39;s reputation by using this attack to decrease their likes, and improve your own restaurant\u0026#39;s reputation by using this attack to increase their likes.\u003c/p\u003e\n\n\u003cp\u003eHope it helps.\u003cbr\u003e\nSincerely,\u003cbr\u003e\nPablo\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-07T12:14:32.211Z","allow_singular_disclosure_after":-109788628.4922311,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","r3y","apapedulimu","pabster","huntman"],"severity":{"rating":"medium","score":4.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1703131,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Pablo, \nThanks for your report. We are looking into this issue.","markdown_message":"\u003cp\u003eHi Pablo, \u003cbr\u003e\nThanks for your report. We are looking into this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-26T10:25:22.411Z","updated_at":"2017-05-26T10:25:22.411Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1728423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates @vinothzomato ?","markdown_message":"\u003cp\u003eAny updates \u003ca href=\"/vinothzomato\"\u003e@vinothzomato\u003c/a\u003e ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-03T21:17:15.818Z","updated_at":"2017-06-03T21:17:15.818Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1736919,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for reporting. Should be resolved.","markdown_message":"\u003cp\u003eThanks for reporting. Should be resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-07T06:28:42.878Z","updated_at":"2017-06-07T06:28:42.878Z","actor":{"username":"ankitladhania","cleared":false,"url":"/ankitladhania","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"pabster","url":"/pabster"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1737368,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for fixing. Requesting disclosure please.","markdown_message":"\u003cp\u003eThanks for fixing. Requesting disclosure please.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-07T12:14:32.181Z","updated_at":"2017-06-07T12:14:32.181Z","first_to_agree":true,"actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1793367,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-30T04:51:38.545Z","updated_at":"2017-06-30T04:51:38.545Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1793368,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-30T04:51:38.596Z","updated_at":"2017-06-30T04:51:38.596Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1877925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, bounty @vinothzomato ?","markdown_message":"\u003cp\u003eHello, bounty \u003ca href=\"/vinothzomato\"\u003e@vinothzomato\u003c/a\u003e ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-30T11:20:23.840Z","updated_at":"2017-07-30T11:20:23.840Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1987533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello is there any bounty @vinothzomato @zomato ?","markdown_message":"\u003cp\u003eHello is there any bounty \u003ca href=\"/vinothzomato\"\u003e@vinothzomato\u003c/a\u003e \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-10T10:00:03.209Z","updated_at":"2017-09-10T10:00:03.209Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2119376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am very sorry to have to ask for a bounty here but in your program it does say that it offers bounties @zomato .","markdown_message":"\u003cp\u003eI am very sorry to have to ask for a bounty here but in your program it does say that it offers bounties \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e .\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-31T22:03:43.901Z","updated_at":"2017-10-31T22:03:43.901Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2178217,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"This report is not eligible for a reward due to program policy in effect at the issue reported time.","markdown_message":"\u003cp\u003eThis report is not eligible for a reward due to program policy in effect at the issue reported time.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-23T05:16:19.440Z","updated_at":"2017-11-23T05:16:19.440Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}