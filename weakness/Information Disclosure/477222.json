{"id":477222,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzcyMjI=","url":"https://hackerone.com/reports/477222","title":"Last build status and coverage leaked to unauthorized users","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-01-09T19:52:23.194Z","submitted_at":"2019-01-09T19:52:23.194Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xanbanx","url":"/xanbanx","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-5463"],"singular_disclosure_disabled":true,"disclosed_at":"2019-09-01T18:06:10.339Z","bug_reporter_agreed_on_going_public_at":"2019-09-01T18:06:10.259Z","team_member_agreed_on_going_public_at":"2019-08-30T22:23:24.369Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"GitLab CI supports creating badges for the latest build/coverage on a certain branches. However, with restricted access, where users do not have access to pipelines, users still have access to the build/coverage status of any branch.\nThis access works for different configurations:\n\n1. For public projects with restricted pipeline access, any user (the user does not need to be signed in) has access to this information\n2. For internal projects with restricted pipeline access, any authenticated user has access to this information\n3. For private projects, any Guest user of that project has access to this information\n\n## Steps to reproduce\n\n1. Create a public repo, configure CI, and push some code. Consider the project namespace to be `test/cibadges` in these steps.\n2. Restrict the visibility of whole repo to `Project Members Only` and disable `Public builds` in the CI settings\n3. As a non-authenticated user visit the following page: `https://example.gitlab.com/test/cibadges/badges/master/pipeline.svg`\n\nThis will return a SVG image showing the build status of the `master` branch. This works for any other branch as well. The same thing also works with the coverage badge accessible via the following link `https://example.gitlab.com/test/cibadges/badges/master/coverage.svg`\nThe same works for the other configurations as mentioned above.\n\nEven if repos and therefore also pipelines are completely disabled, the last build status/coverage still can be retrieved via the badges link.\n\n## Steps to mitigate\n\nPerform proper authorization check handling a badge request\n\n## Impact\n\nUsers with restricted pipeline access can see the build/coverage status for different branches","vulnerability_information_html":"\u003cp\u003eGitLab CI supports creating badges for the latest build/coverage on a certain branches. However, with restricted access, where users do not have access to pipelines, users still have access to the build/coverage status of any branch.\u003cbr\u003e\nThis access works for different configurations:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFor public projects with restricted pipeline access, any user (the user does not need to be signed in) has access to this information\u003c/li\u003e\n\u003cli\u003eFor internal projects with restricted pipeline access, any authenticated user has access to this information\u003c/li\u003e\n\u003cli\u003eFor private projects, any Guest user of that project has access to this information\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a public repo, configure CI, and push some code. Consider the project namespace to be \u003ccode\u003etest/cibadges\u003c/code\u003e in these steps.\u003c/li\u003e\n\u003cli\u003eRestrict the visibility of whole repo to \u003ccode\u003eProject Members Only\u003c/code\u003e and disable \u003ccode\u003ePublic builds\u003c/code\u003e in the CI settings\u003c/li\u003e\n\u003cli\u003eAs a non-authenticated user visit the following page: \u003ccode\u003ehttps://example.gitlab.com/test/cibadges/badges/master/pipeline.svg\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThis will return a SVG image showing the build status of the \u003ccode\u003emaster\u003c/code\u003e branch. This works for any other branch as well. The same thing also works with the coverage badge accessible via the following link \u003ccode\u003ehttps://example.gitlab.com/test/cibadges/badges/master/coverage.svg\u003c/code\u003e\u003cbr\u003e\nThe same works for the other configurations as mentioned above.\u003c/p\u003e\n\n\u003cp\u003eEven if repos and therefore also pipelines are completely disabled, the last build status/coverage still can be retrieved via the badges link.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-mitigate\"\u003eSteps to mitigate\u003c/h2\u003e\n\n\u003cp\u003ePerform proper authorization check handling a badge request\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eUsers with restricted pipeline access can see the build/coverage status for different branches\u003c/p\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":22,"voters":["karma7","securitychops","mashoud1122","mygf","khizer47","m7mdharoun","z41b1337_","cr4xerbik4sh","cryptographer","dyplodus","and 12 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3950456,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xanbanx,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 20 business days with an update.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We will investigate the issue as soon as possible.\u003cbr\u003e\nDue to our current workload, we will get back within 20 business days with an update.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2019-01-09T20:21:42.507Z","updated_at":"2019-01-09T20:21:42.507Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3988015,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hello @xanbanx,\n\nThanks for reporting this issue. Unfortunately, we will be considering it a duplicate of the previously submitted report regarding Guest access to the described resources.\n\nBest regards,\nSecurity Team | GitLab","markdown_message":"\u003cp\u003eHello \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue. Unfortunately, we will be considering it a duplicate of the previously submitted report regarding Guest access to the described resources.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSecurity Team | GitLab\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-16T17:27:49.660Z","updated_at":"2019-01-16T17:27:49.660Z","original_report_id":440185,"actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3988422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Makes totally sense. Thanks for the update.\n\nCheers,\nXanbanx","markdown_message":"\u003cp\u003eMakes totally sense. Thanks for the update.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nXanbanx\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-16T18:35:11.809Z","updated_at":"2019-01-16T18:35:11.809Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4077573,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asaba \n\nThis report is marked as a duplicate of #440185. While #440185 is fixed, the issue of this report still exists.\nTherefore, I kindly ask to reopen this report - Thanks!\n\nCheers,\nXanbanx","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asaba\"\u003e@asaba\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThis report is marked as a duplicate of \u003ca href=\"/reports/440185\"\u003e#440185\u003c/a\u003e. While \u003ca href=\"/reports/440185\"\u003e#440185\u003c/a\u003e is fixed, the issue of this report still exists.\u003cbr\u003e\nTherefore, I kindly ask to reopen this report - Thanks!\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nXanbanx\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-01T09:33:46.134Z","updated_at":"2019-02-01T09:33:46.134Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4251626,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asaba,\n\nIs there any update on this one?\n\nCheers,\nXanbanx","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asaba\"\u003e@asaba\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eIs there any update on this one?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nXanbanx\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T10:27:21.120Z","updated_at":"2019-03-04T10:27:21.120Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4255801,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Hello @xanbanx ,\n\nI am reopening this report while the behavior is verified by the engineering team.\n\nRegards,","markdown_message":"\u003cp\u003eHello \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eI am reopening this report while the behavior is verified by the engineering team.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T21:03:37.680Z","updated_at":"2019-03-04T21:03:37.680Z","actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4639940,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asaba,\nIt's almost 2 months. Has the engineering team verified the behavior?\nBest,\nXanbanx","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asaba\"\u003e@asaba\u003c/a\u003e,\u003cbr\u003e\nIt\u0026#39;s almost 2 months. Has the engineering team verified the behavior?\u003cbr\u003e\nBest,\u003cbr\u003e\nXanbanx\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-25T08:47:58.958Z","updated_at":"2019-04-25T08:47:58.958Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4642300,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xanbanx ,\n\nThe engineering team has verified the behavior. We apologize for the delays in addressing our backlog of Low severity issues. We will review within the next 2 weeks to determine if a bounty can be awarded ahead of a patch.\n\nBest Regards,","markdown_message":"\u003cp\u003eHi \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThe engineering team has verified the behavior. We apologize for the delays in addressing our backlog of Low severity issues. We will review within the next 2 weeks to determine if a bounty can be awarded ahead of a patch.\u003c/p\u003e\n\n\u003cp\u003eBest Regards,\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-25T15:22:59.412Z","updated_at":"2019-04-25T15:22:59.412Z","actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4695559,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi,\n\nThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\n\nWe will continue to keep you updated via HackerOne as a fix is scheduled.\n\nBest regards,\nSecurity Team | GitLab Inc.\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\u003c/p\u003e\n\n\u003cp\u003eWe will continue to keep you updated via HackerOne as a fix is scheduled.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-30T23:09:41.911Z","updated_at":"2019-04-30T23:09:41.911Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"xanbanx","url":"/xanbanx"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4712933,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks \u003c3","markdown_message":"\u003cp\u003eThanks \u0026lt;3\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-02T12:01:31.123Z","updated_at":"2019-05-02T12:01:31.123Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5701476,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-30T22:22:30.354Z","updated_at":"2019-08-30T22:22:30.354Z","actor":{"username":"akelly","cleared":false,"url":"/akelly","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"xanbanx","url":"/xanbanx"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5701477,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello @xanbanx,\n\nNow that it has been 30 days since a fix was released for this finding, we would like to publicly disclose this report.\n\nPlease note that [the GitLab issue](https://gitlab.com/gitlab-org/gitlab-ce/issues/56407) for this report has now been set to public. If you see any sensitive information that needs to be redacted or removed in that GitLab issue or this report, please let me know here.\n\nThanks again for helping make GitLab more secure.\n\nHave a great day,\nAndrew\nSecurity Team | GitLab","markdown_message":"\u003cp\u003eHello \u003ca href=\"/xanbanx\"\u003e@xanbanx\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eNow that it has been 30 days since a fix was released for this finding, we would like to publicly disclose this report.\u003c/p\u003e\n\n\u003cp\u003ePlease note that \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F56407\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethe GitLab issue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for this report has now been set to public. If you see any sensitive information that needs to be redacted or removed in that GitLab issue or this report, please let me know here.\u003c/p\u003e\n\n\u003cp\u003eThanks again for helping make GitLab more secure.\u003c/p\u003e\n\n\u003cp\u003eHave a great day,\u003cbr\u003e\nAndrew\u003cbr\u003e\nSecurity Team | GitLab\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-30T22:23:24.406Z","updated_at":"2019-08-30T22:23:24.406Z","first_to_agree":true,"actor":{"username":"akelly","cleared":false,"url":"/akelly","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5708458,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the bounty!","markdown_message":"\u003cp\u003eThanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-01T18:06:10.286Z","updated_at":"2019-09-01T18:06:10.286Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5708459,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-01T18:06:10.363Z","updated_at":"2019-09-01T18:06:10.363Z","actor":{"username":"xanbanx","cleared":false,"url":"/xanbanx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}