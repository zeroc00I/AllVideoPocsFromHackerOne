{"id":677557,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Nzc1NTc=","url":"https://hackerone.com/reports/677557","title":"mod_http2, memory corruption on early pushes (CVE-2019-10081)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-08-20T14:14:29.247Z","submitted_at":"2019-08-20T14:14:29.247Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cy1337","url":"/cy1337","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":26,"url":"https://hackerone.com/ibb-apache","handle":"ibb-apache","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Apache httpd (IBB)","twitter_handle":"","website":"http://apache.org/security","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-10081"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-15T18:00:26.476Z","bug_reporter_agreed_on_going_public_at":"2019-10-15T18:00:26.434Z","team_member_agreed_on_going_public_at":"2019-10-08T20:19:40.605Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"HTTP/2 very early pushes, for example configured with `H2PushResource`, could lead to an overwrite of memory in the pushing request's pool, leading to crashes. The memory copied is that of the configured push link header values, not data supplied by the client. Scenarios where an attacker may be able to influence response header values could potentially lead to controlled code execution. (Code execution has not been demonstrated and is unlikely with the config included here.) This issue affects versions 2.4.20 through 2.4.39.\n\nThis CVE is noted on the [Apache HTTPD advisory list](https://httpd.apache.org/security/vulnerabilities_24.html) as of August 14, 2019.\n\nReproduction is possible under ASAN builds of HTTPD with `MaxMemFree 1` and `H2Push On`\n\nThe following supplement to the default configuration is used:\n```\nProtocols h2c http/1.1\nMaxMemFree 1\nH2Push On\nH2EarlyHints On\nH2MaxSessionStreams 65535\nH2WindowSize 65535\nH2MinWorkers 5\nH2MaxWorkers 32\nH2MaxWorkerIdleSeconds 3\nH2StreamMaxMemSize 1024\nH2SerializeHeaders on\nH2CopyFiles on\nH2Padding 7\n\u003cLocation /\u003e\n    Header add Link \"\u003c/xxx.css\u003e;rel=preload\"\n    Header add Link \"\u003c/xxx.js\u003e;rel=preload\"\n    H2PushResource /xxx2.css\n    H2PushResource /xxx3.css\n    H2PushResource /\n\u003c/Location\u003e \n```\n\nUnder this configuration, the UAF is easily observed when handling traffic from [http2fuzz](https://github.com/c0nrad/http2fuzz). The behavior is affected by the size of responses and frequency of requests.\n\nASAN reports for these crashes are interesting because the faulting address tends to be an ASCII string. \n\nHere is a report where it manifested as a SEGV on an address which is actually an ASCII string (`0x44415445 == \"DATE\"`):\n```\n=================================================================\n==7224==ERROR: AddressSanitizer: SEGV on unknown address 0x000044415445 (pc 0x00000068a8a3 bp 0x7fd8cf572a30 sp 0x7fd8cf5728d0 T1021)\n    #0 0x68a8a2 in ap_http_filter /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_filters.c:497\n    #1 0x464232 in ap_get_brigade /home/cyoung/http2_fuzz/httpd-2.4.39/server/util_filter.c:553\n    #2 0x696781 in ap_discard_request_body /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_filters.c:1637\n    #3 0x47f9d5 in ap_finalize_request_protocol /home/cyoung/http2_fuzz/httpd-2.4.39/server/protocol.c:1589\n    #4 0x67d037 in ap_die_r /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_request.c:82\n    #5 0x680ad3 in ap_process_async_request /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_request.c:476\n    #6 0x680bc0 in ap_process_request /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_request.c:488\n    #7 0x67648d in ap_process_http_sync_connection /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_core.c:210\n    #8 0x676702 in ap_process_http_connection /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_core.c:251\n    #9 0x4f4c90 in ap_run_process_connection /home/cyoung/http2_fuzz/httpd-2.4.39/server/connection.c:42\n    #10 0x8f488d in h2_task_do /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_task.c:615\n    #11 0x904388 in slot_run /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_workers.c:231\n    #12 0x7fdadd58b92d in dummy_worker threadproc/unix/thread.c:142\n    #13 0x7fdadd0c36b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)\n    #14 0x7fdadcdf941c in clone (/lib/x86_64-linux-gnu/libc.so.6+0x10741c)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_filters.c:497 ap_http_filter\nThread T1021 created by T0 here:\n    #0 0x7fdadeddb253 in pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x36253)\n    #1 0x7fdadd58bbd7 in apr_thread_create threadproc/unix/thread.c:179\n    #2 0x903a7e in activate_slot /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_workers.c:106\n    #3 0x9051de in h2_workers_create /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_workers.c:358\n    #4 0x8735fb in h2_conn_child_init /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_conn.c:136\n    #5 0x86b62f in h2_child_init /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/mod_http2.c:186\n    #6 0x4cff5c in ap_run_child_init /home/cyoung/http2_fuzz/httpd-2.4.39/server/config.c:166\n    #7 0x9e104c in child_main /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2502\n    #8 0x9e1a61 in make_child /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2691\n    #9 0x9e38d7 in perform_idle_server_maintenance /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2886\n    #10 0x9e440a in server_main_loop /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:3015\n    #11 0x9e4e1d in event_run /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:3092\n    #12 0x45e3ad in ap_run_mpm /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm_common.c:94\n    #13 0x445d2b in main /home/cyoung/http2_fuzz/httpd-2.4.39/server/main.c:819\n    #14 0x7fdadcd1282f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n\n==7224==ABORTING\n```\n\nAnd another trace shows `bPPUSP` as the fault address:\n```\n=================================================================\n==16301==ERROR: AddressSanitizer: SEGV on unknown address 0x625050555350 (pc 0x7fb7144ffa1f bp 0x7fb4f3775530 sp 0x7fb4f3775500 T1058)\n    #0 0x7fb7144ffa1e in apr_pool_cleanup_kill memory/unix/apr_pools.c:2553\n    #1 0x907d6f in pool_kill /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_bucket_beam.c:491\n    #2 0x90877a in beam_cleanup /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_bucket_beam.c:601\n    #3 0x908965 in h2_beam_destroy /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_bucket_beam.c:622\n    #4 0x8f352e in h2_task_destroy /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_task.c:530\n    #5 0x889186 in stream_destroy_iter /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_mplx.c:310\n    #6 0x8f9325 in ihash_iter /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_util.c:275\n    #7 0x7fb7144db246 in apr_hash_do tables/apr_hash.c:542\n    #8 0x8f9416 in h2_ihash_iter /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_util.c:283\n    #9 0x88933f in purge_streams /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_mplx.c:328\n    #10 0x899ac4 in h2_mplx_dispatch_master_events /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_mplx.c:1066\n    #11 0x8c8ce8 in dispatch_master /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_session.c:2072\n    #12 0x8ce130 in h2_session_process /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_session.c:2264\n    #13 0x873b76 in h2_conn_run /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_conn.c:208\n    #14 0x883731 in h2_h2_process_conn /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_h2.c:657\n    #15 0x4f4c90 in ap_run_process_connection /home/cyoung/http2_fuzz/httpd-2.4.39/server/connection.c:42\n    #16 0x9d7eed in process_socket /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:1050\n    #17 0x9de808 in worker_thread /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2083\n    #18 0x7fb71452a92d in dummy_worker threadproc/unix/thread.c:142\n    #19 0x7fb7140626b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)\n    #20 0x7fb713d9841c in clone (/lib/x86_64-linux-gnu/libc.so.6+0x10741c)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV memory/unix/apr_pools.c:2553 apr_pool_cleanup_kill\nThread T1058 created by T1042 here:\n    #0 0x7fb715d7a253 in pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x36253)\n    #1 0x7fb71452abd7 in apr_thread_create threadproc/unix/thread.c:179\n    #2 0x9dff5f in start_threads /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2337\n    #3 0x7fb71452a92d in dummy_worker threadproc/unix/thread.c:142\n    #4 0x7fb7140626b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)\n\nThread T1042 created by T0 here:\n    #0 0x7fb715d7a253 in pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x36253)\n    #1 0x7fb71452abd7 in apr_thread_create threadproc/unix/thread.c:179\n    #2 0x9e13e1 in child_main /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2542\n    #3 0x9e1ada in make_child /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2691\n    #4 0x9e3950 in perform_idle_server_maintenance /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2886\n    #5 0x9e4483 in server_main_loop /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:3015\n    #6 0x9e4e96 in event_run /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:3092\n    #7 0x45e3ad in ap_run_mpm /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm_common.c:94\n    #8 0x445d2b in main /home/cyoung/http2_fuzz/httpd-2.4.39/server/main.c:819\n    #9 0x7fb713cb182f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n\n==16301==ABORTING\n```\n\n## Impact\n\nAt a minimum, a remote unauthenticated attacker can DoS the server. The maximum risk, code execution, would be highly context dependent since an attacker generally cannot control the values being written improperly.","vulnerability_information_html":"\u003cp\u003eHTTP/2 very early pushes, for example configured with \u003ccode\u003eH2PushResource\u003c/code\u003e, could lead to an overwrite of memory in the pushing request\u0026#39;s pool, leading to crashes. The memory copied is that of the configured push link header values, not data supplied by the client. Scenarios where an attacker may be able to influence response header values could potentially lead to controlled code execution. (Code execution has not been demonstrated and is unlikely with the config included here.) This issue affects versions 2.4.20 through 2.4.39.\u003c/p\u003e\n\n\u003cp\u003eThis CVE is noted on the \u003ca href=\"/redirect?url=https%3A%2F%2Fhttpd.apache.org%2Fsecurity%2Fvulnerabilities_24.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eApache HTTPD advisory list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e as of August 14, 2019.\u003c/p\u003e\n\n\u003cp\u003eReproduction is possible under ASAN builds of HTTPD with \u003ccode\u003eMaxMemFree 1\u003c/code\u003e and \u003ccode\u003eH2Push On\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThe following supplement to the default configuration is used:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eProtocols h2c http/1.1\nMaxMemFree 1\nH2Push On\nH2EarlyHints On\nH2MaxSessionStreams 65535\nH2WindowSize 65535\nH2MinWorkers 5\nH2MaxWorkers 32\nH2MaxWorkerIdleSeconds 3\nH2StreamMaxMemSize 1024\nH2SerializeHeaders on\nH2CopyFiles on\nH2Padding 7\n\u0026lt;Location /\u0026gt;\n    Header add Link \u0026quot;\u0026lt;/xxx.css\u0026gt;;rel=preload\u0026quot;\n    Header add Link \u0026quot;\u0026lt;/xxx.js\u0026gt;;rel=preload\u0026quot;\n    H2PushResource /xxx2.css\n    H2PushResource /xxx3.css\n    H2PushResource /\n\u0026lt;/Location\u0026gt; \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUnder this configuration, the UAF is easily observed when handling traffic from \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fc0nrad%2Fhttp2fuzz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp2fuzz\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The behavior is affected by the size of responses and frequency of requests.\u003c/p\u003e\n\n\u003cp\u003eASAN reports for these crashes are interesting because the faulting address tends to be an ASCII string. \u003c/p\u003e\n\n\u003cp\u003eHere is a report where it manifested as a SEGV on an address which is actually an ASCII string (\u003ccode\u003e0x44415445 == \u0026quot;DATE\u0026quot;\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e=================================================================\n==7224==ERROR: AddressSanitizer: SEGV on unknown address 0x000044415445 (pc 0x00000068a8a3 bp 0x7fd8cf572a30 sp 0x7fd8cf5728d0 T1021)\n    #0 0x68a8a2 in ap_http_filter /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_filters.c:497\n    #1 0x464232 in ap_get_brigade /home/cyoung/http2_fuzz/httpd-2.4.39/server/util_filter.c:553\n    #2 0x696781 in ap_discard_request_body /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_filters.c:1637\n    #3 0x47f9d5 in ap_finalize_request_protocol /home/cyoung/http2_fuzz/httpd-2.4.39/server/protocol.c:1589\n    #4 0x67d037 in ap_die_r /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_request.c:82\n    #5 0x680ad3 in ap_process_async_request /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_request.c:476\n    #6 0x680bc0 in ap_process_request /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_request.c:488\n    #7 0x67648d in ap_process_http_sync_connection /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_core.c:210\n    #8 0x676702 in ap_process_http_connection /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_core.c:251\n    #9 0x4f4c90 in ap_run_process_connection /home/cyoung/http2_fuzz/httpd-2.4.39/server/connection.c:42\n    #10 0x8f488d in h2_task_do /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_task.c:615\n    #11 0x904388 in slot_run /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_workers.c:231\n    #12 0x7fdadd58b92d in dummy_worker threadproc/unix/thread.c:142\n    #13 0x7fdadd0c36b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)\n    #14 0x7fdadcdf941c in clone (/lib/x86_64-linux-gnu/libc.so.6+0x10741c)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http/http_filters.c:497 ap_http_filter\nThread T1021 created by T0 here:\n    #0 0x7fdadeddb253 in pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x36253)\n    #1 0x7fdadd58bbd7 in apr_thread_create threadproc/unix/thread.c:179\n    #2 0x903a7e in activate_slot /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_workers.c:106\n    #3 0x9051de in h2_workers_create /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_workers.c:358\n    #4 0x8735fb in h2_conn_child_init /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_conn.c:136\n    #5 0x86b62f in h2_child_init /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/mod_http2.c:186\n    #6 0x4cff5c in ap_run_child_init /home/cyoung/http2_fuzz/httpd-2.4.39/server/config.c:166\n    #7 0x9e104c in child_main /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2502\n    #8 0x9e1a61 in make_child /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2691\n    #9 0x9e38d7 in perform_idle_server_maintenance /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2886\n    #10 0x9e440a in server_main_loop /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:3015\n    #11 0x9e4e1d in event_run /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:3092\n    #12 0x45e3ad in ap_run_mpm /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm_common.c:94\n    #13 0x445d2b in main /home/cyoung/http2_fuzz/httpd-2.4.39/server/main.c:819\n    #14 0x7fdadcd1282f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n\n==7224==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd another trace shows \u003ccode\u003ebPPUSP\u003c/code\u003e as the fault address:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e=================================================================\n==16301==ERROR: AddressSanitizer: SEGV on unknown address 0x625050555350 (pc 0x7fb7144ffa1f bp 0x7fb4f3775530 sp 0x7fb4f3775500 T1058)\n    #0 0x7fb7144ffa1e in apr_pool_cleanup_kill memory/unix/apr_pools.c:2553\n    #1 0x907d6f in pool_kill /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_bucket_beam.c:491\n    #2 0x90877a in beam_cleanup /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_bucket_beam.c:601\n    #3 0x908965 in h2_beam_destroy /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_bucket_beam.c:622\n    #4 0x8f352e in h2_task_destroy /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_task.c:530\n    #5 0x889186 in stream_destroy_iter /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_mplx.c:310\n    #6 0x8f9325 in ihash_iter /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_util.c:275\n    #7 0x7fb7144db246 in apr_hash_do tables/apr_hash.c:542\n    #8 0x8f9416 in h2_ihash_iter /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_util.c:283\n    #9 0x88933f in purge_streams /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_mplx.c:328\n    #10 0x899ac4 in h2_mplx_dispatch_master_events /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_mplx.c:1066\n    #11 0x8c8ce8 in dispatch_master /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_session.c:2072\n    #12 0x8ce130 in h2_session_process /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_session.c:2264\n    #13 0x873b76 in h2_conn_run /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_conn.c:208\n    #14 0x883731 in h2_h2_process_conn /home/cyoung/http2_fuzz/httpd-2.4.39/modules/http2/h2_h2.c:657\n    #15 0x4f4c90 in ap_run_process_connection /home/cyoung/http2_fuzz/httpd-2.4.39/server/connection.c:42\n    #16 0x9d7eed in process_socket /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:1050\n    #17 0x9de808 in worker_thread /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2083\n    #18 0x7fb71452a92d in dummy_worker threadproc/unix/thread.c:142\n    #19 0x7fb7140626b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)\n    #20 0x7fb713d9841c in clone (/lib/x86_64-linux-gnu/libc.so.6+0x10741c)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV memory/unix/apr_pools.c:2553 apr_pool_cleanup_kill\nThread T1058 created by T1042 here:\n    #0 0x7fb715d7a253 in pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x36253)\n    #1 0x7fb71452abd7 in apr_thread_create threadproc/unix/thread.c:179\n    #2 0x9dff5f in start_threads /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2337\n    #3 0x7fb71452a92d in dummy_worker threadproc/unix/thread.c:142\n    #4 0x7fb7140626b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)\n\nThread T1042 created by T0 here:\n    #0 0x7fb715d7a253 in pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x36253)\n    #1 0x7fb71452abd7 in apr_thread_create threadproc/unix/thread.c:179\n    #2 0x9e13e1 in child_main /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2542\n    #3 0x9e1ada in make_child /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2691\n    #4 0x9e3950 in perform_idle_server_maintenance /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:2886\n    #5 0x9e4483 in server_main_loop /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:3015\n    #6 0x9e4e96 in event_run /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm/event/event.c:3092\n    #7 0x45e3ad in ap_run_mpm /home/cyoung/http2_fuzz/httpd-2.4.39/server/mpm_common.c:94\n    #8 0x445d2b in main /home/cyoung/http2_fuzz/httpd-2.4.39/server/main.c:819\n    #9 0x7fb713cb182f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n\n==16301==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAt a minimum, a remote unauthenticated attacker can DoS the server. The maximum risk, code execution, would be highly context dependent since an attacker generally cannot control the values being written improperly.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":50,"name":"Use After Free"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-07T20:19:40.728Z","allow_singular_disclosure_after":-36065849.339427896,"singular_disclosure_allowed":true,"vote_count":3,"voters":["must4r","joder","fad3d"],"severity":{"rating":"high","score":8.6,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5634266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cy1337 \n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@ktistai","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cy1337\"\u003e@cy1337\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/ktistai\"\u003e@ktistai\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-22T07:47:12.800Z","updated_at":"2019-08-22T07:47:12.800Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5634313,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @cy1337 , \n\nCan you send an email from vuln-report@secur3.us towards analysts@managed.hackerone.com and also mention Ktistai in the subject. I am 99% sure the reporter is you, but because of the mismatch between email addresses I just have to check. Sorry about that. \n\nThanks, \n@ktistai","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cy1337\"\u003e@cy1337\u003c/a\u003e , \u003c/p\u003e\n\n\u003cp\u003eCan you send an email from \u003ca title=\"vuln-report@secur3.us\" href=\"mailto:vuln-report@secur3.us\" rel=\"nofollow noopener noreferrer\"\u003evuln-report@secur3.us\u003c/a\u003e towards \u003ca title=\"analysts@managed.hackerone.com\" href=\"mailto:analysts@managed.hackerone.com\" rel=\"nofollow noopener noreferrer\"\u003eanalysts@managed.hackerone.com\u003c/a\u003e and also mention Ktistai in the subject. I am 99% sure the reporter is you, but because of the mismatch between email addresses I just have to check. Sorry about that. \u003c/p\u003e\n\n\u003cp\u003eThanks, \u003cbr\u003e\n\u003ca href=\"/ktistai\"\u003e@ktistai\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-22T07:56:06.464Z","updated_at":"2019-08-22T07:56:06.464Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5640309,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Done. Although I am curious why this was needed since I also sign into H1 with this email address.","markdown_message":"\u003cp\u003eDone. Although I am curious why this was needed since I also sign into H1 with this email address.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-22T15:36:58.890Z","updated_at":"2019-08-22T15:36:58.890Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5645416,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @cy1337 \n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@Ktistai\n\nPS: ``` Although I am curious why this was needed since I also sign into H1 with this email address.``` : I had no clue where to find the email in your profile....","markdown_message":"\u003cp\u003eHello \u003ca href=\"/cy1337\"\u003e@cy1337\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/ktistai\"\u003e@Ktistai\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePS: \u003ccode\u003eAlthough I am curious why this was needed since I also sign into H1 with this email address.\u003c/code\u003e : I had no clue where to find the email in your profile....\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-23T08:29:34.373Z","updated_at":"2019-08-23T08:29:34.373Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5989549,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:18:54.595Z","updated_at":"2019-10-08T20:18:54.595Z","cve_ids":["CVE-2019-10081"],"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989550,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:19:25.917Z","updated_at":"2019-10-08T20:19:25.917Z","actor":{"url":"/ibb-apache","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Apache httpd (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-apache","collaborator":{"username":"cy1337","url":"/cy1337"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989552,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for helping keep the Internet safe!","markdown_message":"\u003cp\u003eThanks for helping keep the Internet safe!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-08T20:19:35.722Z","updated_at":"2019-10-08T20:19:35.722Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"cy1337","url":"/cy1337"},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989555,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:19:40.630Z","updated_at":"2019-10-08T20:19:40.630Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6047802,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-15T18:00:26.449Z","updated_at":"2019-10-15T18:00:26.449Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6047803,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-15T18:00:26.491Z","updated_at":"2019-10-15T18:00:26.491Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}