{"id":134546,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzQ1NDY=","url":"https://hackerone.com/reports/134546","title":"WordPress Flash XSS in *flashmediaelement.swf*","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-26T06:34:20.780Z","submitted_at":"2016-04-26T06:34:20.780Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cure53","url":"/cure53","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-10T12:51:12.764Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-06-10T12:51:04.174Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Intro\n==\n\nWordPress is vulnerable against a reflected XSS that stems from an insecure URL sanitization problem performed in the file *flashmediaelement.swf*. The code in the file attempts to remove *flashVars* [¹](https://helpx.adobe.com/flash/kb/pass-variables-swfs-flashvars.html) in case they have been set GET parameters but fails to do so, enabling XSS via *ExternalInterface* [²](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html).\n\nThe attack technique was first described by Soroush Dalili in 2013 [³](https://soroush.secproject.com/blog/2013/10/catch-up-on-flash-xss-exploitation-bypassing-the-guardians-part-1/). The vulnerability in *flashmediaelement.swf* was discovered in April 2016, first identified as SOME[⁴](http://www.benhayak.com/2015/06/same-origin-method-execution-some.html) bug by Kinugawa. Then, after a team review, the XSS potential was discovered and analyzed by Heiderich, Kinugawa and Inführ. Finally, it was discovered, that this file comes packaged with latest WordPress and the issue was reported here by Heiderich et al. \n\n**PoC:**\nhttps://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert`1`\n\nBackground\n==\n\nIn the browser-world, a Flash file can be fed with parameters in multiple ways.\n\n**Way One:** *flashVars*\n\n```html\n\u003cembed src=\"myFlashMovie.swf\"\n    quality=\"high\"\n    bgcolor=\"#ffffff\"\n    width=\"550\"\n    height=\"400\"\n    name=\"myFlashMovie\"     \n    FlashVars=\"myVariable=Hello%20World\u0026mySecondVariable=Goodbye\"\n    align=\"middle\"\n    allowScriptAccess=\"sameDomain\"\n    allowFullScreen=\"false\"\n    type=\"application/x-shockwave-flash\"\n    pluginspage=\"http://www.adobe.com/go/getflash\"\n/\u003e\n```\n\n**Way Two:** GET parameters\n\n```\nmyFlashMovie.swf?myVariable=Hello%20World\u0026mySecondVariable=Goodbye\n```\n\nQuite obviously, *flashVars* via GET give an attacker more leverage, especially in case the Flash file can be opened directly in the browser. No need to embed it, just attach the *flashVars* via GET and the fun begins. \n\nNot unlike many other Flash files, *flashmediaelement.swf* attempts to protect itself from *flashVars* being set via GET.\n\nAttackers often abuse *flashVars* to exploit Flash XSS bugs originating from insecure handling of `navigateToURL`[⁵](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/package.html), `ExternalInterface.call`[⁶](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html#call%28%29) and other risky methods. So, why not get rid of GET parameters in the first place:\n\n```actionscript\n// get parameters\n// Use only FlashVars, ignore QueryString\nvar params:Object, pos:int, query:Object;\n\nparams = LoaderInfo(this.root.loaderInfo).parameters;\npos = root.loaderInfo.url.indexOf('?');\nif (pos !== -1) {\n\tquery = parseStr(root.loaderInfo.url.substr(pos + 1));\n\n\tfor (var key:String in params) {\n\t\tif (query.hasOwnProperty(trim(key))) {\n\t\t\tdelete params[key];\n\t\t}\n\t}\n}\n\n[...]\n\nprivate static function parseStr (str:String) : Object {\n\tvar hash:Object = {},\n\t\tarr1:Array, arr2:Array;\n\n\tstr = unescape(str).replace(/\\+/g, \" \");\n\n\tarr1 = str.split('\u0026');\n\tif (!arr1.length) {\n\t\treturn {};\n\t}\n\n\tfor (var i:uint = 0, length:uint = arr1.length; i \u003c length; i++) {\n\t\tarr2 = arr1[i].split('=');\n\t\tif (!arr2.length) {\n\t\t\tcontinue;\n\t\t}\n\t\thash[trim(arr2[0])] = trim(arr2[1]);\n\t}\n\treturn hash;\n}\n```\n\nFrom: https://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\n\nThe code shown above parses the URL query string and checks, if the GET parameter names spotted in there are also present among the flashVars (or vice versa). If a parameter name appears in both URL and the *flashVars* array, then the parameter must have been set via GET. If not, all is fine - and the parameter must have been set via *flashVars*. \n\nLet's call this code \"The GET Killer\"!\n\nThis way of \"scrubbing\" *flashVars* and making sure that no GET parameters can be used is fairly common and assumed to work well. But it can be bypassed using a dirty trick: invalid characters in the name of the GET parameters. Let's have a quick look at our PoC again:  \n\n**PoC:**\nhttps://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert`1`\n\nNotice something? We obfuscate the name of our GET parameter a bit.\n\n```\njsinitfunctio%gn \u003c see the %g?\n```\n\nThe Flash player is very tolerant when handling input via GET. Invalid URL escapes for example will simply be stripped! This means, that despite us calling the GET parameter `jsinitfunctio%gn`, the parameter that really arrived in the Flash file is again called `jsinitfunction` because the invalid parts are stripped.\n\nThat of course messes up the \"The GET Killer\". Because now, the label it checks for based on the parsed URL string contains the `%g` but the actual flashVar does not! No match, no scrub. We can submit data by using GET again. \n\nJust like this: `({'jsinitfunctio%gn':''}).hasOwnProperty('jsinitfunction') // false`\n\nBut that's not all. The file *flashmediaelement.swf* ships more defensive mechanisms. One of them if for example a black-list that checks, that the parameter values paired with risky methods don't contain characters like parenthesis. Because that would indicate, that someone tries to smuggle in some executable code, like an `alert(1)` instead of just providing a callback, like `alert`.\n\n```actionscript\nprivate function isIllegalChar(s:String, isUrl:Boolean):Boolean {\n\tvar illegals:String = \"' \\\" ( ) { } * + \\\\ \u003c \u003e\";\n\tif (isUrl) {\n\t\tillegals = \"\\\" { } \\\\ \u003c \u003e\";\n\t}\n\tif (Boolean(s)) { // Otherwise exception if parameter null.\n\t\tfor each (var illegal:String in illegals.split(' ')) {\n\t\t\tif (s.indexOf(illegal) \u003e= 0) {\n\t\t\t\treturn true; // Illegal char found\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n```\n\nFrom: https://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\n\nAs you can see, the method shown above checks the input for malicious characters that indicate executable JavaScript. Parenthesis, curlies, operators and all the nasty characters. From the ECMAScript 5 world. \n\nWhat is missing? The new ways of executing code offered by ECMAScript 6 by using back-ticks[⁷](https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/template_strings). Let's have a look at the PoC again:\n\n**PoC:**\nhttps://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert`1`\n\nNotice something? We don't use parenthesis to execute the alert. We use back-ticks instead. And they are not blacklisted of course.\n\nBut we are still not finished, there is yet another security mechanism installed by *flashmediaelement.swf* to make the attacker's life harder. And this is a check for the `ExternalInterface.objectID`[⁸](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html#objectID). This particular member is only present, in case the embedding HTML element (`\u003cembed\u003e` or `\u003cobject\u003e`) is applied with an \"ID\" attribute. Here is the important bit of code:\n\n\n```actionscript\nif (_output != null) {\n\t_output.appendText(txt + \"\\n\");\n\tif (ExternalInterface.objectID != null \u0026\u0026 ExternalInterface.objectID.toString() != \"\") {\n\t\tvar pattern:RegExp = /'/g; //'\n\t\tExternalInterface.call(\"setTimeout\", _jsCallbackFunction + \"('\" + ExternalInterface.objectID + \"','message','\" + txt.replace(pattern, \"’\") + \"')\", 0);\n\t}\n} \n```\n\nFrom: https://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\n\nSo, again. If the Flash file wasn't properly embedded but opened directly, the whole thing will not work.\n\nNow, let's have a look how browsers actually embed Flash files when they are supposed to open them \"directly\" (by requesting the Flash/SWF file from the affected server). Because browers generate quite a bit of markup when opening an SWF directly.\n\n**Firefox does this:**\n```html\n\u003chtml\u003e\u003chead\u003e\u003cmeta name=\"viewport\" content=\"width=device-width; height=device-height;\"\u003e\u003c/head\u003e\u003cbody marginwidth=\"0\" marginheight=\"0\"\u003e\u003cembed height=\"100%\" width=\"100%\" name=\"plugin\" src=\"test.swf\" type=\"application/x-shockwave-flash\"\u003e\u003c/body\u003e\u003c/html\u003e\n```\n\n**MSIE does this:**\n```html\n\"\u003chtml\u003e\u003chead\u003e\u003cstyle\u003e@-ms-viewport {width:device-width;}html, body {margin:0;padding:0;width:100%;height:100%;overflow:hidden;}\u003c/style\u003e\u003c/head\u003e\u003cbody\u003e\u003cembed width=\"100%\" height=\"100%\" src=\"test.swf\" type=\"application/x-shockwave-flash\" fullscreen=\"yes\"\u003e\u003c/body\u003e\u003c/html\u003e\"\n```\n\n**Chrome however dies this:**\n```html\n\u003chtml\u003e\u003cbody style=\"background-color: rgb(38,38,38); height: 100%; width: 100%; overflow: hidden; margin: 0\"\u003e\u003cembed width=\"100%\" height=\"100%\" name=\"plugin\" id=\"plugin\" src=\"test.swf\" type=\"application/x-shockwave-flash\"\u003e\u003c/body\u003e\u003c/html\u003e\n```\n\nThe embed code generated by MSIE and Firefox contains no `id` attribute. But Chrome's does! That means, that without any actual effort from the attacker, Chrome automatically \"bypasses\" the third layer of protection.\n\nAnd that makes the attack work. Let's reiterate:\n\n1. We bypass \"The GET Killer\" using invalid URL escapes\n1. We bypass the blacklist using ES6 backticks\n1. Chrome \"bypasses\" the check for the `ExternalInterface.objectID`\n\nAnd that is it. \n\nWell, not exactly. Maybe also have a look at the other SWF files WordPress ships. They are buggy too. But it's not as bad a s this issue. So we will talk about these later. \n\nAffected Systems\n==\n\nAll WordPress instances that allow to directly call this file. That should be the absolute majority. Google finds a couple of 100k of them but we assume it is actually significantly more[⁹](https://www.google.com/search?q=inurl:/wp-includes/js/mediaelement/flashmediaelement.swf+ext:swf\u0026channel=fs\u0026start=10).\n\nHere is some numbers that other people guesstimate:\n * https://managewp.com/14-surprising-statistics-about-wordpress-usage\n * https://www.quora.com/How-many-websites-are-built-on-Wordpress\n * https://wordpress.com/activity/\n\nFurther note, browser-based XSS filters will not detect the attack and hence not protect here.\n\nMitigation\n==\n\n* Prevent direct access to all Flash files in the WordPress folder (`Content-Disposition` headers might help)\n* Configure your WAF to block direct access to this file\n* Wait for the fix and update Wordpress","vulnerability_information_html":"\u003ch1 id=\"intro\"\u003eIntro\u003c/h1\u003e\n\n\u003cp\u003eWordPress is vulnerable against a reflected XSS that stems from an insecure URL sanitization problem performed in the file \u003cem\u003eflashmediaelement.swf\u003c/em\u003e. The code in the file attempts to remove \u003cem\u003eflashVars\u003c/em\u003e \u003ca href=\"/redirect?url=https%3A%2F%2Fhelpx.adobe.com%2Fflash%2Fkb%2Fpass-variables-swfs-flashvars.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e¹\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in case they have been set GET parameters but fails to do so, enabling XSS via \u003cem\u003eExternalInterface\u003c/em\u003e \u003ca href=\"/redirect?url=http%3A%2F%2Fhelp.adobe.com%2Fen_US%2FFlashPlatform%2Freference%2Factionscript%2F3%2Fflash%2Fexternal%2FExternalInterface.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e²\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe attack technique was first described by Soroush Dalili in 2013 \u003ca href=\"/redirect?url=https%3A%2F%2Fsoroush.secproject.com%2Fblog%2F2013%2F10%2Fcatch-up-on-flash-xss-exploitation-bypassing-the-guardians-part-1%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e³\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The vulnerability in \u003cem\u003eflashmediaelement.swf\u003c/em\u003e was discovered in April 2016, first identified as SOME\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.benhayak.com%2F2015%2F06%2Fsame-origin-method-execution-some.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e⁴\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e bug by Kinugawa. Then, after a team review, the XSS potential was discovered and analyzed by Heiderich, Kinugawa and Inführ. Finally, it was discovered, that this file comes packaged with latest WordPress and the issue was reported here by Heiderich et al. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert%601%60\" href=\"/redirect?url=https%3A%2F%2Fexample.com%2Fwp-includes%2Fjs%2Fmediaelement%2Fflashmediaelement.swf%3F%25%23jsinitfunctio%25gn%3Dalert%25601%2560\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert%601%60\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"background\"\u003eBackground\u003c/h1\u003e\n\n\u003cp\u003eIn the browser-world, a Flash file can be fed with parameters in multiple ways.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eWay One:\u003c/strong\u003e \u003cem\u003eflashVars\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;embed\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;myFlashMovie.swf\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003equality=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;high\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ebgcolor=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;#ffffff\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;550\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;400\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;myFlashMovie\u0026quot;\u003c/span\u003e     \n    \u003cspan class=\"na\"\u003eFlashVars=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;myVariable=Hello%20World\u0026amp;mySecondVariable=Goodbye\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ealign=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;middle\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eallowScriptAccess=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;sameDomain\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eallowFullScreen=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;false\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;application/x-shockwave-flash\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epluginspage=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.adobe.com/go/getflash\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eWay Two:\u003c/strong\u003e GET parameters\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emyFlashMovie.swf?myVariable=Hello%20World\u0026amp;mySecondVariable=Goodbye\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eQuite obviously, \u003cem\u003eflashVars\u003c/em\u003e via GET give an attacker more leverage, especially in case the Flash file can be opened directly in the browser. No need to embed it, just attach the \u003cem\u003eflashVars\u003c/em\u003e via GET and the fun begins. \u003c/p\u003e\n\n\u003cp\u003eNot unlike many other Flash files, \u003cem\u003eflashmediaelement.swf\u003c/em\u003e attempts to protect itself from \u003cem\u003eflashVars\u003c/em\u003e being set via GET.\u003c/p\u003e\n\n\u003cp\u003eAttackers often abuse \u003cem\u003eflashVars\u003c/em\u003e to exploit Flash XSS bugs originating from insecure handling of \u003ccode\u003enavigateToURL\u003c/code\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fhelp.adobe.com%2Fen_US%2FFlashPlatform%2Freference%2Factionscript%2F3%2Fflash%2Fnet%2Fpackage.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e⁵\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, \u003ccode\u003eExternalInterface.call\u003c/code\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fhelp.adobe.com%2Fen_US%2FFlashPlatform%2Freference%2Factionscript%2F3%2Fflash%2Fexternal%2FExternalInterface.html%23call%2528%2529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e⁶\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and other risky methods. So, why not get rid of GET parameters in the first place:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight actionscript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// get parameters\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// Use only FlashVars, ignore QueryString\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eparams\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003epos\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003equery\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eparams\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eLoaderInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eloaderInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eparameters\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003epos\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eloaderInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eindexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;?\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epos\u003c/span\u003e \u003cspan class=\"o\"\u003e!==\u003c/span\u003e \u003cspan class=\"mi\"\u003e-1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003equery\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eparseStr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eloaderInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esubstr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epos\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eString\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehasOwnProperty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etrim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"nx\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n\n\u003cspan class=\"kr\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kr\"\u003estatic\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003eparseStr\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estr\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eObject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{},\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003earr1\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003earr2\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eArray\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"nx\"\u003estr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eunescape\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\+\u003c/span\u003e\u003cspan class=\"sr\"\u003e/g\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot; \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"nx\"\u003earr1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026amp;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003earr1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003euint\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003euint\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003earr1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003earr2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003earr1\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003esplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;=\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003earr2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003etrim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earr2\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e])]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003etrim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earr2\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFrom: \u003ca title=\"https://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fjohndyer%2Fmediaelement%2Fblob%2Fmaster%2Fsrc%2Fflash%2FFlashMediaElement.as\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe code shown above parses the URL query string and checks, if the GET parameter names spotted in there are also present among the flashVars (or vice versa). If a parameter name appears in both URL and the \u003cem\u003eflashVars\u003c/em\u003e array, then the parameter must have been set via GET. If not, all is fine - and the parameter must have been set via \u003cem\u003eflashVars\u003c/em\u003e. \u003c/p\u003e\n\n\u003cp\u003eLet\u0026#39;s call this code \u0026quot;The GET Killer\u0026quot;!\u003c/p\u003e\n\n\u003cp\u003eThis way of \u0026quot;scrubbing\u0026quot; \u003cem\u003eflashVars\u003c/em\u003e and making sure that no GET parameters can be used is fairly common and assumed to work well. But it can be bypassed using a dirty trick: invalid characters in the name of the GET parameters. Let\u0026#39;s have a quick look at our PoC again:  \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert%601%60\" href=\"/redirect?url=https%3A%2F%2Fexample.com%2Fwp-includes%2Fjs%2Fmediaelement%2Fflashmediaelement.swf%3F%25%23jsinitfunctio%25gn%3Dalert%25601%2560\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert%601%60\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNotice something? We obfuscate the name of our GET parameter a bit.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ejsinitfunctio%gn \u0026lt; see the %g?\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe Flash player is very tolerant when handling input via GET. Invalid URL escapes for example will simply be stripped! This means, that despite us calling the GET parameter \u003ccode\u003ejsinitfunctio%gn\u003c/code\u003e, the parameter that really arrived in the Flash file is again called \u003ccode\u003ejsinitfunction\u003c/code\u003e because the invalid parts are stripped.\u003c/p\u003e\n\n\u003cp\u003eThat of course messes up the \u0026quot;The GET Killer\u0026quot;. Because now, the label it checks for based on the parsed URL string contains the \u003ccode\u003e%g\u003c/code\u003e but the actual flashVar does not! No match, no scrub. We can submit data by using GET again. \u003c/p\u003e\n\n\u003cp\u003eJust like this: \u003ccode\u003e({\u0026#39;jsinitfunctio%gn\u0026#39;:\u0026#39;\u0026#39;}).hasOwnProperty(\u0026#39;jsinitfunction\u0026#39;) // false\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eBut that\u0026#39;s not all. The file \u003cem\u003eflashmediaelement.swf\u003c/em\u003e ships more defensive mechanisms. One of them if for example a black-list that checks, that the parameter values paired with risky methods don\u0026#39;t contain characters like parenthesis. Because that would indicate, that someone tries to smuggle in some executable code, like an \u003ccode\u003ealert(1)\u003c/code\u003e instead of just providing a callback, like \u003ccode\u003ealert\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight actionscript\"\u003e\u003ccode\u003e\u003cspan class=\"kr\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003eisIllegalChar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eisUrl\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eBoolean\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eBoolean\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eillegals\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eString\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u0026#39; \\\u0026quot; ( ) { } * + \\\\ \u0026lt; \u0026gt;\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eisUrl\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eillegals\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\\\u0026quot; { } \\\\ \u0026lt; \u0026gt;\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eBoolean\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Otherwise exception if parameter null.\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003eeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eillegal\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003eString\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003eillegals\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eindexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eillegal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Illegal char found\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFrom: \u003ca title=\"https://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fjohndyer%2Fmediaelement%2Fblob%2Fmaster%2Fsrc%2Fflash%2FFlashMediaElement.as\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAs you can see, the method shown above checks the input for malicious characters that indicate executable JavaScript. Parenthesis, curlies, operators and all the nasty characters. From the ECMAScript 5 world. \u003c/p\u003e\n\n\u003cp\u003eWhat is missing? The new ways of executing code offered by ECMAScript 6 by using back-ticks\u003ca href=\"/redirect?url=https%3A%2F%2Fdeveloper.mozilla.org%2Fde%2Fdocs%2FWeb%2FJavaScript%2FReference%2Ftemplate_strings\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e⁷\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Let\u0026#39;s have a look at the PoC again:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert%601%60\" href=\"/redirect?url=https%3A%2F%2Fexample.com%2Fwp-includes%2Fjs%2Fmediaelement%2Fflashmediaelement.swf%3F%25%23jsinitfunctio%25gn%3Dalert%25601%2560\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://example.com/wp-includes/js/mediaelement/flashmediaelement.swf?%#jsinitfunctio%gn=alert%601%60\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNotice something? We don\u0026#39;t use parenthesis to execute the alert. We use back-ticks instead. And they are not blacklisted of course.\u003c/p\u003e\n\n\u003cp\u003eBut we are still not finished, there is yet another security mechanism installed by \u003cem\u003eflashmediaelement.swf\u003c/em\u003e to make the attacker\u0026#39;s life harder. And this is a check for the \u003ccode\u003eExternalInterface.objectID\u003c/code\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fhelp.adobe.com%2Fen_US%2FFlashPlatform%2Freference%2Factionscript%2F3%2Fflash%2Fexternal%2FExternalInterface.html%23objectID\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e⁸\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This particular member is only present, in case the embedding HTML element (\u003ccode\u003e\u0026lt;embed\u0026gt;\u003c/code\u003e or \u003ccode\u003e\u0026lt;object\u0026gt;\u003c/code\u003e) is applied with an \u0026quot;ID\u0026quot; attribute. Here is the important bit of code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight actionscript\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e_output\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003e_output\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eappendText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etxt\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\\n\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eExternalInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eobjectID\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003eExternalInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eobjectID\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epattern\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"nb\"\u003eRegExp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u0026#39;/g\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//\u0026#39;\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eExternalInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;setTimeout\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003e_jsCallbackFunction\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;(\u0026#39;\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eExternalInterface\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eobjectID\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u0026#39;,\u0026#39;message\u0026#39;,\u0026#39;\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003etxt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epattern\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;’\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u0026#39;)\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFrom: \u003ca title=\"https://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fjohndyer%2Fmediaelement%2Fblob%2Fmaster%2Fsrc%2Fflash%2FFlashMediaElement.as\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/johndyer/mediaelement/blob/master/src/flash/FlashMediaElement.as\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSo, again. If the Flash file wasn\u0026#39;t properly embedded but opened directly, the whole thing will not work.\u003c/p\u003e\n\n\u003cp\u003eNow, let\u0026#39;s have a look how browsers actually embed Flash files when they are supposed to open them \u0026quot;directly\u0026quot; (by requesting the Flash/SWF file from the affected server). Because browers generate quite a bit of markup when opening an SWF directly.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eFirefox does this:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u0026lt;head\u0026gt;\u0026lt;meta\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;viewport\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003econtent=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;width=device-width; height=device-height;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u003c/span\u003e \u003cspan class=\"na\"\u003emarginwidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emarginheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;embed\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;100%\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;100%\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;plugin\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;test.swf\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;application/x-shockwave-flash\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eMSIE does this:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u0026quot;\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u0026lt;head\u0026gt;\u0026lt;style\u0026gt;\u003c/span\u003e\u003cspan class=\"k\"\u003e@-ms-viewport\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003edevice-width\u003c/span\u003e\u003cspan class=\"p\"\u003e;}\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nt\"\u003ebody\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003emargin\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nl\"\u003epadding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nl\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e100%\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nl\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e100%\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nl\"\u003eoverflow\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"nb\"\u003ehidden\u003c/span\u003e\u003cspan class=\"p\"\u003e;}\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;embed\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;100%\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;100%\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;test.swf\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;application/x-shockwave-flash\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003efullscreen=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;yes\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u003c/span\u003e\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eChrome however dies this:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u0026lt;body\u003c/span\u003e \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;background-color: rgb(38,38,38); height: 100%; width: 100%; overflow: hidden; margin: 0\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;embed\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;100%\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;100%\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;plugin\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;plugin\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;test.swf\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;application/x-shockwave-flash\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe embed code generated by MSIE and Firefox contains no \u003ccode\u003eid\u003c/code\u003e attribute. But Chrome\u0026#39;s does! That means, that without any actual effort from the attacker, Chrome automatically \u0026quot;bypasses\u0026quot; the third layer of protection.\u003c/p\u003e\n\n\u003cp\u003eAnd that makes the attack work. Let\u0026#39;s reiterate:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eWe bypass \u0026quot;The GET Killer\u0026quot; using invalid URL escapes\u003c/li\u003e\n\u003cli\u003eWe bypass the blacklist using ES6 backticks\u003c/li\u003e\n\u003cli\u003eChrome \u0026quot;bypasses\u0026quot; the check for the \u003ccode\u003eExternalInterface.objectID\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAnd that is it. \u003c/p\u003e\n\n\u003cp\u003eWell, not exactly. Maybe also have a look at the other SWF files WordPress ships. They are buggy too. But it\u0026#39;s not as bad a s this issue. So we will talk about these later. \u003c/p\u003e\n\n\u003ch1 id=\"affected-systems\"\u003eAffected Systems\u003c/h1\u003e\n\n\u003cp\u003eAll WordPress instances that allow to directly call this file. That should be the absolute majority. Google finds a couple of 100k of them but we assume it is actually significantly more\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3Dinurl%3A%2Fwp-includes%2Fjs%2Fmediaelement%2Fflashmediaelement.swf%2Bext%3Aswf%26channel%3Dfs%26start%3D10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e⁹\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eHere is some numbers that other people guesstimate:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://managewp.com/14-surprising-statistics-about-wordpress-usage\" href=\"/redirect?url=https%3A%2F%2Fmanagewp.com%2F14-surprising-statistics-about-wordpress-usage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://managewp.com/14-surprising-statistics-about-wordpress-usage\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://www.quora.com/How-many-websites-are-built-on-Wordpress\" href=\"/redirect?url=https%3A%2F%2Fwww.quora.com%2FHow-many-websites-are-built-on-Wordpress\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.quora.com/How-many-websites-are-built-on-Wordpress\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://wordpress.com/activity/\" href=\"/redirect?url=https%3A%2F%2Fwordpress.com%2Factivity%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wordpress.com/activity/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eFurther note, browser-based XSS filters will not detect the attack and hence not protect here.\u003c/p\u003e\n\n\u003ch1 id=\"mitigation\"\u003eMitigation\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003ePrevent direct access to all Flash files in the WordPress folder (\u003ccode\u003eContent-Disposition\u003c/code\u003e headers might help)\u003c/li\u003e\n\u003cli\u003eConfigure your WAF to block direct access to this file\u003c/li\u003e\n\u003cli\u003eWait for the fix and update Wordpress\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"1337.0","formatted_bounty":"$1,337","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-07-10T12:51:04.430Z","allow_singular_disclosure_after":-141060882.6785776,"singular_disclosure_allowed":true,"vote_count":68,"voters":["static","yxw21","sourc7","d1m0ck","konqi","bobrov","harisec","hunter","michiel","wkcaj","and 58 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":927809,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice, thanks for the report.\nThe WordPress security team has been notified and will get back to you shortly.","markdown_message":"\u003cp\u003eNice, thanks for the report.\u003cbr\u003e\nThe WordPress security team has been notified and will get back to you shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T07:34:19.539Z","updated_at":"2016-04-26T07:34:19.539Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":928390,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, as for possible mitigation advice, we are fairly sure that this will do (via .htaccess where applicable):\n\n```\n\u003cFilesMatch \"\\.(swf)$\"\u003e\nHeader set Content-Disposition attachment\n\u003c/FilesMatch\u003e\n```","markdown_message":"\u003cp\u003eAlso, as for possible mitigation advice, we are fairly sure that this will do (via .htaccess where applicable):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;FilesMatch \u0026quot;\\.(swf)$\u0026quot;\u0026gt;\nHeader set Content-Disposition attachment\n\u0026lt;/FilesMatch\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-04-26T10:08:38.560Z","updated_at":"2016-04-26T10:08:48.262Z","actor":{"username":"cure53","cleared":false,"url":"/cure53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928657,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Mario,\n\nThanks again for the detailed and well-researched report, great maneuvering around the various SWF protections.\n\nHave you also contacted the authors of the `mediaelement`? We may be able to fix it ourselves, but there is a great chance the authors will be better/faster at it and it would be great to coordinate any releases and announcements.\n\nThanks,\nNikolay.","markdown_message":"\u003cp\u003eHey Mario,\u003c/p\u003e\n\n\u003cp\u003eThanks again for the detailed and well-researched report, great maneuvering around the various SWF protections.\u003c/p\u003e\n\n\u003cp\u003eHave you also contacted the authors of the \u003ccode\u003emediaelement\u003c/code\u003e? We may be able to fix it ourselves, but there is a great chance the authors will be better/faster at it and it would be great to coordinate any releases and announcements.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nNikolay.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T14:14:17.140Z","updated_at":"2016-04-26T14:14:17.140Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":928669,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Nikolay,\n\nThanks :) And nope, we haven't contacted them yet. They only offer public GitHub tickets for bug reports and have no security contact. Given the impact, we decided to go this way instead. As far as I can see, WP is the largest project using this library.\n\nCheers,\n.mario","markdown_message":"\u003cp\u003eHi Nikolay,\u003c/p\u003e\n\n\u003cp\u003eThanks :) And nope, we haven\u0026#39;t contacted them yet. They only offer public GitHub tickets for bug reports and have no security contact. Given the impact, we decided to go this way instead. As far as I can see, WP is the largest project using this library.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n.mario\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T14:19:49.626Z","updated_at":"2016-04-26T14:19:49.626Z","actor":{"username":"cure53","cleared":false,"url":"/cure53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928675,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK, thanks, Mario. We will ping the author and will see if he has a better fix.\n\nWe will keep you posted about the timeline.\n\nNikolay.","markdown_message":"\u003cp\u003eOK, thanks, Mario. We will ping the author and will see if he has a better fix.\u003c/p\u003e\n\n\u003cp\u003eWe will keep you posted about the timeline.\u003c/p\u003e\n\n\u003cp\u003eNikolay.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T14:22:58.241Z","updated_at":"2016-04-26T14:22:58.241Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":928679,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good! And happy to engage in the discussion / re-tests if it helps. We believe the fix is not exactly easy, as the author presumably doesn't want to be too aggressive with the GET-parameter scrubbing - but also doesn't want to have other niche cases slip through after the fix. ","markdown_message":"\u003cp\u003eSounds good! And happy to engage in the discussion / re-tests if it helps. We believe the fix is not exactly easy, as the author presumably doesn\u0026#39;t want to be too aggressive with the GET-parameter scrubbing - but also doesn\u0026#39;t want to have other niche cases slip through after the fix. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T14:30:27.598Z","updated_at":"2016-04-26T14:30:27.598Z","actor":{"username":"cure53","cleared":false,"url":"/cure53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928707,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Agreed that the fix is not trivial – it will have to cover the first two problems pretty well – maybe replicate the player’s GET arguments permissiveness and also add some extra characters to test for.\n\nThank you so much for the offer to re-test when we have a fix, I am sure you will find more fun ways to break it :-)","markdown_message":"\u003cp\u003eAgreed that the fix is not trivial – it will have to cover the first two problems pretty well – maybe replicate the player’s GET arguments permissiveness and also add some extra characters to test for.\u003c/p\u003e\n\n\u003cp\u003eThank you so much for the offer to re-test when we have a fix, I am sure you will find more fun ways to break it :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T14:49:06.874Z","updated_at":"2016-04-26T14:49:06.874Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":935351,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Mario, just an update—we're working closely with the authors of both media elements and plupload on a fix. We don't have specific ETA, just yet, but there is progress.\n\nIt would be great if you’d like to join us in the conversation that's happening on WordPress.org Slack. It takes a minute to set it up here:\n\nhttps://make.wordpress.org/chat/\n\nJust let me know your username when done.\n\nThanks again,\nNikolay.","markdown_message":"\u003cp\u003eMario, just an update—we\u0026#39;re working closely with the authors of both media elements and plupload on a fix. We don\u0026#39;t have specific ETA, just yet, but there is progress.\u003c/p\u003e\n\n\u003cp\u003eIt would be great if you’d like to join us in the conversation that\u0026#39;s happening on WordPress.org Slack. It takes a minute to set it up here:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://make.wordpress.org/chat/\" href=\"/redirect?url=https%3A%2F%2Fmake.wordpress.org%2Fchat%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://make.wordpress.org/chat/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eJust let me know your username when done.\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003cbr\u003e\nNikolay.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-01T14:00:46.420Z","updated_at":"2016-05-01T14:00:46.420Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":935354,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Aye, username is `cure53`","markdown_message":"\u003cp\u003eAye, username is \u003ccode\u003ecure53\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-01T14:08:59.589Z","updated_at":"2016-05-01T14:08:59.589Z","actor":{"username":"cure53","cleared":false,"url":"/cure53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":936575,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all. So far nothing came in. Is there a schedule for a discussion / plans for the fix?","markdown_message":"\u003cp\u003eHi all. So far nothing came in. Is there a schedule for a discussion / plans for the fix?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-02T14:57:12.131Z","updated_at":"2016-05-02T14:57:12.131Z","actor":{"username":"cure53","cleared":false,"url":"/cure53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":938167,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just for the record, there is some progress in the Slack channel. Currently leaning towards not supporting arbitrary query arguments in those two Flash projects, just whitelisting the cache-busters.","markdown_message":"\u003cp\u003eJust for the record, there is some progress in the Slack channel. Currently leaning towards not supporting arbitrary query arguments in those two Flash projects, just whitelisting the cache-busters.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-03T08:46:22.242Z","updated_at":"2016-05-03T08:46:22.242Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":948779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all! \n\nSince the bug has been fixed and the new version is out, what's the status here?\nWe are planning, as discussed on slack, to release  our write-up on Friday, 1pm CEST.","markdown_message":"\u003cp\u003eHi all! \u003c/p\u003e\n\n\u003cp\u003eSince the bug has been fixed and the new version is out, what\u0026#39;s the status here?\u003cbr\u003e\nWe are planning, as discussed on slack, to release  our write-up on Friday, 1pm CEST.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-10T13:52:17.322Z","updated_at":"2016-05-10T13:52:17.322Z","actor":{"username":"cure53","cleared":false,"url":"/cure53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":985388,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-26T16:36:50.232Z","updated_at":"2016-05-26T16:36:50.232Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cure53","url":"/cure53"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1000168,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all, two questions - is there any plans for a bug bounty on this one, and will the ticket be opened for public access anytime soon?","markdown_message":"\u003cp\u003eHi all, two questions - is there any plans for a bug bounty on this one, and will the ticket be opened for public access anytime soon?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-05T08:23:24.132Z","updated_at":"2016-06-05T08:23:24.132Z","actor":{"username":"cure53","cleared":false,"url":"/cure53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1007901,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-10T12:50:34.298Z","updated_at":"2016-06-10T12:50:34.298Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"1337.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"cure53","url":"/cure53"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1007903,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-10T12:51:04.356Z","updated_at":"2016-06-10T12:51:04.356Z","first_to_agree":true,"actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1007925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cool, thanks :)","markdown_message":"\u003cp\u003eCool, thanks :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-10T13:14:26.937Z","updated_at":"2016-06-10T13:14:26.937Z","actor":{"username":"cure53","cleared":false,"url":"/cure53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/123/1c801729a8988a0b6873c3d9ccf131e2a1488011_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1061482,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-10T12:51:12.854Z","updated_at":"2016-07-10T12:51:12.854Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}