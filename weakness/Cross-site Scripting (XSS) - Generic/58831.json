{"id":58831,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81ODgzMQ==","url":"https://hackerone.com/reports/58831","title":"Flash XSS on img.mail.ru","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-28T13:41:45.437Z","submitted_at":"2015-04-28T13:41:45.437Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tunnelshade","url":"/tunnelshade","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-10-30T12:22:06.146Z","bug_reporter_agreed_on_going_public_at":"2015-09-30T12:21:53.815Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Vulnerable Flash File: http://img.mail.ru/r/video2/player_v2.swf\r\n\r\nSteps:\r\n+ Open http://img.mail.ru/r/video2/player_v2.swf?metadataUrl=http://videoapi.my.mail.ru/videos//community/mir/_groupvideo/921.json\u0026redirectUrl=\\%22));alert(document.domain);}catch(e){}//\r\n+ Click on social share and click on anything (eg. twitter)\r\n\r\nSeverity:\r\n+ XSS on \r\n+ There is an ActionScript function `ApplicationController.like` bound to javascript using external interface. So, I suspect that like jacking is possible since img.mail.ru doesn't send **X-FRAME-OPTIONS**.","vulnerability_information_html":"\u003cp\u003eVulnerable Flash File: \u003ca title=\"http://img.mail.ru/r/video2/player_v2.swf\" href=\"/redirect?url=http%3A%2F%2Fimg.mail.ru%2Fr%2Fvideo2%2Fplayer_v2.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://img.mail.ru/r/video2/player_v2.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSteps:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eOpen \u003ca title=\"http://img.mail.ru/r/video2/player_v2.swf?metadataUrl=http://videoapi.my.mail.ru/videos//community/mir/_groupvideo/921.json\u0026amp;redirectUrl=/%22))%3Balert(document.domain)%3B%7Dcatch(e)%7B%7D//\" href=\"/redirect?url=http%3A%2F%2Fimg.mail.ru%2Fr%2Fvideo2%2Fplayer_v2.swf%3FmetadataUrl%3Dhttp%3A%2F%2Fvideoapi.my.mail.ru%2Fvideos%2F%2Fcommunity%2Fmir%2F_groupvideo%2F921.json%26redirectUrl%3D%2F%2522%29%29%253Balert%28document.domain%29%253B%257Dcatch%28e%29%257B%257D%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://img.mail.ru/r/video2/player_v2.swf?metadataUrl=http://videoapi.my.mail.ru/videos//community/mir/_groupvideo/921.json\u0026amp;redirectUrl=/%22))%3Balert(document.domain)%3B%7Dcatch(e)%7B%7D//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on social share and click on anything (eg. twitter)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eSeverity:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eXSS on \u003c/li\u003e\n\u003cli\u003eThere is an ActionScript function \u003ccode\u003eApplicationController.like\u003c/code\u003e bound to javascript using external interface. So, I suspect that like jacking is possible since img.mail.ru doesn\u0026#39;t send \u003cstrong\u003eX-FRAME-OPTIONS\u003c/strong\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-10-30T12:21:54.112Z","allow_singular_disclosure_after":-163035010.33395946,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":392713,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\n\nI have confirmed your report, and it was escalated. You will be noticed when we prepare a fix, stay in touch.\nBut I must notice, your report is not in a bug bounty program's scope. Please review [bug bounty program rules](https://hackerone.com/mailru).  ","markdown_message":"\u003cp\u003eThank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003c/p\u003e\n\n\u003cp\u003eI have confirmed your report, and it was escalated. You will be noticed when we prepare a fix, stay in touch.\u003cbr\u003e\nBut I must notice, your report is not in a bug bounty program\u0026#39;s scope. Please review \u003ca href=\"https://hackerone.com/mailru\"\u003ebug bounty program rules\u003c/a\u003e.  \u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-28T14:32:17.903Z","updated_at":"2015-04-28T14:32:17.903Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":575601,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Your bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue.\nUnfortunately,  your report was not in a bug bounty program's scope(check the [rules](https://hackerone.com/mailru)), so  we cannot qualify you for reward :(","markdown_message":"\u003cp\u003eYour bug has been fixed! \u003cbr\u003e\nPlease confirm that you are no longer able to reproduce the issue.\u003cbr\u003e\nUnfortunately,  your report was not in a bug bounty program\u0026#39;s scope(check the \u003ca href=\"https://hackerone.com/mailru\"\u003erules\u003c/a\u003e), so  we cannot qualify you for reward :(\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-03T10:35:22.858Z","updated_at":"2015-09-03T10:35:22.858Z","actor":{"username":"donkeykong","cleared":false,"url":"/donkeykong","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tunnelshade","url":"/tunnelshade"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":575626,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You removed the file. Is that the fix?","markdown_message":"\u003cp\u003eYou removed the file. Is that the fix?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-03T11:03:17.320Z","updated_at":"2015-09-03T11:03:17.320Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":591823,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, we decided to delete this file.","markdown_message":"\u003cp\u003eYes, we decided to delete this file.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-18T10:28:41.826Z","updated_at":"2015-09-18T10:28:41.826Z","actor":{"username":"yngwie","cleared":false,"url":"/yngwie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/185/1b6bf6046f42c100e3793d87a8410bc07178fa8f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":603048,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Fixed then!","markdown_message":"\u003cp\u003eFixed then!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-30T12:21:53.843Z","updated_at":"2015-09-30T12:21:53.843Z","first_to_agree":true,"actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":638282,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-30T12:22:06.173Z","updated_at":"2015-10-30T12:22:06.173Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":716587,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-11T10:32:30.407Z","updated_at":"2015-12-11T10:32:30.407Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}