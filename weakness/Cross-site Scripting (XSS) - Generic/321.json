{"id":321,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjE=","url":"https://hackerone.com/reports/321","title":"CSP not consistently applied","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2013-11-08T09:59:03.704Z","submitted_at":"2013-11-08T09:59:03.704Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"janpaul123","url":"/janpaul123","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/YZUxfgrSUW7WpvyeCobsu4EH/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2013-11-30T01:10:30.353Z","bug_reporter_agreed_on_going_public_at":"2013-11-30T01:10:30.353Z","team_member_agreed_on_going_public_at":"2013-11-29T22:36:18.063Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Also thought I'd formally submitted the issue we discussed yesterday, that sometimes the CSP response headers served are missing for browsers that don't support them, but then the page without these headers can be cached by Cloudflare. This makes it easier to mount a XSS attack.","vulnerability_information_html":"\u003cp\u003eAlso thought I\u0026#39;d formally submitted the issue we discussed yesterday, that sometimes the CSP response headers served are missing for browsers that don\u0026#39;t support them, but then the page without these headers can be cached by Cloudflare. This makes it easier to mount a XSS attack.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2013-11-30T01:10:30.000Z","allow_singular_disclosure_after":-223446250.9111886,"singular_disclosure_allowed":true,"vote_count":14,"voters":["bobrov","sameerphad72","jarvis7","catferq","cuso4","eveeez","r3y","mr_r3boot","styrene","codyzacharias","and 4 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1463,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey JP, thanks for formally submitting this. We resolved this bug yesterday by disabling conditional CSP headers and regardless of which browser you're using, we're now always responding with the proper CSP headers. CloudFlare cached a response of a user that visited us with a CSP incompatible browser (so, that response didn't have a `Content-Security-Policy` header), and started serving this cached response to users that did have a CSP compatible browser. The `Content-Security-Policy` header is ignored by browsers that do not support CSP.","markdown_message":"\u003cp\u003eHey JP, thanks for formally submitting this. We resolved this bug yesterday by disabling conditional CSP headers and regardless of which browser you\u0026#39;re using, we\u0026#39;re now always responding with the proper CSP headers. CloudFlare cached a response of a user that visited us with a CSP incompatible browser (so, that response didn\u0026#39;t have a \u003ccode\u003eContent-Security-Policy\u003c/code\u003e header), and started serving this cached response to users that did have a CSP compatible browser. The \u003ccode\u003eContent-Security-Policy\u003c/code\u003e header is ignored by browsers that do not support CSP.\u003c/p\u003e\n","automated_response":false,"created_at":"2013-11-08T12:33:01.777Z","updated_at":"2013-11-08T12:33:01.777Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"janpaul123","url":"/janpaul123"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good, thanks for the clarification!","markdown_message":"\u003cp\u003eGood, thanks for the clarification!\u003c/p\u003e\n","automated_response":false,"created_at":"2013-11-10T20:30:48.427Z","updated_at":"2013-11-10T20:30:48.427Z","actor":{"username":"janpaul123","cleared":false,"url":"/janpaul123","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YZUxfgrSUW7WpvyeCobsu4EH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2684,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2013-11-29T22:36:10.760Z","updated_at":"2013-11-29T22:36:10.760Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"janpaul123","url":"/janpaul123"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2685,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2013-11-29T22:36:18.074Z","updated_at":"2013-11-29T22:36:18.074Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2695,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Brilliant, thanks Alex!","markdown_message":"\u003cp\u003eBrilliant, thanks Alex!\u003c/p\u003e\n","automated_response":false,"created_at":"2013-11-30T01:10:30.371Z","updated_at":"2013-11-30T01:10:30.371Z","actor":{"username":"janpaul123","cleared":false,"url":"/janpaul123","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YZUxfgrSUW7WpvyeCobsu4EH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}