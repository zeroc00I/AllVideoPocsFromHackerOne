{"id":148865,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg4NjU=","url":"https://hackerone.com/reports/148865","title":"HTML in Diffusion not escaped in certain circumstances","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-02T14:39:29.049Z","submitted_at":"2016-07-02T14:39:29.049Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"danny_b","url":"/danny_b","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-08-01T14:45:33.265Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-07-02T14:45:32.999Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"HTML in Diffusion source code listing is not escaped\n\nSteps to reproduce:\n* have the syntax hilight turned on\n* the file is bigger than 256kB, thus syntax hilight is claimed in header to be turned off automatically, however, plaintext file doesn't display like with regular (manual) syntax highlight off, but the content is being parsed\n\nFile should contain HTML constructions, but could be of any type (extension).\nHaving javascript constructions there with alert() within the HTML causes such dialogues to pop up on given page obviously.","vulnerability_information_html":"\u003cp\u003eHTML in Diffusion source code listing is not escaped\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ehave the syntax hilight turned on\u003c/li\u003e\n\u003cli\u003ethe file is bigger than 256kB, thus syntax hilight is claimed in header to be turned off automatically, however, plaintext file doesn\u0026#39;t display like with regular (manual) syntax highlight off, but the content is being parsed\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eFile should contain HTML constructions, but could be of any type (extension).\u003cbr\u003e\nHaving javascript constructions there with alert() within the HTML causes such dialogues to pop up on given page obviously.\u003c/p\u003e\n","bounty_amount":"600.0","formatted_bounty":"$600","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-01T14:45:33.146Z","allow_singular_disclosure_after":-139153591.55026668,"singular_disclosure_allowed":true,"vote_count":12,"voters":["lukasreschke","michiel","nomi404","nigba","dyabla","natkubpom","adambacchus","hacky007","dogscience","sh4ttel2","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1050461,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This issue is discussed here: \u003chttps://secure.phabricator.com/T11257\u003e","markdown_message":"\u003cp\u003eThis issue is discussed here: \u003ca title=\"https://secure.phabricator.com/T11257\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FT11257\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/T11257\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T14:43:14.443Z","updated_at":"2016-07-02T14:43:14.443Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"danny_b","url":"/danny_b"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050463,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"In setting an award for this report, I am primarily considering these factors:\n\n  - This is stored XSS, which is severe.\n  - Exploiting it requires write access to a repository, which mitigates the attack somewhat.","markdown_message":"\u003cp\u003eIn setting an award for this report, I am primarily considering these factors:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThis is stored XSS, which is severe.\u003c/li\u003e\n\u003cli\u003eExploiting it requires write access to a repository, which mitigates the attack somewhat.\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2016-07-02T14:45:12.548Z","updated_at":"2016-07-02T14:45:12.548Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Phabricator"}},"bounty_amount":"600.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"danny_b","url":"/danny_b"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050465,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Details on this report (and a patch) are available publicly, so this can be disclosed at any time.","markdown_message":"\u003cp\u003eDetails on this report (and a patch) are available publicly, so this can be disclosed at any time.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T14:45:33.069Z","updated_at":"2016-07-02T14:45:33.069Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks again for the report!","markdown_message":"\u003cp\u003eThanks again for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T14:46:11.556Z","updated_at":"2016-07-02T14:46:11.556Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1099890,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-01T14:45:33.344Z","updated_at":"2016-08-01T14:45:33.344Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Phabricator"}},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}