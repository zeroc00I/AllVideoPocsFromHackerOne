{"id":111262,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTEyNjI=","url":"https://hackerone.com/reports/111262","title":"The csrf token remains same after user logs in","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-17T15:23:57.058Z","submitted_at":"2016-01-17T15:23:57.058Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mrsihag","url":"/mrsihag","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-02-25T21:13:44.298Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-01-26T21:13:40.328Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"As the CSRF token doesn't change after login. Any other user that uses the same workstation is vulnerable. A safer way would be to use dynamic CSRF token or just change the token after login, so attacker doesnt get hold of this.\n\nDetails of the attacks scenario in a shared workstation environment\n\n1.The attacker simply copies the authenticity token. This token is the only protection against the CSRF attack.\n\n2.Any other user that uses the workstation after that is vulnerable to CSRF. The attacker simply needs to craft a link with the required GET or POST method as he already have the CSRF token and send it to the victim via email, chat etc.\n\n3.The attacker can trick the victim in doing anything he wants without the user being aware of it.\n\nIn the most basic sense the attacker has an authenticity token of another user which he shouldn't have had in the first place.","vulnerability_information_html":"\u003cp\u003eAs the CSRF token doesn\u0026#39;t change after login. Any other user that uses the same workstation is vulnerable. A safer way would be to use dynamic CSRF token or just change the token after login, so attacker doesnt get hold of this.\u003c/p\u003e\n\n\u003cp\u003eDetails of the attacks scenario in a shared workstation environment\u003c/p\u003e\n\n\u003cp\u003e1.The attacker simply copies the authenticity token. This token is the only protection against the CSRF attack.\u003c/p\u003e\n\n\u003cp\u003e2.Any other user that uses the workstation after that is vulnerable to CSRF. The attacker simply needs to craft a link with the required GET or POST method as he already have the CSRF token and send it to the victim via email, chat etc.\u003c/p\u003e\n\n\u003cp\u003e3.The attacker can trick the victim in doing anything he wants without the user being aware of it.\u003c/p\u003e\n\n\u003cp\u003eIn the most basic sense the attacker has an authenticity token of another user which he shouldn\u0026#39;t have had in the first place.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-02-25T21:13:40.415Z","allow_singular_disclosure_after":-152780562.72335804,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":761317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-01-17T15:23:57.209Z","updated_at":"2016-01-17T15:23:57.209Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":761495,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report.\n\nThis is somewhat hard to judge. Generally speaking, once somebody had access to the physical machine there is not much that somebody can do to prevent attacks anyways (e.g. DMA attacks). There is not much of an additional threat created by this.\n\nThe general rule of thumb being here: Do not let somebody else access the physical machine that you use to access your data.\n\nI'll discuss this with the team and let you know how we will proceed on this one.","markdown_message":"\u003cp\u003eThanks a lot for your report.\u003c/p\u003e\n\n\u003cp\u003eThis is somewhat hard to judge. Generally speaking, once somebody had access to the physical machine there is not much that somebody can do to prevent attacks anyways (e.g. DMA attacks). There is not much of an additional threat created by this.\u003c/p\u003e\n\n\u003cp\u003eThe general rule of thumb being here: Do not let somebody else access the physical machine that you use to access your data.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll discuss this with the team and let you know how we will proceed on this one.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-17T20:14:09.276Z","updated_at":"2016-01-17T20:14:09.276Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773125,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have meanwhile fixed this at https://github.com/owncloud/core/pull/21894 and it will be included within the upcoming 9.0 major release.\n\nDue to the reasons pointed out above we do consider this as a security hardening and not a security issue.","markdown_message":"\u003cp\u003eWe have meanwhile fixed this at \u003ca title=\"https://github.com/owncloud/core/pull/21894\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fpull%2F21894\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/owncloud/core/pull/21894\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and it will be included within the upcoming 9.0 major release.\u003c/p\u003e\n\n\u003cp\u003eDue to the reasons pointed out above we do consider this as a security hardening and not a security issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-26T21:13:22.585Z","updated_at":"2016-01-26T21:13:22.585Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mrsihag","url":"/mrsihag"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773126,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-26T21:13:29.239Z","updated_at":"2016-01-26T21:13:29.239Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773127,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-26T21:13:40.355Z","updated_at":"2016-01-26T21:13:40.355Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":813202,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-25T21:13:44.337Z","updated_at":"2016-02-25T21:13:44.337Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":813569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sir if not eligible for bounty but you give me swag for my effort please\n","markdown_message":"\u003cp\u003esir if not eligible for bounty but you give me swag for my effort please\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-26T03:53:05.963Z","updated_at":"2016-02-26T03:53:05.963Z","actor":{"username":"mrsihag","cleared":false,"url":"/mrsihag","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}