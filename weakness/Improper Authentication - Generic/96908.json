{"id":96908,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjkwOA==","url":"https://hackerone.com/reports/96908","title":"An administrator without the 'Settings' permission is able to see payment gateways","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-30T23:46:24.189Z","submitted_at":"2015-10-30T23:46:24.189Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"brakhane","url":"/brakhane","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-11-18T20:58:31.135Z","bug_reporter_agreed_on_going_public_at":"2015-11-18T20:58:30.989Z","team_member_agreed_on_going_public_at":"2015-11-18T20:08:29.225Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n====\nAn administrator who lacks the 'Settings' permission is not able to see the shops payment gateways through the UI.  But the endpoint `shop.myshopify.com/admin/payment_gateways.json` does disclose payment gateways to the unprivileged user.\n\nMitigation\n====\nRestrict the endpoint in question to be only accessible with the correct permission set.","vulnerability_information_html":"\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eAn administrator who lacks the \u0026#39;Settings\u0026#39; permission is not able to see the shops payment gateways through the UI.  But the endpoint \u003ccode\u003eshop.myshopify.com/admin/payment_gateways.json\u003c/code\u003e does disclose payment gateways to the unprivileged user.\u003c/p\u003e\n\n\u003ch1 id=\"mitigation\"\u003eMitigation\u003c/h1\u003e\n\n\u003cp\u003eRestrict the endpoint in question to be only accessible with the correct permission set.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-18T20:08:29.402Z","allow_singular_disclosure_after":-158756866.6863155,"singular_disclosure_allowed":true,"vote_count":2,"voters":["spetr0x","lover_boy"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":639412,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-10-30T23:46:25.066Z","updated_at":"2015-10-30T23:46:25.066Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":639417,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Viewing payment gateways (and therefor partially credentials) is also possible by navigating directly to `admin/settings/payments`.","markdown_message":"\u003cp\u003eViewing payment gateways (and therefor partially credentials) is also possible by navigating directly to \u003ccode\u003eadmin/settings/payments\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-30T23:50:58.420Z","updated_at":"2015-10-30T23:50:58.420Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":652886,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report.\n\nThe second issue (regarding `/admin/settings/payments`) was already reported to us previously by another researcher (and we just rolled out a fix for that) but the `/admin/payment_gateways.json` issue was new. We are working on a fix for that, and will get back to you soon.","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eThe second issue (regarding \u003ccode\u003e/admin/settings/payments\u003c/code\u003e) was already reported to us previously by another researcher (and we just rolled out a fix for that) but the \u003ccode\u003e/admin/payment_gateways.json\u003c/code\u003e issue was new. We are working on a fix for that, and will get back to you soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-10T18:10:21.418Z","updated_at":"2015-11-10T18:10:21.418Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":655415,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The `/admin/payment_gateways.json` endpoint is now accessible only to users with the Settings permission. (It had been available to users with the Orders permission due to legacy code.)\n\nOur next round of bounty decisions will take place next week, so we'll be in touch with you then.\n\nThanks again for your report!","markdown_message":"\u003cp\u003eThe \u003ccode\u003e/admin/payment_gateways.json\u003c/code\u003e endpoint is now accessible only to users with the Settings permission. (It had been available to users with the Orders permission due to legacy code.)\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place next week, so we\u0026#39;ll be in touch with you then.\u003c/p\u003e\n\n\u003cp\u003eThanks again for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-12T16:12:43.741Z","updated_at":"2015-11-12T16:12:43.741Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"brakhane","url":"/brakhane"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":690759,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify! This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify! This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-18T20:08:20.939Z","updated_at":"2015-11-18T20:08:20.939Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"brakhane","url":"/brakhane"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":690760,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-18T20:08:29.262Z","updated_at":"2015-11-18T20:08:29.262Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":690817,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"You're welcome, thanks for the bounty!","markdown_message":"\u003cp\u003eYou\u0026#39;re welcome, thanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-18T20:58:31.016Z","updated_at":"2015-11-18T20:58:31.016Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":690818,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-18T20:58:31.162Z","updated_at":"2015-11-18T20:58:31.162Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}