{"id":154410,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTQ0MTA=","url":"https://hackerone.com/reports/154410","title":"Delete/modify  your own comment after limited access(IDOR)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-27T17:57:27.520Z","submitted_at":"2016-07-27T17:57:27.520Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-08-09T00:26:34.692Z","bug_reporter_agreed_on_going_public_at":"2016-08-09T00:26:34.572Z","team_member_agreed_on_going_public_at":"2016-08-08T21:56:06.850Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : When user has access to some feature like orders , Transfer etc. where comment section is available. Suppose staff members comments in it . Now owner of the account limited access to orders , then he won't be able to access his comments and he won't be able to modify/delete  his comments. But this can be bypassed and he can still modify and delete his own comments. \nComment ID can be used in any other feature's comment section to delete/modify comments. \n\nSuppose A staff member was given access to orders and products. Now he commented on the orders and after some days his access to orders was limited by owner. Now he should not be able to delete it's own comments but he can still delete these comments by delete request of  transfer comment section.\n\nSteps to reproduce : \n1. Create a shop and add a staff member(Attacker) to it and provide him all the access.\n2.Now from attackers account comment on any order.Let say comment ID is \"12345\"\n3.Now from Owner account limit the access of orders so the staff member should not be able to access the comments.\n4.Now go to attackers account and go to any transfer and comment on that transfer.(Staff member can go to the transfer because he has access to products.)\n5.Now you will see the modify and delete options on the transfer comment.Delete or modify the comment and intercept the request.\n\nHTTP request will look something like this : \n\nPOST /admin/transfers/774529/timeline_comments/[Transfer_comment_ID]HTTP/1.1\nHost: vijaygangani1110store.myshopify.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html, application/xhtml+xml, application/xml\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-Requested-With: XMLHttpRequest\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-XHR-Referer: https://vijaygangani1110store.myshopify.com/admin/transfers/774529\nX-CSRF-Token: DSyGAzUBvMcMmYFiUTMbgXMbWPIK97AYA8vNiQWh5GhYEVEeNSpvPQFv5eKCYVg1aDH3G8DQP13FoCpfWvFuuQ==\nReferer: https://vijaygangani1110store.myshopify.com/admin/transfers/774529\nContent-Length: 151\nCookie: [Cookie_values]\nConnection: keep-alive\n\nutf8=%E2%9C%93\u0026_method=delete\u0026authenticity_token=[ouath_token]\n\nIn the above request change the comment ID of transfer to order Comment ID and the comment will be deleted. The same can be applied to modification of the comment which should not happen .\nThis whole process work vice versa . Suppose i have limited access to transfer then i can delete the comment by orders and if i have limited access to orders then i can delete comment by transfer. \n\n\nLet me know if you need any Video POC regarding this to understand the issue more closely.\n\nBest Regards !\nVijay Kumar  ","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eDescription : When user has access to some feature like orders , Transfer etc. where comment section is available. Suppose staff members comments in it . Now owner of the account limited access to orders , then he won\u0026#39;t be able to access his comments and he won\u0026#39;t be able to modify/delete  his comments. But this can be bypassed and he can still modify and delete his own comments. \u003cbr\u003e\nComment ID can be used in any other feature\u0026#39;s comment section to delete/modify comments. \u003c/p\u003e\n\n\u003cp\u003eSuppose A staff member was given access to orders and products. Now he commented on the orders and after some days his access to orders was limited by owner. Now he should not be able to delete it\u0026#39;s own comments but he can still delete these comments by delete request of  transfer comment section.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce : \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a shop and add a staff member(Attacker) to it and provide him all the access.\n2.Now from attackers account comment on any order.Let say comment ID is \u0026quot;12345\u0026quot;\n3.Now from Owner account limit the access of orders so the staff member should not be able to access the comments.\n4.Now go to attackers account and go to any transfer and comment on that transfer.(Staff member can go to the transfer because he has access to products.)\n5.Now you will see the modify and delete options on the transfer comment.Delete or modify the comment and intercept the request.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eHTTP request will look something like this : \u003c/p\u003e\n\n\u003cp\u003ePOST /admin/transfers/774529/timeline_comments/[Transfer_comment_ID]HTTP/1.1\u003cbr\u003e\nHost: vijaygangani1110store.myshopify.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/html, application/xhtml+xml, application/xml\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nX-XHR-Referer: \u003ca title=\"https://vijaygangani1110store.myshopify.com/admin/transfers/774529\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani1110store.myshopify.com%2Fadmin%2Ftransfers%2F774529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani1110store.myshopify.com/admin/transfers/774529\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nX-CSRF-Token: DSyGAzUBvMcMmYFiUTMbgXMbWPIK97AYA8vNiQWh5GhYEVEeNSpvPQFv5eKCYVg1aDH3G8DQP13FoCpfWvFuuQ==\u003cbr\u003e\nReferer: \u003ca title=\"https://vijaygangani1110store.myshopify.com/admin/transfers/774529\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani1110store.myshopify.com%2Fadmin%2Ftransfers%2F774529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani1110store.myshopify.com/admin/transfers/774529\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Length: 151\u003cbr\u003e\nCookie: [Cookie_values]\u003cbr\u003e\nConnection: keep-alive\u003c/p\u003e\n\n\u003cp\u003eutf8=%E2%9C%93\u0026amp;_method=delete\u0026amp;authenticity_token=[ouath_token]\u003c/p\u003e\n\n\u003cp\u003eIn the above request change the comment ID of transfer to order Comment ID and the comment will be deleted. The same can be applied to modification of the comment which should not happen .\u003cbr\u003e\nThis whole process work vice versa . Suppose i have limited access to transfer then i can delete the comment by orders and if i have limited access to orders then i can delete comment by transfer. \u003c/p\u003e\n\n\u003cp\u003eLet me know if you need any Video POC regarding this to understand the issue more closely.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar  \u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["bugdiscloseguys","sumit7","ph3t","w00tr00t","dyabla","fksociety","no-longer-with-company"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1091292,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2016-07-27T17:57:27.842Z","updated_at":"2016-07-27T17:57:27.842Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1092904,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-28T13:44:07.243Z","updated_at":"2016-07-28T13:44:07.243Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1095410,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We recently rolled out a fix for the issue.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. We recently rolled out a fix for the issue.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-29T15:45:24.405Z","updated_at":"2016-07-29T15:45:24.405Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1113675,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping improve Shopify's security!","markdown_message":"\u003cp\u003eThanks again for helping improve Shopify\u0026#39;s security!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-08T21:55:54.605Z","updated_at":"2016-08-08T21:55:54.605Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1113676,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-08T21:56:06.877Z","updated_at":"2016-08-08T21:56:06.877Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1113907,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-09T00:26:34.606Z","updated_at":"2016-08-09T00:26:34.606Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1113908,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-09T00:26:34.721Z","updated_at":"2016-08-09T00:26:34.721Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1164708,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-31T13:22:05.943Z","updated_at":"2018-02-28T13:10:46.034Z","additional_data":{"added_weaknesses":[{"id":75,"name":"Privilege Escalation"}],"removed_weaknesses":[{"id":27,"name":"Improper Authentication - Generic"}]},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}