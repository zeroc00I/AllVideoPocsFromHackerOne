{"id":331302,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzEzMDI=","url":"https://hackerone.com/reports/331302","title":"Improper protection of FileContentProvider","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-03-30T08:21:53.366Z","submitted_at":"2018-03-30T08:21:53.366Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mmmds","url":"/mmmds","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-3765"],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-01T14:05:16.781Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-31T14:05:15.501Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Some data in the FileContentProvider is protected against applications not related to NextCloud. The application checks if calling application package name contains \"com.nextcloud.client\" string. Every application with such substring in package name is allowed to fully access FileContentProvider.\n\ncom.owncloud.android.providers.FileContentProvider\n\n``` java\n    private boolean isCallerNotAllowed() {\n        String callingPackage = this.mContext.getPackageManager().getNameForUid(Binder.getCallingUid());\n        return callingPackage == null || !callingPackage.contains(this.mContext.getPackageName());\n    }\n```\n\n## Impact\n\nMalicious applications with \"com.nextcloud.client\" in their package names are able to access FileContentProvider without restrictions. For example they are able to read private keys to end-to-end encryption using URI: content://org.nextcloud/arbitrary_data","vulnerability_information_html":"\u003cp\u003eSome data in the FileContentProvider is protected against applications not related to NextCloud. The application checks if calling application package name contains \u0026quot;com.nextcloud.client\u0026quot; string. Every application with such substring in package name is allowed to fully access FileContentProvider.\u003c/p\u003e\n\n\u003cp\u003ecom.owncloud.android.providers.FileContentProvider\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kt\"\u003eboolean\u003c/span\u003e \u003cspan class=\"nf\"\u003eisCallerNotAllowed\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003ecallingPackage\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003emContext\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetPackageManager\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetNameForUid\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eBinder\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetCallingUid\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ecallingPackage\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ecallingPackage\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003econtains\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003emContext\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetPackageName\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eMalicious applications with \u0026quot;com.nextcloud.client\u0026quot; in their package names are able to access FileContentProvider without restrictions. For example they are able to read private keys to end-to-end encryption using URI: content://org.nextcloud/arbitrary_data\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T14:05:15.587Z","allow_singular_disclosure_after":-26148710.72814076,"singular_disclosure_allowed":true,"vote_count":6,"voters":["a_d_a_m","mygf","eveeez","japz","cryptographer","vshack1"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":1,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"com.nextcloud.client","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2546515,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-03-30T08:21:53.838Z","updated_at":"2018-03-30T08:21:53.838Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2571900,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could I ask for a response?","markdown_message":"\u003cp\u003eCould I ask for a response?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-06T07:00:23.298Z","updated_at":"2018-04-06T07:00:23.298Z","actor":{"username":"mmmds","cleared":false,"url":"/mmmds","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2571954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ergh, this would imply that you've installed a malicious application. I guess we could directly check the signature instead, but I don't consider this a major issue to be honest.","markdown_message":"\u003cp\u003eErgh, this would imply that you\u0026#39;ve installed a malicious application. I guess we could directly check the signature instead, but I don\u0026#39;t consider this a major issue to be honest.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-06T07:42:56.361Z","updated_at":"2018-04-06T07:42:56.361Z","actor":{"username":"mdjanic","cleared":false,"url":"/mdjanic","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2580973,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-09T12:13:39.027Z","updated_at":"2018-04-09T12:13:39.027Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2755977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThis should be fixed in the next android version we release (mid of june).\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThis should be fixed in the next android version we release (mid of june).\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-17T09:33:16.450Z","updated_at":"2018-05-17T09:33:16.450Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2782375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThanks again for your report.\n\nAs stated this will be fixed in the upcoming android release.\n\nI'll keep you updated. With regard to the security advisory, can you let us know how you want to be credited? The following possibilities are there:\n\nFull name (or pseudonym)\nMail address (optional)\nCompany name (optional)\nWebsite (optional)\n\nPlease note that we release more detailed security advisories only after a grace period has passed to give users a chance to update. We'd appreciate if you would not share any details about this bug until we've released our official security advisory.\n\nWe would like to wait with disclosing this a few weeks as we want all our users to upgrade. But also want all our customers (with custom builds of the client) to be upgraded. I'll keep you posted on this.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThanks again for your report.\u003c/p\u003e\n\n\u003cp\u003eAs stated this will be fixed in the upcoming android release.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll keep you updated. With regard to the security advisory, can you let us know how you want to be credited? The following possibilities are there:\u003c/p\u003e\n\n\u003cp\u003eFull name (or pseudonym)\u003cbr\u003e\nMail address (optional)\u003cbr\u003e\nCompany name (optional)\u003cbr\u003e\nWebsite (optional)\u003c/p\u003e\n\n\u003cp\u003ePlease note that we release more detailed security advisories only after a grace period has passed to give users a chance to update. We\u0026#39;d appreciate if you would not share any details about this bug until we\u0026#39;ve released our official security advisory.\u003c/p\u003e\n\n\u003cp\u003eWe would like to wait with disclosing this a few weeks as we want all our users to upgrade. But also want all our customers (with custom builds of the client) to be upgraded. I\u0026#39;ll keep you posted on this.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-23T07:01:25.192Z","updated_at":"2018-05-23T07:01:25.192Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2782379,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! We have determined this to be eligible for a reward of $50.\n\nThanks a lot for making the internet a safer place and keep hacking. Please do not share this information with any third-parties yet.","markdown_message":"\u003cp\u003eCongratulations! We have determined this to be eligible for a reward of $50.\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for making the internet a safer place and keep hacking. Please do not share this information with any third-parties yet.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-23T07:02:54.277Z","updated_at":"2018-05-23T07:02:54.277Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"mmmds","url":"/mmmds"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2833583,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThe RC of version 3.2.0 is out of the android app.\nCould you verify this issue is resolved?\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThe RC of version 3.2.0 is out of the android app.\u003cbr\u003e\nCould you verify this issue is resolved?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-02T18:55:23.245Z","updated_at":"2018-06-02T18:55:23.245Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2880660,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our latest releases and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-13T18:55:01.205Z","updated_at":"2018-06-13T18:55:01.205Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mmmds","url":"/mmmds"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2908351,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-19T18:24:48.397Z","updated_at":"2018-06-19T18:24:48.397Z","cve_ids":["CVE-2018-3765"],"actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6932723,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-31T14:05:15.526Z","updated_at":"2020-01-31T14:05:15.526Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7188550,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-01T14:05:16.803Z","updated_at":"2020-03-01T14:05:16.803Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}