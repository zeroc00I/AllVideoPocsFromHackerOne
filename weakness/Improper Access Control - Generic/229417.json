{"id":229417,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjk0MTc=","url":"https://hackerone.com/reports/229417","title":"Design Flaw in session management of password reset ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-05-17T20:50:48.187Z","submitted_at":"2017-05-17T20:50:48.187Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"asaxena2190","url":"/asaxena2190","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-02T11:00:00.435Z","bug_reporter_agreed_on_going_public_at":"2017-06-02T11:00:00.361Z","team_member_agreed_on_going_public_at":"2017-06-02T09:54:02.246Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi team,\n\nI found that there is some design flaw in the website in Password reset functionality.\n\nThis report is basically combination of two reports ( #223329 \u0026 #223339) those are already resolved but i bypass the fixes provided for.\n\nIssue 1: Bypass the Logout CSRF fix.\n\n**Steps to reproduce/POC:**\n\n1. Login with user A.\n2. Request for password reset token from user B.\n3. Use this reset password link on the same browser where user A is already logged in.\n4. User A will be logged out.\n\n**Scenario for Logout CSRF:**\n1. Victim is already logged in his account.\n2. Attacker request the password reset token on his account.\n3. Attacker will send the password reset link encapsulated in other link to victim.\n4. Victim will click on the link and will get logged out.\n\n**Impact:**\n1. In general there are very less imppact of logout CSRF but using the bypass method explained by me impacting the whole account of the user.\n2. If an attacker gets successful to do logout the Victim. Victim will never log in with his/her current password. He have to change the password unintentionally. \n\n**Issue 2:** User is getting logged in just by clicking on the reset password token or link as described in the report #223339. It is marked resolved.\n\nAs you are well aware the above Issue : 2, so i am not explaining but i will explain the impact of the combination of the both issues.\n\n#Combination of both Issues (Scenario):\n\n1. Attacker will generate the two password reset token back to back.\n2. Attacker will not use the tokens.\n3. He will encapsulate the password reset link in a html file with some javascript. \n4. Attacker will upload the the above script on the serer which will execute the both password reset token one by one with the sleep of 3 or 4 seconds.\n5. So when first password reset token will be executed on the victim's browser he will get logged out from his account.\n6. and when second password reset token will be executed on the victim's browser he will be automatically logged in the attacker's account.\n7. So attacker will easily do logout the victim from his account and logged in his account for his malicious purpose.\n8. As weblate is project and development based site. Attacker could be interested in the code written by victim or his idea of project, So attacker can use the above attack to login victim to his account and victim will do the changes unknowingly in the attacker's account as victim is considering that account his account.\n\nPlease look into this.\n\nThanks,\nAkash Saxena.\n","vulnerability_information_html":"\u003cp\u003eHi team,\u003c/p\u003e\n\n\u003cp\u003eI found that there is some design flaw in the website in Password reset functionality.\u003c/p\u003e\n\n\u003cp\u003eThis report is basically combination of two reports ( \u003ca href=\"/reports/223329\"\u003e#223329\u003c/a\u003e \u0026amp; \u003ca href=\"/reports/223339\"\u003e#223339\u003c/a\u003e) those are already resolved but i bypass the fixes provided for.\u003c/p\u003e\n\n\u003cp\u003eIssue 1: Bypass the Logout CSRF fix.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce/POC:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin with user A.\u003c/li\u003e\n\u003cli\u003eRequest for password reset token from user B.\u003c/li\u003e\n\u003cli\u003eUse this reset password link on the same browser where user A is already logged in.\u003c/li\u003e\n\u003cli\u003eUser A will be logged out.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eScenario for Logout CSRF:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eVictim is already logged in his account.\u003c/li\u003e\n\u003cli\u003eAttacker request the password reset token on his account.\u003c/li\u003e\n\u003cli\u003eAttacker will send the password reset link encapsulated in other link to victim.\u003c/li\u003e\n\u003cli\u003eVictim will click on the link and will get logged out.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIn general there are very less imppact of logout CSRF but using the bypass method explained by me impacting the whole account of the user.\u003c/li\u003e\n\u003cli\u003eIf an attacker gets successful to do logout the Victim. Victim will never log in with his/her current password. He have to change the password unintentionally. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eIssue 2:\u003c/strong\u003e User is getting logged in just by clicking on the reset password token or link as described in the report \u003ca href=\"/reports/223339\"\u003e#223339\u003c/a\u003e. It is marked resolved.\u003c/p\u003e\n\n\u003cp\u003eAs you are well aware the above Issue : 2, so i am not explaining but i will explain the impact of the combination of the both issues.\u003c/p\u003e\n\n\u003ch1 id=\"combination-of-both-issues-scenario\"\u003eCombination of both Issues (Scenario):\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eAttacker will generate the two password reset token back to back.\u003c/li\u003e\n\u003cli\u003eAttacker will not use the tokens.\u003c/li\u003e\n\u003cli\u003eHe will encapsulate the password reset link in a html file with some javascript. \u003c/li\u003e\n\u003cli\u003eAttacker will upload the the above script on the serer which will execute the both password reset token one by one with the sleep of 3 or 4 seconds.\u003c/li\u003e\n\u003cli\u003eSo when first password reset token will be executed on the victim\u0026#39;s browser he will get logged out from his account.\u003c/li\u003e\n\u003cli\u003eand when second password reset token will be executed on the victim\u0026#39;s browser he will be automatically logged in the attacker\u0026#39;s account.\u003c/li\u003e\n\u003cli\u003eSo attacker will easily do logout the victim from his account and logged in his account for his malicious purpose.\u003c/li\u003e\n\u003cli\u003eAs weblate is project and development based site. Attacker could be interested in the code written by victim or his idea of project, So attacker can use the above attack to login victim to his account and victim will do the changes unknowingly in the attacker\u0026#39;s account as victim is considering that account his account.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePlease look into this.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAkash Saxena.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-02T09:54:02.288Z","allow_singular_disclosure_after":-110228991.69071975,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","asaxena2190","spetr0x","stkovrflw"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1681750,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Interesting scenario, thanks for providing it. We will look deeper into it in next days.","markdown_message":"\u003cp\u003eInteresting scenario, thanks for providing it. We will look deeper into it in next days.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-17T21:20:01.127Z","updated_at":"2017-05-17T21:20:01.127Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1685527,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for spotting, fixed in https://github.com/WeblateOrg/weblate/commit/b76e73ebe9723d3feed9c8c32573dff1c7dd18a2, will be deployed later today.","markdown_message":"\u003cp\u003eThanks for spotting, fixed in \u003ca title=\"https://github.com/WeblateOrg/weblate/commit/b76e73ebe9723d3feed9c8c32573dff1c7dd18a2\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWeblateOrg%2Fweblate%2Fcommit%2Fb76e73ebe9723d3feed9c8c32573dff1c7dd18a2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WeblateOrg/weblate/commit/b76e73ebe9723d3feed9c8c32573dff1c7dd18a2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, will be deployed later today.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-19T10:06:01.340Z","updated_at":"2017-05-19T10:06:01.340Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"asaxena2190","url":"/asaxena2190"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1724466,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-02T09:54:02.265Z","updated_at":"2017-06-02T09:54:02.265Z","first_to_agree":true,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1724519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is it deployed? ","markdown_message":"\u003cp\u003eIs it deployed? \u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-02T10:23:27.007Z","updated_at":"2017-06-02T10:23:27.007Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1724526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes.","markdown_message":"\u003cp\u003eYes.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-02T10:26:40.792Z","updated_at":"2017-06-02T10:26:40.792Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1724597,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-02T11:00:00.396Z","updated_at":"2017-06-02T11:00:00.396Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1724598,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-02T11:00:00.450Z","updated_at":"2017-06-02T11:00:00.450Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}