{"id":155704,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTU3MDQ=","url":"https://hackerone.com/reports/155704","title":"Staff member can delete Private Apps","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-01T01:21:34.225Z","submitted_at":"2016-08-01T01:21:34.225Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-08-09T00:26:01.123Z","bug_reporter_agreed_on_going_public_at":"2016-08-09T00:26:01.002Z","team_member_agreed_on_going_public_at":"2016-08-08T21:55:16.233Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nBug description : I noticed that Full access staff member doesn't have access to private Apps Even he has access to Apps. But a Staff member can actually Delete Private Apps through the normal App link by changing the ID. \n\nSteps to reproduce : \n1. Create A shop and install any app. Also create private App. \n2. Add a staff member with full access .\n3. Now Login from staff member and go to app section from his account.You will see that he is not able to access private Apps yet.\n4. Now Try to delete the normal App and Capture the request.The request will look like the following request : \n\nVulnerable HTTP request : \n\nPOST /admin/apps/[App_ID]HTTP/1.1\nHost: [your_store].myshopify.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://vijaygangani1110store.myshopify.com/admin/apps\nCookie: [Cookie]\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 132\n\n_method=delete\u0026authenticity_token=[Token]\n\n5. Change the App ID to private App ID and you will see from Owners account that the private App has been Deleted. \n\nApp_ID parameter is vulnerable here. Server doesn't check the permissions and let the staff member Delete the App.\n\n\nLet me know if you need any other help from my side. \n\nBest Regards !\nVijay Kumar \n\n\n","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eBug description : I noticed that Full access staff member doesn\u0026#39;t have access to private Apps Even he has access to Apps. But a Staff member can actually Delete Private Apps through the normal App link by changing the ID. \u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce : \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate A shop and install any app. Also create private App. \u003c/li\u003e\n\u003cli\u003eAdd a staff member with full access .\u003c/li\u003e\n\u003cli\u003eNow Login from staff member and go to app section from his account.You will see that he is not able to access private Apps yet.\u003c/li\u003e\n\u003cli\u003eNow Try to delete the normal App and Capture the request.The request will look like the following request : \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eVulnerable HTTP request : \u003c/p\u003e\n\n\u003cp\u003ePOST /admin/apps/[App_ID]HTTP/1.1\u003cbr\u003e\nHost: [your_store].myshopify.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nReferer: \u003ca title=\"https://vijaygangani1110store.myshopify.com/admin/apps\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani1110store.myshopify.com%2Fadmin%2Fapps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani1110store.myshopify.com/admin/apps\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: [Cookie]\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 132\u003c/p\u003e\n\n\u003cp\u003e_method=delete\u0026amp;authenticity_token=[Token]\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eChange the App ID to private App ID and you will see from Owners account that the private App has been Deleted. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eApp_ID parameter is vulnerable here. Server doesn\u0026#39;t check the permissions and let the staff member Delete the App.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need any other help from my side. \u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["bugdiscloseguys","mefkan","ph3t","dyabla","zenturio","no-longer-with-company"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1098784,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2016-08-01T01:21:34.710Z","updated_at":"2016-08-01T01:21:34.710Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1102161,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-02T13:16:10.494Z","updated_at":"2016-08-02T13:16:10.494Z","additional_data":{"old_title":"Critical : Staff member can Delete Private Apps (IDOR)","new_title":"Staff member can delete Private Apps"},"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1102164,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-02T13:17:27.005Z","updated_at":"2018-02-28T13:10:44.115Z","additional_data":{"added_weaknesses":[],"removed_weaknesses":[{"id":27,"name":"Improper Authentication - Generic"}]},"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1102264,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We recently restricted management of private apps to full access users, so you are correct there is a problem here, other users should not be able to delete private apps. I'm marking this issue as Triaged and we are investigating a solution. Thank you for reporting this issue.","markdown_message":"\u003cp\u003eWe recently restricted management of private apps to full access users, so you are correct there is a problem here, other users should not be able to delete private apps. I\u0026#39;m marking this issue as Triaged and we are investigating a solution. Thank you for reporting this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-02T13:56:59.796Z","updated_at":"2016-08-02T13:56:59.796Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1103097,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We recently deployed a fix for this issue.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. We recently deployed a fix for this issue.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-02T21:28:40.258Z","updated_at":"2016-08-02T21:28:40.258Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1113670,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify! This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify! This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-08T21:55:04.705Z","updated_at":"2016-08-08T21:55:04.705Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1113673,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-08T21:55:16.260Z","updated_at":"2016-08-08T21:55:16.260Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1113905,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-09T00:26:01.033Z","updated_at":"2016-08-09T00:26:01.033Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1113906,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-09T00:26:01.159Z","updated_at":"2016-08-09T00:26:01.159Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1164712,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-31T13:23:33.837Z","updated_at":"2018-02-28T13:10:46.052Z","additional_data":{"added_weaknesses":[{"id":75,"name":"Privilege Escalation"}],"removed_weaknesses":[]},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}