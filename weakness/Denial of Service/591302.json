{"id":591302,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTEzMDI=","url":"https://hackerone.com/reports/591302","title":"Denial of service to WP-JSON API by cache poisoning the CORS allow origin header","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-05-28T08:24:13.932Z","submitted_at":"2019-05-28T08:24:13.932Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nathand","url":"/nathand","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-04-16T11:47:55.468Z","bug_reporter_agreed_on_going_public_at":"2020-03-26T06:09:20.243Z","team_member_agreed_on_going_public_at":"2020-04-16T11:47:55.369Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The WP-JSON implementation on some wordpress.com websites I've tested is vulnerable to denial of service where by an attacker can provide an arbitrary `Origin` header in the request, which is then echoed back in the response via the `Access-Control-Allow-Origin` header, which is cached and served to other requests.\n\nThis response header is used by browsers to determine whether the requesting origin (if it is a cross origin request) is allowed to read the response in the request. In the event the victim website had another origin that used the WP-JSON API to request data from their wordpress.com site (e.g. a sub domain), this cache poisoning would deny access to such requests due to failed a CORS access control check. It appears that this vulnerability is only a concern if the WP-JSON API responses are cached, which you can determine by the presence of a `X-Cache: hit` header in the response.\n\n## Proof of concept\n\nFor this test, I'm going to target `█████████.com`, a wordpress.com site. I will be doing this with a cache busting technique that doesn't really poison the live site's cache (by supplying a bespoke query string value) so this should be safe to repeat verbatim.\n\n  1. First, open a HTTPS website - it doesn't matter which website, as long as it isn't `https://█████████.com` (to trigger browser CORS). For my test, I used my own website https://nathandavison.com.\n  1. Open the javascript console and execute the following 5-10 times (to make sure the cache is poisoned across backends): `fetch('https://██████████.com/wp-json/?dontreallypoison1').then(res =\u003e res.json()).then(json =\u003e console.log(json))`\n  1. Now, open another HTTPS website - it also doesn't matter which site it is, as long as it too isn't `https://███████.com`. Execute the same fetch as above.\n  1. You should now experience a CORS error in your browser, such as: `Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at https://█████████.com/wp-json/?dontreallypoison1. (Reason: CORS header ‘Access-Control-Allow-Origin’ does not match ‘https://nathandavison.com’).`\n\nWhat's going on here? because the WP-JSON response is CORS aware, it is responding with a `Access-Control-Allow-Origin` header value. Presumably to offer wide support for CORS, the `Origin` value in the request is being echoed back. So far, I believe this is standard Wordpress WP-JSON behavior. However, automattic/wordpress.com is caching this response and is not keying the cache based on the request `Origin` value (which is `https://nathandavison.com` in step 1 above), so therefore is serving the poisoned response in step 4, and because the other origin is not `https://nathandavison.com`, CORS in the browser blocks the response coming back into the DOM.\n\nI believe any wordpress.com website that caches WP-JSON responses is vulnerable to this. A quick way, as an attacker, to find potential victims would be a query like this:\n\nhttps://publicwww.com/websites/%22If%20you're%20reading%20this,%20you%20should%20visit%20automattic.com%22/\n\n## Attach scenario\n\nTo attack this, a victim site would have to:\n\n  1. Use WP-JSON is a meaningful way in a browser context (or any other context that respects CORS headers)\n  1. Use it from an origin that triggers CORS. For example, if the WP-JSON API is used on \"foo.████.com\" to request the blog posts from \"█████.com\". Another example may be a \"headless\" Wordpress site (e.g. api.x.com is Wordpress and x.com is the frontend, which uses the WP-JSON plugin to interact with the WP backend).\n\nOnce a target is found that satisfies these conditions, an attacker would then simply poison the CORS response with regular requests to specific endpoints. This poisoning would result (in the example above) in visitors to \"foo.██████.com\" failing to load the WP-JSON API requests to \"██████████.com\" due to CORS failures, causing a DoS for whatever service relies on this functionality.\n\n## Fix\n\nI believe to fix this, automattic should make sure that edge caches for WP-JSON requests are using the `Origin` header in the request to key the cache, so one value can't affect the cache served to another value. Preventing the echoing back of the `Origin` into the `Access-Control-Allow-Origin` response header without first passing through a configurable whitelist would also be a potential solution, but this may be harder to implement. \n\n## More information\n\nPlease see the following blog post for more information on this:\n\nhttps://nathandavison.com/blog/corsing-a-denial-of-service-via-cache-poisoning\n\nI wrote this post in response to disclosing a very similar vulnerability to another Wordpress SaaS provider.\n\n## Impact\n\nThe impact of this vulnerability depends on how and where a client uses the WP-JSON plugin. If a wordpress.com customer uses WP-JSON in a context that relies on CORS, this technique could deny service to the WP-JSON endpoints in use.","vulnerability_information_html":"\u003cp\u003eThe WP-JSON implementation on some wordpress.com websites I\u0026#39;ve tested is vulnerable to denial of service where by an attacker can provide an arbitrary \u003ccode\u003eOrigin\u003c/code\u003e header in the request, which is then echoed back in the response via the \u003ccode\u003eAccess-Control-Allow-Origin\u003c/code\u003e header, which is cached and served to other requests.\u003c/p\u003e\n\n\u003cp\u003eThis response header is used by browsers to determine whether the requesting origin (if it is a cross origin request) is allowed to read the response in the request. In the event the victim website had another origin that used the WP-JSON API to request data from their wordpress.com site (e.g. a sub domain), this cache poisoning would deny access to such requests due to failed a CORS access control check. It appears that this vulnerability is only a concern if the WP-JSON API responses are cached, which you can determine by the presence of a \u003ccode\u003eX-Cache: hit\u003c/code\u003e header in the response.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of concept\u003c/h2\u003e\n\n\u003cp\u003eFor this test, I\u0026#39;m going to target \u003ccode\u003e█████████.com\u003c/code\u003e, a wordpress.com site. I will be doing this with a cache busting technique that doesn\u0026#39;t really poison the live site\u0026#39;s cache (by supplying a bespoke query string value) so this should be safe to repeat verbatim.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFirst, open a HTTPS website - it doesn\u0026#39;t matter which website, as long as it isn\u0026#39;t \u003ccode\u003ehttps://█████████.com\u003c/code\u003e (to trigger browser CORS). For my test, I used my own website \u003ca title=\"https://nathandavison.com\" href=\"/redirect?url=https%3A%2F%2Fnathandavison.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nathandavison.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eOpen the javascript console and execute the following 5-10 times (to make sure the cache is poisoned across backends): \u003ccode\u003efetch(\u0026#39;https://██████████.com/wp-json/?dontreallypoison1\u0026#39;).then(res =\u0026gt; res.json()).then(json =\u0026gt; console.log(json))\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eNow, open another HTTPS website - it also doesn\u0026#39;t matter which site it is, as long as it too isn\u0026#39;t \u003ccode\u003ehttps://███████.com\u003c/code\u003e. Execute the same fetch as above.\u003c/li\u003e\n\u003cli\u003eYou should now experience a CORS error in your browser, such as: \u003ccode\u003eCross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at https://█████████.com/wp-json/?dontreallypoison1. (Reason: CORS header ‘Access-Control-Allow-Origin’ does not match ‘https://nathandavison.com’).\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhat\u0026#39;s going on here? because the WP-JSON response is CORS aware, it is responding with a \u003ccode\u003eAccess-Control-Allow-Origin\u003c/code\u003e header value. Presumably to offer wide support for CORS, the \u003ccode\u003eOrigin\u003c/code\u003e value in the request is being echoed back. So far, I believe this is standard Wordpress WP-JSON behavior. However, automattic/wordpress.com is caching this response and is not keying the cache based on the request \u003ccode\u003eOrigin\u003c/code\u003e value (which is \u003ccode\u003ehttps://nathandavison.com\u003c/code\u003e in step 1 above), so therefore is serving the poisoned response in step 4, and because the other origin is not \u003ccode\u003ehttps://nathandavison.com\u003c/code\u003e, CORS in the browser blocks the response coming back into the DOM.\u003c/p\u003e\n\n\u003cp\u003eI believe any wordpress.com website that caches WP-JSON responses is vulnerable to this. A quick way, as an attacker, to find potential victims would be a query like this:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://publicwww.com/websites/%22If%20you\u0026#39;re%20reading%20this,%20you%20should%20visit%20automattic.com%22/\" href=\"/redirect?url=https%3A%2F%2Fpublicwww.com%2Fwebsites%2F%2522If%2520you%27re%2520reading%2520this%2C%2520you%2520should%2520visit%2520automattic.com%2522%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://publicwww.com/websites/%22If%20you\u0026#39;re%20reading%20this,%20you%20should%20visit%20automattic.com%22/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"attach-scenario\"\u003eAttach scenario\u003c/h2\u003e\n\n\u003cp\u003eTo attack this, a victim site would have to:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eUse WP-JSON is a meaningful way in a browser context (or any other context that respects CORS headers)\u003c/li\u003e\n\u003cli\u003eUse it from an origin that triggers CORS. For example, if the WP-JSON API is used on \u0026quot;foo.████.com\u0026quot; to request the blog posts from \u0026quot;█████.com\u0026quot;. Another example may be a \u0026quot;headless\u0026quot; Wordpress site (e.g. api.x.com is Wordpress and x.com is the frontend, which uses the WP-JSON plugin to interact with the WP backend).\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eOnce a target is found that satisfies these conditions, an attacker would then simply poison the CORS response with regular requests to specific endpoints. This poisoning would result (in the example above) in visitors to \u0026quot;foo.██████.com\u0026quot; failing to load the WP-JSON API requests to \u0026quot;██████████.com\u0026quot; due to CORS failures, causing a DoS for whatever service relies on this functionality.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eI believe to fix this, automattic should make sure that edge caches for WP-JSON requests are using the \u003ccode\u003eOrigin\u003c/code\u003e header in the request to key the cache, so one value can\u0026#39;t affect the cache served to another value. Preventing the echoing back of the \u003ccode\u003eOrigin\u003c/code\u003e into the \u003ccode\u003eAccess-Control-Allow-Origin\u003c/code\u003e response header without first passing through a configurable whitelist would also be a potential solution, but this may be harder to implement. \u003c/p\u003e\n\n\u003ch2 id=\"more-information\"\u003eMore information\u003c/h2\u003e\n\n\u003cp\u003ePlease see the following blog post for more information on this:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://nathandavison.com/blog/corsing-a-denial-of-service-via-cache-poisoning\" href=\"/redirect?url=https%3A%2F%2Fnathandavison.com%2Fblog%2Fcorsing-a-denial-of-service-via-cache-poisoning\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nathandavison.com/blog/corsing-a-denial-of-service-via-cache-poisoning\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI wrote this post in response to disclosing a very similar vulnerability to another Wordpress SaaS provider.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe impact of this vulnerability depends on how and where a client uses the WP-JSON plugin. If a wordpress.com customer uses WP-JSON in a context that relies on CORS, this technique could deny service to the WP-JSON endpoints in use.\u003c/p\u003e\n","bounty_amount":"550.0","formatted_bounty":"$550","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-04-25T06:09:20.344Z","allow_singular_disclosure_after":-21428363.36172357,"singular_disclosure_allowed":true,"vote_count":381,"voters":["nagli","wh0ru","s1r1u5","a_d_a_m","mashoud1122","base_64","sameerphad72","slaxxx","0xelkomy","k3ypt0","and 371 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4938484,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Thanks for the report. I was able to reproduce this issue, I'm going to forward this report to the appropriate team.","markdown_message":"\u003cp\u003eHi. Thanks for the report. I was able to reproduce this issue, I\u0026#39;m going to forward this report to the appropriate team.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-28T08:36:50.939Z","updated_at":"2019-05-28T08:36:50.939Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4938676,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-28T08:46:15.002Z","updated_at":"2019-05-28T08:46:15.002Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4955516,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nathand, thanks for the great report. I just wanted to give a quick update - yesterday we rolled out a fix for our VIP Go environment (where TechCrunch runs), can you give it a look and confirm that it's resolved from your POV?\n\nWe're currently in the process of patching other parts of our infrastructure that are also affected and will keep you updated on that progress.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nathand\"\u003e@nathand\u003c/a\u003e, thanks for the great report. I just wanted to give a quick update - yesterday we rolled out a fix for our VIP Go environment (where TechCrunch runs), can you give it a look and confirm that it\u0026#39;s resolved from your POV?\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re currently in the process of patching other parts of our infrastructure that are also affected and will keep you updated on that progress.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-30T17:32:27.866Z","updated_at":"2019-05-30T17:32:27.866Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4957205,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nickdaughert, I can confirm the fix appears to have been effective for TechCrunch for my PoC above - I'm no longer seeing one `Origin` poisoning the cache for other origins.\n\nHowever, I think there may still be an edge case issue - if I mix sending requests to the same wp-json endpoint between requests with an origin and ones without an origin header at all, sometimes the response for the request with an origin will come back without a `Access-Control-Allow-Origin` header. So in other words, it still seems possible for a request without an `Origin` to poison the cache for requests with an `Origin`.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nickdaughert\"\u003e@nickdaughert\u003c/a\u003e, I can confirm the fix appears to have been effective for TechCrunch for my PoC above - I\u0026#39;m no longer seeing one \u003ccode\u003eOrigin\u003c/code\u003e poisoning the cache for other origins.\u003c/p\u003e\n\n\u003cp\u003eHowever, I think there may still be an edge case issue - if I mix sending requests to the same wp-json endpoint between requests with an origin and ones without an origin header at all, sometimes the response for the request with an origin will come back without a \u003ccode\u003eAccess-Control-Allow-Origin\u003c/code\u003e header. So in other words, it still seems possible for a request without an \u003ccode\u003eOrigin\u003c/code\u003e to poison the cache for requests with an \u003ccode\u003eOrigin\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-30T22:14:47.501Z","updated_at":"2019-05-30T22:14:47.501Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5179033,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @nathand - thanks for that additional info, I wanted to provide a quick update - work on this last bit is still ongoing, and I'm hoping we'll have it wrapped up this week.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nathand\"\u003e@nathand\u003c/a\u003e - thanks for that additional info, I wanted to provide a quick update - work on this last bit is still ongoing, and I\u0026#39;m hoping we\u0026#39;ll have it wrapped up this week.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-24T14:06:47.950Z","updated_at":"2019-06-24T14:06:47.950Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5182366,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update @nickdaugherty - no problems just let me know when ready and I'll give it a test.","markdown_message":"\u003cp\u003eThanks for the update \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e - no problems just let me know when ready and I\u0026#39;ll give it a test.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-24T22:04:10.145Z","updated_at":"2019-06-24T22:04:10.145Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5309426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nathand - We've rolled out a patch for the second part of this report (cache poisoning when no Origin is sent).\n\nCan you please look again and let us know if you consider the issue to be resolved?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nathand\"\u003e@nathand\u003c/a\u003e - We\u0026#39;ve rolled out a patch for the second part of this report (cache poisoning when no Origin is sent).\u003c/p\u003e\n\n\u003cp\u003eCan you please look again and let us know if you consider the issue to be resolved?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-12T16:13:24.193Z","updated_at":"2019-07-12T16:13:24.193Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5312609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nickdaugherty - yep that looks good. I can't seem to poison the responses for other origins now, this is resolved. Nice job!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e - yep that looks good. I can\u0026#39;t seem to poison the responses for other origins now, this is resolved. Nice job!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-12T23:35:41.987Z","updated_at":"2019-07-12T23:35:41.987Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5326624,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Great, thanks for confirming @nathand. We're still looking into fixes in a few other parts of our infrastructure (not including VIP Go where the site from the POC is hosted), but we wanted to mark this as Resolved while that's in progress so that we can make a bounty decision ASAP.\n\nThanks again for the report, and we looking forward to working with you again in the future!","markdown_message":"\u003cp\u003eGreat, thanks for confirming \u003ca href=\"/nathand\"\u003e@nathand\u003c/a\u003e. We\u0026#39;re still looking into fixes in a few other parts of our infrastructure (not including VIP Go where the site from the POC is hosted), but we wanted to mark this as Resolved while that\u0026#39;s in progress so that we can make a bounty decision ASAP.\u003c/p\u003e\n\n\u003cp\u003eThanks again for the report, and we looking forward to working with you again in the future!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-15T22:27:39.375Z","updated_at":"2019-07-15T22:27:39.375Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"nathand","url":"/nathand"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5381438,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problems @nickdaugherty, sounds good.\n\nI see Automattic do publicly disclose reports, and it would be great if we could for this report too - however would you prefer I wait on requesting disclosure while the other infrastructure is attended to?","markdown_message":"\u003cp\u003eNo problems \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e, sounds good.\u003c/p\u003e\n\n\u003cp\u003eI see Automattic do publicly disclose reports, and it would be great if we could for this report too - however would you prefer I wait on requesting disclosure while the other infrastructure is attended to?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-21T08:15:59.120Z","updated_at":"2019-07-21T08:15:59.120Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5391955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @nathand, yes, please wait on requesting public disclosure until the other few spots are buttoned up on this end, it is much appreciated :) We'll update here once that has been completed.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nathand\"\u003e@nathand\u003c/a\u003e, yes, please wait on requesting public disclosure until the other few spots are buttoned up on this end, it is much appreciated :) We\u0026#39;ll update here once that has been completed.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-22T22:36:32.847Z","updated_at":"2019-07-22T22:36:32.847Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5712182,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nickdaugherty, just wondering if you had any updates on this?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e, just wondering if you had any updates on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-02T12:55:52.040Z","updated_at":"2019-09-02T12:55:52.040Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5839715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nickdaugherty, checking in to see if you had a bounty decision on this + whether I'm okay to request disclosure?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e, checking in to see if you had a bounty decision on this + whether I\u0026#39;m okay to request disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-18T23:05:29.276Z","updated_at":"2019-09-18T23:05:29.276Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5880203,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the lack of updates here, I've nudged the internal team on this and will hopefully have something for you soon.","markdown_message":"\u003cp\u003eSorry for the lack of updates here, I\u0026#39;ve nudged the internal team on this and will hopefully have something for you soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-24T17:42:58.228Z","updated_at":"2019-09-24T17:42:58.228Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6056640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @nathand - just wanted to let you know that WordPress core 5.2.4 has been released, which contains a partial fix for this by ensuring that the `Vary: Origin` header is sent from core REST API endpoints when needed.\n\nI'm still waiting to hear back from the internal teams that are working to ensure all Automattic services properly vary the cache when `Vary: Origin` is sent (still have a few more spots).","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nathand\"\u003e@nathand\u003c/a\u003e - just wanted to let you know that WordPress core 5.2.4 has been released, which contains a partial fix for this by ensuring that the \u003ccode\u003eVary: Origin\u003c/code\u003e header is sent from core REST API endpoints when needed.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m still waiting to hear back from the internal teams that are working to ensure all Automattic services properly vary the cache when \u003ccode\u003eVary: Origin\u003c/code\u003e is sent (still have a few more spots).\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-16T15:54:15.009Z","updated_at":"2019-10-16T15:54:15.009Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6059586,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice! thanks for letting me know. Out of curiosity was the fix in Wordpress as a result of this report or a happy coincidence?","markdown_message":"\u003cp\u003eNice! thanks for letting me know. Out of curiosity was the fix in Wordpress as a result of this report or a happy coincidence?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-16T22:41:22.760Z","updated_at":"2019-10-16T22:41:22.760Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6313452,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @nickdaugherty, just checking in on whether this is ready for disclosure request \u0026 bounty decision?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e, just checking in on whether this is ready for disclosure request \u0026amp; bounty decision?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-15T09:15:23.275Z","updated_at":"2019-11-15T09:15:23.275Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6846965,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nickdaugherty just checking if you had any updates on whether the other infrastructure was patches for this.","markdown_message":"\u003cp\u003e\u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e just checking if you had any updates on whether the other infrastructure was patches for this.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-23T04:20:07.805Z","updated_at":"2020-01-23T04:20:07.805Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7401473,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Apologies for the long delay here. Thanks again for the responsible disclosure.","markdown_message":"\u003cp\u003eApologies for the long delay here. Thanks again for the responsible disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-23T15:38:22.479Z","updated_at":"2020-03-23T15:38:22.479Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"nathand","url":"/nathand"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7424109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks Automattic - would it be viable now to request disclosure of this report?","markdown_message":"\u003cp\u003eThanks Automattic - would it be viable now to request disclosure of this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-24T21:58:19.765Z","updated_at":"2020-03-24T21:58:19.765Z","actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7441412,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's fine, would you like to do a full disclosure or a limited one? If it's the first, we'll edit/hide the affected customer domain.","markdown_message":"\u003cp\u003eThat\u0026#39;s fine, would you like to do a full disclosure or a limited one? If it\u0026#39;s the first, we\u0026#39;ll edit/hide the affected customer domain.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-25T20:31:43.830Z","updated_at":"2020-03-25T20:31:43.830Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7443986,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks @xknown - full would be great please.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/xknown\"\u003e@xknown\u003c/a\u003e - full would be great please.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-26T06:09:20.263Z","updated_at":"2020-03-26T06:09:20.263Z","first_to_agree":true,"actor":{"username":"nathand","cleared":false,"url":"/nathand","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NY2oTeWofAnqK1X5MRNFCDXy/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7684024,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-16T11:47:55.398Z","updated_at":"2020-04-16T11:47:55.398Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7684025,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-16T11:47:55.511Z","updated_at":"2020-04-16T11:47:55.511Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}