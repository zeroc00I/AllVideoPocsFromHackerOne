{"id":161485,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjE0ODU=","url":"https://hackerone.com/reports/161485","title":"Non-secure requests to www.lahitapiola.fi are not automatically upgraded to HTTPS","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-08-19T22:16:58.943Z","submitted_at":"2016-08-19T22:16:58.943Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-09T19:24:52.048Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:14:26.408Z","team_member_agreed_on_going_public_at":"2019-10-09T19:24:51.935Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"To reproduce, send a `HEAD` request to `http://www.lahitapiola.fi` like so:\n\n```\ncurl -I http://www.lahitapiola.fi\nHTTP/1.1 301 Moved Permanently\nDate: Fri, 19 Aug 2016 22:11:59 GMT\nLocation: http://www.lahitapiola.fi/henkilo\nCache-Control: max-age=60\nExpires: Fri, 19 Aug 2016 22:12:59 GMT\nContent-Type: text/html; charset=iso-8859-1\nSet-Cookie: TS0159a426=0147052ac59d111bf38a364a9cd7c5f17c819d9baeab5600d1c4d83de4302318828d8e96ab; Path=/\nTransfer-Encoding: chunked\n```\n\nYou will see that the server does not instruct the client to upgrade the connection to HTTPS. The server responds with a 301 status code but redirects the visitors to the non-HTTPS site. It should respond with a 301 status code and the response header `Location` set to `https://www.lahitapiola.fi`.\n\nNon-secure connections need to be upgraded to HTTPS as soon as possible using a permanent redirect. Since this isn't happening, any information transmitted by users (including usernames and passwords) is at risk of compromise. Considering that the site responds to HTTPS requests @ `https://www.lahitapiola.fi` this oversight should be corrected.","vulnerability_information_html":"\u003cp\u003eTo reproduce, send a \u003ccode\u003eHEAD\u003c/code\u003e request to \u003ccode\u003ehttp://www.lahitapiola.fi\u003c/code\u003e like so:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -I http://www.lahitapiola.fi\nHTTP/1.1 301 Moved Permanently\nDate: Fri, 19 Aug 2016 22:11:59 GMT\nLocation: http://www.lahitapiola.fi/henkilo\nCache-Control: max-age=60\nExpires: Fri, 19 Aug 2016 22:12:59 GMT\nContent-Type: text/html; charset=iso-8859-1\nSet-Cookie: TS0159a426=0147052ac59d111bf38a364a9cd7c5f17c819d9baeab5600d1c4d83de4302318828d8e96ab; Path=/\nTransfer-Encoding: chunked\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou will see that the server does not instruct the client to upgrade the connection to HTTPS. The server responds with a 301 status code but redirects the visitors to the non-HTTPS site. It should respond with a 301 status code and the response header \u003ccode\u003eLocation\u003c/code\u003e set to \u003ccode\u003ehttps://www.lahitapiola.fi\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eNon-secure connections need to be upgraded to HTTPS as soon as possible using a permanent redirect. Since this isn\u0026#39;t happening, any information transmitted by users (including usernames and passwords) is at risk of compromise. Considering that the site responds to HTTPS requests @ \u003ccode\u003ehttps://www.lahitapiola.fi\u003c/code\u003e this oversight should be corrected.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["mygf","brodie_codie","geeknik","codeanddecode","cryptographer","loverboy137","mortenrickirasmussen","boogiehacks","asias2020","big_white"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1144437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nThis is an https best practice issue, and the report will be regarded as informative. The site www.lahitapiola.fi does not process customer related data. All systems with customer date are already protected with SSL/TLS and not at all accessible using plaintext http.\n\nAnyway, our security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eThis is an https best practice issue, and the report will be regarded as informative. The site \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e does not process customer related data. All systems with customer date are already protected with SSL/TLS and not at all accessible using plaintext http.\u003c/p\u003e\n\n\u003cp\u003eAnyway, our security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-22T11:36:10.605Z","updated_at":"2016-08-22T11:36:24.698Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1146064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the explanation. I thought that the report was viable since all of your other `in-scope` domains appear to redirect from http to https automatically.","markdown_message":"\u003cp\u003eThank you for the explanation. I thought that the report was viable since all of your other \u003ccode\u003ein-scope\u003c/code\u003e domains appear to redirect from http to https automatically.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-22T21:25:38.394Z","updated_at":"2016-08-22T21:25:38.394Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1217165,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-26T20:19:10.143Z","updated_at":"2016-09-26T20:19:10.143Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1297568,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are looking into fixes for this issue. It requires a lot of regression testing, so we will have to wait and see how it progresses.","markdown_message":"\u003cp\u003eWe are looking into fixes for this issue. It requires a lot of regression testing, so we will have to wait and see how it progresses.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-14T08:31:13.967Z","updated_at":"2016-11-14T08:31:13.967Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1441497,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-24T17:53:27.510Z","updated_at":"2017-01-24T17:53:27.510Z","additional_data":{"old_severity":null,"new_severity":"Medium (5.3)","old_severity_id":null,"new_severity_id":21415},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1441499,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-24T17:53:59.391Z","updated_at":"2017-01-24T17:53:59.391Z","additional_data":{"old_severity":"Medium (5.3)","new_severity":"Low","old_severity_id":21415,"new_severity_id":21417},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1499370,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We have decided to award you with a bounty. The report will be kept open until we have a fix. There will be no further updates until that time. We will most likely disclose the report publicly when it is resolved.","markdown_message":"\u003cp\u003eWe have decided to award you with a bounty. The report will be kept open until we have a fix. There will be no further updates until that time. We will most likely disclose the report publicly when it is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-22T15:09:51.897Z","updated_at":"2017-02-22T15:09:51.897Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1502421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty.","markdown_message":"\u003cp\u003eThank you for the bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-23T23:37:57.306Z","updated_at":"2017-02-23T23:37:57.306Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1617638,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, just FYI this is now fixed.","markdown_message":"\u003cp\u003eHi, just FYI this is now fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-18T09:54:31.232Z","updated_at":"2017-04-18T09:54:31.232Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1617641,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved.","markdown_message":"\u003cp\u003eClosing as resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-18T09:54:56.722Z","updated_at":"2017-04-18T09:54:56.722Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5960590,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:14:26.432Z","updated_at":"2019-10-04T16:14:26.432Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5997996,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosing.","markdown_message":"\u003cp\u003eDisclosing.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-09T19:24:51.960Z","updated_at":"2019-10-09T19:24:51.960Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5997997,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-09T19:24:52.072Z","updated_at":"2019-10-09T19:24:52.072Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5998025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note to readers of this report - things have changed during the years and almost all of the transport -related reports are closed as informative unless there is a proper business case. Quoting OWASP and wikipedia is not a business case though.","markdown_message":"\u003cp\u003eNote to readers of this report - things have changed during the years and almost all of the transport -related reports are closed as informative unless there is a proper business case. Quoting OWASP and wikipedia is not a business case though.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-09T19:26:38.073Z","updated_at":"2019-10-09T19:26:38.073Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3397,"category":"team","content":"##Issue\n\nThe reporter found that www.lahitapiola.fi is not completely using secure transport protocols. This finding was not a surprise, as it was according to business decisions. The report is somewhat related to #146707, where we fixed login-pages that served mixed content. \n\n##Fix\n\nSecure transport was enabled on www.lahitapiola.fi.\n\n##Reasoning\n\nThe issue was initially dismissed as not critical, as this site only presents public content and the login pages were already fixed. SSL/TLS misconfigurations are mostly treated as out of scope per our policy. Over time, the decision to start moving all content to https for this domains was made (for both security, trust and other reasons). As there was a report regarding this issue already present, we decided to award the reporter with a bounty. As a general policy, we are still quite strict on what SSL/TLS issues will be processed.","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found that \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is not completely using secure transport protocols. This finding was not a surprise, as it was according to business decisions. The report is somewhat related to \u003ca href=\"/reports/146707\"\u003e#146707\u003c/a\u003e, where we fixed login-pages that served mixed content. \u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eSecure transport was enabled on \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe issue was initially dismissed as not critical, as this site only presents public content and the login pages were already fixed. SSL/TLS misconfigurations are mostly treated as out of scope per our policy. Over time, the decision to start moving all content to https for this domains was made (for both security, trust and other reasons). As there was a report regarding this issue already present, we decided to award the reporter with a bounty. As a general policy, we are still quite strict on what SSL/TLS issues will be processed.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}