{"id":78260,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODI2MA==","url":"https://hackerone.com/reports/78260","title":"Stored XSS в имени песни (2) на платёжном гейте.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-24T00:35:07.871Z","submitted_at":"2015-07-24T00:35:07.871Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"4lemon","url":"/4lemon","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1782,"url":"https://hackerone.com/ok","handle":"ok","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/782/0e7098faf92785cddc86bcf693dbb068dad14311_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/782/0e7098faf92785cddc86bcf693dbb068dad14311_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ok.ru","twitter_handle":"","website":"http://ok.ru","about":"Odnoklassniki social network"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-20T16:04:22.093Z","bug_reporter_agreed_on_going_public_at":"2017-02-27T16:05:12.585Z","team_member_agreed_on_going_public_at":"2017-03-20T16:04:22.048Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-29T16:05:12.617Z","allow_singular_disclosure_after":-118421184.7305498,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sp1d3rs","eveeez","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":523245,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-24T00:35:44.803Z","updated_at":"2015-07-24T00:35:44.803Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":548686,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-14T15:18:51.260Z","updated_at":"2015-08-14T15:18:51.260Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":553638,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-18T20:51:58.867Z","updated_at":"2015-08-18T20:51:58.867Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":553661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-18T21:06:00.774Z","updated_at":"2015-08-18T21:06:28.877Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606758,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-02T16:25:39.321Z","updated_at":"2015-10-02T16:25:39.321Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606827,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-02T17:06:48.059Z","updated_at":"2015-10-02T17:06:48.059Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":712782,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-08T13:22:38.746Z","updated_at":"2015-12-08T13:22:38.746Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":712848,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-08T15:07:38.670Z","updated_at":"2015-12-08T15:07:38.670Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":714066,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-09T10:43:23.381Z","updated_at":"2015-12-09T10:43:23.381Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":714086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-09T10:47:54.829Z","updated_at":"2015-12-09T10:47:54.829Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":714092,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-09T10:50:59.160Z","updated_at":"2015-12-09T10:50:59.160Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1078160,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-20T15:09:21.655Z","updated_at":"2016-07-20T15:09:21.655Z","actor":{"url":"/ok","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/782/0e7098faf92785cddc86bcf693dbb068dad14311_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ok.ru"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ok","collaborator":{"username":"4lemon","url":"/4lemon"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1078167,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-20T15:14:50.281Z","updated_at":"2016-07-20T15:14:50.281Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1177721,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-06T16:28:35.674Z","updated_at":"2016-09-06T16:28:35.674Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"4lemon","url":"/4lemon"},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1508669,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T16:05:12.602Z","updated_at":"2017-02-27T16:05:12.602Z","first_to_agree":true,"actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1552540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-20T16:03:56.008Z","updated_at":"2017-03-20T16:03:56.008Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1552541,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-20T16:04:22.071Z","updated_at":"2017-03-20T16:04:22.071Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1552542,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-20T16:04:22.143Z","updated_at":"2017-03-20T16:04:22.143Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3598,"category":"team","content":"4lemon прислал способ эксплуатации хранимой XSS, использующий комбинацию уязвимостей сервиса покупки музыки в Одноклассниках:\n\n\u003e Я уже описывал как сделать песню с опасными тэгами в предыдущем репорте. Нашлось, где это можно использывать ещё. Причём в данном случае эксплуатация на порядок проще.\n\n\u003e 1. Открываем http://ok.ru/gifts\n\u003e 2. Кликаем любой подарок\n\u003e 3.Выбираем кому дарить (можно самому себе), это абсолютно не важно.\n\u003e 4. На следующем экране кликаем \"добавить песню\". При выборе \"моя музыка\" систем говорит, что нету таких песен, которые можно добавить.\n\u003e 5. Выбираем любую - дальше магия - в burp proxy выбираем \"перехватывать все запросы\" - и после нажатия кнопки \"добавить\", в перехаченом запросе, изменяем id трэка на наш (122884868317642), заряженный трэк. (Кстати, в итоге, получается что можно добавить любой трэк из системы, что, по всей видимости, тоже является логической ошибкой) 5.1 Отравляем запрос дальше.\n\u003e 6. Происходит каскад редиректов. И срабатывает XSS\n\u003e Самое интересное, что если достать из прокси запрос к paymentnew.ok.ru то в нём уже есть вся необходимая инфа и открытие этой ссылки не привязано к сессии пользователя его создавшего, таким образом, можно атаковать любого пользователя (для примера открыл эту ссылку в другом браузере).\n\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e4lemon прислал способ эксплуатации хранимой XSS, использующий комбинацию уязвимостей сервиса покупки музыки в Одноклассниках:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eЯ уже описывал как сделать песню с опасными тэгами в предыдущем репорте. Нашлось, где это можно использывать ещё. Причём в данном случае эксплуатация на порядок проще.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eОткрываем \u003ca title=\"http://ok.ru/gifts\" href=\"/redirect?url=http%3A%2F%2Fok.ru%2Fgifts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://ok.ru/gifts\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eКликаем любой подарок\n3.Выбираем кому дарить (можно самому себе), это абсолютно не важно.\u003c/li\u003e\n\u003cli\u003eНа следующем экране кликаем \u0026quot;добавить песню\u0026quot;. При выборе \u0026quot;моя музыка\u0026quot; систем говорит, что нету таких песен, которые можно добавить.\u003c/li\u003e\n\u003cli\u003eВыбираем любую - дальше магия - в burp proxy выбираем \u0026quot;перехватывать все запросы\u0026quot; - и после нажатия кнопки \u0026quot;добавить\u0026quot;, в перехаченом запросе, изменяем id трэка на наш (122884868317642), заряженный трэк. (Кстати, в итоге, получается что можно добавить любой трэк из системы, что, по всей видимости, тоже является логической ошибкой) 5.1 Отравляем запрос дальше.\u003c/li\u003e\n\u003cli\u003eПроисходит каскад редиректов. И срабатывает XSS\nСамое интересное, что если достать из прокси запрос к paymentnew.ok.ru то в нём уже есть вся необходимая инфа и открытие этой ссылки не привязано к сессии пользователя его создавшего, таким образом, можно атаковать любого пользователя (для примера открыл эту ссылку в другом браузере).\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}