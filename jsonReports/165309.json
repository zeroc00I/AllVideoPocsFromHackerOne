{"id":165309,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjUzMDk=","url":"https://hackerone.com/reports/165309","title":"Subdomain Takeover in http://genghis-cdn.shopify.io/ pointing to Fastly ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-02T15:25:15.655Z","submitted_at":"2016-09-02T15:25:15.655Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"peroni","url":"/peroni","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/146/bc97fcb48703e602e82e5ab47ccf42d1e3f0480a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-06T15:46:49.314Z","bug_reporter_agreed_on_going_public_at":"2016-09-06T15:41:27.082Z","team_member_agreed_on_going_public_at":"2016-09-06T15:46:49.255Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI've found a Shopifu cdn domain here which had an instance of fastly setup but did not remove the dns record when the service was cancelled. a subdomain takeover similar to that of https://hackerone.com/reports/32825 could be possible.\n\nVulnerable URL: http://genghis-cdn.shopify.io\n\nPage Response: \n```\nFastly error: unknown domain: genghis-cdn.shopify.io. Please check that this domain has been added to a service.\n```\n\nWhich indicate that this domain is point to fastly but there is no app in fastly with that name allowing anyone to claim it.\nThe subdomain \"http://genghis-cdn.shopify.io/\" is currently pointing to Fastly (shopify-e.map.fastly.net), but is not registered to a service. \n\n```\n$ host genghis-cdn.shopify.io\ngenghis-cdn.shopify.io is an alias for shopify-e.map.fastly.net.\nshopify-e.map.fastly.net is an alias for prod.shopify-e.map.fastlylb.net.\nprod.shopify-e.map.fastlylb.net has address 151.101.60.108\n```\n\n\nThanks!","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve found a Shopifu cdn domain here which had an instance of fastly setup but did not remove the dns record when the service was cancelled. a subdomain takeover similar to that of \u003ca title=\"https://hackerone.com/reports/32825\" href=\"https://hackerone.com/reports/32825\"\u003ehttps://hackerone.com/reports/32825\u003c/a\u003e could be possible.\u003c/p\u003e\n\n\u003cp\u003eVulnerable URL: \u003ca title=\"http://genghis-cdn.shopify.io\" href=\"/redirect?url=http%3A%2F%2Fgenghis-cdn.shopify.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://genghis-cdn.shopify.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePage Response: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eFastly error: unknown domain: genghis-cdn.shopify.io. Please check that this domain has been added to a service.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich indicate that this domain is point to fastly but there is no app in fastly with that name allowing anyone to claim it.\u003cbr\u003e\nThe subdomain \u0026quot;\u003ca title=\"http://genghis-cdn.shopify.io/\" href=\"/redirect?url=http%3A%2F%2Fgenghis-cdn.shopify.io%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://genghis-cdn.shopify.io/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; is currently pointing to Fastly (shopify-e.map.fastly.net), but is not registered to a service. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ host genghis-cdn.shopify.io\ngenghis-cdn.shopify.io is an alias for shopify-e.map.fastly.net.\nshopify-e.map.fastly.net is an alias for prod.shopify-e.map.fastlylb.net.\nprod.shopify-e.map.fastlylb.net has address 151.101.60.108\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks!\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":19,"voters":["sameoldstory","michiel","nahamsec","ngalog","amad3u6","ayoubfathi_","bugdiscloseguys","dudez","harry_mg","ymy","and 9 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1169922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2016-09-02T15:25:15.921Z","updated_at":"2016-09-02T15:25:15.921Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1170120,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-02T17:01:32.186Z","updated_at":"2016-09-02T17:01:32.186Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1177483,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We have removed the obsolete DNS record.\n\nBecause shopify.io is not in scope for our white hat program, this issue is not eligible for a bounty. Thank you for your interest in improving the security of the Shopify platform!","markdown_message":"\u003cp\u003eThanks again for your report. We have removed the obsolete DNS record.\u003c/p\u003e\n\n\u003cp\u003eBecause shopify.io is not in scope for our white hat program, this issue is not eligible for a bounty. Thank you for your interest in improving the security of the Shopify platform!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-06T14:57:02.592Z","updated_at":"2016-09-06T14:57:02.592Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"peroni","url":"/peroni"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1177553,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey,\n\nThis is totally unfair! but you already resolved and awarded bounties for many reports in shopify.io\n\n that report which even not make sense and not even a security issue was at shardm-reader.chi2.shopify.io : https://hackerone.com/reports/157876\n\nthat report also was at icinga.chi2.shopify.io : https://hackerone.com/reports/143482 \n\nEven if you rate by the \"best impact\" I can't compare that report https://hackerone.com/reports/157876 with mine.\n\nthis not make any sense. Public Disclosure!\n\n\n\n\n","markdown_message":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003eThis is totally unfair! but you already resolved and awarded bounties for many reports in shopify.io\u003c/p\u003e\n\n\u003cp\u003ethat report which even not make sense and not even a security issue was at shardm-reader.chi2.shopify.io : \u003ca title=\"https://hackerone.com/reports/157876\" href=\"https://hackerone.com/reports/157876\"\u003ehttps://hackerone.com/reports/157876\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ethat report also was at icinga.chi2.shopify.io : \u003ca title=\"https://hackerone.com/reports/143482\" href=\"https://hackerone.com/reports/143482\"\u003ehttps://hackerone.com/reports/143482\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eEven if you rate by the \u0026quot;best impact\u0026quot; I can\u0026#39;t compare that report \u003ca title=\"https://hackerone.com/reports/157876\" href=\"https://hackerone.com/reports/157876\"\u003ehttps://hackerone.com/reports/157876\u003c/a\u003e with mine.\u003c/p\u003e\n\n\u003cp\u003ethis not make any sense. Public Disclosure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-06T15:27:17.154Z","updated_at":"2016-09-06T15:41:07.723Z","actor":{"username":"peroni","cleared":false,"url":"/peroni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/146/bc97fcb48703e602e82e5ab47ccf42d1e3f0480a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1177579,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Reports pertaining to out-of-scope systems are considered on a case-by-case basis, and in most cases they are ineligible for a bounty, unless there are significant security implications. In the case of your report, no Shopify systems were exposed at that address and the DNS record was unused, so we have decided that an exception is not warranted.","markdown_message":"\u003cp\u003eReports pertaining to out-of-scope systems are considered on a case-by-case basis, and in most cases they are ineligible for a bounty, unless there are significant security implications. In the case of your report, no Shopify systems were exposed at that address and the DNS record was unused, so we have decided that an exception is not warranted.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-06T15:39:35.360Z","updated_at":"2016-09-06T15:39:35.360Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1177584,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-06T15:41:27.122Z","updated_at":"2016-09-06T15:41:27.122Z","first_to_agree":true,"actor":{"username":"peroni","cleared":false,"url":"/peroni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/146/bc97fcb48703e602e82e5ab47ccf42d1e3f0480a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1177604,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-06T15:46:38.543Z","updated_at":"2016-09-06T15:46:38.543Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1177605,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-06T15:46:49.282Z","updated_at":"2016-09-06T15:46:49.282Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1177606,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-06T15:46:49.362Z","updated_at":"2016-09-06T15:46:49.362Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1177709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\"case-by-case basis\" ? Okay. I hope readers could compare that report with this one https://hackerone.com/reports/32825 .\n\nhttps://media.giphy.com/media/3o7qDSOvfaCO9b3MlO/giphy.gif\n\nHave a nice day!","markdown_message":"\u003cp\u003e\u0026quot;case-by-case basis\u0026quot; ? Okay. I hope readers could compare that report with this one \u003ca title=\"https://hackerone.com/reports/32825\" href=\"https://hackerone.com/reports/32825\"\u003ehttps://hackerone.com/reports/32825\u003c/a\u003e .\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://media.giphy.com/media/3o7qDSOvfaCO9b3MlO/giphy.gif\" href=\"/redirect?url=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2F3o7qDSOvfaCO9b3MlO%2Fgiphy.gif\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://media.giphy.com/media/3o7qDSOvfaCO9b3MlO/giphy.gif\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHave a nice day!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-06T16:23:37.560Z","updated_at":"2016-09-06T16:23:37.560Z","actor":{"username":"peroni","cleared":false,"url":"/peroni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/146/bc97fcb48703e602e82e5ab47ccf42d1e3f0480a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}