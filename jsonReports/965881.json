{"id":965881,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjU4ODE=","url":"https://hackerone.com/reports/965881","title":"Null dereference in `cmd_denotify_operation_execute`","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2020-08-24T14:31:45.066Z","submitted_at":"2020-08-24T14:31:45.161Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"catenacyber","url":"/catenacyber","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-27T11:20:24.722Z","bug_reporter_agreed_on_going_public_at":"2020-08-27T11:20:24.673Z","team_member_agreed_on_going_public_at":"2020-08-27T06:00:24.186Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"To reproduce, run test suite on following input :\n```\nrequire \"vnd.dovecot.testsuite\";\nrequire \"notify\";\nrequire \"envelope\";\ntest \"D Middle\" {\t/**/\n\tnotify\n:options \"timo@exat\";\n\n\tdenotify :is \"noot\";\n\n\tif not test_result_execute {\n\t\ttest_fail \"fat\";\n\t}\n}\n\n```\n\nOutput is with (ASAN enabled) stack trace\n```\nAddressSanitizer:DEADLYSIGNAL\n=================================================================\n==33277==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7fff60f5f232 bp 0x7ffee1c8d320 sp 0x7ffee1c8d320 T0)\n==33277==The signal is caused by a READ memory access.\n==33277==Hint: address points to the zero page.\n    #0 0x7fff60f5f231 in strlen (libsystem_c.dylib:x86_64+0x1231)\n    #1 0x10e771fc8 in wrap_strlen (libclang_rt.asan_osx_dynamic.dylib:x86_64h+0x15fc8)\n    #2 0x10e17bae7 in cmd_denotify_operation_execute cmd-denotify.c:356\n    #3 0x10e0d75dd in sieve_interpreter_operation_execute sieve-interpreter.c:899\n    #4 0x10e0d6fee in sieve_interpreter_continue sieve-interpreter.c:940\n    #5 0x10e0d7bc6 in sieve_interpreter_start sieve-interpreter.c:1012\n    #6 0x10df8ccee in testsuite_run fuzz_testsuite.c:60\n\n```\n\n## Impact\n\nA null pointer dereference should crash the program","vulnerability_information_html":"\u003cp\u003eTo reproduce, run test suite on following input :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erequire \u0026quot;vnd.dovecot.testsuite\u0026quot;;\nrequire \u0026quot;notify\u0026quot;;\nrequire \u0026quot;envelope\u0026quot;;\ntest \u0026quot;D Middle\u0026quot; {   /**/\n    notify\n:options \u0026quot;timo@exat\u0026quot;;\n\n    denotify :is \u0026quot;noot\u0026quot;;\n\n    if not test_result_execute {\n        test_fail \u0026quot;fat\u0026quot;;\n    }\n}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOutput is with (ASAN enabled) stack trace\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eAddressSanitizer:DEADLYSIGNAL\n=================================================================\n==33277==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7fff60f5f232 bp 0x7ffee1c8d320 sp 0x7ffee1c8d320 T0)\n==33277==The signal is caused by a READ memory access.\n==33277==Hint: address points to the zero page.\n    #0 0x7fff60f5f231 in strlen (libsystem_c.dylib:x86_64+0x1231)\n    #1 0x10e771fc8 in wrap_strlen (libclang_rt.asan_osx_dynamic.dylib:x86_64h+0x15fc8)\n    #2 0x10e17bae7 in cmd_denotify_operation_execute cmd-denotify.c:356\n    #3 0x10e0d75dd in sieve_interpreter_operation_execute sieve-interpreter.c:899\n    #4 0x10e0d6fee in sieve_interpreter_continue sieve-interpreter.c:940\n    #5 0x10e0d7bc6 in sieve_interpreter_start sieve-interpreter.c:1012\n    #6 0x10df8ccee in testsuite_run fuzz_testsuite.c:60\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA null pointer dereference should crash the program\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":51,"name":"NULL Pointer Dereference"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":42900,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/dovecot/pigeonhole","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9043625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug is caused by executing the deprecated denotify command with an ID match while an earlier deprecated notify command was executed without an ID. The attempt to match a NULL ID causes a segmentation fault. This bug has low impact, since only the user can trigger this for his own delivery by writing a Sieve script structured like this and the \"notify\" extension is deprecated and not likely used much anymore.\n\nI have a fix.","markdown_message":"\u003cp\u003eThis bug is caused by executing the deprecated denotify command with an ID match while an earlier deprecated notify command was executed without an ID. The attempt to match a NULL ID causes a segmentation fault. This bug has low impact, since only the user can trigger this for his own delivery by writing a Sieve script structured like this and the \u0026quot;notify\u0026quot; extension is deprecated and not likely used much anymore.\u003c/p\u003e\n\n\u003cp\u003eI have a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-26T10:49:34.162Z","updated_at":"2020-08-26T10:49:34.162Z","actor":{"username":"sbosch","cleared":false,"url":"/sbosch","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9050969,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T05:33:18.961Z","updated_at":"2020-08-27T05:33:18.961Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9051121,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T05:57:52.767Z","updated_at":"2020-08-27T05:57:52.767Z","additional_data":{"old_severity":"Medium (4.4)","new_severity":"None","old_severity_id":827203,"new_severity_id":829998},"actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9051146,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is not a security issue, and we thank you for taking time to report this to us. We will fix this bug eventually.","markdown_message":"\u003cp\u003eThis is not a security issue, and we thank you for taking time to report this to us. We will fix this bug eventually.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-27T05:59:46.466Z","updated_at":"2020-08-27T05:59:46.466Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"catenacyber","url":"/catenacyber"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9051154,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T06:00:14.969Z","updated_at":"2020-08-27T06:00:14.969Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"catenacyber","url":"/catenacyber"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9051155,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T06:00:24.211Z","updated_at":"2020-08-27T06:00:24.211Z","first_to_agree":true,"actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9053395,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T11:20:24.694Z","updated_at":"2020-08-27T11:20:24.694Z","actor":{"username":"catenacyber","cleared":false,"url":"/catenacyber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9053396,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T11:20:24.752Z","updated_at":"2020-08-27T11:20:24.752Z","actor":{"username":"catenacyber","cleared":false,"url":"/catenacyber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}