{"id":35287,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTI4Nw==","url":"https://hackerone.com/reports/35287","title":"getting emails of users/removing them from victims account [using typical attack]","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-11-12T13:04:55.177Z","submitted_at":"2014-11-12T13:04:55.177Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"akhil-reni","url":"/akhil-reni","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-03-13T04:17:05.335Z","bug_reporter_agreed_on_going_public_at":"2015-03-13T04:17:04.736Z","team_member_agreed_on_going_public_at":"2015-03-12T19:41:06.521Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey Hi, \r\n\r\nI would like to explain a typical type of attack combined with a brute force attack leading to email disclosure. \r\nconditions : should be having email notifications ON .\r\n\r\nEvery time someone follows me , favs my tweet i get a notification on my email, and the footer of the email . click here if this email is not signed up.\r\n\r\nhttps://twitter.com/account/not_my_account/[account_name]/D26H5-DAH4C-141579\r\n\r\nEvery notification email has a different unique Code.\r\nBut the probability of getting the right is very LOW.\r\nBut when we send 1000 email notifications to the victim(by fav and un-fav continuously on a particular tweet )  \r\nthe probability decreases a bit, and when the email notifications are increased the probability of getting the right code gets HIGH!\r\n\r\nchances of getting the right code ∝ number of notification emails.\r\n\r\nThis whole process can be simply automated using PHP or python, making it more easy.\r\n\r\nFaults in the system:\r\n\r\n1) a unique code is generated every time, 5 secs 5 notification emails = 5 different codes.\r\n      Fix suggested: The code generated should be the same for like next 1 hour\r\n\r\n2)  The code doesn't expire.  i dig'd into one of my old twitter notification emails and seen that the code is still active.\r\n        Fix suggested : Expire tokens ASAP!\r\n\r\n3)  Getting the right discloses the email. whenever i get the right code, the email is disclosed.\r\n              For example: for username @test entering the right code discloses\r\n              \"If you did not sign up for the Twitter account \"test\", please confirm so that we may remove your                  email address test@gmail.com from this account. \"\r\n      Fix suggested : use *** instead\r\nsomething like te****@gmail.com\r\n\r\n4) if a user removes an email , the code should immediately  get expired .\r\n    if we hit the right code it still discloses the old email.\r\nsomething like this:\r\n\"Your email has been removed.\r\nYour email (test@live.com) has been removed from the Twitter account \"test\".\r\n\r\nYou will no longer receive Twitter notifications intended for this account.\"\r\n\r\n\r\nThanks,\r\nKarthik\r\nwesecureapp","vulnerability_information_html":"\u003cp\u003eHey Hi, \u003c/p\u003e\n\n\u003cp\u003eI would like to explain a typical type of attack combined with a brute force attack leading to email disclosure. \u003cbr\u003e\nconditions : should be having email notifications ON .\u003c/p\u003e\n\n\u003cp\u003eEvery time someone follows me , favs my tweet i get a notification on my email, and the footer of the email . click here if this email is not signed up.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://twitter.com/account/not_my_account/%5Baccount_name%5D/D26H5-DAH4C-141579\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Faccount%2Fnot_my_account%2F%255Baccount_name%255D%2FD26H5-DAH4C-141579\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/account/not_my_account/%5Baccount_name%5D/D26H5-DAH4C-141579\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eEvery notification email has a different unique Code.\u003cbr\u003e\nBut the probability of getting the right is very LOW.\u003cbr\u003e\nBut when we send 1000 email notifications to the victim(by fav and un-fav continuously on a particular tweet )\u003cbr\u003e\u003cbr\u003e\nthe probability decreases a bit, and when the email notifications are increased the probability of getting the right code gets HIGH!\u003c/p\u003e\n\n\u003cp\u003echances of getting the right code ∝ number of notification emails.\u003c/p\u003e\n\n\u003cp\u003eThis whole process can be simply automated using PHP or python, making it more easy.\u003c/p\u003e\n\n\u003cp\u003eFaults in the system:\u003c/p\u003e\n\n\u003cp\u003e1) a unique code is generated every time, 5 secs 5 notification emails = 5 different codes.\u003cbr\u003e\n      Fix suggested: The code generated should be the same for like next 1 hour\u003c/p\u003e\n\n\u003cp\u003e2)  The code doesn\u0026#39;t expire.  i dig\u0026#39;d into one of my old twitter notification emails and seen that the code is still active.\u003cbr\u003e\n        Fix suggested : Expire tokens ASAP!\u003c/p\u003e\n\n\u003cp\u003e3)  Getting the right discloses the email. whenever i get the right code, the email is disclosed.\u003cbr\u003e\n              For example: for username \u003ca href=\"/test\"\u003e@test\u003c/a\u003e entering the right code discloses\u003cbr\u003e\n              \u0026quot;If you did not sign up for the Twitter account \u0026quot;test\u0026quot;, please confirm so that we may remove your                  email address \u003ca title=\"test@gmail.com\" href=\"mailto:test@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003etest@gmail.com\u003c/a\u003e from this account. \u0026quot;\u003cbr\u003e\n      Fix suggested : use *** instead\u003cbr\u003e\nsomething like te****@gmail.com\u003c/p\u003e\n\n\u003cp\u003e4) if a user removes an email , the code should immediately  get expired .\u003cbr\u003e\n    if we hit the right code it still discloses the old email.\u003cbr\u003e\nsomething like this:\u003cbr\u003e\n\u0026quot;Your email has been removed.\u003cbr\u003e\nYour email (\u003ca title=\"test@live.com\" href=\"mailto:test@live.com\" rel=\"nofollow noopener noreferrer\"\u003etest@live.com\u003c/a\u003e) has been removed from the Twitter account \u0026quot;test\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eYou will no longer receive Twitter notifications intended for this account.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nKarthik\u003cbr\u003e\nwesecureapp\u003c/p\u003e\n","bounty_amount":"140.0","formatted_bounty":"$140","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-04-11T19:41:07.311Z","allow_singular_disclosure_after":-180439222.68809795,"singular_disclosure_allowed":true,"vote_count":2,"voters":["dudez","eveeez"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":159352,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello, and thank you for the report.\n\nI will look into this a bit further, but the token is tied to the account that you specify in [account_name], as well as a timestamp from when the token is generated (why we you notice that a new one is generated with each request).\n\nCould you perhaps show a working proof-of-concept, or try to for a test account like “jimio74” to deduce the associated email address? We believe that the difficulty in crawlability/discoverability of these links to be sufficient for protecting the information displayed on the page; however, I’ll also look into the obfuscation (t****@gmail.com) as you suggest, and can change this report's resolution if we end up making any changes.\n\nthanks!","markdown_message":"\u003cp\u003eHello, and thank you for the report.\u003c/p\u003e\n\n\u003cp\u003eI will look into this a bit further, but the token is tied to the account that you specify in [account_name], as well as a timestamp from when the token is generated (why we you notice that a new one is generated with each request).\u003c/p\u003e\n\n\u003cp\u003eCould you perhaps show a working proof-of-concept, or try to for a test account like “jimio74” to deduce the associated email address? We believe that the difficulty in crawlability/discoverability of these links to be sufficient for protecting the information displayed on the page; however, I’ll also look into the obfuscation (t****@gmail.com) as you suggest, and can change this report\u0026#39;s resolution if we end up making any changes.\u003c/p\u003e\n\n\u003cp\u003ethanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-13T05:14:29.388Z","updated_at":"2014-11-13T05:14:29.388Z","actor":{"username":"jimio","cleared":false,"url":"/jimio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/734/78744d51291d123ab5043159d56fd0f228b782b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161877,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"hey hi,\n\nYes, Every time a new token is generated and the old one doesn't expire.\nMaking a change like using asterisks  is really a good idea,\ncause email id is some sensitive information(sometimes can retrieve  from browser history )  :)\nWhats your call? \n\n\nRegards,\nKarthik","markdown_message":"\u003cp\u003ehey hi,\u003c/p\u003e\n\n\u003cp\u003eYes, Every time a new token is generated and the old one doesn\u0026#39;t expire.\u003cbr\u003e\nMaking a change like using asterisks  is really a good idea,\u003cbr\u003e\ncause email id is some sensitive information(sometimes can retrieve  from browser history )  :)\u003cbr\u003e\nWhats your call? \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nKarthik\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T12:39:56.380Z","updated_at":"2014-11-17T12:39:56.380Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":162681,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T20:52:56.940Z","updated_at":"2014-11-17T20:52:56.940Z","actor":{"username":"jimio","cleared":false,"url":"/jimio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/734/78744d51291d123ab5043159d56fd0f228b782b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":166312,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\n3 \u0026 4 on your list were the only issues that we considered fixing. 1 \u0026 2 are sufficiently protected due to the nature in which tokens are generated.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003e3 \u0026amp; 4 on your list were the only issues that we considered fixing. 1 \u0026amp; 2 are sufficiently protected due to the nature in which tokens are generated.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-22T04:36:34.199Z","updated_at":"2014-11-22T04:43:53.013Z","actor":{"username":"jimio","cleared":false,"url":"/jimio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/734/78744d51291d123ab5043159d56fd0f228b782b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"akhil-reni","url":"/akhil-reni"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":166334,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Seems fixed :) \n","markdown_message":"\u003cp\u003eSeems fixed :) \u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-22T06:30:30.993Z","updated_at":"2014-11-22T06:30:30.993Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":166867,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","markdown_message":"\u003cp\u003eThanks again for helping us keep Twitter safe and secure for our users!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-23T22:11:10.681Z","updated_at":"2014-11-23T22:11:10.681Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"140.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"akhil-reni","url":"/akhil-reni"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":352553,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks again. Let's disclose this publicly.","markdown_message":"\u003cp\u003eThanks again. Let\u0026#39;s disclose this publicly.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-12T19:41:06.699Z","updated_at":"2015-03-12T19:41:06.699Z","first_to_agree":true,"actor":{"username":"jintwitter","cleared":false,"url":"/jintwitter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":353191,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Not the best of ones :)","markdown_message":"\u003cp\u003eNot the best of ones :)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-13T04:17:04.891Z","updated_at":"2015-03-13T04:17:04.891Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":353192,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-13T04:17:05.394Z","updated_at":"2015-03-13T04:17:05.394Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}