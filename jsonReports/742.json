{"id":742,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDI=","url":"https://hackerone.com/reports/742","title":"A password reset page does not properly validate the authenticity token at the server side.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-01-17T14:53:50.225Z","submitted_at":"2014-01-17T14:53:50.225Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"niks","url":"/niks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/238/f5315570129ace98832cd975d52d91427afa8527_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-04-19T20:59:39.929Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-04-19T20:59:39.632Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. Go to https://hackerone.com/users/password/new and request a new password.\r\n2. go to email, and click on the link.\r\n3. put the new password, submit and intercept the request; remove the authenticity token from the request and now forward it to the server.\r\n4. you will see request still got completed and user logged in. The token did not verify on the server side.","vulnerability_information_html":"\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://hackerone.com/users/password/new\" href=\"https://hackerone.com/users/password/new\"\u003ehttps://hackerone.com/users/password/new\u003c/a\u003e and request a new password.\u003c/li\u003e\n\u003cli\u003ego to email, and click on the link.\u003c/li\u003e\n\u003cli\u003eput the new password, submit and intercept the request; remove the authenticity token from the request and now forward it to the server.\u003c/li\u003e\n\u003cli\u003eyou will see request still got completed and user logged in. The token did not verify on the server side.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-02-20T00:37:23.881Z","allow_singular_disclosure_after":-216367664.8802272,"singular_disclosure_allowed":true,"vote_count":3,"voters":["bobrov","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3807,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"hey niks - Sorry man, but we don't think these are bugs. The CSRF protection for Rails works by calling `reset_session` if validation fails. For logged-out users, this has no effect, as you'd expect. This is a reasonable system as exploiting CSRF against logged-out users does not present any security risks in almost all contexts. Unless there's some specific security implication that we've overlooked, we're going to treat the lack of CSRF enforcement when there's no active session as intentional and not a bug. Thanks, good luck on the next find!","markdown_message":"\u003cp\u003ehey niks - Sorry man, but we don\u0026#39;t think these are bugs. The CSRF protection for Rails works by calling \u003ccode\u003ereset_session\u003c/code\u003e if validation fails. For logged-out users, this has no effect, as you\u0026#39;d expect. This is a reasonable system as exploiting CSRF against logged-out users does not present any security risks in almost all contexts. Unless there\u0026#39;s some specific security implication that we\u0026#39;ve overlooked, we\u0026#39;re going to treat the lack of CSRF enforcement when there\u0026#39;s no active session as intentional and not a bug. Thanks, good luck on the next find!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-18T09:25:01.366Z","updated_at":"2014-01-18T09:25:01.366Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3817,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But in this particular case, after resetting the password, the application directly logged the user into session, this is likely same issue reported by  https://hackerone.com/reports/547 here, the difference is, i have reported the same issue with csrf not enforced properly, a step ahead than that issue. will you explain?\nthanks. ","markdown_message":"\u003cp\u003eBut in this particular case, after resetting the password, the application directly logged the user into session, this is likely same issue reported by  \u003ca title=\"https://hackerone.com/reports/547\" href=\"https://hackerone.com/reports/547\"\u003ehttps://hackerone.com/reports/547\u003c/a\u003e here, the difference is, i have reported the same issue with csrf not enforced properly, a step ahead than that issue. will you explain?\u003cbr\u003e\nthanks. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-18T09:49:16.206Z","updated_at":"2014-01-18T09:49:16.206Z","actor":{"username":"niks","cleared":false,"url":"/niks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/238/f5315570129ace98832cd975d52d91427afa8527_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3873,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Okay, okay. :) We've had quite a few people notice that our CSRF validation doesn't enforce against sessionless users. This was an intentional decision, and is actually the default behavior in Rails. We just ended up changing this behavior when someone pointed out another concern that made us reconsider. Even though this is technically a duplicate report, we're going to go ahead and reward a small bounty since we ended up changing the behavior. Thanks for the patience with us Nikhil!","markdown_message":"\u003cp\u003eOkay, okay. :) We\u0026#39;ve had quite a few people notice that our CSRF validation doesn\u0026#39;t enforce against sessionless users. This was an intentional decision, and is actually the default behavior in Rails. We just ended up changing this behavior when someone pointed out another concern that made us reconsider. Even though this is technically a duplicate report, we\u0026#39;re going to go ahead and reward a small bounty since we ended up changing the behavior. Thanks for the patience with us Nikhil!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-21T00:37:24.012Z","updated_at":"2014-01-21T00:37:24.012Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"niks","url":"/niks"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3874,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-01-21T00:37:31.493Z","updated_at":"2014-01-21T00:37:31.493Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"niks","url":"/niks"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3877,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks arice","markdown_message":"\u003cp\u003eThanks arice\u003c/p\u003e\n","automated_response":false,"created_at":"2014-01-21T03:32:44.466Z","updated_at":"2014-01-21T03:32:44.466Z","actor":{"username":"niks","cleared":false,"url":"/niks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/238/f5315570129ace98832cd975d52d91427afa8527_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":33281,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-19T20:59:39.652Z","updated_at":"2014-04-19T20:59:39.652Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":33282,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-19T20:59:39.945Z","updated_at":"2014-04-19T20:59:39.945Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}