{"id":291012,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTEwMTI=","url":"https://hackerone.com/reports/291012","title":"Server-side cache poisoning leads to the http://my.dev.owox.com inaccessibility","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-11-16T21:14:26.878Z","submitted_at":"2017-11-16T21:14:26.878Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":12633,"url":"https://hackerone.com/owox","handle":"owox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/633/b14ae8476ac40405c091161f2338c091b5fecdc4_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/633/b14ae8476ac40405c091161f2338c091b5fecdc4_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OWOX, Inc.","twitter_handle":"owoxbi","website":"https://bi.owox.com","about":"Get more advantages from Google Analytics and complete control over your data in Google BigQuery"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-23T14:58:37.708Z","bug_reporter_agreed_on_going_public_at":"2017-11-23T13:30:02.928Z","team_member_agreed_on_going_public_at":"2017-11-23T14:58:37.568Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-12-23T13:30:03.092Z","allow_singular_disclosure_after":-95183715.08837159,"singular_disclosure_allowed":true,"vote_count":15,"voters":["jensec","th3r0ck","flashdisk","edoverflow","eveeez","an0nym0us","bountyoverflow","shepard","whitesector","alfredsaonoy","and 5 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2163698,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-16T21:22:51.853Z","updated_at":"2017-11-16T21:22:51.853Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165274,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T14:41:46.448Z","updated_at":"2017-11-17T14:41:46.448Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165615,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T16:16:37.934Z","updated_at":"2017-11-17T16:16:37.934Z","actor":{"username":"aldoshyna","cleared":false,"url":"/aldoshyna","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165617,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T16:18:15.648Z","updated_at":"2017-11-17T16:18:15.648Z","actor":{"username":"aldoshyna","cleared":false,"url":"/aldoshyna","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165620,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-17T16:20:03.521Z","updated_at":"2017-11-17T16:20:03.521Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2178966,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-23T13:30:03.006Z","updated_at":"2017-11-23T13:30:03.006Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2179171,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-23T14:58:37.586Z","updated_at":"2017-11-23T14:58:37.586Z","actor":{"username":"m_ostapenko","cleared":false,"url":"/m_ostapenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2179172,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-23T14:58:37.726Z","updated_at":"2017-11-23T14:58:37.726Z","actor":{"username":"m_ostapenko","cleared":false,"url":"/m_ostapenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5943,"category":"team","content":"By using single specially crafted URL, it was possible to cause service inaccessibility for all users who will visit the site, as result of infinite redirect loop.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eBy using single specially crafted URL, it was possible to cause service inaccessibility for all users who will visit the site, as result of infinite redirect loop.\u003c/p\u003e\n"},{"id":5941,"category":"researcher","content":"I discovered an issue, when by using single specially crafted URL, it was possible to cause service inaccessibility for all users who will visit the site, as result of infinite redirect loop.\nI named it as cache poisoning in the report title, but honestly i have no idea what caused this behavior:) It could be cache or proxy bug.\nTo ensure that problem exists, and site inaccessible not only for me, i checked it from the different IP addresses/proxies/Tor.\nIssue was discovered occasionally, upon checking for Open Redirects and was reported in a few minutes after discovery.\nSeverity was set accordingly to CVSS3.\n\n##POC\n1) Visit next link:\n```\nhttp://my.dev.owox.com//www.google.com/%2e%2e%2f\n```\n2) my.dev.owox.com will become inaccessible to the all users with next response:\n```\nHTTP/1.1 301 Moved Permanently\nServer: nginx\nDate: Thu, 16 Nov 2017 21:05:45 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nLocation: http://my.dev.owox.com//www.google.com/%2e%2e%2f/\nX-Frame-Options: SAMEORIGIN\n```\nand will go to the constant redirect loop for the any user who will visit the site.\n\nThe OWOX team fixed the issue very fast, i even thought that it was a false-positive (cuz i couldn't reproduce issue after 1hr), and self-closed the report:)\nThanks to the team for the fast fix and great experience!\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eI discovered an issue, when by using single specially crafted URL, it was possible to cause service inaccessibility for all users who will visit the site, as result of infinite redirect loop.\u003cbr\u003e\nI named it as cache poisoning in the report title, but honestly i have no idea what caused this behavior:) It could be cache or proxy bug.\u003cbr\u003e\nTo ensure that problem exists, and site inaccessible not only for me, i checked it from the different IP addresses/proxies/Tor.\u003cbr\u003e\nIssue was discovered occasionally, upon checking for Open Redirects and was reported in a few minutes after discovery.\u003cbr\u003e\nSeverity was set accordingly to CVSS3.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\n\u003cp\u003e1) Visit next link:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://my.dev.owox.com//www.google.com/%2e%2e%2f\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2) my.dev.owox.com will become inaccessible to the all users with next response:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 301 Moved Permanently\nServer: nginx\nDate: Thu, 16 Nov 2017 21:05:45 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nLocation: http://my.dev.owox.com//www.google.com/%2e%2e%2f/\nX-Frame-Options: SAMEORIGIN\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand will go to the constant redirect loop for the any user who will visit the site.\u003c/p\u003e\n\n\u003cp\u003eThe OWOX team fixed the issue very fast, i even thought that it was a false-positive (cuz i couldn\u0026#39;t reproduce issue after 1hr), and self-closed the report:)\u003cbr\u003e\nThanks to the team for the fast fix and great experience!\u003c/p\u003e\n"}]}