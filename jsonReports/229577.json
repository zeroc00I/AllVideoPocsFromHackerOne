{"id":229577,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjk1Nzc=","url":"https://hackerone.com/reports/229577","title":"Old password can be new password","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-05-18T09:58:45.364Z","submitted_at":"2017-05-18T09:58:45.364Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"proabiral","url":"/proabiral","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-03T05:07:16.115Z","bug_reporter_agreed_on_going_public_at":"2017-06-03T05:07:16.051Z","team_member_agreed_on_going_public_at":"2017-06-02T09:54:10.718Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Affected Domain:\nhttps://demo.weblate.org/ \n\n### Issue: \nThe sites like Facebook and Google keeps tracks of old password and does not allow user to set password similar to their old passwords.\nHowever in case of demo.weblate.org. It is possible for a user to set new password which is exactly similar to old passwords. \n\n### Impact:\nThought the impact of the issue is not high, it is always best practice to now allow so. \n\n### Solution:\nThe password history of the user should be tracked and user should not be allowed to set password which are similar to his old passwords.","vulnerability_information_html":"\u003ch3 id=\"affected-domain\"\u003eAffected Domain:\u003c/h3\u003e\n\n\u003cp\u003e\u003ca title=\"https://demo.weblate.org/\" href=\"/redirect?url=https%3A%2F%2Fdemo.weblate.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://demo.weblate.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003ch3 id=\"issue\"\u003eIssue:\u003c/h3\u003e\n\n\u003cp\u003eThe sites like Facebook and Google keeps tracks of old password and does not allow user to set password similar to their old passwords.\u003cbr\u003e\nHowever in case of demo.weblate.org. It is possible for a user to set new password which is exactly similar to old passwords. \u003c/p\u003e\n\n\u003ch3 id=\"impact\"\u003eImpact:\u003c/h3\u003e\n\n\u003cp\u003eThought the impact of the issue is not high, it is always best practice to now allow so. \u003c/p\u003e\n\n\u003ch3 id=\"solution\"\u003eSolution:\u003c/h3\u003e\n\n\u003cp\u003eThe password history of the user should be tracked and user should not be allowed to set password which are similar to his old passwords.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-02T09:54:10.782Z","allow_singular_disclosure_after":-110228991.45031056,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","apapedulimu","m7mdharoun","spetr0x","oblivionx79x","sule"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1684376,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"There is no way to figure out similarity to old password unless storing them in clear text and that we certainly don't want to do. The only thing we could do is comparing to last password as that is the one users enters in the form as well. But why to do that?\n\nHonestly I don't see much reason to enforce any policy on this - when user is changing the password, it's up to him what he wants to use. Also enforcing regular password changes is quite bad idea (see eg. https://arstechnica.com/security/2016/08/frequent-password-changes-are-the-enemy-of-security-ftc-technologist-says/).","markdown_message":"\u003cp\u003eThere is no way to figure out similarity to old password unless storing them in clear text and that we certainly don\u0026#39;t want to do. The only thing we could do is comparing to last password as that is the one users enters in the form as well. But why to do that?\u003c/p\u003e\n\n\u003cp\u003eHonestly I don\u0026#39;t see much reason to enforce any policy on this - when user is changing the password, it\u0026#39;s up to him what he wants to use. Also enforcing regular password changes is quite bad idea (see eg. \u003ca title=\"https://arstechnica.com/security/2016/08/frequent-password-changes-are-the-enemy-of-security-ftc-technologist-says/\" href=\"/redirect?url=https%3A%2F%2Farstechnica.com%2Fsecurity%2F2016%2F08%2Ffrequent-password-changes-are-the-enemy-of-security-ftc-technologist-says%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://arstechnica.com/security/2016/08/frequent-password-changes-are-the-enemy-of-security-ftc-technologist-says/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-18T20:11:25.112Z","updated_at":"2017-05-18T20:11:25.112Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1684923,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Thanks for the quick response.\nI think there is no need to store the old password in plain text. The solution can be implemented even if password is hashed. The hashes of last '3-4' number of password should be stored and every time user tries to change the password, the hash of new password should be checked again hash of old passwords. The new password should only be allowed to set if it's hash does not match old password's hash.\n\nYes, and its up to the user to choose his password but user would definitely use his new password from one of his old password, if allowed to do so.\n\nAdditional Info:\nIn the research paper you provided, the user would change the new password something similar to his old password, if the exact similar old password is not allowed to used. The solution for this is available too. The old password should be first mutated before hashing it and the hash of mutated password should be created. Every time user tries to change password, the hash of new password should be matched against hashes of old password and mutated password.\n\nRegards,\nAbiral","markdown_message":"\u003cp\u003eThanks for the quick response.\u003cbr\u003e\nI think there is no need to store the old password in plain text. The solution can be implemented even if password is hashed. The hashes of last \u0026#39;3-4\u0026#39; number of password should be stored and every time user tries to change the password, the hash of new password should be checked again hash of old passwords. The new password should only be allowed to set if it\u0026#39;s hash does not match old password\u0026#39;s hash.\u003c/p\u003e\n\n\u003cp\u003eYes, and its up to the user to choose his password but user would definitely use his new password from one of his old password, if allowed to do so.\u003c/p\u003e\n\n\u003cp\u003eAdditional Info:\u003cbr\u003e\nIn the research paper you provided, the user would change the new password something similar to his old password, if the exact similar old password is not allowed to used. The solution for this is available too. The old password should be first mutated before hashing it and the hash of mutated password should be created. Every time user tries to change password, the hash of new password should be matched against hashes of old password and mutated password.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAbiral\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-19T02:53:12.911Z","updated_at":"2017-05-19T02:53:12.911Z","actor":{"username":"proabiral","cleared":true,"url":"/proabiral","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1685352,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Still I fail to see why we should avoid this. But as this has been brought several times, it's probably better to implement some policy than discussing this. I've added simple check against current password in https://github.com/WeblateOrg/weblate/commit/a24423e4b70256a906fe763664437bfbca2002d5, but I don't think we should store past passwords. This is really something what stores too much of sensitive data without gaining anything substantial.","markdown_message":"\u003cp\u003eStill I fail to see why we should avoid this. But as this has been brought several times, it\u0026#39;s probably better to implement some policy than discussing this. I\u0026#39;ve added simple check against current password in \u003ca title=\"https://github.com/WeblateOrg/weblate/commit/a24423e4b70256a906fe763664437bfbca2002d5\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWeblateOrg%2Fweblate%2Fcommit%2Fa24423e4b70256a906fe763664437bfbca2002d5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WeblateOrg/weblate/commit/a24423e4b70256a906fe763664437bfbca2002d5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, but I don\u0026#39;t think we should store past passwords. This is really something what stores too much of sensitive data without gaining anything substantial.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-19T08:35:29.065Z","updated_at":"2017-05-19T08:35:29.065Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"proabiral","url":"/proabiral"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1724467,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-02T09:54:10.736Z","updated_at":"2017-06-02T09:54:10.736Z","first_to_agree":true,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1727610,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-03T05:07:16.069Z","updated_at":"2017-06-03T05:07:16.069Z","actor":{"username":"proabiral","cleared":true,"url":"/proabiral","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1727611,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-03T05:07:16.130Z","updated_at":"2017-06-03T05:07:16.130Z","actor":{"username":"proabiral","cleared":true,"url":"/proabiral","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}