{"id":438306,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzgzMDY=","url":"https://hackerone.com/reports/438306","title":"Accidental Access to Programs Information via SAML Login","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-11-09T17:45:13.041Z","submitted_at":"2018-11-09T17:45:13.041Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"npbhatter17","url":"/npbhatter17","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-14T18:24:09.268Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-11-14T18:23:49.187Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-12-14T18:23:49.255Z","allow_singular_disclosure_after":-64409660.20403497,"singular_disclosure_allowed":true,"vote_count":32,"voters":["dyuen","jobert","muon4","sameerphad72","teknogeek","nahoragg","mygf","yuvraj_dighe","yipman","dudez","and 22 more..."],"severity":{"rating":"critical","score":9.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3618767,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-09T18:01:45.671Z","updated_at":"2018-11-09T18:02:05.382Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3619613,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-09T18:30:27.081Z","updated_at":"2018-11-09T18:30:27.081Z","actor":{"username":"npbhatter17","cleared":false,"url":"/npbhatter17","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3638680,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-14T01:34:03.987Z","updated_at":"2018-11-14T01:34:03.987Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"npbhatter17","url":"/npbhatter17"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3638681,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-14T01:34:08.535Z","updated_at":"2018-11-14T01:47:36.302Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3644445,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-14T18:23:49.207Z","updated_at":"2018-11-14T18:23:49.207Z","first_to_agree":true,"actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3644447,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-14T18:24:09.156Z","updated_at":"2018-11-14T18:24:09.156Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3644929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-14T20:11:16.407Z","updated_at":"2018-11-14T20:11:16.407Z","actor":{"username":"npbhatter17","cleared":false,"url":"/npbhatter17","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3659302,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-16T18:09:14.643Z","updated_at":"2018-11-16T18:09:14.643Z","actor":{"username":"npbhatter17","cleared":false,"url":"/npbhatter17","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3736492,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T01:31:11.653Z","updated_at":"2018-11-30T01:31:11.653Z","additional_data":{},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":11714,"category":"team","content":"On November 8th, 2018, HackerOne released software to production that contained a bug which impacted our Security Assertion Markup Language (SAML) authentication system. As a result of the bug, the SAML JIT (Just-In-Time) provisioning mechanism granted users of one customer program read-only access to another customer program. Users who signed in after the software code was pushed into production were inadvertently added as users to 12 other customer programs. The scope of this faulty software behavior was 12 customer programs and 34 user accounts of customers.\n\n# Timeline\n\n| **Date**   | **Time (PST)** | **Action**                                                              |\n|------------|----------------|-------------------------------------------------------------------------|\n| 2018-11-08 | 12:48 PM       | Software containing bug deployed to production                      |\n| 2018-11-08 | 1:08 PM        | HackerOne’s engineering team is informed of unexpected program memberships |\n| 2018-11-08 | 1:17 PM        | SAML JIT provisioning disabled for all customers                        |\n| 2018-11-08 | 1:31 PM        | HackerOne maintenance mode enabled, disabling all unauthorized access   |\n| 2018-11-08 | 1:51 PM        | Unauthorized program memberships removed                                |\n| 2018-11-08 | 2:52 PM        | HackerOne restored to normal functionality                              |\n| 2018-11-08 | 10:00 PM        | All customers and users involved are notified of the incident           |\n\n# Impacted Data\nBetween 12:48 PM and 1:31 PM PST on November 8th, 2018, 34 employees of HackerOne customers had access to certain program details in one or more programs other than their own. A total of 12 customer programs and 34 customer user accounts were involved.\n\nDuring that time, the users had read-only permissions which gave them access to reports (titles, vulnerability information) as well as some program details, such as common responses and dashboards. Seven programs had vulnerability reports viewed by unauthorized employees. Four programs had their inboxes viewed, which disclosed report states, titles, issue tracker references, reporter, assignee, and when the report was last updated. However, for those four programs, no vulnerability descriptions were accessed. One impacted program had no data accessed at all. Impacted customers were notified as to what pieces of data were accessed.\n\nCustomers’ employees were also impacted. There were 34 customer usernames and email addresses that were shared with other customers without their authorization as they were added to customer programs. These individuals were notified regarding this unintended access.\n\n**If your data was accessed during this incident, you have received a separate notification from HackerOne.**\n\n# Root Cause\nA refactor of the SAML JIT provisioning code path incorrectly scoped a data query that resulted in returning the affected programs. When a user authenticated via SAML after the software containing the bug was released, they were immediately added to at least one of the affected programs. The user was not assigned to any permission groups within the program, giving them the default “read-only” access that allows them to view program details, reports and make internal comments.\n\n# Resolution and Recovery\nAt 1:08 PM PST, the engineering on-call duty was notified of unexpected users being added to programs. At that time an incident response team identified that a release at 12:48 PM PST included a change to SAML JIT provisioning. At 1:17 PM PST, the team decided to disable the SAML JIT provisioning system to reduce the impact of the issue.\n\nBy 1:31 PM PST, the incident team decided to put production into maintenance mode in order to safely investigate the extent of the unauthorized access. HackerOne customers that signed in after the code release were inadvertently added to 12 other programs. A total of 34 customer user accounts were involved, and each was added to the 12 programs impacted. At 1:51 PM PST, all changes as a result of the bug were reverted.\n\nBefore restoring full functionality, the incident team investigated the extent of the impact to identify what unauthorized access occurred as well as what personal user data was exposed. Once the investigation was complete, the site was restored to full functionality at 2:52 PM PST. At this time, SAML JIT provisioning is disabled until the feature has undergone a further review.\n\nThis was not eligible for a bounty, as the HackerOne team was first to identify the issue.\n\n# Preventative Measures \nAs part of our incident response process, we are conducting an internal review and analysis of the incident. We are taking the following actions to address the underlying causes of issues and to help prevent future occurrence:\n\n - Improve our staging environment to include SAML JIT provisioned programs to more closely mirror our production environment, so we can identify similar bugs before release\n - Improve our database schema to limit the reach of queries executed by the system\n - Improve data access logging to identify affected parties in a more efficient and timely manner in the future\n - Improve model-level validations to include additional business logic rules that would prevent edge cases that cannot be hit through normal application usage\n - Increase our positive as well as negative path testing in both integration and acceptance tests","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eOn November 8th, 2018, HackerOne released software to production that contained a bug which impacted our Security Assertion Markup Language (SAML) authentication system. As a result of the bug, the SAML JIT (Just-In-Time) provisioning mechanism granted users of one customer program read-only access to another customer program. Users who signed in after the software code was pushed into production were inadvertently added as users to 12 other customer programs. The scope of this faulty software behavior was 12 customer programs and 34 user accounts of customers.\u003c/p\u003e\n\n\u003ch1 id=\"timeline\"\u003eTimeline\u003c/h1\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e\u003cstrong\u003eDate\u003c/strong\u003e\u003c/th\u003e\n\u003cth\u003e\u003cstrong\u003eTime (PST)\u003c/strong\u003e\u003c/th\u003e\n\u003cth\u003e\u003cstrong\u003eAction\u003c/strong\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e2018-11-08\u003c/td\u003e\n\u003ctd\u003e12:48 PM\u003c/td\u003e\n\u003ctd\u003eSoftware containing bug deployed to production\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2018-11-08\u003c/td\u003e\n\u003ctd\u003e1:08 PM\u003c/td\u003e\n\u003ctd\u003eHackerOne’s engineering team is informed of unexpected program memberships\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2018-11-08\u003c/td\u003e\n\u003ctd\u003e1:17 PM\u003c/td\u003e\n\u003ctd\u003eSAML JIT provisioning disabled for all customers\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2018-11-08\u003c/td\u003e\n\u003ctd\u003e1:31 PM\u003c/td\u003e\n\u003ctd\u003eHackerOne maintenance mode enabled, disabling all unauthorized access\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2018-11-08\u003c/td\u003e\n\u003ctd\u003e1:51 PM\u003c/td\u003e\n\u003ctd\u003eUnauthorized program memberships removed\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2018-11-08\u003c/td\u003e\n\u003ctd\u003e2:52 PM\u003c/td\u003e\n\u003ctd\u003eHackerOne restored to normal functionality\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2018-11-08\u003c/td\u003e\n\u003ctd\u003e10:00 PM\u003c/td\u003e\n\u003ctd\u003eAll customers and users involved are notified of the incident\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch1 id=\"impacted-data\"\u003eImpacted Data\u003c/h1\u003e\n\n\u003cp\u003eBetween 12:48 PM and 1:31 PM PST on November 8th, 2018, 34 employees of HackerOne customers had access to certain program details in one or more programs other than their own. A total of 12 customer programs and 34 customer user accounts were involved.\u003c/p\u003e\n\n\u003cp\u003eDuring that time, the users had read-only permissions which gave them access to reports (titles, vulnerability information) as well as some program details, such as common responses and dashboards. Seven programs had vulnerability reports viewed by unauthorized employees. Four programs had their inboxes viewed, which disclosed report states, titles, issue tracker references, reporter, assignee, and when the report was last updated. However, for those four programs, no vulnerability descriptions were accessed. One impacted program had no data accessed at all. Impacted customers were notified as to what pieces of data were accessed.\u003c/p\u003e\n\n\u003cp\u003eCustomers’ employees were also impacted. There were 34 customer usernames and email addresses that were shared with other customers without their authorization as they were added to customer programs. These individuals were notified regarding this unintended access.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eIf your data was accessed during this incident, you have received a separate notification from HackerOne.\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1 id=\"root-cause\"\u003eRoot Cause\u003c/h1\u003e\n\n\u003cp\u003eA refactor of the SAML JIT provisioning code path incorrectly scoped a data query that resulted in returning the affected programs. When a user authenticated via SAML after the software containing the bug was released, they were immediately added to at least one of the affected programs. The user was not assigned to any permission groups within the program, giving them the default “read-only” access that allows them to view program details, reports and make internal comments.\u003c/p\u003e\n\n\u003ch1 id=\"resolution-and-recovery\"\u003eResolution and Recovery\u003c/h1\u003e\n\n\u003cp\u003eAt 1:08 PM PST, the engineering on-call duty was notified of unexpected users being added to programs. At that time an incident response team identified that a release at 12:48 PM PST included a change to SAML JIT provisioning. At 1:17 PM PST, the team decided to disable the SAML JIT provisioning system to reduce the impact of the issue.\u003c/p\u003e\n\n\u003cp\u003eBy 1:31 PM PST, the incident team decided to put production into maintenance mode in order to safely investigate the extent of the unauthorized access. HackerOne customers that signed in after the code release were inadvertently added to 12 other programs. A total of 34 customer user accounts were involved, and each was added to the 12 programs impacted. At 1:51 PM PST, all changes as a result of the bug were reverted.\u003c/p\u003e\n\n\u003cp\u003eBefore restoring full functionality, the incident team investigated the extent of the impact to identify what unauthorized access occurred as well as what personal user data was exposed. Once the investigation was complete, the site was restored to full functionality at 2:52 PM PST. At this time, SAML JIT provisioning is disabled until the feature has undergone a further review.\u003c/p\u003e\n\n\u003cp\u003eThis was not eligible for a bounty, as the HackerOne team was first to identify the issue.\u003c/p\u003e\n\n\u003ch1 id=\"preventative-measures\"\u003ePreventative Measures\u003c/h1\u003e\n\n\u003cp\u003eAs part of our incident response process, we are conducting an internal review and analysis of the incident. We are taking the following actions to address the underlying causes of issues and to help prevent future occurrence:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eImprove our staging environment to include SAML JIT provisioned programs to more closely mirror our production environment, so we can identify similar bugs before release\u003c/li\u003e\n\u003cli\u003eImprove our database schema to limit the reach of queries executed by the system\u003c/li\u003e\n\u003cli\u003eImprove data access logging to identify affected parties in a more efficient and timely manner in the future\u003c/li\u003e\n\u003cli\u003eImprove model-level validations to include additional business logic rules that would prevent edge cases that cannot be hit through normal application usage\u003c/li\u003e\n\u003cli\u003eIncrease our positive as well as negative path testing in both integration and acceptance tests\u003c/li\u003e\n\u003c/ul\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}