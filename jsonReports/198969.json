{"id":198969,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTg5Njk=","url":"https://hackerone.com/reports/198969","title":"IDOR - Deleting other user's reminders just by id","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-17T10:54:19.613Z","submitted_at":"2017-01-17T10:54:19.613Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-28T07:20:16.083Z","bug_reporter_agreed_on_going_public_at":"2017-08-29T07:20:09.852Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello, I have found that one can delete other user's reminders just by passing the id. The folder id, user id and other linking data is not passed and not validated (by making a normal delete requests all these parameters are passed, but they don't seem to be validated)\n\nPOC\n----------------\n\n```\nPUT /appsuite/api/reminder?action=delete\u0026session=619f92c3343e426d968f6782e5eaba4a HTTP/1.1\nHost: sandbox.open-xchange.com\nConnection: close\n/**/\n\n{\"id\":5}\n```\n\nResponse\n\n```\nHTTP/1.1 200 OK\nServer: nginx\n/**/\n\n{\"data\":[5]}\n```\n\nThe reminder with id 5 does not belong to the logged user.\n\nI have also attached a video to see the exploit made. As you will see, I will be logged with user 2, then make burp requests to get all my reminders. User 2 will have 2 reminders. Then I will switch to user 3 in incognito and you can see that this user has just 1 reminder with another id. Then, from this user I will make a request to delete a reminder from user 2 just by passing the id. I will click this 2 times and after this, I will switch to user 2 and see that his reminder has been deleted by user 3. The users can be identified by the passes session id in the request and you will see this is different.\n","vulnerability_information_html":"\u003cp\u003eHello, I have found that one can delete other user\u0026#39;s reminders just by passing the id. The folder id, user id and other linking data is not passed and not validated (by making a normal delete requests all these parameters are passed, but they don\u0026#39;t seem to be validated)\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePUT /appsuite/api/reminder?action=delete\u0026amp;session=619f92c3343e426d968f6782e5eaba4a HTTP/1.1\nHost: sandbox.open-xchange.com\nConnection: close\n/**/\n\n{\u0026quot;id\u0026quot;:5}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nServer: nginx\n/**/\n\n{\u0026quot;data\u0026quot;:[5]}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe reminder with id 5 does not belong to the logged user.\u003c/p\u003e\n\n\u003cp\u003eI have also attached a video to see the exploit made. As you will see, I will be logged with user 2, then make burp requests to get all my reminders. User 2 will have 2 reminders. Then I will switch to user 3 in incognito and you can see that this user has just 1 reminder with another id. Then, from this user I will make a request to delete a reminder from user 2 just by passing the id. I will click this 2 times and after this, I will switch to user 2 and see that his reminder has been deleted by user 3. The users can be identified by the passes session id in the request and you will see this is different.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-28T07:20:09.884Z","allow_singular_disclosure_after":-102634352.12492256,"singular_disclosure_allowed":true,"vote_count":12,"voters":["jensec","bl4de","vijay_kumar","eveeez","r3y","mr_r3boot","bb00x","sh3r1","spetr0x","tkye","and 2 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1424741,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Nice find!","markdown_message":"\u003cp\u003eNice find!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-17T12:46:53.648Z","updated_at":"2017-01-17T12:46:53.648Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1424742,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-17T12:47:04.347Z","updated_at":"2017-01-17T12:47:04.347Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1424755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland . It would be nice to include my name \"Iordache Cosmin\" in the researcher credits. If you usually don't do this it's ok, I won't mind.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e . It would be nice to include my name \u0026quot;Iordache Cosmin\u0026quot; in the researcher credits. If you usually don\u0026#39;t do this it\u0026#39;s ok, I won\u0026#39;t mind.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-17T12:53:37.258Z","updated_at":"2017-01-17T12:53:43.849Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1427373,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as Resolved since no further information is required, note that we're still working on this.","markdown_message":"\u003cp\u003eClosing as Resolved since no further information is required, note that we\u0026#39;re still working on this.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T13:00:59.607Z","updated_at":"2017-01-18T13:00:59.607Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1429563,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-19T09:45:22.414Z","updated_at":"2017-01-19T09:45:22.414Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1429580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mheiland Thanks for the bounty! As always, tell me when this is resolved in sandbox and I am happy to test the fix","markdown_message":"\u003cp\u003e\u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e Thanks for the bounty! As always, tell me when this is resolved in sandbox and I am happy to test the fix\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-19T09:55:27.247Z","updated_at":"2017-01-19T09:55:27.247Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1962206,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-29T07:20:09.868Z","updated_at":"2017-08-29T07:20:09.868Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2029277,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T07:20:16.103Z","updated_at":"2017-09-28T07:20:16.103Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4916992,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-24T12:18:45.402Z","updated_at":"2019-05-24T12:18:45.402Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":401094},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}