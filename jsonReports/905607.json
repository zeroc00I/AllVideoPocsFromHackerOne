{"id":905607,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDU2MDc=","url":"https://hackerone.com/reports/905607","title":"[cs.money] Open Redirect Leads to Account Takeover","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-06-22T19:34:01.920Z","submitted_at":"2020-06-22T19:34:01.920Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"abdilahrf_","url":"/abdilahrf_","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/558/09725b0d8db02c3a57c944483ed19905bdb4d871_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":48311,"url":"https://hackerone.com/cs_money","handle":"cs_money","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"CS Money","twitter_handle":"csmoneytrade","website":"https://cs.money","about":"CS:GO trading platform that helps people to trade, buy, sell and search for the best skins and deals they could possibly find."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-30T12:31:27.285Z","bug_reporter_agreed_on_going_public_at":"2020-09-29T05:08:12.350Z","team_member_agreed_on_going_public_at":"2020-09-30T12:31:27.131Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nI found an open redirect on `https://cs.money` domain, using this payload `https://cs.money///google.com` we can redirect into any domain that we want, you can see the request and response from this image below :\n\n‚ñà‚ñà‚ñà\n\n## Steps To Reproduce:\n\nThe final payload is having an account takeover as the impact, by chaining the openredirect vulnerability with login oauth function, the steps to reproduce is below:\n\n  1. Open this url `https://auth.dota.trade/login?redirectUrl=https://cs.money///loving-turing-29a494.netlify.app%2523\u0026callbackUrl=https://cs.money///loving-turing-29a494.netlify.app%2523` , the login url was gotten from `cs.money` index page button `sign in through steam`:\n\n‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\n\n  2. Login as usual, the application will redirect you to `https://loving-turing-29a494.netlify.app/#?token=Dlk9sGd8zc6OvxlITijQR\u0026redirectUrl=https://cs.money///loving-turing-29a494.netlify.app#` you will see like this image :\n‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\n  3.the  attacker already received the victim token on the attacker listener \n‚ñà‚ñà‚ñà\n\n**If the vulnerability requires hosted server, please, let us know if it is a public or a local one you've tested vulnerability on.**\n### Public\nMy POC Hosted here : loving-turing-29a494.netlify.app\n\nI also create the video POC that show an attacker take over an victim account :\n‚ñà‚ñà‚ñà‚ñà‚ñà\n\n## Impact\n\nAttacker gained full control of the victim account, was able to change the trade-offer link into the attacker link and redeem all the items into attacker account and almost can do anything.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eI found an open redirect on \u003ccode\u003ehttps://cs.money\u003c/code\u003e domain, using this payload \u003ccode\u003ehttps://cs.money///google.com\u003c/code\u003e we can redirect into any domain that we want, you can see the request and response from this image below :\u003c/p\u003e\n\n\u003cp\u003e‚ñà‚ñà‚ñà\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eThe final payload is having an account takeover as the impact, by chaining the openredirect vulnerability with login oauth function, the steps to reproduce is below:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen this url \u003ccode\u003ehttps://auth.dota.trade/login?redirectUrl=https://cs.money///loving-turing-29a494.netlify.app%2523\u0026amp;callbackUrl=https://cs.money///loving-turing-29a494.netlify.app%2523\u003c/code\u003e , the login url was gotten from \u003ccode\u003ecs.money\u003c/code\u003e index page button \u003ccode\u003esign in through steam\u003c/code\u003e:\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin as usual, the application will redirect you to \u003ccode\u003ehttps://loving-turing-29a494.netlify.app/#?token=Dlk9sGd8zc6OvxlITijQR\u0026amp;redirectUrl=https://cs.money///loving-turing-29a494.netlify.app#\u003c/code\u003e you will see like this image :\n‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\n3.the  attacker already received the victim token on the attacker listener \n‚ñà‚ñà‚ñà\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eIf the vulnerability requires hosted server, please, let us know if it is a public or a local one you\u0026#39;ve tested vulnerability on.\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch3 id=\"public\"\u003ePublic\u003c/h3\u003e\n\n\u003cp\u003eMy POC Hosted here : loving-turing-29a494.netlify.app\u003c/p\u003e\n\n\u003cp\u003eI also create the video POC that show an attacker take over an victim account :\u003cbr\u003e\n‚ñà‚ñà‚ñà‚ñà‚ñà\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker gained full control of the victim account, was able to change the trade-offer link into the attacker link and redeem all the items into attacker account and almost can do anything.\u003c/p\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":323,"voters":["pmnh","xdms","env","pyrrhon","boyoz","m0chan","w31rd0","hunter","excavator","najeh_halawani","and 313 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":45901,"asset_type":"URL","asset_identifier":"cs.money","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8393759,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-24T10:52:08.768Z","updated_at":"2020-06-24T10:52:08.768Z","additional_data":{"old_severity":"Critical","new_severity":"Medium","old_severity_id":757920,"new_severity_id":759361},"actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8393763,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nOpen redirects are out of scope.\nAnd the attack vector is very limited.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nOpen redirects are out of scope.\u003cbr\u003e\nAnd the attack vector is very limited.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-24T10:52:49.151Z","updated_at":"2020-06-24T10:52:49.151Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8393879,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @security_csmoney , i did not agree with your statement `attack vector is very limited`  the fact is that I was able to proof that i able to take over an account an this supposed to be critical, can you please discuss it internally again ? because i believe this having critical severity\n\ni can withdraw anyone items to my account and grab all the money easily with this account takeover exploit.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/security_csmoney\"\u003e@security_csmoney\u003c/a\u003e , i did not agree with your statement \u003ccode\u003eattack vector is very limited\u003c/code\u003e  the fact is that I was able to proof that i able to take over an account an this supposed to be critical, can you please discuss it internally again ? because i believe this having critical severity\u003c/p\u003e\n\n\u003cp\u003ei can withdraw anyone items to my account and grab all the money easily with this account takeover exploit.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-24T11:04:35.098Z","updated_at":"2020-06-24T11:04:35.098Z","actor":{"username":"abdilahrf_","cleared":false,"url":"/abdilahrf_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/558/09725b0d8db02c3a57c944483ed19905bdb4d871_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8394800,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nYou mean by\n`i can withdraw anyone items to my account and grab all the money easily with this account takeover exploit.`\nIs that you can withdraw any virtual items from cs.money inventory?","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nYou mean by\u003cbr\u003e\n\u003ccode\u003ei can withdraw anyone items to my account and grab all the money easily with this account takeover exploit.\u003c/code\u003e\u003cbr\u003e\nIs that you can withdraw any virtual items from cs.money inventory?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-24T12:43:10.556Z","updated_at":"2020-06-24T12:43:10.556Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8394835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will reconsider it.\nWill contact you back soon.","markdown_message":"\u003cp\u003eWe will reconsider it.\u003cbr\u003e\nWill contact you back soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-24T12:46:51.451Z","updated_at":"2020-06-24T12:46:51.451Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8394883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @security_csmoney ,\nyes i can do that not to anyone but to the victim (the victim could be anyone tho), after logged-in into the victim account, i can do anything on the victim account.\n\nMy recomendation for this vulnerability is :\n1. Fix the openredirection issue\n2. Implement 2FA after sign-in via steam.\n\nMy recommendation point number 2, to implement 2FA is playing important role here, because even the oauth2 token leaked\nThe attacker is cannot perform any malicious transaction without having correct 2FA or access to the victim phone number, this is the best approach to defend the application from any malicious attacker and already used many big companies such as facebook/paypal/etc.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/security_csmoney\"\u003e@security_csmoney\u003c/a\u003e ,\u003cbr\u003e\nyes i can do that not to anyone but to the victim (the victim could be anyone tho), after logged-in into the victim account, i can do anything on the victim account.\u003c/p\u003e\n\n\u003cp\u003eMy recomendation for this vulnerability is :\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFix the openredirection issue\u003c/li\u003e\n\u003cli\u003eImplement 2FA after sign-in via steam.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eMy recommendation point number 2, to implement 2FA is playing important role here, because even the oauth2 token leaked\u003cbr\u003e\nThe attacker is cannot perform any malicious transaction without having correct 2FA or access to the victim phone number, this is the best approach to defend the application from any malicious attacker and already used many big companies such as facebook/paypal/etc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-24T12:53:39.532Z","updated_at":"2020-06-24T12:55:39.464Z","actor":{"username":"abdilahrf_","cleared":false,"url":"/abdilahrf_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/558/09725b0d8db02c3a57c944483ed19905bdb4d871_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8404912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nWe suppose that we've fixed the open redirect issue.\n2FA is long ago planned, waiting realization.\nWe've decided on 650$ bounty.\nHave you got any questions left?","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nWe suppose that we\u0026#39;ve fixed the open redirect issue.\u003cbr\u003e\n2FA is long ago planned, waiting realization.\u003cbr\u003e\nWe\u0026#39;ve decided on 650$ bounty.\u003cbr\u003e\nHave you got any questions left?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-25T10:47:55.665Z","updated_at":"2020-06-25T10:47:55.665Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8405000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @security_csmoney , \n\nI can confirm the fix was already implemented, but i am still thingking 650$ is still quite not match with the finding because its the core system and login was the crictical point of an application, i was expecting 1000$ at bounty, but if that was already your team decision, i will respect that.\n\nAnd i also found the plus point in this program is that the response time is very quick and also implemented fix very fast which is very good to have, good job team üëç","markdown_message":"\u003cp\u003eHi \u003ca href=\"/security_csmoney\"\u003e@security_csmoney\u003c/a\u003e , \u003c/p\u003e\n\n\u003cp\u003eI can confirm the fix was already implemented, but i am still thingking 650$ is still quite not match with the finding because its the core system and login was the crictical point of an application, i was expecting 1000$ at bounty, but if that was already your team decision, i will respect that.\u003c/p\u003e\n\n\u003cp\u003eAnd i also found the plus point in this program is that the response time is very quick and also implemented fix very fast which is very good to have, good job team üëç\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-25T10:59:48.728Z","updated_at":"2020-06-25T10:59:48.728Z","actor":{"username":"abdilahrf_","cleared":false,"url":"/abdilahrf_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/558/09725b0d8db02c3a57c944483ed19905bdb4d871_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8408368,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nThank you for your feedback.\nWe've decided on 750$ final.","markdown_message":"\u003cp\u003eHey!\u003cbr\u003e\nThank you for your feedback.\u003cbr\u003e\nWe\u0026#39;ve decided on 750$ final.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-25T16:00:32.548Z","updated_at":"2020-06-25T16:00:32.548Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8408395,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Keep up the good work!","markdown_message":"\u003cp\u003eKeep up the good work!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-25T16:02:16.362Z","updated_at":"2020-06-25T16:02:16.362Z","actor":{"url":"/cs_money","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"CS Money"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"cs_money","collaborator":{"username":"abdilahrf_","url":"/abdilahrf_"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8408401,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-25T16:02:32.607Z","updated_at":"2020-06-25T16:02:32.607Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8408403,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-25T16:02:39.031Z","updated_at":"2020-06-25T16:02:39.031Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"abdilahrf_","url":"/abdilahrf_"},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9360836,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-29T05:08:12.372Z","updated_at":"2020-09-29T05:08:12.372Z","first_to_agree":true,"actor":{"username":"abdilahrf_","cleared":false,"url":"/abdilahrf_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/558/09725b0d8db02c3a57c944483ed19905bdb4d871_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9374174,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-30T12:31:27.175Z","updated_at":"2020-09-30T12:31:27.175Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9374175,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-30T12:31:27.319Z","updated_at":"2020-09-30T12:31:27.319Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}