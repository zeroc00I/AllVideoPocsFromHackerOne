{"id":242213,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDIyMTM=","url":"https://hackerone.com/reports/242213","title":"Stored XSS in the any user profile using website link","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-06-21T23:15:15.235Z","submitted_at":"2017-06-21T23:15:15.235Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":952,"url":"https://hackerone.com/pornhub","handle":"pornhub","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Pornhub","twitter_handle":"Pornhub","website":"https://pornhub.com","about":"The premiere destination for adult entertainment"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-07T20:01:42.122Z","bug_reporter_agreed_on_going_public_at":"2017-07-06T18:41:06.882Z","team_member_agreed_on_going_public_at":"2017-07-07T20:01:42.081Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-05T18:41:06.916Z","allow_singular_disclosure_after":-107260038.55283125,"singular_disclosure_allowed":true,"vote_count":14,"voters":["003random","mygf","eveeez","geeknik","r3y","atestpk","test_universe","shepard","linkks","japz","and 4 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1776306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-23T10:58:52.572Z","updated_at":"2017-06-23T10:58:52.572Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1782348,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-26T20:00:20.558Z","updated_at":"2017-06-26T20:00:20.558Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1782427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-26T20:18:34.967Z","updated_at":"2017-06-26T20:19:54.246Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1782501,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-26T20:44:46.563Z","updated_at":"2017-06-26T20:44:46.563Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1791678,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-29T15:48:23.707Z","updated_at":"2017-06-29T15:48:23.707Z","actor":{"url":"/pornhub","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Pornhub"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"pornhub","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1791773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-29T16:27:44.497Z","updated_at":"2017-06-29T16:27:44.497Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1792710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-29T21:48:51.152Z","updated_at":"2017-06-29T21:48:51.152Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1812163,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T18:35:56.872Z","updated_at":"2017-07-06T18:35:56.872Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1812190,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T18:41:06.899Z","updated_at":"2017-07-06T18:41:06.899Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1812226,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T18:50:58.812Z","updated_at":"2017-07-06T18:50:58.812Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1812317,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T19:19:42.085Z","updated_at":"2017-07-06T19:19:42.085Z","additional_data":{},"actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1815514,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-07T20:01:42.100Z","updated_at":"2017-07-07T20:01:42.100Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1815515,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-07T20:01:42.137Z","updated_at":"2017-07-07T20:01:42.137Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1822892,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-10T19:27:18.738Z","updated_at":"2017-07-10T19:41:51.023Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1823251,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-10T21:30:13.025Z","updated_at":"2017-07-10T21:30:13.025Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":4747,"category":"team","content":"The researcher discovered a stored XSS in the `Website` field of a user's profile page.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe researcher discovered a stored XSS in the \u003ccode\u003eWebsite\u003c/code\u003e field of a user\u0026#39;s profile page.\u003c/p\u003e\n"},{"id":4740,"category":"researcher","content":"I discovered Stored XSS attack vector in the user profile page using `Website` field.\nA similar bug was fixed several months ago (i got a Duplicate in that time), but after some time I checked this again, and... the issue was in place again (fix was reverted back for some reason). This time bug was accepted! \nI learned the one thing - always check the bug fixes periodically - something can change!\n\nThe XSS was event-based, inside `href` attribute of the `a` tag (i was unable to achieve persistent XSS when user will visit the page due to strong filtering rules, however, `\"` symbol was not properly sanitized):\n```\nhttps://test.com/\"onmouseover=\u003cpayload\u003e;//\n```\nbecame\n```\n\u003ca href=\"https://test.com/\" onmouseover=\"\u003cpayload\u003e;//\"\u003ehttps://test.com/\"onmouseover=\u003cpayload\u003e;//\u003c/a\u003e\n```\nThe payload was visible on the page as the value of the link. It was possible to steal CSRF tokens, or other sensitive info of any user, who visit the profile page, but also user interaction required (hovering the mouse to the link). \n\nInitially,  set severity to `High`, due to the stored type of XSS, possibility to execute any arbitrary JS, but later asked the team to lower severity to the `Medium` due to user interaction factor.\n\nThanks to the PornHub team for the fast fix and the bounty!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eI discovered Stored XSS attack vector in the user profile page using \u003ccode\u003eWebsite\u003c/code\u003e field.\u003cbr\u003e\nA similar bug was fixed several months ago (i got a Duplicate in that time), but after some time I checked this again, and... the issue was in place again (fix was reverted back for some reason). This time bug was accepted! \u003cbr\u003e\nI learned the one thing - always check the bug fixes periodically - something can change!\u003c/p\u003e\n\n\u003cp\u003eThe XSS was event-based, inside \u003ccode\u003ehref\u003c/code\u003e attribute of the \u003ccode\u003ea\u003c/code\u003e tag (i was unable to achieve persistent XSS when user will visit the page due to strong filtering rules, however, \u003ccode\u003e\u0026quot;\u003c/code\u003e symbol was not properly sanitized):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://test.com/\u0026quot;onmouseover=\u0026lt;payload\u0026gt;;//\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ebecame\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;a href=\u0026quot;https://test.com/\u0026quot; onmouseover=\u0026quot;\u0026lt;payload\u0026gt;;//\u0026quot;\u0026gt;https://test.com/\u0026quot;onmouseover=\u0026lt;payload\u0026gt;;//\u0026lt;/a\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe payload was visible on the page as the value of the link. It was possible to steal CSRF tokens, or other sensitive info of any user, who visit the profile page, but also user interaction required (hovering the mouse to the link). \u003c/p\u003e\n\n\u003cp\u003eInitially,  set severity to \u003ccode\u003eHigh\u003c/code\u003e, due to the stored type of XSS, possibility to execute any arbitrary JS, but later asked the team to lower severity to the \u003ccode\u003eMedium\u003c/code\u003e due to user interaction factor.\u003c/p\u003e\n\n\u003cp\u003eThanks to the PornHub team for the fast fix and the bounty!\u003c/p\u003e\n"}]}