{"id":222692,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjI2OTI=","url":"https://hackerone.com/reports/222692","title":"plugins.trac.wordpress.org likely vulnerable to Cross Site Tracing (xst), TRACE HTTP method should be disabled","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-04-21T07:17:35.489Z","submitted_at":"2017-04-21T07:17:35.489Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-03T16:17:13.138Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:17:10.276Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Background ##\nA Cross-Site Tracing (XST) attack involves the use of Cross-site Scripting (XSS) and the TRACE HTTP method. According to RFC 2616, \"TRACE allows the client to see what is being received at the other end of the request chain and use that data for testing or diagnostic information.\" XST could be used as a method to steal user's cookies via Cross-site Scripting (XSS) even if the cookie has the \"HttpOnly\" flag set and/or exposes the user's Authorization header.\n\nThe TRACE method, while apparently harmless, can be successfully leveraged in some scenarios to steal legitimate users' credentials. This attack technique was discovered by Jeremiah Grossman in 2003, in an attempt to bypass the HttpOnly tag that Microsoft introduced in Internet Explorer 6 sp1 to protect cookies from being accessed by JavaScript. As a matter of fact, one of the most recurring attack patterns in Cross Site Scripting is to access the document.cookie object and send it to a web server controlled by the attacker so that he/she can hijack the victim's session. Tagging a cookie as HttpOnly forbids JavaScript to access it, protecting it from being sent to a third party. However, **the TRACE method can be used to bypass this protection and access the cookie even in this scenario.**\n\nModern browsers now prevent TRACE requests being made via JavaScript, however, **other ways of sending TRACE requests with browsers have been discovered, such as using Java and Flash.**\n\n## PoC ##\n`curl -X TRACE -H \"X-Header: geeknik/pentest\" https://plugins.trac.wordpress.org`\n```\nTRACE / HTTP/1.1\nUser-Agent: curl/7.26.0\nHost: plugins.trac.wordpress.org\nAccept: */*\nX-Header: geeknik/pentest\n```\nSince the server responds to this request, including echoing back my fake header, it is likely vulnerable to XST attacks and the step outlined in the mitigation section should be taken as soon as possible.\n\n## Secondary PoC ##\nDepending on how the server logs are collected and read, it may be possible to trigger XSS flaws in secondary applications using this method:\n`curl -X TRACE -H \"Via: \u003csvg/onload=alert('XSS')\u003e\" https://plugins.trac.wordpress.org`\n```\nTRACE / HTTP/1.1\nUser-Agent: curl/7.26.0\nHost: plugins.trac.wordpress.org\nAccept: */*\nVia: \u003csvg/onload=alert('XSS')\u003e\n```\n\n## Mitigation ##\nIn Apache versions 1.3.34, 2.0.55 and later, set the `TraceEnable` directive to `off` in the main configuration file and then restart Apache.","vulnerability_information_html":"\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\n\u003cp\u003eA Cross-Site Tracing (XST) attack involves the use of Cross-site Scripting (XSS) and the TRACE HTTP method. According to RFC 2616, \u0026quot;TRACE allows the client to see what is being received at the other end of the request chain and use that data for testing or diagnostic information.\u0026quot; XST could be used as a method to steal user\u0026#39;s cookies via Cross-site Scripting (XSS) even if the cookie has the \u0026quot;HttpOnly\u0026quot; flag set and/or exposes the user\u0026#39;s Authorization header.\u003c/p\u003e\n\n\u003cp\u003eThe TRACE method, while apparently harmless, can be successfully leveraged in some scenarios to steal legitimate users\u0026#39; credentials. This attack technique was discovered by Jeremiah Grossman in 2003, in an attempt to bypass the HttpOnly tag that Microsoft introduced in Internet Explorer 6 sp1 to protect cookies from being accessed by JavaScript. As a matter of fact, one of the most recurring attack patterns in Cross Site Scripting is to access the document.cookie object and send it to a web server controlled by the attacker so that he/she can hijack the victim\u0026#39;s session. Tagging a cookie as HttpOnly forbids JavaScript to access it, protecting it from being sent to a third party. However, \u003cstrong\u003ethe TRACE method can be used to bypass this protection and access the cookie even in this scenario.\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eModern browsers now prevent TRACE requests being made via JavaScript, however, \u003cstrong\u003eother ways of sending TRACE requests with browsers have been discovered, such as using Java and Flash.\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePoC\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003ecurl -X TRACE -H \u0026quot;X-Header: geeknik/pentest\u0026quot; https://plugins.trac.wordpress.org\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eTRACE / HTTP/1.1\nUser-Agent: curl/7.26.0\nHost: plugins.trac.wordpress.org\nAccept: */*\nX-Header: geeknik/pentest\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSince the server responds to this request, including echoing back my fake header, it is likely vulnerable to XST attacks and the step outlined in the mitigation section should be taken as soon as possible.\u003c/p\u003e\n\n\u003ch2 id=\"secondary-poc\"\u003eSecondary PoC\u003c/h2\u003e\n\n\u003cp\u003eDepending on how the server logs are collected and read, it may be possible to trigger XSS flaws in secondary applications using this method:\u003cbr\u003e\n\u003ccode\u003ecurl -X TRACE -H \u0026quot;Via: \u0026lt;svg/onload=alert(\u0026#39;XSS\u0026#39;)\u0026gt;\u0026quot; https://plugins.trac.wordpress.org\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eTRACE / HTTP/1.1\nUser-Agent: curl/7.26.0\nHost: plugins.trac.wordpress.org\nAccept: */*\nVia: \u0026lt;svg/onload=alert(\u0026#39;XSS\u0026#39;)\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"mitigation\"\u003eMitigation\u003c/h2\u003e\n\n\u003cp\u003eIn Apache versions 1.3.34, 2.0.55 and later, set the \u003ccode\u003eTraceEnable\u003c/code\u003e directive to \u003ccode\u003eoff\u003c/code\u003e in the main configuration file and then restart Apache.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-03T16:17:10.314Z","allow_singular_disclosure_after":-36420244.58535647,"singular_disclosure_allowed":true,"vote_count":55,"voters":["spam404","sameerphad72","giany","cuso4","brodie_codie","geeknik","r3y","vulnh0lic","osama-hamad","exception","and 45 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1626976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the report, @geeknik. This has been assigned to the wordpress.org systems team and we'll let you know if they decide to take any action with it.","markdown_message":"\u003cp\u003eThank you for the report, \u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e. This has been assigned to the wordpress.org systems team and we\u0026#39;ll let you know if they decide to take any action with it.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-21T18:41:30.978Z","updated_at":"2017-04-21T18:41:30.978Z","actor":{"username":"johnbillion","cleared":false,"url":"/johnbillion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/083/8a397390a09844d8b0657ea57e4203abd852bb2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1638909,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@geeknik Thank you for the report. The systems team has informed us that the TRACE method is now disabled on the plugins trac server.","markdown_message":"\u003cp\u003e\u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e Thank you for the report. The systems team has informed us that the TRACE method is now disabled on the plugins trac server.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-26T23:25:04.796Z","updated_at":"2017-04-26T23:25:04.796Z","actor":{"username":"otto","cleared":false,"url":"/otto","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/196/bd7b2308fb12476f4e36cf8d3afd852a6c89a9b4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1638948,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirmed, the server now returns `405 Method Not Allowed`. ","markdown_message":"\u003cp\u003eConfirmed, the server now returns \u003ccode\u003e405 Method Not Allowed\u003c/code\u003e. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-26T23:57:39.406Z","updated_at":"2017-04-26T23:57:39.406Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1639527,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-27T09:53:22.640Z","updated_at":"2017-04-27T09:53:22.640Z","actor":{"username":"johnbillion","cleared":false,"url":"/johnbillion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/083/8a397390a09844d8b0657ea57e4203abd852bb2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1690188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not worthy of a bounty or swag? If we're scoring things using CVSS this would be a 4.3:\n\n```\nCVSS v2 Base Score: 4.3 (MEDIUM)\nVector: AV:N/AC:M/Au:N/C:P/I:N/A:N\nImpact Subscore: 2.9 \nExploitability Subscore: 8.6 \n```","markdown_message":"\u003cp\u003eNot worthy of a bounty or swag? If we\u0026#39;re scoring things using CVSS this would be a 4.3:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eCVSS v2 Base Score: 4.3 (MEDIUM)\nVector: AV:N/AC:M/Au:N/C:P/I:N/A:N\nImpact Subscore: 2.9 \nExploitability Subscore: 8.6 \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-05-21T21:42:56.354Z","updated_at":"2017-05-21T21:42:56.354Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1979090,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-06T07:16:20.862Z","updated_at":"2017-09-06T07:16:20.862Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1983422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @geeknik,\n\nSorry for the delay on the bounty here. We're still working out a lot of the kinks on our end for handling bounty payouts, etc.\n\nThanks for your patience,\nAaron","markdown_message":"\u003cp\u003eHey \u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay on the bounty here. We\u0026#39;re still working out a lot of the kinks on our end for handling bounty payouts, etc.\u003c/p\u003e\n\n\u003cp\u003eThanks for your patience,\u003cbr\u003e\nAaron\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-07T18:20:10.592Z","updated_at":"2017-09-07T18:20:10.592Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1983719,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update and the bounty, @aaroncampbell! Much appreciated.","markdown_message":"\u003cp\u003eThanks for the update and the bounty, \u003ca href=\"/aaroncampbell\"\u003e@aaroncampbell\u003c/a\u003e! Much appreciated.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-07T20:34:38.242Z","updated_at":"2017-09-07T20:34:38.242Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960634,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:17:10.291Z","updated_at":"2019-10-04T16:17:10.291Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6205306,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-03T16:17:13.155Z","updated_at":"2019-11-03T16:17:13.155Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}