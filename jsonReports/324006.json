{"id":324006,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjQwMDY=","url":"https://hackerone.com/reports/324006","title":"SaaS admin can modify/delete/get user information.","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-03-09T22:01:02.670Z","submitted_at":"2018-03-09T22:01:02.670Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rijalrojan","url":"/rijalrojan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":25188,"url":"https://hackerone.com/pingidentity","handle":"pingidentity","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ping Identity","twitter_handle":"pingidentity","website":"https://www.pingidentity.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-26T20:42:55.491Z","bug_reporter_agreed_on_going_public_at":"2019-03-26T20:30:07.806Z","team_member_agreed_on_going_public_at":"2019-03-26T20:42:55.382Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n**Summary:** [add summary of the vulnerability]\nBased on what is seen, SaaS admin should not have access to users info from this page: https://ort-admin.pingone.com/web-portal/usermanagement#/ however, it is still able to get the info on that page. \n\n**Description:** [add more details about this vulnerability]\nWhen we go to https://ort-admin.pingone.com/web-portal/usermanagement#/, it returns an error that says: `You are not authorized to view that page.`. This means it is blocking certain user permissions like SaaS admin. \n\nBut the Ajax link that retrieves user info on that page does not check for the permission and gives out detail info of the users. \n\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. Make sure you are the SaaS administrator on that page and not a Global Admin. If you do not have a SaaS admin account, you can create one at: https://ort-admin.pingone.com/web-portal/account/administratorsng\n  2. Go to https://ort-admin.pingone.com/web-portal/ajax/user/directory/users/?advancedSearch=false\u0026ascendingSort=true\u0026count=100\u0026searchString=\u0026sortField=name.familyName\u0026startIndex=1\u0026statusFilter=\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nLeaking user information for under privileged user.","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e [add summary of the vulnerability]\u003cbr\u003e\nBased on what is seen, SaaS admin should not have access to users info from this page: \u003ca title=\"https://ort-admin.pingone.com/web-portal/usermanagement#/\" href=\"/redirect?url=https%3A%2F%2Fort-admin.pingone.com%2Fweb-portal%2Fusermanagement%23%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ort-admin.pingone.com/web-portal/usermanagement#/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e however, it is still able to get the info on that page. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e [add more details about this vulnerability]\u003cbr\u003e\nWhen we go to \u003ca title=\"https://ort-admin.pingone.com/web-portal/usermanagement#/\" href=\"/redirect?url=https%3A%2F%2Fort-admin.pingone.com%2Fweb-portal%2Fusermanagement%23%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ort-admin.pingone.com/web-portal/usermanagement#/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, it returns an error that says: \u003ccode\u003eYou are not authorized to view that page.\u003c/code\u003e. This means it is blocking certain user permissions like SaaS admin. \u003c/p\u003e\n\n\u003cp\u003eBut the Ajax link that retrieves user info on that page does not check for the permission and gives out detail info of the users. \u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e(Add details for how we can reproduce the issue)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eMake sure you are the SaaS administrator on that page and not a Global Admin. If you do not have a SaaS admin account, you can create one at: \u003ca title=\"https://ort-admin.pingone.com/web-portal/account/administratorsng\" href=\"/redirect?url=https%3A%2F%2Fort-admin.pingone.com%2Fweb-portal%2Faccount%2Fadministratorsng\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ort-admin.pingone.com/web-portal/account/administratorsng\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://ort-admin.pingone.com/web-portal/ajax/user/directory/users/?advancedSearch=false\u0026amp;ascendingSort=true\u0026amp;count=100\u0026amp;searchString=\u0026amp;sortField=name.familyName\u0026amp;startIndex=1\u0026amp;statusFilter=\" href=\"/redirect?url=https%3A%2F%2Fort-admin.pingone.com%2Fweb-portal%2Fajax%2Fuser%2Fdirectory%2Fusers%2F%3FadvancedSearch%3Dfalse%26ascendingSort%3Dtrue%26count%3D100%26searchString%3D%26sortField%3Dname.familyName%26startIndex%3D1%26statusFilter%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ort-admin.pingone.com/web-portal/ajax/user/directory/users/?advancedSearch=false\u0026amp;ascendingSort=true\u0026amp;count=100\u0026amp;searchString=\u0026amp;sortField=name.familyName\u0026amp;startIndex=1\u0026amp;statusFilter=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eList any additional material (e.g. screenshots, logs, etc.)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eLeaking user information for under privileged user.\u003c/p\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-04-25T20:30:07.914Z","allow_singular_disclosure_after":-52995915.3376759,"singular_disclosure_allowed":true,"vote_count":11,"voters":["mashoud1122","sameerphad72","0-1","samet","sudi","naategh","exception","imprince_007","cryptographer","bughunter01","and 1 more..."],"severity":{"rating":"high","score":8.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":6162,"asset_type":"URL","asset_identifier":"https://ort-admin.pingone.com/*","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2478231,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We might want to change the CVSS for that. Based on what I saw now, because that endpoint also results in leak of uniqueid, we can change the info of those users like removing them: https://ort-admin.pingone.com/web-portal/ajax/user/directory/deleteuser/?userId=\u003cuserid\u003e","markdown_message":"\u003cp\u003eWe might want to change the CVSS for that. Based on what I saw now, because that endpoint also results in leak of uniqueid, we can change the info of those users like removing them: \u003ca title=\"https://ort-admin.pingone.com/web-portal/ajax/user/directory/deleteuser/?userId=\" href=\"/redirect?url=https%3A%2F%2Fort-admin.pingone.com%2Fweb-portal%2Fajax%2Fuser%2Fdirectory%2Fdeleteuser%2F%3FuserId%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ort-admin.pingone.com/web-portal/ajax/user/directory/deleteuser/?userId=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;userid\u0026gt;\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-09T22:04:46.682Z","updated_at":"2018-03-09T22:04:46.682Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2478233,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-09T22:05:11.390Z","updated_at":"2018-03-09T22:05:11.390Z","additional_data":{"old_title":"SaaS admin can get email of other users. ","new_title":"SaaS admin can modify/delete/get user information."},"actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2479869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @uranium238,\n\nThanks for the report. We'll be looking into it and get back to you shortly.\n\nRegards,\n@bagofchips","markdown_message":"\u003cp\u003eHey \u003ca href=\"/uranium238\"\u003e@uranium238\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the report. We\u0026#39;ll be looking into it and get back to you shortly.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/bagofchips\"\u003e@bagofchips\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-10T19:30:20.601Z","updated_at":"2018-03-10T19:30:20.601Z","actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2479873,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. We will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.","markdown_message":"\u003cp\u003eWe were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. We will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-10T19:33:17.498Z","updated_at":"2018-03-10T19:33:17.498Z","actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2480101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good. Thanks @bagofchips \n","markdown_message":"\u003cp\u003eSounds good. Thanks \u003ca href=\"/bagofchips\"\u003e@bagofchips\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-10T21:53:55.538Z","updated_at":"2018-03-10T21:53:55.538Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2511952,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-20T21:08:53.319Z","updated_at":"2018-03-20T21:08:53.319Z","additional_data":{"old_severity":"High (8.3)","new_severity":"High (8.8)","old_severity_id":126993,"new_severity_id":130641},"actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2515896,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-21T20:56:50.340Z","updated_at":"2018-03-21T20:56:50.340Z","actor":{"url":"/pingidentity","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ping Identity"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"pingidentity","collaborator":{"username":"rijalrojan","url":"/rijalrojan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3349954,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-17T17:16:10.765Z","updated_at":"2018-09-17T17:16:10.765Z","actor":{"username":"richardcardona","cleared":false,"url":"/richardcardona","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rijalrojan","url":"/rijalrojan"},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4395957,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Saw the email and found out this is one of the public report? I suggest we make this \"public\" so people in the program can see it. Currently, it does not look like this is public. ","markdown_message":"\u003cp\u003eSaw the email and found out this is one of the public report? I suggest we make this \u0026quot;public\u0026quot; so people in the program can see it. Currently, it does not look like this is public. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-26T20:30:07.837Z","updated_at":"2019-03-26T20:30:07.837Z","first_to_agree":true,"actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4396023,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T20:42:55.412Z","updated_at":"2019-03-26T20:42:55.412Z","actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4396024,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T20:42:55.512Z","updated_at":"2019-03-26T20:42:55.512Z","actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}