{"id":90274,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDI3NA==","url":"https://hackerone.com/reports/90274","title":"CSV Excel Macro Injection Vulnerability in export chat logs","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-24T05:20:48.138Z","submitted_at":"2015-09-24T05:20:48.138Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"alyssa_herrera","url":"/alyssa_herrera","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":205,"url":"https://hackerone.com/zendesk","handle":"zendesk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zendesk","twitter_handle":"","website":"https://www.zendesk.com","about":"Zendesk is a leading cloud-based customer service software solution. Over 100,000 customer accounts use Zendesk to increase customer satisfaction."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-11-05T19:38:38.503Z","bug_reporter_agreed_on_going_public_at":"2015-11-05T02:03:58.957Z","team_member_agreed_on_going_public_at":"2015-11-05T19:38:36.652Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Scenario: An attacker creates a name as =AND(2\u003e1) with a fake email and  with random text in the message body.  This is similar to a vulnerability recently found in zendesk.com as well. When a team member clicks export as csv and opens it instead of seeing =AND(2\u003e1) they see TRUE.  Meaning that cell is now active, and an attacker could make a chat request using a malicious function to execute malware on a team member's pc. \n\nSince functions aren't escaped, the possibilities of using this can be limitless and can cause a severe impact. One example is having it execute malware on staff's computer as seen below, leveraging cmd to execute commands. \n\n\nCrude Poc for executing cmd\nuse -2+3+cmd|' /C calc'!E1 and could execute malicious commands through CMD. \nE1 is the cell it's located in.\n\nAlthough excel has a feature to block this by tell a user that it wants to execute an external script, the team member would believe it's a trusted file coming from a trusted and have a high chance of this being executed. Seeing that it's generated by your site, they may believe it's an enhance functionalist of it to stream line, support. \n\nBest way to mitigate this vulnerability is if you append ' to the list of triggers, = , + , - Excel will ignore the ' and just show ='AND(2\u003e1) instead\n\nSources: https://www.owasp.org/index.php/CSV_Excel_Macro_Injection\n\n","vulnerability_information_html":"\u003cp\u003eScenario: An attacker creates a name as =AND(2\u0026gt;1) with a fake email and  with random text in the message body.  This is similar to a vulnerability recently found in zendesk.com as well. When a team member clicks export as csv and opens it instead of seeing =AND(2\u0026gt;1) they see TRUE.  Meaning that cell is now active, and an attacker could make a chat request using a malicious function to execute malware on a team member\u0026#39;s pc. \u003c/p\u003e\n\n\u003cp\u003eSince functions aren\u0026#39;t escaped, the possibilities of using this can be limitless and can cause a severe impact. One example is having it execute malware on staff\u0026#39;s computer as seen below, leveraging cmd to execute commands. \u003c/p\u003e\n\n\u003cp\u003eCrude Poc for executing cmd\u003cbr\u003e\nuse -2+3+cmd|\u0026#39; /C calc\u0026#39;!E1 and could execute malicious commands through CMD. \u003cbr\u003e\nE1 is the cell it\u0026#39;s located in.\u003c/p\u003e\n\n\u003cp\u003eAlthough excel has a feature to block this by tell a user that it wants to execute an external script, the team member would believe it\u0026#39;s a trusted file coming from a trusted and have a high chance of this being executed. Seeing that it\u0026#39;s generated by your site, they may believe it\u0026#39;s an enhance functionalist of it to stream line, support. \u003c/p\u003e\n\n\u003cp\u003eBest way to mitigate this vulnerability is if you append \u0026#39; to the list of triggers, = , + , - Excel will ignore the \u0026#39; and just show =\u0026#39;AND(2\u0026gt;1) instead\u003c/p\u003e\n\n\u003cp\u003eSources: \u003ca title=\"https://www.owasp.org/index.php/CSV_Excel_Macro_Injection\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FCSV_Excel_Macro_Injection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/CSV_Excel_Macro_Injection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-05T02:03:59.117Z","allow_singular_disclosure_after":-159944709.49103767,"singular_disclosure_allowed":true,"vote_count":5,"voters":["sw33tlie","alyssa_herrera","apapedulimu","luckydivino","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":597083,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"G2 would be used in the cmd poc since it's reflected there.","markdown_message":"\u003cp\u003eG2 would be used in the cmd poc since it\u0026#39;s reflected there.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-24T05:23:10.377Z","updated_at":"2015-09-24T05:23:47.374Z","actor":{"username":"alyssa_herrera","cleared":true,"url":"/alyssa_herrera","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":597715,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @psychomantis,\n\nCongratulations! Your submitted vulnerability has been validated and is in process for remediation. \n\nAlso, you will be awarded $100 and publicly thanked for the responsible disclosure on our Hall of Fame. \n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/psychomantis\"\u003e@psychomantis\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eCongratulations! Your submitted vulnerability has been validated and is in process for remediation. \u003c/p\u003e\n\n\u003cp\u003eAlso, you will be awarded $100 and publicly thanked for the responsible disclosure on our Hall of Fame. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-24T21:31:57.561Z","updated_at":"2015-09-24T21:31:57.561Z","actor":{"url":"/zendesk","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zendesk"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"zendesk","collaborator":{"username":"alyssa_herrera","url":"/alyssa_herrera"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":597717,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-24T21:32:18.754Z","updated_at":"2015-09-24T21:32:18.754Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @psychomantis,\n\nYour submitted issue has been remediated. Can you also verify the fix before we resolve this bug?\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/psychomantis\"\u003e@psychomantis\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYour submitted issue has been remediated. Can you also verify the fix before we resolve this bug?\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T19:39:59.730Z","updated_at":"2015-11-04T19:39:59.730Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It looks to be patched  fully now. Thanks for your quick response","markdown_message":"\u003cp\u003eIt looks to be patched  fully now. Thanks for your quick response\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T21:50:15.864Z","updated_at":"2015-11-04T21:50:15.864Z","actor":{"username":"alyssa_herrera","cleared":true,"url":"/alyssa_herrera","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645955,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for participating in the [Zopim Bug Bounty program](https://hackerone.com/zopim). Please feel free to reach out if you have any questions or concerns.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eThank you for participating in the \u003ca href=\"https://hackerone.com/zopim\"\u003eZopim Bug Bounty program\u003c/a\u003e. Please feel free to reach out if you have any questions or concerns.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T22:06:15.768Z","updated_at":"2015-11-04T22:06:15.768Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"alyssa_herrera","url":"/alyssa_herrera"},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":646215,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-05T02:03:58.975Z","updated_at":"2015-11-05T02:03:58.975Z","first_to_agree":true,"actor":{"username":"alyssa_herrera","cleared":true,"url":"/alyssa_herrera","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":647157,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-05T19:38:36.678Z","updated_at":"2015-11-05T19:38:36.678Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":647158,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-05T19:38:38.527Z","updated_at":"2015-11-05T19:38:38.527Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}