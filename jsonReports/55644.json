{"id":55644,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NTY0NA==","url":"https://hackerone.com/reports/55644","title":"Lack of SSL Pinning on POS Application ( iOS )","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-04-10T07:33:09.683Z","submitted_at":"2015-04-10T07:33:09.683Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ishikawa","url":"/ishikawa","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/797/dbf342ccb9d760e540ad2831da2dcf44a3f6bf2a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-05-21T16:10:17.309Z","bug_reporter_agreed_on_going_public_at":"2015-04-21T16:09:46.285Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#### Description\r\n\r\nGiven that this is a POS application and handle CHD, cryptographic security is of most importance. Applications such as Square, Amazons POS, etc. have already implemented this. The iOS application is correctly checking for SSL certs using the os keychain, but due to the lack of checking for wether or not the certificate actually belongs to Sopify, the mobile app is vulnerable to MiTM attacks in which an attacker is able to install or force the user to install a certificate on the device. Given today's known issues with CAs and the lack of trust they are generating lately, Pinning on mobile devices is a technique that is becoming a standard practice. SSL Pinning is a technique for which you pin your applications or clients to one or more SSL Certificates, keys or CAs. This technique allows you to perform the normal SSL chain of trust exchange during SSL transmissions, but also checks that the SSL certificate or key within that cert is actually the one you know and trust.\r\n\r\n#### Vulnerable platform\r\n\r\niOS - entire application.\r\n\r\n#### Proof of Concept\r\n\r\nA simple way of testing this will be to use a tool like Burp Proxy and/or mitmproxy.\r\nStep 1) install the \"malicious\" cert on device and trust it. An attacker can easily trick a user to install a profile, and/or malicious applications could potentially do it as part of installation. \u2028Step 2) Proxy all the communication through them. \u2028Step 3) You will confirm that your application is no longer using the Certificate it should trust.\r\n\r\n#### Recommendation\r\n\r\nEven though this is not a high risk vulnerability, lack of SSL Pinning certainly creates an unnecessary risk for applications on mobile devices. It is our recommendation that Shopify implements SSL Pinning on iOS, and do not trust the os-level certificate store since other applications might have control over it and there is no guarantees they won't be maliciously altered. Additionally, you might have other types of attacks in which CA issue wild-card certificates to random entities, as it was recently seen with Google and a Chinese CA.\r\nFor more information please refer to \r\nhttps://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning","vulnerability_information_html":"\u003ch4 id=\"description\"\u003eDescription\u003c/h4\u003e\n\n\u003cp\u003eGiven that this is a POS application and handle CHD, cryptographic security is of most importance. Applications such as Square, Amazons POS, etc. have already implemented this. The iOS application is correctly checking for SSL certs using the os keychain, but due to the lack of checking for wether or not the certificate actually belongs to Sopify, the mobile app is vulnerable to MiTM attacks in which an attacker is able to install or force the user to install a certificate on the device. Given today\u0026#39;s known issues with CAs and the lack of trust they are generating lately, Pinning on mobile devices is a technique that is becoming a standard practice. SSL Pinning is a technique for which you pin your applications or clients to one or more SSL Certificates, keys or CAs. This technique allows you to perform the normal SSL chain of trust exchange during SSL transmissions, but also checks that the SSL certificate or key within that cert is actually the one you know and trust.\u003c/p\u003e\n\n\u003ch4 id=\"vulnerable-platform\"\u003eVulnerable platform\u003c/h4\u003e\n\n\u003cp\u003eiOS - entire application.\u003c/p\u003e\n\n\u003ch4 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h4\u003e\n\n\u003cp\u003eA simple way of testing this will be to use a tool like Burp Proxy and/or mitmproxy.\u003cbr\u003e\nStep 1) install the \u0026quot;malicious\u0026quot; cert on device and trust it. An attacker can easily trick a user to install a profile, and/or malicious applications could potentially do it as part of installation. \u2028Step 2) Proxy all the communication through them. \u2028Step 3) You will confirm that your application is no longer using the Certificate it should trust.\u003c/p\u003e\n\n\u003ch4 id=\"recommendation\"\u003eRecommendation\u003c/h4\u003e\n\n\u003cp\u003eEven though this is not a high risk vulnerability, lack of SSL Pinning certainly creates an unnecessary risk for applications on mobile devices. It is our recommendation that Shopify implements SSL Pinning on iOS, and do not trust the os-level certificate store since other applications might have control over it and there is no guarantees they won\u0026#39;t be maliciously altered. Additionally, you might have other types of attacks in which CA issue wild-card certificates to random entities, as it was recently seen with Google and a Chinese CA.\u003cbr\u003e\nFor more information please refer to \u003cbr\u003e\n\u003ca title=\"https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FCertificate_and_Public_Key_Pinning\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-05-21T16:10:04.638Z","allow_singular_disclosure_after":-176998207.24004352,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","shazad_sadiq"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":382402,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thank you for your report.\n\nWe will consider implementing certificate pinning in future versions of our mobile applications, but do not consider this a serious enough issue to warrant immediate changes as it requires the user to add a malicious certificate to their own device, or for a publicly trusted CA to issue an invalid certificate.","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eWe will consider implementing certificate pinning in future versions of our mobile applications, but do not consider this a serious enough issue to warrant immediate changes as it requires the user to add a malicious certificate to their own device, or for a publicly trusted CA to issue an invalid certificate.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T19:10:05.632Z","updated_at":"2015-04-16T19:10:05.632Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@clayton have in mind that OMM programs on mobile devices do install Profiles with their own certificates and there are plenty of attacks currently doing this type of trick. Additionally, you even have unintended applications such as the case for LinkedIn who created an app that forced people into installing profiles creating a trend in people to trust this actions.  IHMO, you should to take a second look at this for your own security sake. It sounds we both agree on the fact that is an issue, not just on the severity of it.  I agree with you it is not a \"critical\" issue, but I would recommend you not to treat as low, but as a medium-high. This is a common trend nowadays and the type of application you guys have that handles CHD. It is important that you are on top of your game. \n\nLast, but not least,  Given this is not a duplicate \u0026 given we both agree it is an issue we just disagree on the severity. Will I still get a bounty ?","markdown_message":"\u003cp\u003e\u003ca href=\"/clayton\"\u003e@clayton\u003c/a\u003e have in mind that OMM programs on mobile devices do install Profiles with their own certificates and there are plenty of attacks currently doing this type of trick. Additionally, you even have unintended applications such as the case for LinkedIn who created an app that forced people into installing profiles creating a trend in people to trust this actions.  IHMO, you should to take a second look at this for your own security sake. It sounds we both agree on the fact that is an issue, not just on the severity of it.  I agree with you it is not a \u0026quot;critical\u0026quot; issue, but I would recommend you not to treat as low, but as a medium-high. This is a common trend nowadays and the type of application you guys have that handles CHD. It is important that you are on top of your game. \u003c/p\u003e\n\n\u003cp\u003eLast, but not least,  Given this is not a duplicate \u0026amp; given we both agree it is an issue we just disagree on the severity. Will I still get a bounty ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T19:32:13.650Z","updated_at":"2015-04-16T19:32:13.650Z","actor":{"username":"ishikawa","cleared":false,"url":"/ishikawa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/797/dbf342ccb9d760e540ad2831da2dcf44a3f6bf2a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":382654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This report will not get a bounty. This issue has been previously reported to our security team.","markdown_message":"\u003cp\u003eThis report will not get a bounty. This issue has been previously reported to our security team.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T22:10:29.182Z","updated_at":"2015-04-16T22:10:29.182Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@andrewdunbar thanks for the prompt answer. ","markdown_message":"\u003cp\u003e\u003ca href=\"/andrewdunbar\"\u003e@andrewdunbar\u003c/a\u003e thanks for the prompt answer. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T22:11:20.015Z","updated_at":"2015-04-16T22:11:20.015Z","actor":{"username":"ishikawa","cleared":false,"url":"/ishikawa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/797/dbf342ccb9d760e540ad2831da2dcf44a3f6bf2a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":386503,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-21T16:09:46.393Z","updated_at":"2015-04-21T16:09:46.393Z","first_to_agree":true,"actor":{"username":"ishikawa","cleared":false,"url":"/ishikawa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/797/dbf342ccb9d760e540ad2831da2dcf44a3f6bf2a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":425896,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-21T16:10:17.466Z","updated_at":"2015-05-21T16:10:17.466Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}