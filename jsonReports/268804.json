{"id":268804,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjg4MDQ=","url":"https://hackerone.com/reports/268804","title":"CVE-2017-12986 The IPv6 routing header parser in tcpdump before 4.9.2 has a buffer over-read in print-rt6.c:rt6_print().","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-09-15T23:38:23.508Z","submitted_at":"2017-09-15T23:38:23.508Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21653,"url":"https://hackerone.com/ibb-data","handle":"ibb-data","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Data Processing (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-12986"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-08T20:32:28.931Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:23:09.565Z","team_member_agreed_on_going_public_at":"2019-10-08T20:32:28.792Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Reported to the devs on 4 February 2017.\nTcpdump 4.9.2 released on 8 September 2017.\nPatch: https://github.com/the-tcpdump-group/tcpdump/commit/7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c\n\n`The IPv6 routing header parser in tcpdump before 4.9.2 has a buffer over-read in print-rt6.c:rt6_print().`\n\n```\n/tcpdump -nr test000\nreading from file test000, link-type IPV6 (Raw IPv6)\n=================================================================\n==567==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60400000e001 at pc 0x00000063663d bp 0x7ffec82f8fb0 sp 0x7ffec82f8fa8\nREAD of size 1 at 0x60400000e001 thread T0\n    #0 0x63663c in rt6_print /root/tcpdump/./print-rt6.c:48:2\n    #1 0x57859b in ip6_print /root/tcpdump/./print-ip6.c:328:14\n    #2 0x576fdc in ipN_print /root/tcpdump/./print-ip.c:700:3\n    #3 0x626677 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n    #4 0x4de3c9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n    #5 0x4ccb0b in print_packet /root/tcpdump/./tcpdump.c:2555:2\n    #6 0x775960 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n    #7 0x6a3f3c in pcap_loop /root/libpcap/./pcap.c:1623:8\n    #8 0x4c8f1e in main /root/tcpdump/./tcpdump.c:2058:12\n    #9 0x7fe428299b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n    #10 0x4c419c in _start (/root/tcpdump/tcpdump+0x4c419c)\n\n0x60400000e001 is located 1 bytes to the right of 48-byte region [0x60400000dfd0,0x60400000e000)\nallocated by thread T0 here:\n    #0 0x4a6b1b in malloc (/root/tcpdump/tcpdump+0x4a6b1b)\n    #1 0x7772b3 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n    #2 0x774fc2 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n    #3 0x774d54 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump/./print-rt6.c:48 rt6_print\n```","vulnerability_information_html":"\u003cp\u003eReported to the devs on 4 February 2017.\u003cbr\u003e\nTcpdump 4.9.2 released on 8 September 2017.\u003cbr\u003e\nPatch: \u003ca title=\"https://github.com/the-tcpdump-group/tcpdump/commit/7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fthe-tcpdump-group%2Ftcpdump%2Fcommit%2F7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/the-tcpdump-group/tcpdump/commit/7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eThe IPv6 routing header parser in tcpdump before 4.9.2 has a buffer over-read in print-rt6.c:rt6_print().\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/tcpdump -nr test000\nreading from file test000, link-type IPV6 (Raw IPv6)\n=================================================================\n==567==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60400000e001 at pc 0x00000063663d bp 0x7ffec82f8fb0 sp 0x7ffec82f8fa8\nREAD of size 1 at 0x60400000e001 thread T0\n    #0 0x63663c in rt6_print /root/tcpdump/./print-rt6.c:48:2\n    #1 0x57859b in ip6_print /root/tcpdump/./print-ip6.c:328:14\n    #2 0x576fdc in ipN_print /root/tcpdump/./print-ip.c:700:3\n    #3 0x626677 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n    #4 0x4de3c9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n    #5 0x4ccb0b in print_packet /root/tcpdump/./tcpdump.c:2555:2\n    #6 0x775960 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n    #7 0x6a3f3c in pcap_loop /root/libpcap/./pcap.c:1623:8\n    #8 0x4c8f1e in main /root/tcpdump/./tcpdump.c:2058:12\n    #9 0x7fe428299b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n    #10 0x4c419c in _start (/root/tcpdump/tcpdump+0x4c419c)\n\n0x60400000e001 is located 1 bytes to the right of 48-byte region [0x60400000dfd0,0x60400000e000)\nallocated by thread T0 here:\n    #0 0x4a6b1b in malloc (/root/tcpdump/tcpdump+0x4a6b1b)\n    #1 0x7772b3 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n    #2 0x774fc2 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n    #3 0x774d54 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump/./print-rt6.c:48 rt6_print\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":9,"name":"Buffer Over-read"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-03T16:23:09.633Z","allow_singular_disclosure_after":-36420901.79690176,"singular_disclosure_allowed":true,"vote_count":7,"voters":["geeknik","codeanddecode","japz","kishoretrommer","lysis","cyraf","4souss"],"severity":{"rating":"high","score":7.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2000727,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-15T23:47:31.047Z","updated_at":"2017-09-15T23:47:31.047Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":75593},"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2017346,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For the tpcdump reports, both old and new, I believe these flaws could be exploited remotely by sending malformed packets at targets you know are running tcpdump. Unfortunately for me, I didn't do a good enough job of explaining this and the submissions look like it is a local crash in tcpdump while reading pcap files and also I don't have the chops to craft an exploit that takes advantage of this however I believe at the very least we'll cause a crash on the tcpdump side after receiving the packet due to memory corruption, in this case an invalid read caused by a malformed IPv6 routing header.","markdown_message":"\u003cp\u003eFor the tpcdump reports, both old and new, I believe these flaws could be exploited remotely by sending malformed packets at targets you know are running tcpdump. Unfortunately for me, I didn\u0026#39;t do a good enough job of explaining this and the submissions look like it is a local crash in tcpdump while reading pcap files and also I don\u0026#39;t have the chops to craft an exploit that takes advantage of this however I believe at the very least we\u0026#39;ll cause a crash on the tcpdump side after receiving the packet due to memory corruption, in this case an invalid read caused by a malformed IPv6 routing header.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-23T03:59:15.954Z","updated_at":"2017-09-23T03:59:15.954Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216207,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:19:03.565Z","updated_at":"2017-12-12T06:19:03.565Z","additional_data":{"old_team":"The Internet","new_team":"Data Processing (IBB)"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216436,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:41:08.296Z","updated_at":"2017-12-12T06:41:08.296Z","additional_data":{"old_severity":"High","new_severity":"High (7.3)","old_severity_id":75593,"new_severity_id":101069},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216437,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:41:14.960Z","updated_at":"2017-12-12T06:41:14.960Z","cve_ids":["CVE-2017-12986"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216438,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:41:19.418Z","updated_at":"2017-12-12T06:41:19.418Z","actor":{"url":"/ibb-data","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Data Processing (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-data","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216439,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:41:25.654Z","updated_at":"2017-12-12T06:41:25.654Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960680,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:23:09.584Z","updated_at":"2019-10-04T16:23:09.584Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5989668,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:32:28.829Z","updated_at":"2019-10-08T20:32:28.829Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989669,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:32:28.958Z","updated_at":"2019-10-08T20:32:28.958Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}