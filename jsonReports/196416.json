{"id":196416,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTY0MTY=","url":"https://hackerone.com/reports/196416","title":"Clearing , Shifting and Pop Value from Frozen Array  ","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2017-01-06T21:41:25.406Z","submitted_at":"2017-01-06T21:41:25.406Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"an0n-j","url":"/an0n-j","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/099/222/8fb256358976ee24d8bc993c42822d8476f5d816_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-30T13:20:50.498Z","bug_reporter_agreed_on_going_public_at":"2017-08-30T12:24:12.630Z","team_member_agreed_on_going_public_at":"2017-08-30T13:20:50.455Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey again!\n\nFounded another missing best practice in mruby. That allow an attacker to Delete (pop) or clear the ___Frozen ARRAY___. This report is similar to [194866](https://hackerone.com/reports/194866)\nPOC\n===\n$a = [1,2,3,4,5].freeze\n\n$a.pop         \n\u003e\"#=\u003e This will give 5 and ___$a___ will become [1,2,3,4]\"\n\n$a.shift       \n\u003e \"#=\u003e This will give 1 and ___$a___ will become [2,3,4,5]\"\n\n$a.clear        \n\u003e \"#=\u003e This will clear the whole FROZEN ARRAY.\"\n\nExplanation\n========\nThe issue is in __mrb_ary_pop__  ,  __mrb_ary_shift__  \u0026 in  __mrb_ary_clear__ methods of [Array.c](https://github.com/mruby/mruby/blob/master/src/array.c)  because there is no method calling to check the weather the Array is frozen or not.\nI'm not too much familiar with ruby to determine its impact, may be it doesn't effect at all but it should be fix.\n\nFix\n==\nApply __ary_modify__ method in all above mentioned methods.","vulnerability_information_html":"\u003cp\u003eHey again!\u003c/p\u003e\n\n\u003cp\u003eFounded another missing best practice in mruby. That allow an attacker to Delete (pop) or clear the \u003cstrong\u003e\u003cem\u003eFrozen ARRAY\u003c/em\u003e\u003c/strong\u003e. This report is similar to \u003ca href=\"https://hackerone.com/reports/194866\"\u003e194866\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePOC\u003c/h1\u003e\n\n\u003cp\u003e$a = [1,2,3,4,5].freeze\u003c/p\u003e\n\n\u003cp\u003e$a.pop         \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u0026quot;#=\u0026gt; This will give 5 and \u003cstrong\u003e\u003cem\u003e$a\u003c/em\u003e\u003c/strong\u003e will become [1,2,3,4]\u0026quot;\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e$a.shift       \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u0026quot;#=\u0026gt; This will give 1 and \u003cstrong\u003e\u003cem\u003e$a\u003c/em\u003e\u003c/strong\u003e will become [2,3,4,5]\u0026quot;\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e$a.clear        \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u0026quot;#=\u0026gt; This will clear the whole FROZEN ARRAY.\u0026quot;\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch1 id=\"explanation\"\u003eExplanation\u003c/h1\u003e\n\n\u003cp\u003eThe issue is in \u003cstrong\u003emrb_ary_pop\u003c/strong\u003e  ,  \u003cstrong\u003emrb_ary_shift\u003c/strong\u003e  \u0026amp; in  \u003cstrong\u003emrb_ary_clear\u003c/strong\u003e methods of \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fblob%2Fmaster%2Fsrc%2Farray.c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eArray.c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  because there is no method calling to check the weather the Array is frozen or not.\u003cbr\u003e\nI\u0026#39;m not too much familiar with ruby to determine its impact, may be it doesn\u0026#39;t effect at all but it should be fix.\u003c/p\u003e\n\n\u003ch1 id=\"fix\"\u003eFix\u003c/h1\u003e\n\n\u003cp\u003eApply \u003cstrong\u003eary_modify\u003c/strong\u003e method in all above mentioned methods.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-29T12:24:12.687Z","allow_singular_disclosure_after":-102529645.02643946,"singular_disclosure_allowed":true,"vote_count":12,"voters":["cuso4","eveeez","khizer47","mr_r3boot","an0n-j","cr4xerbik4sh","japz","spetr0x","clarckowen_","farzan_2003","and 2 more..."],"severity":{"rating":"none","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1405277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-01-06T21:41:25.623Z","updated_at":"2017-01-06T21:41:25.623Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1405457,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue and opened an issue upstream: https://github.com/mruby/mruby/issues/3379\n\nSince this issue does not appear to have any security implications in our environment, it will most likely not be eligible for a bounty.","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the issue and opened an issue upstream: \u003ca title=\"https://github.com/mruby/mruby/issues/3379\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3379\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3379\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSince this issue does not appear to have any security implications in our environment, it will most likely not be eligible for a bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-06T22:55:18.561Z","updated_at":"2017-01-06T22:55:18.561Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1407230,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue has been fixed upstream.","markdown_message":"\u003cp\u003eThanks again for your report. This issue has been fixed upstream.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-08T15:51:50.155Z","updated_at":"2017-01-08T15:51:50.155Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"an0n-j","url":"/an0n-j"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1407231,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-08T15:52:24.638Z","updated_at":"2017-01-08T15:52:24.638Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1965643,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-30T12:24:12.649Z","updated_at":"2017-08-30T12:24:12.649Z","first_to_agree":true,"actor":{"username":"an0n-j","cleared":false,"url":"/an0n-j","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/099/222/8fb256358976ee24d8bc993c42822d8476f5d816_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1965755,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-30T13:20:50.472Z","updated_at":"2017-08-30T13:20:50.472Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1965756,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-30T13:20:50.513Z","updated_at":"2017-08-30T13:20:50.513Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}