{"id":21064,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTA2NA==","url":"https://hackerone.com/reports/21064","title":"Back - Refresh - Attack To  Obtain User Credentials","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-07-22T18:14:57.958Z","submitted_at":"2014-07-22T18:14:57.958Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xtross1","url":"/xtross1","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-07-23T16:40:23.459Z","bug_reporter_agreed_on_going_public_at":"2014-07-23T16:35:22.471Z","team_member_agreed_on_going_public_at":"2014-07-23T16:40:23.369Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Back - refresh attack is attack which enables an adversary to obtain application credentials by going by to previous page and re-submitting the expired-document.\r\n\r\nHow to perform:\r\n1. Register to https://\u003csome-site\u003e/auth/register/\r\n2. Once registered, press \"Back\" on the browser window. Now you'll see the \"Document Expired\" page.\r\n3. Now run an interceptor (burp/tamper data)\r\n4. Click \"Tray again\" on the web page\r\n5. Click \"Re-send data\"\r\n6. Watch the intercepted request.\r\n\r\nYou'll observe that login credentials both email and passwords being resubmitted by browser get captured.","vulnerability_information_html":"\u003cp\u003eBack - refresh attack is attack which enables an adversary to obtain application credentials by going by to previous page and re-submitting the expired-document.\u003c/p\u003e\n\n\u003cp\u003eHow to perform:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRegister to https://\u0026lt;some-site\u0026gt;/auth/register/\u003c/li\u003e\n\u003cli\u003eOnce registered, press \u0026quot;Back\u0026quot; on the browser window. Now you\u0026#39;ll see the \u0026quot;Document Expired\u0026quot; page.\u003c/li\u003e\n\u003cli\u003eNow run an interceptor (burp/tamper data)\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Tray again\u0026quot; on the web page\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Re-send data\u0026quot;\u003c/li\u003e\n\u003cli\u003eWatch the intercepted request.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eYou\u0026#39;ll observe that login credentials both email and passwords being resubmitted by browser get captured.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-22T16:35:22.553Z","allow_singular_disclosure_after":-200492476.4002669,"singular_disclosure_allowed":true,"vote_count":1,"voters":["wargsec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":93636,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How do you recommend we prevent this?","markdown_message":"\u003cp\u003eHow do you recommend we prevent this?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-22T18:19:32.691Z","updated_at":"2014-07-22T18:19:32.691Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":93640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The following steps can be used: \n* An intermediate page can be used to prevent this from happening b/w registering and the main landing page\n* Look for redirection status (302 codes)\n* Redirect user back to landing page if he presses back button\n","markdown_message":"\u003cp\u003eThe following steps can be used: \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAn intermediate page can be used to prevent this from happening b/w registering and the main landing page\u003c/li\u003e\n\u003cli\u003eLook for redirection status (302 codes)\u003c/li\u003e\n\u003cli\u003eRedirect user back to landing page if he presses back button\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2014-07-22T18:23:28.075Z","updated_at":"2014-07-22T18:23:28.075Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":93658,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"This doesn't seem worth fixing. In general, if an attacker has access to a browser process with information in history, they can attack it directly. #13587 discusses an attack where the attacker simply inspects the process memory to retrieve the password.\n\nSimilarly, attackers with access to the process can just install a keylogger before you use the machine.\n\nUsing untrusted machines is inherently dangerous, and there are severe limits to the steps we can realistically take to protect users. We also already support two-factor auth, which is probably the best general-purpose mitigation against this class of attacks.","markdown_message":"\u003cp\u003eThis doesn\u0026#39;t seem worth fixing. In general, if an attacker has access to a browser process with information in history, they can attack it directly. \u003ca href=\"/reports/13587\"\u003e#13587\u003c/a\u003e discusses an attack where the attacker simply inspects the process memory to retrieve the password.\u003c/p\u003e\n\n\u003cp\u003eSimilarly, attackers with access to the process can just install a keylogger before you use the machine.\u003c/p\u003e\n\n\u003cp\u003eUsing untrusted machines is inherently dangerous, and there are severe limits to the steps we can realistically take to protect users. We also already support two-factor auth, which is probably the best general-purpose mitigation against this class of attacks.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-22T18:35:51.304Z","updated_at":"2014-07-22T18:35:51.304Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":93661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well the vulnerability which you are describing regarding - obtaining user creds from memory is different attack which is used for forensics altogether.\n\nThe vulnerability exists on registration page hence 2F auth is of no use here.\n\nThis attack can be used POST the user has created an account. Hence if keylogger is not installed on the computer, he can still use this (web based vulnerability) technique to obtain user creds. On a hardened system (where USBs are disabled or EXEs are not allowed to run) , an attacker can simply use an addon - like tamerdata which is an XPI file to obtain creds, just because the application allows re-submission.\n","markdown_message":"\u003cp\u003eWell the vulnerability which you are describing regarding - obtaining user creds from memory is different attack which is used for forensics altogether.\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability exists on registration page hence 2F auth is of no use here.\u003c/p\u003e\n\n\u003cp\u003eThis attack can be used POST the user has created an account. Hence if keylogger is not installed on the computer, he can still use this (web based vulnerability) technique to obtain user creds. On a hardened system (where USBs are disabled or EXEs are not allowed to run) , an attacker can simply use an addon - like tamerdata which is an XPI file to obtain creds, just because the application allows re-submission.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-22T18:41:56.458Z","updated_at":"2014-07-22T18:41:56.458Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":94425,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-23T16:35:22.486Z","updated_at":"2014-07-23T16:35:22.486Z","first_to_agree":true,"actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":94435,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-23T16:40:23.383Z","updated_at":"2014-07-23T16:40:23.383Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":94436,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-23T16:40:23.472Z","updated_at":"2014-07-23T16:40:23.472Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}