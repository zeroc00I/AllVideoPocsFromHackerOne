{"id":9062,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDYy","url":"https://hackerone.com/reports/9062","title":"No CSRF token used in Phone Verification POST","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-04-22T13:19:51.521Z","submitted_at":"2014-04-22T13:19:51.521Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"siddiki","url":"/siddiki","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-06-11T09:01:06.930Z","bug_reporter_agreed_on_going_public_at":"2014-06-11T09:01:06.374Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When I tried to register in mail.ru,I submitted my phone number and Got a verification code in my phone.\r\nDuring submission of that code,I saw that POST goes without any CSRF tokens.And I identified two other vulnerabilities on that procedure.\r\n\r\n1. No Session Verification on server side while submitting the code.This phone verification system should be designed in such a way,so that no one could use that without a proper session.Now with the present design,anyone can submit codes randomly without any session verification.\r\n2. No limitation on random submissions on that form.Any user can try unlimited number of codes on that form.Mail.ru does not have any limit on number of wrong tries at this endpoint.This should be checked.\r\n3. No CSRF token is available on this form submission.Mail.ru should impose CSRF tokens in this form to protect it against CSRF attacks.\r\n","vulnerability_information_html":"\u003cp\u003eWhen I tried to register in mail.ru,I submitted my phone number and Got a verification code in my phone.\u003cbr\u003e\nDuring submission of that code,I saw that POST goes without any CSRF tokens.And I identified two other vulnerabilities on that procedure.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eNo Session Verification on server side while submitting the code.This phone verification system should be designed in such a way,so that no one could use that without a proper session.Now with the present design,anyone can submit codes randomly without any session verification.\u003c/li\u003e\n\u003cli\u003eNo limitation on random submissions on that form.Any user can try unlimited number of codes on that form.Mail.ru does not have any limit on number of wrong tries at this endpoint.This should be checked.\u003c/li\u003e\n\u003cli\u003eNo CSRF token is available on this form submission.Mail.ru should impose CSRF tokens in this form to protect it against CSRF attacks.\u003c/li\u003e\n\u003c/ol\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-05-24T11:16:59.281Z","allow_singular_disclosure_after":-208295552.2397041,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":36080,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for your report to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\n\nCan you point to any exploitation scenario / security impact for this CSRF?","markdown_message":"\u003cp\u003eThank you for your report to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003c/p\u003e\n\n\u003cp\u003eCan you point to any exploitation scenario / security impact for this CSRF?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-22T15:10:30.391Z","updated_at":"2014-04-22T15:10:30.391Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":36087,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Actually there is no legitimate security vulnerability lies on missing CSRF token of this form.But it is a better practice to use CSRF tokens on all FORM.Besides point 1,2 should be taken in count in regard of this issue.","markdown_message":"\u003cp\u003eActually there is no legitimate security vulnerability lies on missing CSRF token of this form.But it is a better practice to use CSRF tokens on all FORM.Besides point 1,2 should be taken in count in regard of this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-22T15:19:25.863Z","updated_at":"2014-04-22T15:19:25.863Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":37948,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"(Un)fortunately, we can't confirm your report as a real security threat. \nWe have a rate limitation in this form, and unfortunately we really no need a CSRF tokens in this place.\nIf you still think you have found a real security vulnerability, you can try to find an exploitation scenario with security impact or provide a working exploit.","markdown_message":"\u003cp\u003e(Un)fortunately, we can\u0026#39;t confirm your report as a real security threat. \u003cbr\u003e\nWe have a rate limitation in this form, and unfortunately we really no need a CSRF tokens in this place.\u003cbr\u003e\nIf you still think you have found a real security vulnerability, you can try to find an exploitation scenario with security impact or provide a working exploit.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-24T11:17:00.014Z","updated_at":"2014-04-24T11:17:33.722Z","actor":{"username":"invented","cleared":false,"url":"/invented","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/144/fa785af0ed7584420769bdcfc1b459187dea42a3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":71578,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-11T09:01:06.391Z","updated_at":"2014-06-11T09:01:06.391Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":71579,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-11T09:01:06.945Z","updated_at":"2014-06-11T09:01:06.945Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}