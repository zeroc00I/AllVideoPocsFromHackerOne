{"id":1018094,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDE4MDk0","url":"https://hackerone.com/reports/1018094","title":"Staff Member can Get POS Access Without User Interaction","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-10-25T00:54:23.928Z","submitted_at":"2020-10-25T00:54:24.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ngalog","url":"/ngalog","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-19T22:08:27.893Z","bug_reporter_agreed_on_going_public_at":"2020-11-19T22:08:27.798Z","team_member_agreed_on_going_public_at":"2020-11-19T19:11:43.124Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI found that it is possible for a staff member to grant themselves POS access without user interaction from admin.\n\n## Steps to reproduce\n- Login as a staff member with `Manage Locations` permission only, in a shop that has POS channel up and running (Could be Lite)\n- Make sure your staff member account didn't have POS enabled \n- Make this GraphQL call\n\n```json\n{\"query\":\"mutation {retailUserDataUpdate(id:\\\"gid://shopify/StaffMember/63779504283\\\",retailUserData:{posAccess:true,pin:\\\"1423\\\"}){staffMember{name canAccessPrivateApps authenticationSettings{tfaEnabled}}userErrors{message}}}\"}\n```\n\nReplace `63779504283` with your personal staff member id, you can find it in `https://your-store.myshopify.com/admin/settings/account/` and click your account name, then you staff member id is in the url.\n\n- Now your staff member account has POS enabled, and pin is set.\n\n## Impact\n\nIt will allow to a staff member to POS takeover without user interaction.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI found that it is possible for a staff member to grant themselves POS access without user interaction from admin.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eLogin as a staff member with \u003ccode\u003eManage Locations\u003c/code\u003e permission only, in a shop that has POS channel up and running (Could be Lite)\u003c/li\u003e\n\u003cli\u003eMake sure your staff member account didn\u0026#39;t have POS enabled \u003c/li\u003e\n\u003cli\u003eMake this GraphQL call\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;query\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;mutation {retailUserDataUpdate(id:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003egid://shopify/StaffMember/63779504283\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e,retailUserData:{posAccess:true,pin:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e1423\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e}){staffMember{name canAccessPrivateApps authenticationSettings{tfaEnabled}}userErrors{message}}}\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eReplace \u003ccode\u003e63779504283\u003c/code\u003e with your personal staff member id, you can find it in \u003ccode\u003ehttps://your-store.myshopify.com/admin/settings/account/\u003c/code\u003e and click your account name, then you staff member id is in the url.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eNow your staff member account has POS enabled, and pin is set.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIt will allow to a staff member to POS takeover without user interaction.\u003c/p\u003e\n","bounty_amount":"1100.0","formatted_bounty":"$1,100","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":13,"voters":["mashoud1122","kapkan","mirhat","th4nu_0x0","powerjacobb1","thenewlife","yinvi777","joe_glueck","loosecontrol","seven6","and 3 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9648290,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @ngalog!\nThank you for your report! We have reproduced this and our engineering team is investigating.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e!\u003cbr\u003e\nThank you for your report! We have reproduced this and our engineering team is investigating.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-27T13:34:28.072Z","updated_at":"2020-10-27T13:34:28.072Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9685733,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @ngalog, thanks again for the report.\n\nOur engineering team has deployed a fix for this so the issue should no longer be reproducible. If you are able to bypass the fix, please let us know.\n\nThanks for helping make Shopify more secure. We hope you'll continue to do so.\n\nHappy Hacking!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e, thanks again for the report.\u003c/p\u003e\n\n\u003cp\u003eOur engineering team has deployed a fix for this so the issue should no longer be reproducible. If you are able to bypass the fix, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThanks for helping make Shopify more secure. We hope you\u0026#39;ll continue to do so.\u003c/p\u003e\n\n\u003cp\u003eHappy Hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-30T17:01:16.367Z","updated_at":"2020-10-30T17:01:16.367Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ngalog","url":"/ngalog"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9685751,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey again @ngalog.\n\nI just wanted to quickly also let you know we'll be following up on a bounty amount soon.\n\nCheers.","markdown_message":"\u003cp\u003eHey again \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eI just wanted to quickly also let you know we\u0026#39;ll be following up on a bounty amount soon.\u003c/p\u003e\n\n\u003cp\u003eCheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-30T17:03:05.732Z","updated_at":"2020-10-30T17:03:05.732Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9685953,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @ngalog,\n\nThanks again for your report! During our investigation, we determined that the implications of having POS access are limited to physical access to a device that is already logged in as a full-permissions user. However, our plan is to eventually remove this barrier. For this reason, we’re awarding a $600 bounty for the current impact of this behaviour, with a $500 bonus to account for potential future impact. Please find below our rationale generated using our [CVSS calculator](https://shopify.github.io/appsec/cvss_calculator/).\n\n## Base Score CVSS:3.0/AV:P/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N 3.2\n## Environment: Core\n\n#### Attack Complexity: L\n* Specific conditions to exploit?: Yes\n* Extensive effort to exploit?: No\n\n#### Privileges Required: L\n* Requires privileged account (not self-registered)?: Yes\n* Does the attacker need extensive permissions?: No\n\n#### User Interaction: N\n* Requires victim to perform some action during exploit?: No\n\n#### Scope: U\n* Can the attacker impact a separate service?: No\n\n#### Confidentiality: L\n* How much data could be accessed?: Some\n* How much of Shopify is impacted?: Some\n\n#### Integrity: L\n* How much data could be changed?: Some\n* How much of Shopify is impacted?: Some\n\n#### Availability: N\n* Level of disruption to network service?: None","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks again for your report! During our investigation, we determined that the implications of having POS access are limited to physical access to a device that is already logged in as a full-permissions user. However, our plan is to eventually remove this barrier. For this reason, we’re awarding a $600 bounty for the current impact of this behaviour, with a $500 bonus to account for potential future impact. Please find below our rationale generated using our \u003ca href=\"/redirect?url=https%3A%2F%2Fshopify.github.io%2Fappsec%2Fcvss_calculator%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCVSS calculator\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"base-score-cvss-3-0-av-p-ac-l-pr-l-ui-n-s-u-c-l-i-l-a-n-3-2\"\u003eBase Score CVSS:3.0/AV:P/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N 3.2\u003c/h2\u003e\n\n\u003ch2 id=\"environment-core\"\u003eEnvironment: Core\u003c/h2\u003e\n\n\u003ch4 id=\"attack-complexity-l\"\u003eAttack Complexity: L\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eSpecific conditions to exploit?: Yes\u003c/li\u003e\n\u003cli\u003eExtensive effort to exploit?: No\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4 id=\"privileges-required-l\"\u003ePrivileges Required: L\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eRequires privileged account (not self-registered)?: Yes\u003c/li\u003e\n\u003cli\u003eDoes the attacker need extensive permissions?: No\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4 id=\"user-interaction-n\"\u003eUser Interaction: N\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eRequires victim to perform some action during exploit?: No\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4 id=\"scope-u\"\u003eScope: U\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eCan the attacker impact a separate service?: No\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4 id=\"confidentiality-l\"\u003eConfidentiality: L\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eHow much data could be accessed?: Some\u003c/li\u003e\n\u003cli\u003eHow much of Shopify is impacted?: Some\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4 id=\"integrity-l\"\u003eIntegrity: L\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eHow much data could be changed?: Some\u003c/li\u003e\n\u003cli\u003eHow much of Shopify is impacted?: Some\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4 id=\"availability-n\"\u003eAvailability: N\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eLevel of disruption to network service?: None\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-10-30T17:20:13.009Z","updated_at":"2020-10-30T17:20:13.009Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"600.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"ngalog","url":"/ngalog"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9698672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds great! Thanks!","markdown_message":"\u003cp\u003eSounds great! Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-02T04:52:21.970Z","updated_at":"2020-11-02T04:52:21.970Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9871533,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-19T19:11:43.140Z","updated_at":"2020-11-19T19:11:43.140Z","first_to_agree":true,"actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9872981,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-19T22:08:27.832Z","updated_at":"2020-11-19T22:08:27.832Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9872982,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-19T22:08:27.925Z","updated_at":"2020-11-19T22:08:27.925Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}