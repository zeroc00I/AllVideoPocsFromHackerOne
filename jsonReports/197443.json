{"id":197443,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTc0NDM=","url":"https://hackerone.com/reports/197443","title":"XSS in topics because of bandcamp preview engine vulnerability","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-01-11T02:43:37.980Z","submitted_at":"2017-01-11T02:43:37.980Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16893,"url":"https://hackerone.com/discourse","handle":"discourse","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Discourse","twitter_handle":"discourse","website":"https://discourse.org","about":"Discourse is JavaScript (ember.js) and Ruby on Rails based 100% open source discussion software -- https://github.com/discourse/discourse"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-01-20T23:50:12.412Z","bug_reporter_agreed_on_going_public_at":"2017-01-20T23:50:12.367Z","team_member_agreed_on_going_public_at":"2017-01-20T23:49:06.302Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. Load http://try.discourse.org\n2. Click \"New topic\"\n3. Enter this payload https://89.223.28.48/bandcamp.com/album/index.html?XSSa2 to field with placeholder \"Type title or paste a link here\"\n4. Wait for the preview engine to parse the link\n4. XSS will fire\n\n{F151439}\n\nYou should sanitize external data in this engine and replace *matches_regexp* from\n`^https?:\\/\\/.*bandcamp\\.com\\/album\\/`\nto\n`^https?:\\/\\/.*\\.bandcamp\\.com\\/album\\/`\nto fix the issue.","vulnerability_information_html":"\u003col\u003e\n\u003cli\u003eLoad \u003ca title=\"http://try.discourse.org\" href=\"/redirect?url=http%3A%2F%2Ftry.discourse.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://try.discourse.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;New topic\u0026quot;\u003c/li\u003e\n\u003cli\u003eEnter this payload \u003ca title=\"https://89.223.28.48/bandcamp.com/album/index.html?XSSa2\" href=\"/redirect?url=https%3A%2F%2F89.223.28.48%2Fbandcamp.com%2Falbum%2Findex.html%3FXSSa2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://89.223.28.48/bandcamp.com/album/index.html?XSSa2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to field with placeholder \u0026quot;Type title or paste a link here\u0026quot;\u003c/li\u003e\n\u003cli\u003eWait for the preview engine to parse the link\u003c/li\u003e\n\u003cli\u003eXSS will fire\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"______________2017-01-11___5.23.20.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/151/439/90d35b475ba20f54579aec62721b1f7a6d940aa4/______________2017-01-11___5.23.20.png?response-content-disposition=attachment%3B%20filename%3D%22______________2017-01-11___5.23.20.png%22%3B%20filename%2A%3DUTF-8%27%27______________2017-01-11___5.23.20.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045202Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026amp;X-Amz-Signature=1236332e435e32dbe12704d405797420ce69c95c0947f51858a919767d28d59a\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/151/439/90d35b475ba20f54579aec62721b1f7a6d940aa4/______________2017-01-11___5.23.20.png?response-content-disposition=attachment%3B%20filename%3D%22______________2017-01-11___5.23.20.png%22%3B%20filename%2A%3DUTF-8%27%27______________2017-01-11___5.23.20.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045202Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026amp;X-Amz-Signature=1236332e435e32dbe12704d405797420ce69c95c0947f51858a919767d28d59a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eYou should sanitize external data in this engine and replace \u003cem\u003ematches_regexp\u003c/em\u003e from\u003cbr\u003e\n\u003ccode\u003e^https?:\\/\\/.*bandcamp\\.com\\/album\\/\u003c/code\u003e\u003cbr\u003e\nto\u003cbr\u003e\n\u003ccode\u003e^https?:\\/\\/.*\\.bandcamp\\.com\\/album\\/\u003c/code\u003e\u003cbr\u003e\nto fix the issue.\u003c/p\u003e\n","bounty_amount":"256.0","formatted_bounty":"$256","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":151439,"file_name":"______________2017-01-11___5.23.20.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/151/439/90d35b475ba20f54579aec62721b1f7a6d940aa4/______________2017-01-11___5.23.20.png?response-content-disposition=attachment%3B%20filename%3D%22______________2017-01-11___5.23.20.png%22%3B%20filename%2A%3DUTF-8%27%27______________2017-01-11___5.23.20.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045202Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=1236332e435e32dbe12704d405797420ce69c95c0947f51858a919767d28d59a","file_size":2646630,"type":"image/png"}],"allow_singular_disclosure_at":"2017-02-19T23:49:06.381Z","allow_singular_disclosure_after":-121669375.89447677,"singular_disclosure_allowed":true,"vote_count":13,"voters":["bogdantcaciuc","spam404","yaworsk","skavans","marotagem_vrt","eveeez","malcolmx","khizer47","daniyal_nasir","fantam1","and 3 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1412789,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please change the severity to the \"High\". I have made mistake looking at this report #191909 where you have changed the severity to the \"Critical\" at first.","markdown_message":"\u003cp\u003ePlease change the severity to the \u0026quot;High\u0026quot;. I have made mistake looking at this report \u003ca href=\"/reports/191909\"\u003e#191909\u003c/a\u003e where you have changed the severity to the \u0026quot;Critical\u0026quot; at first.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T02:52:55.367Z","updated_at":"2017-01-11T02:52:55.367Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1412813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting @skavans, we'll get back to you regarding this shortly.","markdown_message":"\u003cp\u003eThanks for reporting \u003ca href=\"/skavans\"\u003e@skavans\u003c/a\u003e, we\u0026#39;ll get back to you regarding this shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T03:37:41.355Z","updated_at":"2017-01-11T03:37:41.355Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1412822,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Not an exploit unless the post can be saved and the rendered, saved post issues XSS. Otherwise you are just XSS-ing.. yourself.\n\nThere is the issue of editing but that narrows the surface considerably versus saved posts.","markdown_message":"\u003cp\u003eNot an exploit unless the post can be saved and the rendered, saved post issues XSS. Otherwise you are just XSS-ing.. yourself.\u003c/p\u003e\n\n\u003cp\u003eThere is the issue of editing but that narrows the surface considerably versus saved posts.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T03:43:29.775Z","updated_at":"2017-01-11T03:50:10.939Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1412824,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-11T03:43:40.302Z","updated_at":"2017-01-11T03:43:40.302Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":18774,"new_severity_id":18781},"actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1413072,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I wanna make the vector for the saved post but I can not post anything, all 2 test accounts are \"temporary on hold\" for about an hour already, should I wait for the accounts moderation?\nAccounts name are skavans and skavans2.","markdown_message":"\u003cp\u003eI wanna make the vector for the saved post but I can not post anything, all 2 test accounts are \u0026quot;temporary on hold\u0026quot; for about an hour already, should I wait for the accounts moderation?\u003cbr\u003e\nAccounts name are skavans and skavans2.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T08:33:10.617Z","updated_at":"2017-01-11T08:33:10.617Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1413364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just create new accounts. If we detect bot like pasting behavior the site will auto block you. So try typing instead of pasting.","markdown_message":"\u003cp\u003eJust create new accounts. If we detect bot like pasting behavior the site will auto block you. So try typing instead of pasting.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T12:02:40.585Z","updated_at":"2017-01-11T12:02:40.585Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1413410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This payload URL works in the saved post:\nhttps://89.223.28.48/bandcamp.com/album/index.html?XSS55555\n\nThe vulnerability exists because of poor opengraph variables values escaping together with wrong URL matcher regexp.\n\nExample post with stored XSS: https://try.discourse.org/t/tha-last-topic-to-test/581\n\nPlease let me know if you need some extra information to locate and fix the bug.","markdown_message":"\u003cp\u003eThis payload URL works in the saved post:\u003cbr\u003e\n\u003ca title=\"https://89.223.28.48/bandcamp.com/album/index.html?XSS55555\" href=\"/redirect?url=https%3A%2F%2F89.223.28.48%2Fbandcamp.com%2Falbum%2Findex.html%3FXSS55555\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://89.223.28.48/bandcamp.com/album/index.html?XSS55555\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability exists because of poor opengraph variables values escaping together with wrong URL matcher regexp.\u003c/p\u003e\n\n\u003cp\u003eExample post with stored XSS: \u003ca title=\"https://try.discourse.org/t/tha-last-topic-to-test/581\" href=\"/redirect?url=https%3A%2F%2Ftry.discourse.org%2Ft%2Ftha-last-topic-to-test%2F581\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://try.discourse.org/t/tha-last-topic-to-test/581\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you need some extra information to locate and fix the bug.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T12:23:50.737Z","updated_at":"2017-01-11T12:30:16.120Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":151524,"filename":"______________2017-01-11___15.18.27.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/151/524/b4483b16ad7c2e9e76a8d95409d69e8798b6ed5f/______________2017-01-11___15.18.27.png?response-content-disposition=attachment%3B%20filename%3D%22______________2017-01-11___15.18.27.png%22%3B%20filename%2A%3DUTF-8%27%27______________2017-01-11___15.18.27.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045202Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=8aebbd8b055de0864ee4c3e59cb0491c61e1d87818f6e3e383a07905f0dcac45"}],"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1414092,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-11T17:48:55.196Z","updated_at":"2017-01-11T17:48:55.196Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1414095,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@skavans thanks for your detailed report. We're fixing it.","markdown_message":"\u003cp\u003e\u003ca href=\"/skavans\"\u003e@skavans\u003c/a\u003e thanks for your detailed report. We\u0026#39;re fixing it.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T17:49:49.559Z","updated_at":"2017-01-11T17:49:49.559Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1414602,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"OK! I see the repro now.","markdown_message":"\u003cp\u003eOK! I see the repro now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T20:52:08.453Z","updated_at":"2017-01-11T20:52:08.453Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1414604,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-11T20:52:41.250Z","updated_at":"2017-01-11T20:52:41.250Z","actor":{"url":"/discourse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Discourse"}},"bounty_amount":"256.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"discourse","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1414696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for bounty :)","markdown_message":"\u003cp\u003eThanks for bounty :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T21:38:18.963Z","updated_at":"2017-01-11T21:38:18.963Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1431882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose?","markdown_message":"\u003cp\u003eCan we disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-20T05:49:02.879Z","updated_at":"2017-01-20T05:49:02.879Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1433919,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-20T23:49:06.333Z","updated_at":"2017-01-20T23:49:06.333Z","first_to_agree":true,"actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1433933,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-20T23:50:12.386Z","updated_at":"2017-01-20T23:50:12.386Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1433934,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-20T23:50:12.425Z","updated_at":"2017-01-20T23:50:12.425Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}